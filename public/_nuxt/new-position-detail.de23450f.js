import{_ as Po}from"./new-position-title.19a0338d.js";import{_ as io}from"./token-warning.dfe64ed2.js";import{_ as No}from"./status-block.612e8861.js";import{j as Go,n as zo,d as pe,e as oo,u as no,a as Y,g as mo,c as be,s as Le,m as Se,b as Oe,p as Ao,G as Ro,H as Oo,T as Co,C as Yo}from"./pool.2f1319f2.js";import{s as xe,m as Qo,l as Jo,b as Zo,a as Ko}from"./transform.c672907f.js";import{D as h}from"./decimal.0bdeb344.js";import{u as Ye,a as ao}from"./sha256.bc56e032.js";import{a as Qe,r as O,l as y,H as qo,q as _e,e as Je,o as C,f as B,t as qe,N as Bo,h as i,p as go,k as yo,m as so,s as Lo,i as de,u as z,v as j,j as Ae,x as fe,y as wo,a4 as Vo,b as lo,C as He,a8 as Io,O as $o,w as ze,F as vo,E as fo,B as uo,A as po,c as Me,D as xo,G as en,z as on,a1 as nn,Q as tn,S as an}from"./entry.ebd8291c.js";import{i as eo}from"./import-icon.de3e6c66.js";import{_ as ro}from"./assets-card.356f8d99.js";import{_ as sn}from"./coin-lock.5d5505e9.js";import{a as ln}from"./new-add-or-create.ab63399b.js";import{_ as un,a as rn}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              *//* empty css              */import{u as Mo}from"./notifi.6d69a8f8.js";/* empty css              *//* empty css              */import"./back.c4c1bc97.js";import"./swap-setting.3a9876aa.js";/* empty css              */import"./icon-error_2x.ce3832cf.js";/* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.b6dc3954.js";import"./useWhale.44c2e14c.js";import"./index.350531ce.js";const ho=Math.PI,bo=2*ho,Ge=1e-6,dn=bo-Ge;function Uo(e){this._+=e[0];for(let n=1,a=e.length;n<a;++n)this._+=arguments[n]+e[n]}function cn(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return Uo;const a=10**n;return function(s){this._+=s[0];for(let P=1,A=s.length;P<A;++P)this._+=Math.round(arguments[P]*a)/a+s[P]}}class mn{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?Uo:cn(n)}moveTo(n,a){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+a}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,a){this._append`L${this._x1=+n},${this._y1=+a}`}quadraticCurveTo(n,a,s,P){this._append`Q${+n},${+a},${this._x1=+s},${this._y1=+P}`}bezierCurveTo(n,a,s,P,A,R){this._append`C${+n},${+a},${+s},${+P},${this._x1=+A},${this._y1=+R}`}arcTo(n,a,s,P,A){if(n=+n,a=+a,s=+s,P=+P,A=+A,A<0)throw new Error(`negative radius: ${A}`);let R=this._x1,d=this._y1,o=s-n,c=P-a,p=R-n,l=d-a,b=p*p+l*l;if(this._x1===null)this._append`M${this._x1=n},${this._y1=a}`;else if(b>Ge)if(!(Math.abs(l*o-c*p)>Ge)||!A)this._append`L${this._x1=n},${this._y1=a}`;else{let H=s-R,ne=P-d,x=o*o+c*c,ce=H*H+ne*ne,v=Math.sqrt(x),m=Math.sqrt(b),q=A*Math.tan((ho-Math.acos((x+b-ce)/(2*v*m)))/2),t=q/m,k=q/v;Math.abs(t-1)>Ge&&this._append`L${n+t*p},${a+t*l}`,this._append`A${A},${A},0,0,${+(l*H>p*ne)},${this._x1=n+k*o},${this._y1=a+k*c}`}}arc(n,a,s,P,A,R){if(n=+n,a=+a,s=+s,R=!!R,s<0)throw new Error(`negative radius: ${s}`);let d=s*Math.cos(P),o=s*Math.sin(P),c=n+d,p=a+o,l=1^R,b=R?P-A:A-P;this._x1===null?this._append`M${c},${p}`:(Math.abs(this._x1-c)>Ge||Math.abs(this._y1-p)>Ge)&&this._append`L${c},${p}`,s&&(b<0&&(b=b%bo+bo),b>dn?this._append`A${s},${s},0,1,${l},${n-d},${a-o}A${s},${s},0,1,${l},${this._x1=c},${this._y1=p}`:b>Ge&&this._append`A${s},${s},0,${+(b>=ho)},${l},${this._x1=n+s*Math.cos(A)},${this._y1=a+s*Math.sin(A)}`)}rect(n,a,s,P){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+a}h${s=+s}v${+P}h${-s}Z`}toString(){return this._}}function Ke(e){return function(){return e}}function vn(e){let n=3;return e.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const s=Math.floor(a);if(!(s>=0))throw new RangeError(`invalid digits: ${a}`);n=s}return e},()=>new mn(n)}function fn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function jo(e){this._context=e}jo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:this._context.lineTo(e,n);break}}};function pn(e){return new jo(e)}function hn(e){return e[0]}function bn(e){return e[1]}function kn(e,n){var a=Ke(!0),s=null,P=pn,A=null,R=vn(d);e=typeof e=="function"?e:e===void 0?hn:Ke(e),n=typeof n=="function"?n:n===void 0?bn:Ke(n);function d(o){var c,p=(o=fn(o)).length,l,b=!1,H;for(s==null&&(A=P(H=R())),c=0;c<=p;++c)!(c<p&&a(l=o[c],c,o))===b&&((b=!b)?A.lineStart():A.lineEnd()),b&&A.point(+e(l,c,o),+n(l,c,o));if(H)return A=null,H+""||null}return d.x=function(o){return arguments.length?(e=typeof o=="function"?o:Ke(+o),d):e},d.y=function(o){return arguments.length?(n=typeof o=="function"?o:Ke(+o),d):n},d.defined=function(o){return arguments.length?(a=typeof o=="function"?o:Ke(!!o),d):a},d.curve=function(o){return arguments.length?(P=o,s!=null&&(A=P(s)),d):P},d.context=function(o){return arguments.length?(o==null?s=A=null:A=P(s=o),d):s},d}function So(){}function Eo(e){this._context=e}Eo.prototype={areaStart:So,areaEnd:So,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,n){e=+e,n=+n,this._point?this._context.lineTo(e,n):(this._point=1,this._context.moveTo(e,n))}};function gn(e){return new Eo(e)}function To(e,n,a){const s=new h(10).pow(n-a);return new h(1.0001).pow(e).mul(s)}const yn=Qe({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,n){const a=O(1),s=O(""),P=O(""),A=y(()=>{var t,k,I;return l.sqrtPriceX64ToPrice((t=e.poolInfo)==null?void 0:t.current_sqrt_price,(k=e.poolInfo)==null?void 0:k.coinA.decimals,(I=e.poolInfo)==null?void 0:I.coinB.decimals).toString()}),R=y(()=>{let t=0;return e.direction?t=(Number(e.minPrice)/Number(A.value)-1)*100:t=(Number(e.minPrice)/Number(1/Number(A.value))-1)*100,t=t>0&&t<.1?.1:t,t=t<0&&t>-.1?-.1:t,t}),d=y(()=>{let t=0;return e.direction?t=(Number(e.maxPrice)/Number(A.value)-1)*100:t=(Number(e.maxPrice)/Number(1/Number(A.value))-1)*100,t=t>0&&t<.1?.1:t,t=t<0&&t>-.1?-.1:t,t}),o=Ye(),c=y(()=>o),p=y(()=>c.value.chainName?oo(c.value.chainName):{}),{TickMath:l,getNearestTickByTick:b}=p.value,H=()=>{const t=a.value/2;a.value=t,ce(e.poolInfo,t)},ne=()=>{const t=a.value*2;a.value=t,ce(e.poolInfo,t)},x=(t=[])=>{let k=6;const I=Math.abs(Number(t[0])-Number(t[t.length-1]));return I>=6?k=0:I>=1?k=1:I>=.1?k=2:I>=.01?k=3:I>=.001?k=4:I>=1e-4?k=5:I>=1e-5?k=6:I>=1e-6?k=7:I>=1e-7&&(k=8),k},ce=(t,k=1)=>{if(t&&t.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const I=Number(e.poolInfo.current_tick_index);let _=I+100*k,r=I-100*k,V,X;if(e.maxPrice==="∞")X=p.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?X=l.priceToTickIndex(new h(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):X=l.priceToTickIndex(new h(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{X=443636}if(e.minPrice==="0")V=p.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?V=l.priceToTickIndex(new h(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):V=l.priceToTickIndex(new h(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{V=-443636}let ue=0;if(e.currentPriceTab!=="full range"){if(I>=V&&I<=X){const M=I-V,me=X-I;ue=Math.max(Math.abs(M),Math.abs(me))}else I<V?ue=Math.abs(X-I):ue=Math.abs(I-V);_=I+ue+100*k,r=I-ue-100*k}else{const M=(Math.abs(I)>5e3,2e4);_=I+M*k,r=I-M*k}r<-443636&&(r=-443636),_>443636&&(_=443636);const ee=new h(t.liquidity).div(Math.pow(10,8)).toString(),L=e.tickList,D=[],J=[];let oe={};for(let M=0;M<L.length;M++){if(oe=L[M],oe.index<=I&&oe.index>=r){if(D.length<1&&M!==0){const me=L[M-1];D.unshift({...me,index:r})}D.unshift(oe)}else if(oe.index>I&&oe.index<=_&&(J.push(oe),D.length<1&&M!==0)){const me=L[M-1];D.push({...me,index:r})}if(oe.index>_){const me=L[M];if(J.push({...me,index:_}),D.length<1&&M!==0){const ge=L[M-1];D.push({...ge,index:r})}break}}let ae="0";for(let M=D.length-1;M>=0;M--)ae=new h(ae).plus(new h(D[M].liquidityNet.toString()).div(Math.pow(10,8))).toString(),D[M].liquityAmount=ae;let K=ee;for(let M=0;M<J.length;M++)K=new h(K).plus(new h(J[M].liquidityNet.toString()).div(Math.pow(10,8))).toString(),J[M].liquityAmount=K;let re=[];const Z=L&&L.length>0?{index:I,liquityAmount:Number(ee)}:{index:I,liquityAmount:0};(D.length>0||J.length>0)&&(re=[...D.reverse(),Z,...J],e.direction||(re=re.reverse()));const ke=[];L.forEach(M=>{ke.push({...M,liquidityGross:M.liquidityGross.toString(),liquidityNet:M.liquidityNet.toString()})}),m(re,r,_,V,X,I)}};let v=O(!1);qo(()=>{document.body.clientWidth<750?v.value=!1:v.value=!0,window.onresize=()=>{document.body.clientWidth<750?v.value=!1:v.value=!0,ce(e.poolInfo,a.value)}});const m=(t,k,I,_,r,V)=>{let X,ue;e.direction?(X=e.before7dContractPriceLowest?l.priceToTickIndex(new h(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ue=e.before7dContractPriceHighest?l.priceToTickIndex(new h(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(X=e.before7dContractPriceLowest?l.priceToTickIndex(new h(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ue=e.before7dContractPriceHighest?l.priceToTickIndex(new h(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const ee={top:30,right:35,bottom:20,left:55};let L,D;v.value,L=340-ee.left-ee.right,D=205-ee.top-ee.bottom;const J=I-k,oe=parseInt(String(J/4));let ae=[k+oe/4,k+oe,k+2*oe,I-oe,I-oe/4];const K=k,re=I,Z=L/(re-K);e.currentPriceTab==="full range"&&(ae=[k,k+2*oe,I]);const ke=ae.map($=>e.direction?To($,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new h(1).div(To($,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());x(ke),xe("#chart").selectAll("*").remove();const M=xe("#chart").attr("width",L+ee.left+ee.right).attr("height",D+ee.top+ee.bottom).append("g").attr("transform",`translate(${ee.left},${ee.right})`),me=Qo(t,function($){return Number(Math.abs($.liquityAmount))})||0,ge=Jo().range([0,D]).domain([me,0]);Zo().rangeRound([0,L]).padding(.1);const u=M.append("g").attr("id","barsBox").selectAll("rect").data(t).enter().append("rect");c.value.theme=="default"?u.attr("x",function($,N){return N===0?0:e.direction?Math.abs($.index-K)*Z:Math.abs(re-$.index)*Z}).attr("y",function($,N){return e.direction?N===t.length-1?0:ge($.liquityAmount):N===t.length-1?0:ge(t[N+1].liquityAmount)}).attr("width",function($,N){return N===0&&t.length===1&&$.liquityAmount>0?L:(e.direction,N!==t.length-1?Math.abs(t[N+1].index-$.index)*Z:0)}).attr("height",function($,N){return N===0&&t.length===1&&$.liquityAmount>0?D:e.direction?N===t.length-1?0:D-ge($.liquityAmount):N===t.length-1?0:D-ge(t[N+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):u.attr("x",function($,N){return N===0?0:e.direction?Math.abs($.index-K)*Z:Math.abs(re-$.index)*Z}).attr("y",function($,N){return e.direction?N===t.length-1?0:ge(Math.abs($.liquityAmount)):N===t.length-1?0:ge(Math.abs(t[N+1].liquityAmount))}).attr("width",function($,N){return N===0&&t.length===1&&$.liquityAmount>0?L:(e.direction,N!==t.length-1?Math.abs(t[N+1].index-$.index)*Z:0)}).attr("height",function($,N){if(N===0&&t.length===1&&$.liquityAmount>0)return D;if(e.direction)return N===t.length-1?0:Number($.liquityAmount)?D-ge(Math.abs($.liquityAmount)):0;{if(N===t.length-1)return 0;const le=D-ge(Math.abs(t[N+1].liquityAmount));return Number(t[N+1].liquityAmount)?le:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const f=M.append("g");f.append("line").attr("x1",0).attr("y1",155).attr("x2",L).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),f.append("g");let T=0;e.direction?T=Math.abs(V-K)*Z:T=Math.abs(V-re)*Z,(c.value.theme=="default"?M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+T+", 0)"),xe("#triangle").attr("width",8).attr("height",4);let E=[[0,0],[4,4],[8,0]],G=kn().x(function($){return $[0]}).y(function($){return $[1]}).curve(gn);const U=T-4;M.append("path").attr("d",G(E)).style("fill",c.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+U+", 0)");let F,W,te,se;e.direction?(F=_<K?-100:parseInt(String(Math.abs(_-K)*Z)),W=r<K?-100:parseInt(String(Math.abs(r-K)*Z)),te=X<K?-100:Math.abs(X-K)*Z,se=ue<K?-100:Math.abs(ue-K)*Z):(W=_<K?-100:Math.abs(re-_)*Z,F=r<K?-100:Math.abs(re-r)*Z,se=X<K?-100:Math.abs(re-X)*Z,te=ue<K?-100:Math.abs(re-ue)*Z),e.minPrice==="0"&&(F=0),e.maxPrice==="∞"&&(W=L),v.value?s.value=L-F+60+"px":s.value=L-F+52+"px",P.value=W+74+"px",X&&te<L&&M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+te+", 0)"),ue&&se<L&&M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+se+", 0)");const he=Ko().extent([[0,0],[L,D]]).handleSize(30).on("end",we);M.append("g").attr("class","brush").call(he).call(he.move,[F,W]);function we($){if(!$.sourceEvent||!$.selection)return;v.value?s.value=L-$.selection[0]+60+"px":s.value=L-$.selection[0]+52+"px",P.value=$.selection[1]+74+"px";let N,le,ye=0,g=0;e.direction?(ye=b(parseInt(String($.selection[0]/Z+K)),Number(e.poolInfo.tickSpacing)),N=l.tickIndexToPrice(ye,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),g=b(parseInt(String($.selection[1]/Z+K)),Number(e.poolInfo.tickSpacing)),le=l.tickIndexToPrice(g,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):(g=b(re-$.selection[0]/Z,Number(e.poolInfo.tickSpacing)),N=1/l.tickIndexToPrice(g,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ye=b(re-$.selection[1]/Z,Number(e.poolInfo.tickSpacing)),le=1/l.tickIndexToPrice(ye,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),n.emit("onChangeMinPrice",String(pe(String(N),6))),n.emit("onChangeMaxPrice",String(pe(String(le),6)))}c.value.theme=="default"?xe(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):xe(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};O(""),_e(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([t,k,I,_])=>{t&&k&&I&&ce(t,a.value)},{immediate:!0});const q=O(!0);return _e(()=>e.chartLoading,(t,k)=>{t!==k&&(q.value=t)},{immediate:!0,deep:!0}),{store:c,loading:q,zoomOut:H,zoomIn:ne,rangeSizeLower:R,rangeSizeUpper:d,rangeSizeLowerPosition:s,rangeSizeUpperPosition:P,decimalFormat:Go,numberformat:zo}}});const wn=e=>(go("data-v-59ae7c8b"),e=e(),yo(),e),_n={class:"chart-box"},An={class:"chart"},Cn=wn(()=>i("svg",{id:"chart"},null,-1)),In=[Cn];function $n(e,n,a,s,P,A){return C(),B("div",_n,[qe(i("div",An,In,512),[[Bo,!e.loading]])])}const Do=Je(yn,[["render",$n],["__scopeId","data-v-59ae7c8b"]]),Sn=Qe({components:{StatusBlock:No,NewPositionChart:Do,TokenWarning:io},setup(e){const n=O(),a=O(),s=y(()=>{var t,k;return(k=(t=l.value)==null?void 0:t.poolInfo)==null?void 0:k.needReverse}),P=Ye(),A=y(()=>P),R=y(()=>A.value.currentExplorer),d=y(()=>A.value.theme),o=y(()=>A.value.chainName),c=no(),p=y(()=>c),l=O({}),b=so();_e(()=>[p.value.currentPositionInfo,o.value],([t,k])=>{var I;(k=="Aptos"&&t||k=="Sui"&&t&&(t==null?void 0:t.nftHash)==((I=b==null?void 0:b.query)==null?void 0:I.pos))&&(l.value=t,n.value=l.value.token_a,a.value=l.value.token_b)},{immediate:!0});const H=t=>{var k;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((k=p.value.tokensObj[t==null?void 0:t.address])==null?void 0:k.logo_url)||(d.value==="default"?eo("/image/coins/unknown.png"):eo("/image/coins/sui-unknown.png"))},ne=y(()=>o.value?oo(o.value):{}),x=O([]),ce=async t=>{const k=await ne.value.getTicks(t),I=k?ne.value.getTickDataFromUrlData(k):[];x.value=I};_e(()=>[l.value,p.value.poolsObj],([t,k])=>{t&&!be(t)&&t.poolInfo&&k&&!be(k)&&ce(k[t.poolAddress])},{immediate:!0});const v=O(!0),m=(t,k)=>t!=="0"&&k!=="∞"?Le(1/(1-Number((t/k)**.25)),2)+"x":"1x",q=y(()=>l.value.minPrice&&l.value.maxPrice?m(l.value.minPrice,l.value.maxPrice):"--");return{needReverse:s,getCoinIcon:H,theme:d,indexStore:P,direct:v,addCommom:Y,decimalUi:pe,tickList:x,positionInfo:l,fromCoin:n,toCoin:a,getExplorerUrl:mo,lever:q,currentExplorer:R}}}),Tn=""+globalThis.__publicAssetsURL("image/aptos-price.png"),Pn=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),Nn=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),Rn=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Fe=e=>(go("data-v-0ec88d9c"),e=e(),yo(),e),On={class:"new-position-info"},qn={class:"pool-info"},Bn={class:"left"},Ln={class:"coin-a"},Mn={alt:""},Un={class:"coin-b"},jn={alt:""},En={class:"position-name"},Dn=["href"],Fn=Fe(()=>i("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),Wn=[Fn],Hn={key:0,class:"pool-fee"},Xn=Fe(()=>i("span",null,"Fee tier",-1)),Gn={class:"right"},zn={class:"h5-pool-info"},Yn={class:"coin-info"},Qn={class:"coin-a"},Jn={alt:""},Zn={class:"coin-b"},Kn={alt:""},Vn={class:"position-name"},xn=["href"],et=Fe(()=>i("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),ot=[et],nt={key:0,class:"pool-fee"},tt={class:"price-info"},it={class:"price-and-chart"},at={class:"left"},st={class:"current-price"},lt=Fe(()=>i("span",null,"Current Price",-1)),ut={class:"coin-rate"},rt=Fe(()=>i("div",null,[i("svg",{class:"icon icon-up","aria-hidden":"true"},[i("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),dt=Fe(()=>i("div",null,[i("svg",{class:"icon icon-down","aria-hidden":"true"},[i("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),ct=[rt,dt],mt={key:0},vt={key:1},ft={key:0,class:"position-range"},pt=Fe(()=>i("div",{class:"position-range-title"}," Position Range ",-1)),ht={key:0},bt={key:1},kt={key:2,src:Tn,alt:""},gt={key:3,src:Pn,alt:""},yt={key:4},wt={key:5},_t={key:1,class:"position-range position-range-warp"},At={key:0,class:"position-range-title"},Ct={key:1,class:"position-range-title"},It={key:2},$t={key:3},St={class:"price-img"},Tt={key:0,src:Nn,alt:""},Pt={key:1,src:Rn,alt:""},Nt={key:4},Rt={key:5},Ot={class:"lever"},qt=Fe(()=>i("div",{class:"lever-title"},"Leverage",-1)),Bt={class:"lever-text"},Lt={class:"right"},Mt=Fe(()=>i("div",{class:"chat-mask"},null,-1));function Ut(e,n,a,s,P,A){var p,l,b,H,ne,x,ce,v,m,q,t,k,I,_,r,V,X,ue,ee,L,D,J,oe,ae,K,re,Z,ke,M,me;const R=io,d=No,o=Do,c=Lo("image");return C(),B("div",On,[i("div",qn,[i("div",Bn,[i("div",Ln,[qe(i("img",Mn,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),de(R,{address:e.needReverse?(H=(b=e.positionInfo)==null?void 0:b.token_b)==null?void 0:H.address:(l=(p=e.positionInfo)==null?void 0:p.token_a)==null?void 0:l.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),i("div",Un,[qe(i("img",jn,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),de(R,{address:e.needReverse?(v=(ce=e.positionInfo)==null?void 0:ce.token_a)==null?void 0:v.address:(x=(ne=e.positionInfo)==null?void 0:ne.token_b)==null?void 0:x.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),i("div",En,[i("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:z(mo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},j((q=(m=e.positionInfo)==null?void 0:m.name)==null?void 0:q.split("|")[1]),9,Dn)]),(C(),B("svg",{class:"copy-icon","aria-hidden":"true",onClick:n[0]||(n[0]=ge=>e.indexStore.copy(e.positionInfo.nftHash))},Wn)),e.positionInfo.fee?(C(),B("div",Hn,[Xn,Ae(" "+j(e.positionInfo.fee*100)+"% ",1)])):fe("",!0)]),i("div",Gn,[de(d,{"current-status":(t=e.positionInfo)==null?void 0:t.currentStatus},null,8,["current-status"])])]),i("div",zn,[i("div",null,[i("div",Yn,[i("div",Qn,[qe(i("img",Jn,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),de(R,{address:e.needReverse?(r=(_=e.positionInfo)==null?void 0:_.token_b)==null?void 0:r.address:(I=(k=e.positionInfo)==null?void 0:k.token_a)==null?void 0:I.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),i("div",Zn,[qe(i("img",Kn,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),de(R,{address:e.needReverse?(ee=(ue=e.positionInfo)==null?void 0:ue.token_a)==null?void 0:ee.address:(X=(V=e.positionInfo)==null?void 0:V.token_b)==null?void 0:X.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),i("div",Vn,[i("div",null,[i("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:z(mo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},j((D=(L=e.positionInfo)==null?void 0:L.name)==null?void 0:D.split("|")[1]),9,xn),(C(),B("svg",{class:"copy-icon","aria-hidden":"true",onClick:n[1]||(n[1]=ge=>e.indexStore.copy(e.positionInfo.nftHash))},ot))]),e.positionInfo.fee?(C(),B("div",nt,j(e.positionInfo.fee*100)+"%",1)):fe("",!0)])]),de(d,{"current-status":(J=e.positionInfo)==null?void 0:J.currentStatus},null,8,["current-status"])]),i("div",tt,[i("div",it,[i("div",at,[i("div",st,[i("div",null,[lt,i("div",ut,[i("div",{onClick:n[2]||(n[2]=ge=>e.direct=!e.direct)},ct)])]),(e.needReverse?!e.direct:e.direct)?(C(),B("div",mt,[Ae(j(("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(e.positionInfo.currentPrice,6)))+"   ",1),i("span",null,j((oe=e.toCoin)==null?void 0:oe.symbol)+" per "+j((ae=e.fromCoin)==null?void 0:ae.symbol),1)])):(C(),B("div",vt,[Ae(j(("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(e.positionInfo.currentPriceReverse,6)))+"   ",1),i("span",null,j((K=e.fromCoin)==null?void 0:K.symbol)+" per "+j((re=e.toCoin)==null?void 0:re.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(C(),B("div",ft,[pt,i("div",null,[(e.needReverse?!e.direct:e.direct)?(C(),B("div",ht,[Ae(j(("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(e.positionInfo.minPrice,6)))+" ",1),i("span",null,j(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(C(),B("div",bt,[Ae(j(((Z=e.positionInfo)==null?void 0:Z.minPrice)!=="0"?("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(1/e.positionInfo.minPrice,6)):0)+" ",1),i("span",null,j(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(C(),B("img",kt)):(C(),B("img",gt)),(e.needReverse?!e.direct:e.direct)?(C(),B("div",yt,[Ae(j(((ke=e.positionInfo)==null?void 0:ke.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(e.positionInfo.maxPrice,6)):"∞")+" ",1),i("span",null,j(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(C(),B("div",wt,[Ae(j(((M=e.positionInfo)==null?void 0:M.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),i("span",null,j(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(C(),B("div",_t,[(e.needReverse?!e.direct:e.direct)?(C(),B("span",At," Position Range ")):(C(),B("span",Ct," Position Range ")),(e.needReverse?!e.direct:e.direct)?(C(),B("div",It,[Ae(j(("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(e.positionInfo.minPrice,6)))+" ",1),i("span",null,j(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(C(),B("div",$t,[Ae(j(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),i("span",null,j(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),i("div",St,[e.theme=="default"?(C(),B("img",Tt)):(C(),B("img",Pt))]),(e.needReverse?!e.direct:e.direct)?(C(),B("div",Nt,[Ae(j(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(e.positionInfo.maxPrice,6)):"∞")+" ",1),i("span",null,j(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(C(),B("div",Rt,[Ae(j(((me=e.positionInfo)==null?void 0:me.minPrice)!=="0"?("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(1/e.positionInfo.minPrice,6)):0)+" ",1),i("span",null,j(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),Ae("   ")]))])),i("div",Ot,[qt,i("div",Bt,j(e.lever),1)])]),i("div",Lt,[de(o,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse&&e.positionInfo.maxPrice!=="∞"?1/e.positionInfo.maxPrice:e.positionInfo.minPrice,"max-price":e.needReverse&&e.positionInfo.minPrice!=0?1/e.positionInfo.minPrice:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),Mt])])])])}const Fo=Je(Sn,[["render",Ut],["__scopeId","data-v-0ec88d9c"]]),jt=Qe({components:{TokenWarning:io},setup(e,n){const{t:a}=wo(),{$notify:s}=Vo(),P=Ye(),A=y(()=>P),R=no(),d=y(()=>R),o=O({}),c=O({}),p=O({}),l=y(()=>A.value.chainName),b=y(()=>l.value?oo(l.value):{}),H=so(),ne=O(!1),x=async(u=null)=>{const f=u||o.value,T=d.value.addressLpTokens[f.poolAddress];if(T){const w=await b.value.getTickDataByIndex(T.ticks_handle,Number(f.tick_lower_index)),E=await b.value.getTickDataByIndex(T.ticks_handle,Number(f.tick_upper_index));let G={};l.value==="Aptos"?G=await b.value.getPosRewardersAmount({poolAddress:I.currentRoute.value.query.address,positionName:I.currentRoute.value.query.token,tickLowerData:w,tickUpperData:E}):G=await b.value.fetchPosRewardersAmount({poolAddress:f.poolAddress,positionId:f.pos_object_id,coinTypeA:f.coin_type_a,coinTypeB:f.coin_type_b,rewarderInfo:f.poolInfo.rewarder_infos});const U=[];let F=new h(0);G.forEach((W,te)=>{var $,N;const se=($=d.value.tokensObj[W.coin_address])==null?void 0:$.decimals,he=W.amount_owed.toString();let we=new h(he).div(Math.pow(10,se)).toString();if(l.value=="Aptos"&&Number(we)>999999999&&(we="0"),f.poolInfo[`rewarder_display${te+1}`]||Number(we)>0){const le=d.value.tokensObj[W.coin_address],ye=((N=d.value.RATES[W.coin_address])==null?void 0:N.price)||0,g=new h(we).mul(ye).toString();F=new h(F).plus(g),U.push({...W,...le,amount:Number(we)>0?Se(we,se):0,amountUSD:Number(g)>0?Se(g,2):0,amountUSDText:g})}}),_.value=U}};_e(()=>[d.value.currentPositionInfo,l.value],([u,f])=>{var T;f=="Aptos"&&u?(o.value=u,c.value=u==null?void 0:u.token_a,p.value=u==null?void 0:u.token_b):f=="Sui"&&u&&(u==null?void 0:u.nftHash)==((T=H==null?void 0:H.query)==null?void 0:T.pos)&&(o.value=u,c.value=u==null?void 0:u.token_a,p.value=u==null?void 0:u.token_b,ne.value=!1)},{immediate:!0}),_e(()=>[o.value,d.value.addressLpTokens],([u,f])=>{!be(u)&&!be(f)&&x(u)},{immediate:!0});const ce=y(()=>{var u,f,T,w,E,G,U,F;if(o.value&&!be(o.value)&&d.value.RATES){const W=o.value.amountA*((f=d.value.RATES[(u=o.value)==null?void 0:u.token_a.address])==null?void 0:f.price),te=o.value.amountB*((w=d.value.RATES[(T=o.value)==null?void 0:T.token_b.address])==null?void 0:w.price);if((G=d.value.RATES[(E=o.value)==null?void 0:E.token_a.address])!=null&&G.price&&((F=d.value.RATES[(U=o.value)==null?void 0:U.token_b.address])!=null&&F.price)){const se=Number(W+te);return se>0&&se<.01?"<0.01":Y(Le(W+te,2),2)}else return" --"}else return" --"}),v=y(()=>{var u,f;return(f=(u=o.value)==null?void 0:u.poolInfo)==null?void 0:f.needReverse}),m=y(()=>d.value.RATES),q=y(()=>{var u,f;if(m.value&&c.value&&p.value&&!be(m.value)&&!be(c.value)&&!be(p.value)){const T=[],w=Number(o.value.feeOwedA)||0,E=Number(o.value.feeOwedB)||0,G=new h(w).mul(((u=m.value[c.value.address])==null?void 0:u.price)||0),U=new h(E).mul(((f=m.value[p.value.address])==null?void 0:f.price)||0);return T.push({amount:w,amountUSD:G.toString()},{amount:E,amountUSD:U.toString()}),T}return[]}),t=y(()=>{var f,T;let u=new h(0);return(f=q.value)==null||f.forEach(w=>{u=u.add(new h(w.amountUSD))}),l.value=="Sui"&&((T=_.value)==null||T.forEach(w=>{u=u.add(new h(w.amountUSDText))})),u.toNumber()}),k=y(()=>{var f;let u=new h(0);return(f=_.value)==null||f.forEach(T=>{u=u.add(new h(T.amountUSDText))}),u.toNumber()}),I=lo(),_=O([]),{setIsShowSuccess:r,setIsShowRejected:V,setIsShowWaiting:X,setTransactionDesc:ue,setTransactionTxid:ee}=P,L=ao(),D=y(()=>L),J=async()=>{ne.value=!0;let u={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:_.value.length,collect_fee:!0};u.coinTypeC=_.value[0]?_.value[0].coin_address:"",u.coinTypeD=_.value[1]?_.value[1].coin_address:"",u.coinTypeE=_.value[2]?_.value[2].coin_address:"",X(!0),ue();try{let f;if(l.value==="Aptos"){const T=await b.value.getCollectRewarderTransactionPayload(u);f=await D.value.currentWallet.signAndSubmitTransaction(T)}else{u.pos_index=o.value.pos_object_id;const T=await b.value.getCollectRewarderTransactionPayload(u),w=await D.value.currentWallet.signAndExecuteTransactionBlock(T);f=b.value.handleTx(w)}if(f&&f.hash){ee(f.hash),X(!1),r(!0);const T={title:"Claim",desc:"",hash:f.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};l.value!=="Aptos"&&(T.res=f.res),b.value.showTransitionPending(T),await b.value.watchTransaction(T)&&n.emit("getDetails")}else X(!1),V(!0),ne.value=!1}catch{X(!1),V(!0),ne.value=!1}},oe=O(!1),ae=async()=>{oe.value=!0;const u=_.value;let f={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:u.length};f.coinTypeC=u[0]?u[0].coin_address:"",f.coinTypeD=u[1]?u[1].coin_address:"",f.coinTypeE=u[2]?u[2].coin_address:"";try{let T;if(l.value==="Aptos"){const w=await b.value.getCollectRewarderTransactionPayload(f);T=await D.value.currentWallet.signAndSubmitTransaction(w)}else{f.pos_index=o.value.pos_object_id;const w=await b.value.getCollectRewarderTransactionPayload(f),E=await D.value.currentWallet.signAndExecuteTransactionBlock(w);T=b.value.handleTx(E)}if(T&&T.hash){ee(T.hash),X(!1),r(!0);const w=u[0].amount+u[0].symbol,E=f.coinTypeD?" and "+u[1].amount+u[1].symbol:"",G=f.coinTypeE?" and "+u[2].amount+u[2].symbol:"",U={title:"Claim",desc:"",hash:T.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:u[0].address,numa:`+ ${Number(u[0].amount)}`,logoa:d.value.tokensObj&&u[0]&&u[0].address&&d.value.tokensObj[u[0].address]&&d.value.tokensObj[u[0].address].logoURI,tokenb:u[1]&&u[1].address,numb:f.coinTypeD?`+ ${Number(u[1].amount)}`:"",logob:f.coinTypeD?d.value.tokensObj&&u[1]&&u[1].address&&d.value.tokensObj[u[1].address]&&d.value.tokensObj[u[1].address].logoURI:"",tokenc:u[2]&&u[2].address,numc:f.coinTypeE?`+ ${Number(u[2].amount)}`:"",logoc:f.coinTypeE?d.value.tokensObj&&u[2]&&u[2].address&&d.value.tokensObj[u[2].address]&&d.value.tokensObj[u[2].address].logoURI:""},text:w+E+G};l.value!=="Aptos"&&(U.res=T.res),b.value.showTransitionPending(U),await b.value.watchTransaction(U)&&setTimeout(()=>{n.emit("getDetails"),b.value.getAccount(D.value.address)},3e3)}else X(!1),V(!0);oe.value=!1}catch{oe.value=!1,X(!1),V(!0)}},K=y(()=>d.value.positionDetailCurrentTab),re=y(()=>{var T,w,E,G,U,F;const u=pe(v.value?(w=o.value)==null?void 0:w.amountB:(T=o.value)==null?void 0:T.amountA,v.value?(F=(U=o.value)==null?void 0:U.token_b)==null?void 0:F.decimals:(G=(E=o.value)==null?void 0:E.token_a)==null?void 0:G.decimals),f=v.value?d.value.positionActionAmount.toCoinAmount||0:d.value.positionActionAmount.fromCoinAmount||0;if(K.value=="increase")return f?new h(u).add(new h(f)).toString():"";if(f){const W=new h(u).minus(new h(f)).toString();return W<0?"0":String(W)}else return""}),Z=y(()=>{var T,w,E,G,U,F;const u=pe(v.value?(w=o.value)==null?void 0:w.amountA:(T=o.value)==null?void 0:T.amountB,v.value?(F=(U=o.value)==null?void 0:U.token_a)==null?void 0:F.decimals:(G=(E=o.value)==null?void 0:E.token_b)==null?void 0:G.decimals),f=v.value?d.value.positionActionAmount.fromCoinAmount||0:d.value.positionActionAmount.toCoinAmount||0;if(K.value=="increase")return f?new h(u).add(new h(f)).toString():"";if(f){const W=new h(u).minus(new h(f)).toString();return W<0?"0":String(W)}else return""}),ke=y(()=>v.value?d.value.positionActionAmount.toCoinAmount:d.value.positionActionAmount.fromCoinAmount),M=y(()=>v.value?d.value.positionActionAmount.fromCoinAmount:d.value.positionActionAmount.toCoinAmount),me=u=>{var f;return(u==null?void 0:u.logoURI)||(u==null?void 0:u.logo_url)||((f=d.value.tokensObj[u==null?void 0:u.address])==null?void 0:f.logo_url)||(A.value.theme==="default"?eo("/image/coins/unknown.png"):eo("/image/coins/sui-unknown.png"))},ge=y(()=>{var G,U,F,W,te,se,he,we,$,N,le,ye;const{fromCoinAmount:u,toCoinAmount:f}=d.value.positionActionAmount,T=d.value.positionDetailCurrentTab,w=pe(v.value?(U=o.value)==null?void 0:U.amountB:(G=o.value)==null?void 0:G.amountA,v.value?(se=(te=o.value)==null?void 0:te.token_b)==null?void 0:se.decimals:(W=(F=o.value)==null?void 0:F.token_a)==null?void 0:W.decimals),E=pe(v.value?(we=o.value)==null?void 0:we.amountA:(he=o.value)==null?void 0:he.amountB,v.value?(ye=(le=o.value)==null?void 0:le.token_a)==null?void 0:ye.decimals:(N=($=o.value)==null?void 0:$.token_b)==null?void 0:N.decimals);return l.value=="Sui"||T=="remove"&&l.value=="Aptos"&&u==w&&f==E});return{amountUSD:ce,needReverse:v,decimalUi:pe,pendingFees:q,positionInfo:o,pendingRewarderArr:_,pendingYieldAmount:t,toClaim:async()=>{ne.value=!0;const u=Y(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,f=Y(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;ue(a("newAdd.claimWaitingText",{from:v.value?f:u,and:Y(o.value.feeOwedA,o.value.token_a.decimals)==0||Y(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:v.value?u:f})),X(!0);let T;const w={pool:o.value.poolInfo,position:o.value};try{const E=await b.value.getCollectFeeTransactionPayload(w);if(l.value==="Aptos")T=await D.value.currentWallet.signAndSubmitTransaction(E);else{const G=await D.value.currentWallet.signAndExecuteTransactionBlock(E);T=b.value.handleTx(G)}if(T){ee(T.hash),X(!1),r(!0);const G={title:"Claim",desc:"",hash:T.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:Y(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:Y(o.value.feeOwedA,o.value.token_a.decimals)==0?"":d.value.tokensObj&&o.value&&o.value.token_a.address&&d.value.tokensObj[o.value.token_a.address]&&d.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:Y(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:Y(o.value.feeOwedB,o.value.token_b.decimals)==0?"":d.value.tokensObj&&o.value&&o.value.token_b.address&&d.value.tokensObj[o.value.token_b.address]&&d.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${Y(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${Y(o.value.feeOwedA,o.value.token_a.decimals)==0||Y(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${Y(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};l.value!=="Aptos"&&(G.res=T.res),b.value.showTransitionPending(G),await b.value.watchTransaction(G)&&setTimeout(()=>{n.emit("getDetails")},1e3)}else X(!1),V(!0),s.error({icon:He("svg",{class:{icon:!0},"aria-hidden":!0},[He("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:He("div",{class:"notification-title"},[He("span",{innerHTML:Io.global.t("newAdd.claimFailed")},null)]),description:a("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});ne.value=!1}catch{ne.value=!1,X(!1),V(!0),s.error({icon:He("svg",{class:{icon:!0},"aria-hidden":!0},[He("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:He("div",{class:"notification-title"},[He("span",{innerHTML:Io.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:a("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},claimAll:J,fromCoin:c,toCoin:p,showNum:Se,claimLoading:ne,addCommom:Y,afterBase:re,afterQuote:Z,fromCoinAmount:ke,toCoinAmount:M,checkNullObj:be,getCoinIcon:me,chainName:l,isShowAfterAmount:ge,pendingRewarderAmount:k,toClaimRewards:ae,rewarderLoading:oe}}});const Et={class:"liquidity-card"},Dt={class:"liquidity-title"},Ft={class:"liquidity-usd"},Wt=i("span",null,"Liquidity",-1),Ht={class:"liquidity-ratio"},Xt={class:"coin-ratio"},Gt={class:"coin-a-ratio"},zt={class:"coin-b-ratio"},Yt={class:"ratio-progress"},Qt={class:"base-quote-num"},Jt={class:"base-coin-num"},Zt=i("span",null,"Base",-1),Kt={alt:""},Vt={key:0,class:"after"},xt={class:"quote-coin-num"},ei=i("span",null,"Quote",-1),oi={alt:""},ni={key:0,class:"after"},ti={class:"pending-yield"},ii={class:"left"},ai={class:"pending-yield-title"},si={key:0,class:"after"},li={class:"right"},ui={class:"fees-rewards"},ri={class:"fees-rewards-item"},di=i("span",null,"Fees",-1),ci={key:0,class:"after"},mi=i("span",null,"Fees",-1),vi={key:0,class:"after"},fi=i("span",null,"Bonus",-1),pi={alt:""},hi={key:0,class:"after"},bi={key:0,class:"pending-yield"},ki={class:"left"},gi=i("div",{class:"pending-yield-title"},"Pending rewards",-1),yi={key:0,class:"after"},wi={class:"right"},_i={key:1,class:"fees-rewards"},Ai={class:"fees-rewards-item"},Ci=i("span",null,"Bonus",-1),Ii={alt:""},$i={key:0,class:"after"};function Si(e,n,a,s,P,A){var c,p,l,b,H,ne,x,ce,v,m,q,t,k,I,_,r,V,X,ue,ee,L,D,J,oe,ae,K,re,Z,ke,M,me,ge,Ee,u,f,T,w,E,G,U,F,W,te,se,he,we,$,N,le,ye,g,Q,S,ie,ve,$e,Pe,Ce,Ne,Ue,je,We,Re,Be;const R=io,d=uo,o=Lo("image");return C(),B("div",Et,[i("div",Dt,[i("div",Ft,[Wt,i("div",null,"$"+j(e.amountUSD),1)]),i("div",Ht,[i("div",Xt,[i("div",Gt,[i("span",null,j(e.needReverse?(p=e.toCoin)==null?void 0:p.symbol:(c=e.fromCoin)==null?void 0:c.symbol),1),Ae(" "+j(e.needReverse?(b=e.positionInfo)==null?void 0:b.toPercent:(l=e.positionInfo)==null?void 0:l.fromPercent)+"% ",1)]),i("div",zt,[i("span",null,j(e.needReverse?(ne=e.fromCoin)==null?void 0:ne.symbol:(H=e.toCoin)==null?void 0:H.symbol),1),Ae(" "+j(e.needReverse?(ce=e.positionInfo)==null?void 0:ce.fromPercent:(x=e.positionInfo)==null?void 0:x.toPercent)+"% ",1)])]),i("div",Yt,[i("div",{class:"from-percent",style:$o({width:e.needReverse?((m=e.positionInfo)==null?void 0:m.toPercent)+"%":((v=e.positionInfo)==null?void 0:v.fromPercent)+"%"})},null,4),i("div",{class:"to-percent",style:$o({width:e.needReverse?((t=e.positionInfo)==null?void 0:t.fromPercent)+"%":((q=e.positionInfo)==null?void 0:q.toPercent)+"%"})},null,4)])])]),i("div",Qt,[i("div",Jt,[Zt,i("div",null,[qe(i("img",Kt,null,512),[[o,(e.needReverse?(I=e.toCoin)==null?void 0:I.logo_url:(k=e.fromCoin)==null?void 0:k.logo_url)||e.getCoinIcon(e.needReverse?(r=e.positionInfo)==null?void 0:r.token_b:(_=e.positionInfo)==null?void 0:_.token_a)]]),de(R,{address:e.needReverse?(ee=(ue=e.positionInfo)==null?void 0:ue.token_b)==null?void 0:ee.address:(X=(V=e.positionInfo)==null?void 0:V.token_a)==null?void 0:X.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),i("span",null,j(("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(e.needReverse?(D=e.positionInfo)==null?void 0:D.amountB:(L=e.positionInfo)==null?void 0:L.amountA,e.needReverse?(K=(ae=e.positionInfo)==null?void 0:ae.token_b)==null?void 0:K.decimals:(oe=(J=e.positionInfo)==null?void 0:J.token_a)==null?void 0:oe.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:z(be))(e.positionInfo)?(C(),B("div",Vt,j(("addCommom"in e?e.addCommom:z(Y))(e.afterBase))+" after ",1)):fe("",!0)]),i("div",xt,[ei,i("div",null,[qe(i("img",oi,null,512),[[o,(e.needReverse?(Z=e.fromCoin)==null?void 0:Z.logo_url:(re=e.toCoin)==null?void 0:re.logo_url)||e.getCoinIcon(e.needReverse?(M=e.positionInfo)==null?void 0:M.token_a:(ke=e.positionInfo)==null?void 0:ke.token_b)]]),de(R,{address:e.needReverse?(u=(Ee=e.positionInfo)==null?void 0:Ee.token_a)==null?void 0:u.address:(ge=(me=e.positionInfo)==null?void 0:me.token_b)==null?void 0:ge.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),i("span",null,j(("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(e.needReverse?(T=e.positionInfo)==null?void 0:T.amountA:(f=e.positionInfo)==null?void 0:f.amountB,e.needReverse?(U=(G=e.positionInfo)==null?void 0:G.token_a)==null?void 0:U.decimals:(E=(w=e.positionInfo)==null?void 0:w.token_b)==null?void 0:E.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:z(be))(e.positionInfo)?(C(),B("div",ni,j(("addCommom"in e?e.addCommom:z(Y))(e.afterQuote))+" after ",1)):fe("",!0)])]),i("div",ti,[i("div",ii,[i("div",ai,j(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),i("div",null,[Ae(" $"+j(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:z(Y))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(C(),B("span",si,"$0 after")):fe("",!0)])]),i("div",li,[de(d,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.pendingYieldAmount==0,onClick:n[0]||(n[0]=Ie=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:ze(()=>[Ae("Claim")]),_:1},8,["loading","disabled"])])]),i("div",ui,[i("div",ri,[i("div",null,[di,i("div",null,[qe(i("img",null,null,512),[[o,(e.needReverse?(W=e.toCoin)==null?void 0:W.logo_url:(F=e.fromCoin)==null?void 0:F.logo_url)||e.getCoinIcon(e.needReverse?(se=e.positionInfo)==null?void 0:se.token_b:(te=e.positionInfo)==null?void 0:te.token_a)]]),de(R,{address:e.needReverse?(N=($=e.positionInfo)==null?void 0:$.token_b)==null?void 0:N.address:(we=(he=e.positionInfo)==null?void 0:he.token_a)==null?void 0:we.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),i("span",null,j(e.needReverse?("showNum"in e?e.showNum:z(Se))(e.positionInfo.feeOwedB,(Q=(g=e.positionInfo)==null?void 0:g.token_b)==null?void 0:Q.decimals):("showNum"in e?e.showNum:z(Se))(e.positionInfo.feeOwedA,(ye=(le=e.positionInfo)==null?void 0:le.token_a)==null?void 0:ye.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:z(be))(e.positionInfo)&&e.isShowAfterAmount?(C(),B("div",ci," 0 after ")):fe("",!0)]),i("div",null,[mi,i("div",null,[qe(i("img",null,null,512),[[o,(e.needReverse?(ie=e.fromCoin)==null?void 0:ie.logo_url:(S=e.toCoin)==null?void 0:S.logo_url)||e.getCoinIcon(e.needReverse?($e=e.positionInfo)==null?void 0:$e.token_a:(ve=e.positionInfo)==null?void 0:ve.token_b)]]),de(R,{address:e.needReverse?(Ue=(Ne=e.positionInfo)==null?void 0:Ne.token_a)==null?void 0:Ue.address:(Ce=(Pe=e.positionInfo)==null?void 0:Pe.token_b)==null?void 0:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),i("span",null,j(e.needReverse?("showNum"in e?e.showNum:z(Se))(e.positionInfo.feeOwedA,(Be=(Re=e.positionInfo)==null?void 0:Re.token_a)==null?void 0:Be.decimals):("showNum"in e?e.showNum:z(Se))(e.positionInfo.feeOwedB,(We=(je=e.positionInfo)==null?void 0:je.token_b)==null?void 0:We.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:z(be))(e.positionInfo)&&e.isShowAfterAmount?(C(),B("div",vi," 0 after ")):fe("",!0)]),e.chainName=="Sui"?(C(!0),B(vo,{key:0},fo(e.pendingRewarderArr,Ie=>(C(),B("div",{key:Ie},[fi,i("div",null,[qe(i("img",pi,null,512),[[o,Ie.logo_url]]),de(R,{address:Ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),i("span",null,j(Ie.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:z(be))(e.positionInfo)&&e.isShowAfterAmount?(C(),B("div",hi," 0 after ")):fe("",!0)]))),128)):fe("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(C(),B("div",bi,[i("div",ki,[gi,i("div",null,[Ae(" $"+j(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:z(Y))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(C(),B("span",yi,"$0 after")):fe("",!0)])]),i("div",wi,[de(d,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:ze(()=>[Ae("Claim")]),_:1},8,["loading","disabled","onClick"])])])):fe("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(C(),B("div",_i,[i("div",Ai,[(C(!0),B(vo,null,fo(e.pendingRewarderArr,Ie=>(C(),B("div",{key:Ie},[Ci,i("div",null,[qe(i("img",Ii,null,512),[[o,Ie.logo_url]]),de(R,{address:Ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),i("span",null,j(Ie.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:z(be))(e.positionInfo)&&e.isShowAfterAmount?(C(),B("div",$i," 0 after ")):fe("",!0)]))),128))])])):fe("",!0)])}const Wo=Je(jt,[["render",Si]]),Ti=Qe({components:{AssetsCard:ro},setup(e,n){const a=O(""),s=O(""),P=Ye(),A=y(()=>P),R=y(()=>A.value.theme),d=no(),o=y(()=>d),c=O(!1),p=O(!1),l=O(!0),b=y(()=>A.value.chainName),H=y(()=>b.value?oo(b.value):{}),ne=ao(),x=y(()=>ne),ce=y(()=>A.value.slippage),v=O(),m=O(),q=y(()=>x.value.assets&&v.value&&x.value.assets[v.value.address]?Ao(x.value.assets[v.value.address].balance,v.value.decimals):0),t=y(()=>x.value.assets&&m.value&&x.value.assets[m.value.address]?Ao(x.value.assets[m.value.address].balance,m.value.decimals):0),k=w=>{w==="fromCoin"?(l.value=!0,b.value==="Aptos"?a.value=q.value>0?v.value.symbol=="APT"?new h(Number(q.value)).sub(new h(.1)).lt(new h(0))?"0":new h(Number(q.value)).sub(new h(.1)).toString():String(q.value):"":a.value=q.value>0?v.value.symbol=="SUI"?new h(Number(q.value)).sub(new h(.05)).lt(new h(0))?"0":new h(Number(q.value)).sub(new h(.05)).toString():String(q.value):""):(l.value=!1,b.value==="Aptos"?s.value=t.value>0?m.value.symbol=="APT"?new h(Number(t.value)).sub(new h(.1)).lt(new h(0))?"0":new h(Number(t.value)).sub(new h(.1)).toString():String(t.value):"":s.value=t.value>0?m.value.symbol=="SUI"?new h(Number(t.value)).sub(new h(.05)).lt(new h(0))?"0":new h(Number(t.value)).sub(new h(.05)).toString():String(t.value):"")},I=w=>{w==="fromCoin"?(l.value=!0,a.value=Le(new h(Number(q.value)).div(2).toString(),v.value.decimals).toString()):(l.value=!1,s.value=Le(new h(Number(t.value)).div(2).toString(),m.value.decimals).toString())},_=O({}),r=O(!0),V=O({}),X=O(),ue=O(),ee=()=>{var N;if(!_.value||!a.value&&!s.value)return;const{TickMath:w,TickUtil:E}=H.value;let G=_.value.minPrice,U=_.value.maxPrice.indexOf("+")>0?"∞":_.value.maxPrice,F=Number(_.value.tick_lower_index),W=Number(_.value.tick_upper_index);const te=Number(_.value.current_tick_index);let se,he,we=Number(G).toString(),$=_.value.maxPrice.indexOf("+")>0||_.value.maxPrice==="∞"?"∞":Number(U);if(we=="0"&&$=="∞"?(F=Number(_.value.tick_lower_index),W=Number(_.value.tick_upper_index)):(se=w.priceToSqrtPriceX64(new h(G),v.value.decimals,m.value.decimals),he=w.priceToSqrtPriceX64(new h(U),v.value.decimals,m.value.decimals)),X.value=F,ue.value=W,U!=="∞"&&F>=W){c.value=!0,a.value="",p.value=!0,s.value="";return}if(U=="∞"||te>=F&&te<=W){c.value=!1,p.value=!1;let le;if(a.value||s.value){if(l.value){const ve=new h(a.value).mul(Math.pow(10,v.value.decimals)).toString();le=new Oe(ve)}else{const ve=new h(s.value).mul(Math.pow(10,m.value.decimals)).toString();le=new Oe(ve)}const{liquidityAmount:ye,tokenMaxA:g,tokenMaxB:Q,tokenMaxAOrigin:S,tokenMaxBOrigin:ie}=H.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:v.value,tokenB:m.value,lowerTick:F,upperTick:W,coinAmount:le,iscoinA:r.value?l.value:!l.value,roundUp:!0,slippage:Number(ce.value)/100,curSqrtPrice:new Oe(_.value.current_sqrt_price)});V.value={liquidityAmount:ye,tokenMaxA:g,tokenMaxB:Q,tokenMaxAOrigin:S,tokenMaxBOrigin:ie},r.value?l.value?s.value=Number(Q)>0?Q:"":a.value=Number(g)>0?g:"":l.value?s.value=g:a.value=Q}}else if(te>W){if(a.value="",c.value=!0,p.value=!1,a.value||s.value){let le;const ye=new h(s.value).mul(Math.pow(10,(N=m.value)==null?void 0:N.decimals)).toString();le=new Oe(ye),V.value={liquidityAmount:Ro(se,he,le),tokenMaxA:0,tokenMaxB:s.value}}}else if(te<F){if(c.value=!1,p.value=!0,s.value="",a.value||s.value){let le;const ye=new h(a.value).mul(Math.pow(10,v.value.decimals)).toString();le=new Oe(ye),V.value={liquidityAmount:Oo(se,he,le),tokenMaxA:a.value,tokenMaxB:0}}}else c.value=!0,a.value="",p.value=!0,s.value="";d.setPositionActionAmount({fromCoinAmount:a,toCoinAmount:s})};_e(()=>o.value.currentPositionInfo,w=>{if(w&&!be(w)){_.value=w,v.value=_.value.token_a,m.value=_.value.token_b;let E=Number(_.value.tick_lower_index),G=Number(_.value.tick_upper_index);const U=Number(_.value.current_tick_index);(w.maxPrice.indexOf("+")>0||w.maxPrice==="∞"?"∞":w.maxPrice)=="∞"||U>=E&&U<=G?(c.value=!1,p.value=!1):U>G?(a.value="",c.value=!0,p.value=!1):U<E?(c.value=!1,p.value=!0,s.value=""):(c.value=!0,a.value="",p.value=!0,s.value=""),ee()}},{immediate:!0}),_e(a,(w,E)=>{w&&ee(),w==""&&(s.value="")}),_e(s,(w,E)=>{w&&ee(),w==""&&(a.value="")});const L=y(()=>{var w,E;return(E=(w=_.value)==null?void 0:w.poolInfo)==null?void 0:E.needReverse}),D=y(()=>o.value.RATES),J=y(()=>{var W,te,se,he;const w=((te=D.value[(W=v.value)==null?void 0:W.address])==null?void 0:te.price)||0,E=((he=D.value[(se=m.value)==null?void 0:se.address])==null?void 0:he.price)||0,G=new h(w).mul(new h(a.value||0)),U=new h(E).mul(new h(s.value||0)),F=G.add(U);return F.toNumber()?F.toNumber()>0&&F.toNumber()>.01?Y(F.toString(),2):"<0.01":"--"}),oe=O(!1),{t:ae,locale:K}=wo(),re=y(()=>{const w=Number(a.value)>Number(q.value),E=Number(s.value)>Number(t.value);return!a.value&&!s.value?ae("button.enterAmount"):w?ae("button.insufficientBalance",{name:v.value.symbol}):E?ae("button.insufficientBalance",{name:m.value.symbol}):ae("newAdd.addMore")}),Z=y(()=>{const w=Number(a.value)>Number(q.value),E=Number(s.value)>Number(t.value);return!!(!a.value&&!s.value||w||E)}),{setIsShowSuccess:ke,setIsShowRejected:M,setIsShowWaiting:me,setTransactionDesc:ge,setTransactionTxid:Ee,setPositiomNum:u}=P,f=O(!1);return{theme:R,showFromCoinLock:c,showToCoinLock:p,toCoinAmount:s,fromCoinAmount:a,fromCoinBlance:q,toCoinBlance:t,fromCoin:v,toCoin:m,maxBtnSelect:k,halfBtnSelect:I,fixedFromCoin:l,needReverse:L,totalAmount:J,wallet:x,addLiquidityBtnText:re,isShowLiquidityModal:oe,indexStore:P,positionInfo:_,actionLoading:f,toAdd:async()=>{var W,te,se,he,we,$,N,le,ye,g;oe.value=!1,f.value=!0,Ee("");const w=c.value?"":`${a.value} ${(W=v.value)==null?void 0:W.symbol}`,E=p.value?"":`${s.value} ${(te=m.value)==null?void 0:te.symbol}`;ge(ae("tips.increaseLiquiditySuccess",{from:L.value?E:w,and:!c.value&&!p.value?"and":"",to:L.value?w:E})),me(!0);const G=l.value,U=_.value.poolInfo.rewarder_infos;let F={};F.coinTypeC=U[0]?U[0].coinAddress:"",F.coinTypeD=U[1]?U[1].coinAddress:"",F.coinTypeE=U[2]?U[2].coinAddress:"";try{const Q=await H.value.getAddLiquidityTransactionPayload({pool:{poolAddress:_.value.poolAddress,token_a:_.value.token_a,token_b:_.value.token_b},amount:G?V.value.tokenMaxA:V.value.tokenMaxB,fix_amount_a:G,tick_lower:X.value,tick_upper:ue.value,index:b.value==="Aptos"?_.value.index:_.value.pos_object_id,slippage:Number(ce.value)/100,roundUp:!0,collect_fee:!0,...F,curSqrtPrice:new Oe(_==null?void 0:_.value.poolInfo.current_sqrt_price)});let S;if(b.value==="Aptos")S=await x.value.currentWallet.signAndSubmitTransaction(Q);else{const ie=await x.value.currentWallet.signAndExecuteTransactionBlock(Q);S=H.value.handleTx(ie)}if(S&&S.hash){Ee(S.hash),me(!1),ke(!0);const ie={title:"Supplied",desc:ae("tips.addLiquiditySuccessText",{from:c.value?"":`${a.value} ${(se=v.value)==null?void 0:se.symbol}`,and:!c.value&&!p.value?"and":"",to:p.value?"":`${s.value} ${(he=m.value)==null?void 0:he.symbol}`}),hash:S.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:L.value?`${($=m.value)==null?void 0:$.address}`:`${(we=v.value)==null?void 0:we.address}`,numa:L.value?`- ${s.value}`:`- ${a.value}`,logoa:L.value?o.value.tokensObj&&m.value&&m.value.address&&o.value.tokensObj[m.value.address]&&o.value.tokensObj[m.value.address].logoURI:o.value.tokensObj&&v.value&&v.value.address&&o.value.tokensObj[v.value.address]&&o.value.tokensObj[v.value.address].logoURI,tokenb:L.value?`${(le=v.value)==null?void 0:le.address}`:`${(N=m.value)==null?void 0:N.address}`,numb:L.value?`- ${a.value}`:`- ${s.value}`,logob:L.value?o.value.tokensObj&&v.value&&v.value.address&&o.value.tokensObj[v.value.address]&&o.value.tokensObj[v.value.address].logoURI:o.value.tokensObj&&m.value&&m.value.address&&o.value.tokensObj[m.value.address]&&o.value.tokensObj[m.value.address].logoURI},text:`Deopsit ${c.value?"":`${a.value} ${(ye=v.value)==null?void 0:ye.symbol}`} ${!c.value&&!p.value?"and":""} ${p.value?"":`${s.value} ${(g=m.value)==null?void 0:g.symbol}`}`};b.value!=="Aptos"&&(ie.res=S.res),H.value.showTransitionPending(ie),await H.value.watchTransaction(ie)&&setTimeout(()=>{n.emit("getDetails"),H.value.getAccount(x.value.address)},1e3),u()}else me(!1),M(!0);a.value="",s.value="",f.value=!1}catch{a.value="",s.value="",f.value=!1,me(!1),M(!0)}},addLiquidityBtnDisabled:Z,poolStore:d}}});const Pi={class:"new-position-asset"},Ni={class:"add-or-remove"},Ri={class:"liquidity-action-tab"},Oi=i("div",{class:"increase tab-active"}," Increase ",-1),qi={class:"card-item"},Bi={class:"card-item"},Li={key:0,class:"add",src:un},Mi={key:1,class:"add",src:rn},Ui={class:"total-amount"},ji=i("span",null,"Total Amount",-1);function Ei(e,n,a,s,P,A){var p;const R=ro,d=sn,o=uo,c=ln;return C(),B("div",Pi,[i("div",Ni,[i("div",Ri,[Oi,i("div",{class:"remove",onClick:n[0]||(n[0]=l=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),i("div",{class:po(e.needReverse?"card-container reverse":"card-container")},[i("div",qi,[de(R,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=l=>e.fromCoinAmount=l),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:n[2]||(n[2]=l=>e.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=l=>e.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=l=>{e.fromCoinAmount=l}),onOnFocus:n[5]||(n[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(C(),Me(d,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):fe("",!0)]),i("div",Bi,[de(R,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[6]||(n[6]=l=>e.toCoinAmount=l),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:n[7]||(n[7]=l=>e.maxBtnSelect("toCoin")),onOnHalf:n[8]||(n[8]=l=>e.halfBtnSelect("toCoin")),onOnInput:n[9]||(n[9]=l=>{e.toCoinAmount=l}),onOnFocus:n[10]||(n[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(C(),Me(d,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):fe("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(C(),B("img",Li)):fe("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(C(),B("img",Mi)):fe("",!0)],2),i("div",Ui,[ji,i("span",null,"$"+j(e.totalAmount),1)])]),e.wallet.connected?(C(),Me(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:n[11]||(n[11]=l=>e.isShowLiquidityModal=!0)},{default:ze(()=>[i("span",null,j(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(C(),Me(o,{key:1,class:"big-btn",onClick:n[12]||(n[12]=l=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:ze(()=>[i("span",null,j(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(C(),Me(c,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(p=e.positionInfo)==null?void 0:p.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:n[13]||(n[13]=l=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):fe("",!0)])}const ko=Je(Ti,[["render",Ei]]),Di=Qe({components:{AssetsCard:ro},setup(e,n){const a=O(""),s=O(""),P=Ye(),A=y(()=>P),R=y(()=>A.value.theme),d=no(),o=y(()=>d),c=O(!1),p=O(!1),l=O(!0),b=y(()=>A.value.chainName),H=y(()=>b.value?oo(b.value):{}),ne=ao(),x=y(()=>ne),ce=y(()=>A.value.slippage),v=O(),m=O(),q=y(()=>{var g,Q;return(Q=(g=r.value)==null?void 0:g.poolInfo)==null?void 0:Q.needReverse}),t=y(()=>{var g;return pe(r==null?void 0:r.value.amountA,(g=r==null?void 0:r.value.token_a)==null?void 0:g.decimals)}),k=y(()=>{var g;return pe(r==null?void 0:r.value.amountB,(g=r==null?void 0:r.value.token_b)==null?void 0:g.decimals)}),I=g=>{g==="fromCoin"?l.value=!0:l.value=!1,J.value=100,ae({value:1})},_=g=>{g==="fromCoin"?(l.value=!0,a.value=Le(new h(Number(t.value)).div(2).toString(),v.value.decimals).toString()):(l.value=!1,s.value=Le(new h(Number(k.value)).div(2).toString(),m.value.decimals).toString()),L.value=!1},r=O({}),V=O(!0),X=O({}),ue=O(),ee=O(),L=O(!0),D=()=>{var We;if(L.value||!r.value||!a.value&&!s.value||Number(a.value)>Number(t.value)||Number(s.value)>Number(k.value))return;if(a.value==t.value&&s.value==k.value){J.value=100,ae({value:1}),L.value=!0;return}const{TickMath:g,TickUtil:Q}=H.value;let S=r.value.minPrice,ie=r.value.maxPrice.indexOf("+")>0?"∞":r.value.maxPrice,ve=Number(r.value.tick_lower_index),$e=Number(r.value.tick_upper_index);const Pe=Number(r.value.current_tick_index);let Ce,Ne,Ue=Number(S).toString(),je=r.value.maxPrice.indexOf("+")>0||r.value.maxPrice==="∞"?"∞":Number(ie);if(Ue=="0"&&je=="∞"?(ve=Number(r.value.tick_lower_index),$e=Number(r.value.tick_upper_index)):(Ce=g.priceToSqrtPriceX64(new h(S),v.value.decimals,m.value.decimals),Ne=g.priceToSqrtPriceX64(new h(ie),v.value.decimals,m.value.decimals)),ue.value=ve,ee.value=$e,ie!=="∞"&&ve>=$e){c.value=!0,a.value="",p.value=!0,s.value="";return}if(ie=="∞"||Pe>=ve&&Pe<=$e){c.value=!1,p.value=!1;let Re;if(a.value||s.value){if(l.value){const Ze=new h(a.value).mul(Math.pow(10,v.value.decimals)).toString();Re=new Oe(Ze)}else{const Ze=new h(s.value).mul(Math.pow(10,m.value.decimals)).toString();Re=new Oe(Ze)}const{liquidityAmount:Be,tokenMaxA:Ie,tokenMaxB:Xe,tokenMaxAOrigin:to,tokenMaxBOrigin:Te}=H.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:v.value,tokenB:m.value,lowerTick:ve,upperTick:$e,coinAmount:Re,iscoinA:V.value?l.value:!l.value,roundUp:b.value!="Sui",slippage:Number(ce.value)/100,curSqrtPrice:new Oe(r.value.current_sqrt_price)});X.value={liquidityAmount:Be,tokenMaxA:Ie,tokenMaxB:Xe,tokenMaxAOrigin:to,tokenMaxBOrigin:Te},V.value?l.value?s.value=Number(Xe)>0?Xe:"":a.value=Number(Ie)>0?Ie:"":l.value?s.value=Ie:a.value=Xe}}else if(Pe>$e){if(a.value="",c.value=!0,p.value=!1,a.value||s.value){let Re;const Be=new h(s.value).mul(Math.pow(10,(We=m.value)==null?void 0:We.decimals)).toString();Re=new Oe(Be),X.value={liquidityAmount:Ro(Ce,Ne,Re),tokenMaxA:0,tokenMaxB:s.value}}}else if(Pe<ve){if(c.value=!1,p.value=!0,s.value="",a.value||s.value){let Re;const Be=new h(a.value).mul(Math.pow(10,v.value.decimals)).toString();Re=new Oe(Be),X.value={liquidityAmount:Oo(Ce,Ne,Re),tokenMaxA:a.value,tokenMaxB:0}}}else c.value=!0,p.value=!0;L.value=!1,J.value=new h(X.value.liquidityAmount.toString()).div(r.value.liquidity).mul(100).toNumber().toFixed(2),oe.value=X.value.liquidityAmount,d.setPositionActionAmount({fromCoinAmount:a,toCoinAmount:s})},J=O(50),oe=O("0"),ae=g=>{if(!L.value)return;L.value=!0;const Q=r.value.token_a.decimals,S=r.value.token_b.decimals,ie=r.value.tick_lower_index,ve=r.value.tick_upper_index,$e=Co.tickIndexToSqrtPriceX64(ie),Pe=Co.tickIndexToSqrtPriceX64(ve);let Ce="";g.value!==1?Ce=new h(r.value.liquidity).mul(g.value).toString():Ce=r.value.liquidity,Ce=Le(Ce,0)||"0",oe.value=Ce;const Ne=Yo.getCoinAmountFromLiquidity(new Oe(Ce),new Oe(r.value.current_sqrt_price),$e,Pe,b.value!="Sui"),Ue=new h(Ne.coinA.toString()).div(Math.pow(10,Q)).toString(),je=new h(Ne.coinB.toString()).div(Math.pow(10,S)).toString();a.value=Number(Ue)>0?Ue:"",s.value=Number(je)>0?je:"",d.setPositionActionAmount({fromCoinAmount:a,toCoinAmount:s})};_e(()=>o.value.currentPositionInfo,g=>{if(g&&!be(g)){r.value=g,v.value=r.value.token_a,m.value=r.value.token_b,ae({value:J.value/100});let Q=Number(r.value.tick_lower_index),S=Number(r.value.tick_upper_index);const ie=Number(r.value.current_tick_index);(g.maxPrice.indexOf("+")>0||g.maxPrice==="∞"?"∞":g.maxPrice)=="∞"||ie>=Q&&ie<=S?(c.value=!1,p.value=!1):ie>S?(a.value="",c.value=!0,p.value=!1):ie<Q?(c.value=!1,p.value=!0,s.value=""):(c.value=!0,a.value="",p.value=!0,s.value=""),D()}},{immediate:!0}),_e(a,(g,Q)=>{g&&D(),g==""&&(s.value="",J.value=0)}),_e(s,(g,Q)=>{g&&D(),g==""&&(a.value="",J.value=0)});const K=y(()=>o.value.RATES),re=y(()=>{var $e,Pe,Ce,Ne;const g=((Pe=K.value[($e=v.value)==null?void 0:$e.address])==null?void 0:Pe.price)||0,Q=((Ne=K.value[(Ce=m.value)==null?void 0:Ce.address])==null?void 0:Ne.price)||0,S=new h(g).mul(new h(a.value||0)),ie=new h(Q).mul(new h(s.value||0)),ve=S.add(ie);return Y(ve.toString(),2)}),Z=O(!1),{t:ke,locale:M}=wo(),me=y(()=>{const g=Number(a.value)>Number(t.value),Q=Number(s.value)>Number(k.value);return!a.value&&!s.value?ke("button.enterAmount"):g||Q?"Invalid Amount":ke("button.remove")}),ge=y(()=>{const g=Number(a.value)>Number(t.value),Q=Number(s.value)>Number(k.value);return!!(!a.value&&!s.value||g||Q)}),{setIsShowSuccess:Ee,setIsShowRejected:u,setIsShowWaiting:f,setTransactionDesc:T,setTransactionTxid:w,setPositiomNum:E,setTransactionDescText:G}=P,U=O(!1);_e(J,xo((g,Q)=>{g!==Q&&(Number(g)>100?J.value=100:g&&r.value?(J.value=g,ae({value:J.value/100})):(a.value="",s.value=""))},300)),_e(ce,g=>{g&&r.value&&ae({value:J.value/100})});const F=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],W=Mo(),te=y(()=>W),se=y(()=>te.value.status),he=O(!1),we=g=>{g.sources.forEach(S=>{const{pool_address:ie,position_index:ve}=JSON.parse(S.blockchainAddress);ie==r.value.poolAddress&&Number(ve)==Number(r.value.index)&&(he.value=!0)})},$=async()=>{await W.getSources();let g;te.value.allSources.forEach(Q=>{const{pool_address:S,position_index:ie}=JSON.parse(Q.blockchainAddress);S==r.value.poolAddress&&ie==r.value.index&&(g=Q.id)}),W.deleteSource(g)};_e(()=>[te.value.sourceGroups,r.value],([g,Q])=>{g&&g.sources&&g.sources.length>0&&Q&&!be(Q)&&we(g)},{immediate:!0,deep:!0});const N=lo(),le=so();return{theme:R,showFromCoinLock:c,showToCoinLock:p,toCoinAmount:s,fromCoinAmount:a,fromCoinBlance:t,toCoinBlance:k,fromCoin:v,toCoin:m,maxBtnSelect:I,halfBtnSelect:_,fixedFromCoin:l,needReverse:q,totalAmount:re,wallet:x,addLiquidityBtnText:me,isShowLiquidityModal:Z,indexStore:P,positionInfo:r,actionLoading:U,addLiquidityBtnDisabled:ge,sliderVal:J,ratioArr:F,setPercent:ae,poolStore:d,isSlider:L,toRemove:async()=>{var ve,$e,Pe,Ce,Ne,Ue,je,We,Re,Be,Ie,Xe,to;U.value=!0,w("");const g=Y(a.value,v.value.decimals)==0?"":`${pe(a.value,v.value.decimals)} ${v.value.symbol}`,Q=Y(s.value,m.value.decimals)==0?"":`${pe(s.value,m.value.decimals)} ${m.value.symbol}`;T(ke("tips.removeLiquidiyText",{from:q.value?Q:g,and:Y(a.value,v.value.decimals)==0||Y(s.value,m.value.decimals)==0?"":"and",to:q.value?g:Q})),f(!0);const S=r.value.poolInfo.rewarder_infos,ie=S&&S.length>0&&b.value=="Sui"||S&&S.length>0&&J.value==100?ke("modal.removeLiquidityText1"):ke("modal.removeLiquidityText2");G(ie);try{let Te={};Te={pool:{...r.value.poolInfo,coinA:r.value.token_a,coinB:r.value.token_b},coinTypeA:r.value.poolInfo.coinTypeA,coinTypeB:r.value.poolInfo.coinTypeB,position:r.value,delta_liquidity:J.value==100?new Oe(r.value.liquidity):new Oe(Le(oe.value,0)),slippage:Number(ce.value),rewards_num:S.length},Te.coinTypeC=S[0]?S[0].coinAddress:"",Te.coinTypeD=S[1]?S[1].coinAddress:"",Te.coinTypeE=S[2]?S[2].coinAddress:"";const Ze=await H.value.getRemoveLiquidityTransactionPayload(Te);let De;if(b.value==="Aptos")De=await x.value.currentWallet.signAndSubmitTransaction(Ze);else{const Ve=await x.value.currentWallet.signAndExecuteTransactionBlock(Ze);De=H.value.handleTx(Ve)}if(De&&De.hash){w(De.hash),f(!1),Ee(!0);const Ve={title:ke("common.removeLiquidity"),desc:"",hash:De.hash,descTransactions:`Remove ${a.value} ${(ve=v.value)==null?void 0:ve.symbol} and ${s.value} ${($e=m.value)==null?void 0:$e.symbol} 
             from the pool`,sender:x.value.address,chainName:b.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:q.value?`${(Ce=m.value)==null?void 0:Ce.address}`:`${(Pe=v.value)==null?void 0:Pe.address}`,numa:q.value?`+ ${s.value}`:`+ ${a.value}`,logoa:q.value?o.value.tokensObj&&m.value&&m.value.address&&o.value.tokensObj[m.value.address]&&o.value.tokensObj[m.value.address].logoURI:o.value.tokensObj&&v.value&&v.value.address&&o.value.tokensObj[v.value.address]&&o.value.tokensObj[v.value.address].logoURI,tokenb:q.value?`${(Ne=v.value)==null?void 0:Ne.address}`:`${(Ue=m.value)==null?void 0:Ue.address}`,numb:q.value?`+ ${a.value}`:`+ ${s.value}`,logob:q.value?o.value.tokensObj&&v.value&&v.value.address&&o.value.tokensObj[v.value.address]&&o.value.tokensObj[v.value.address].logoURI:o.value.tokensObj&&m.value&&m.value.address&&o.value.tokensObj[m.value.address]&&o.value.tokensObj[m.value.address].logoURI},text:`Withdraw ${a.value} ${(je=v.value)==null?void 0:je.symbol} and ${s.value} ${(We=m.value)==null?void 0:We.symbol}`};b.value!=="Aptos"&&(Ve.res=De.res),H.value.showTransitionPending(Ve);const _o=await H.value.watchTransaction(Ve);if(S.value&&S.value.length>0&&(Number((Re=S[0])==null?void 0:Re.amount)!==0||Te.coinTypeD&&Number((Be=S[1])==null?void 0:Be.amount)!==0||Te.coinTypeE&&Number((Ie=S[2])==null?void 0:Ie.amount)!==0)){const co={title:ke("common.removeLiquidity"),desc:"",hash:De.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:S[0].symbol,numa:`+ ${Number(S[0].amount)}`,logoa:o.value.tokensObj&&S[0]&&S[0].address&&o.value.tokensObj[S[0].address]&&o.value.tokensObj[S[0].address].logoURI,tokenb:Te.coinTypeD?S[1].symbol:"",numb:Te.coinTypeD?`+ ${Number(S[1].amount)}`:"",logob:Te.coinTypeD?o.value.tokensObj&&S[1]&&S[1].address&&o.value.tokensObj[S[1].address]&&o.value.tokensObj[S[1].address].logoURI:"",tokenc:Te.coinTypeE?S[2].symbol:"",numc:Te.coinTypeE?`+ ${Number(S[2].amount)}`:"",logoc:Te.coinTypeE?o.value.tokensObj&&S[2]&&S[2].address&&o.value.tokensObj[S[2].address]&&o.value.tokensObj[S[2].address].logoURI:""},text:`Withdraw ${a.value} ${(Xe=v.value)==null?void 0:Xe.symbol} and ${s.value} ${(to=m.value)==null?void 0:to.symbol}`},Xo=await H.value.setTransations(co)}if(Se(r.value.feeOwedA,r.value.token_a.decimals)!==0||Se(r.value.feeOwedB,r.value.token_b.decimals)!==0){const co={title:"Claim",desc:"",hash:De.hash,chainName:b.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${r.value.token_a.symbol}`,numa:Y(r.value.feeOwedA,r.value.token_a.decimals)==0?"":`+ ${Se(r.value.feeOwedA,r.value.token_a.decimals)}`,logoa:Y(r.value.feeOwedA,r.value.token_a.decimals)==0?"":o.value.tokensObj&&r.value&&r.value.token_a.address&&o.value.tokensObj[r.value.token_a.address]&&o.value.tokensObj[r.value.token_a.address].logoURI,tokenb:`${r.value.token_b.symbol}`,numb:Y(r.value.feeOwedB,r.value.token_b.decimals)==0?"":`+ ${Se(r.value.feeOwedB,r.value.token_b.decimals)}`,logob:Y(r.value.feeOwedB,r.value.token_b.decimals)==0?"":o.value.tokensObj&&r.value&&r.value.token_b.address&&o.value.tokensObj[r.value.token_b.address]&&o.value.tokensObj[r.value.token_b.address].logoURI}},Xo=await H.value.setTransations(co)}_o&&Number(J.value)==100&&se.value=="authenticated"&&he.value&&(await W.subscribePosition({pool_address:r.value.poolAddress,position_index:r.value.index},r.value.nftHash,!1),$()),_o&&(a.value="",s.value="",setTimeout(()=>{n.emit("getDetails")},3e3),setTimeout(()=>{n.emit("getDetails")},6e3),Number(J.value)==100&&le.name=="new-position-detail"&&(b.value==="Aptos"?N.push("/position"):N.push("/pool/position")),J.value=0)}else f(!1),u(!0);U.value=!1}catch{U.value=!1,f(!1),u(!0)}},sFixD:Le}}});const Fi={class:"new-position-asset"},Wi={class:"add-or-remove"},Hi={class:"liquidity-action-tab"},Xi=i("div",{class:"remove tab-active"},"Remove",-1),Gi={class:"card-item"},zi={key:0,class:"assets-card-mask"},Yi={class:"card-item"},Qi={key:0,class:"assets-card-mask"},Ji={class:"remove-ratio"},Zi=i("div",{class:"remove-ratio-title"},"Amount",-1),Ki={class:"remove-ratio-select"},Vi={key:0,class:"ratio"},xi={key:1,class:"ratio"},ea={class:"ratio-list"},oa=["onClick"];function na(e,n,a,s,P,A){const R=ro,d=en,o=uo;return C(),B("div",Fi,[i("div",Wi,[i("div",Hi,[i("div",{class:"increase",onClick:n[0]||(n[0]=c=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),Xi]),i("div",{class:po(e.needReverse?"card-container reverse":"card-container")},[i("div",Gi,[de(R,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=c=>e.fromCoinAmount=c),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:n[2]||(n[2]=c=>e.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=c=>e.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=c=>{e.fromCoinAmount=c,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(C(),B("div",zi)):fe("",!0)]),i("div",Yi,[de(R,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[5]||(n[5]=c=>e.toCoinAmount=c),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:n[6]||(n[6]=c=>e.maxBtnSelect("toCoin")),onOnHalf:n[7]||(n[7]=c=>e.halfBtnSelect("toCoin")),onOnInput:n[8]||(n[8]=c=>{e.toCoinAmount=c,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(C(),B("div",Qi)):fe("",!0)])],2),i("div",Ji,[Zi,i("div",Ki,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(C(),B("div",Vi,j(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:z(Le))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:z(Le))(e.sliderVal,2))+"% ",1)):(C(),B("div",xi," -- ")),i("div",ea,[(C(!0),B(vo,null,fo(e.ratioArr,(c,p)=>(C(),B("div",{key:p,class:po(["ratio-item",e.sliderVal==c.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=c.value}},j(c.name),11,oa))),128))])]),de(d,{value:e.sliderVal,"onUpdate:value":n[9]||(n[9]=c=>e.sliderVal=c)},null,8,["value"])])]),e.wallet.connected?(C(),Me(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:ze(()=>[i("span",null,j(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(C(),Me(o,{key:1,class:"big-btn",onClick:n[10]||(n[10]=c=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:ze(()=>[i("span",null,j(e.$t("button.connectWallet")),1)]),_:1}))])}const ta=Je(Di,[["render",na]]),ia=Qe({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const n=Mo(),a=y(()=>n),s=y(()=>a.value.status),P=Ye();_e(()=>[a.value.targetGroups],p=>{},{immediate:!0});const A=O(!1);_e(()=>s.value,p=>{p=="authenticated",A.value=!1},{immediate:!0});const R=O(!1),d=async()=>{R.value=!R.value;const p={pool_address:e.positionInfo.poolAddress,position_index:e.positionInfo.index},l=e.positionInfo.nftHash;try{await n.subscribePosition(p,l,R.value)}catch{R.value=!R.value}},o=p=>{const l=p.sources;R.value=l.some(b=>JSON.parse(b.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(b.blockchainAddress).position_index)==Number(e.positionInfo.index))},c=lo();return _e(()=>[a.value.sourceGroups,e.positionInfo],([p,l])=>{var b,H,ne;R.value=!1,p&&p.length>0&&p[0]&&l&&!be(l)&&((ne=(H=(b=c==null?void 0:c.currentRoute)==null?void 0:b.value)==null?void 0:H.query)==null?void 0:ne.token)==(l==null?void 0:l.name)&&o(p[0])},{immediate:!0,deep:!0}),{importIcon:eo,isShowSetUp:A,changeSwitch:d,checked:R,notifiStatus:s,store:P}}});const aa=e=>(go("data-v-8f838b7e"),e=e(),yo(),e),sa={class:"range-alerts"},la={class:"range-alerts-top"},ua={class:"title"},ra=aa(()=>i("div",{class:"title-all"},[i("span",{class:"Range"},"Range Alerts")],-1)),da={key:1,class:"h5-switch-box"},ca={class:"range-alerts-bottom"},ma={key:0,class:"pc-switch-box"};function va(e,n,a,s,P,A){const R=uo,d=nn;return C(),B("div",sa,[i("div",la,[i("div",ua,[ra,e.isShowSetUp||e.notifiStatus!=="authenticated"?(C(),Me(R,{key:0,class:"range-alerts-button",onClick:n[0]||(n[0]=on(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:ze(()=>[Ae(" Set up ")]),_:1})):fe("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(C(),B("div",da,[de(d,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):fe("",!0)])]),i("div",ca,[Ae(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(C(),B("div",ma,[de(d,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):fe("",!0)])])}const Ho=Je(ia,[["render",va],["__scopeId","data-v-8f838b7e"]]),fa=Qe({components:{NewPositionTitle:Po,NewPositionInfo:Fo,NewPositionLiquidity:Wo,NewPositionAssetAdd:ko,NewPositionAssetRemove:ko,NewPositionNotifi:Ho},setup(){const e=O(),n=O(),a=O(),s=Ye(),P=y(()=>s),A=y(()=>P.value.chainName),R=no(),d=y(()=>R),o=lo();qo(()=>{e.value={},R.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),d.value.setCurrentPositionLoading(!0)});const c=async()=>{d.value.setCurrentPositionLoading(!0);const m=o.currentRoute.value.query.token||"",q=o.currentRoute.value.query.collect||"",t=o.currentRoute.value.query.address||"",k=o.currentRoute.value.query.pos||"",I=o.currentRoute.value.query.id||"";A.value==="Aptos"?m&&q&&t&&d.value.setCurrentPositionInfo(t,q,m,A.value):m&&t&&k?d.value.setCurrentPositionInfo(t,q,m,A.value,k):I&&d.value.setCurrentPositionInfo("","","",A.value,I)};_e(()=>d.value.poolConfigObj,m=>{m&&!be(m)&&c()},{immediate:!0});const p=y(()=>d.value.currentPositionLoading),l=y(()=>{var q,t,k;const m=((k=(t=(q=o==null?void 0:o.currentRoute)==null?void 0:q.value)==null?void 0:t.query)==null?void 0:k.address)||"";return m&&d.value.addressLpTokens&&!be(d.value.addressLpTokens)&&d.value.addressLpTokens[m]?d.value.addressLpTokens[m]:null});_e(()=>l.value,(m,q)=>{m&&!be(m)&&(e.value=m),m&&!be(m)&&m.current_sqrt_price!==(q==null?void 0:q.current_sqrt_price)&&c()},{immediate:!0});const b=so();_e(()=>[d.value.currentPositionInfo,A.value],([m,q])=>{var t;(q=="Aptos"&&m||q=="Sui"&&m&&(m==null?void 0:m.nftHash)==((t=b==null?void 0:b.query)==null?void 0:t.pos))&&(e.value=m,n.value=e.value.token_a,a.value=e.value.token_b)},{immediate:!0});const H=y(()=>d.value.positionDetailCurrentTab),ne=ao(),x=y(()=>ne),ce=y(()=>P.value.theme);return tn(()=>{x.value.connected||(ce.value==="default"?o.push("/position"):o.push("/pool/position"))}),{positionInfo:e,fromCoin:n,toCoin:a,getDetails:c,currentPositionLoading:p,positionDetailCurrentTab:H,clickRefresh:()=>{c()},chainName:A}}});const pa={class:"new-position-detail"},ha={class:"new-position-content"},ba={class:"left"},ka={class:"right"},ga={class:"loading-global"};function ya(e,n,a,s,P,A){const R=Po,d=Fo,o=Wo,c=ko,p=ta,l=Ho,b=an;return C(),B("div",pa,[de(R,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),i("div",ha,[i("div",ba,[de(d),de(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),i("div",ka,[e.positionDetailCurrentTab=="increase"?(C(),Me(c,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(C(),Me(p,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),de(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="∞"&&e.chainName=="Sui"?(C(),Me(l,{key:2,"position-info":e.positionInfo},null,8,["position-info"])):fe("",!0)])]),qe(i("div",ga,[de(b)],512),[[Bo,e.currentPositionLoading]])])}const Qa=Je(fa,[["render",ya],["__scopeId","data-v-f85efb72"]]);export{Qa as default};
