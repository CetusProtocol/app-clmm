import{_ as Ro}from"./new-position-title.9797d9df.js";import{_ as co}from"./token-warning.2f1ed720.js";import{_ as Oo}from"./status-block.de454ffd.js";import{j as Qo,n as Ko,d as be,e as eo,u as oo,a as Q,g as bo,c as fe,s as Me,r as Se,b as qe,p as Co,J as qo,K as Lo,T as $o,C as Zo,m as Vo}from"./pool.111ff768.js";import{s as to,m as xo,l as en,b as on,a as nn}from"./transform.c672907f.js";import{D as b}from"./decimal.0bdeb344.js";import{u as Ge,a as so}from"./sha256.4003ae9f.js";import{a as ze,r as B,l as y,H as Bo,q as ye,e as Ye,o as _,f as S,t as Te,N as Mo,h as n,p as mo,k as vo,m as fo,s as yo,i as re,u as J,v as D,j as ve,x as me,y as Ao,a4 as tn,b as lo,C as Xe,a8 as So,O as Po,w as Be,F as io,E as ao,B as ro,A as ko,c as Le,D as an,G as sn,z as Uo,P as ln,$ as rn,K as un,S as dn}from"./entry.6232c531.js";import{i as xe}from"./import-icon.de3e6c66.js";import{_ as po}from"./assets-card.f8d4f71a.js";import{_ as cn}from"./coin-lock.47b6b927.js";import{a as mn}from"./new-add-or-create.05e911fe.js";import{_ as vn,a as fn}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              *//* empty css              */import{u as jo}from"./notifi.e4f8eed4.js";import{_ as pn}from"./apr-tips.60090f0e.js";import{u as Eo}from"./farms.67ca66e4.js";/* empty css              *//* empty css              */import"./back.f83d2318.js";import"./swap-setting.35b01f7b.js";/* empty css              */import"./icon-error_2x.0cdd1dd0.js";/* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.d592cb62.js";import"./useWhale.42935724.js";import"./icon_rewards_2x.a780164c.js";const go=Math.PI,_o=2*go,Qe=1e-6,hn=_o-Qe;function Do(e){this._+=e[0];for(let t=1,a=e.length;t<a;++t)this._+=arguments[t]+e[t]}function bn(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Do;const a=10**t;return function(s){this._+=s[0];for(let O=1,p=s.length;O<p;++O)this._+=Math.round(arguments[O]*a)/a+s[O]}}class kn{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Do:bn(t)}moveTo(t,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+a}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,a){this._append`L${this._x1=+t},${this._y1=+a}`}quadraticCurveTo(t,a,s,O){this._append`Q${+t},${+a},${this._x1=+s},${this._y1=+O}`}bezierCurveTo(t,a,s,O,p,T){this._append`C${+t},${+a},${+s},${+O},${this._x1=+p},${this._y1=+T}`}arcTo(t,a,s,O,p){if(t=+t,a=+a,s=+s,O=+O,p=+p,p<0)throw new Error(`negative radius: ${p}`);let T=this._x1,m=this._y1,o=s-t,r=O-a,v=T-t,u=m-a,k=v*v+u*u;if(this._x1===null)this._append`M${this._x1=t},${this._y1=a}`;else if(k>Qe)if(!(Math.abs(u*o-r*v)>Qe)||!p)this._append`L${this._x1=t},${this._y1=a}`;else{let H=s-T,te=O-m,ee=o*o+r*r,oe=H*H+te*te,l=Math.sqrt(ee),f=Math.sqrt(k),P=p*Math.tan((go-Math.acos((ee+k-oe)/(2*l*f)))/2),i=P/f,g=P/l;Math.abs(i-1)>Qe&&this._append`L${t+i*v},${a+i*u}`,this._append`A${p},${p},0,0,${+(u*H>v*te)},${this._x1=t+g*o},${this._y1=a+g*r}`}}arc(t,a,s,O,p,T){if(t=+t,a=+a,s=+s,T=!!T,s<0)throw new Error(`negative radius: ${s}`);let m=s*Math.cos(O),o=s*Math.sin(O),r=t+m,v=a+o,u=1^T,k=T?O-p:p-O;this._x1===null?this._append`M${r},${v}`:(Math.abs(this._x1-r)>Qe||Math.abs(this._y1-v)>Qe)&&this._append`L${r},${v}`,s&&(k<0&&(k=k%_o+_o),k>hn?this._append`A${s},${s},0,1,${u},${t-m},${a-o}A${s},${s},0,1,${u},${this._x1=r},${this._y1=v}`:k>Qe&&this._append`A${s},${s},0,${+(k>=go)},${u},${this._x1=t+s*Math.cos(p)},${this._y1=a+s*Math.sin(p)}`)}rect(t,a,s,O){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+a}h${s=+s}v${+O}h${-s}Z`}toString(){return this._}}function Ve(e){return function(){return e}}function gn(e){let t=3;return e.digits=function(a){if(!arguments.length)return t;if(a==null)t=null;else{const s=Math.floor(a);if(!(s>=0))throw new RangeError(`invalid digits: ${a}`);t=s}return e},()=>new kn(t)}function _n(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Fo(e){this._context=e}Fo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function wn(e){return new Fo(e)}function yn(e){return e[0]}function An(e){return e[1]}function In(e,t){var a=Ve(!0),s=null,O=wn,p=null,T=gn(m);e=typeof e=="function"?e:e===void 0?yn:Ve(e),t=typeof t=="function"?t:t===void 0?An:Ve(t);function m(o){var r,v=(o=_n(o)).length,u,k=!1,H;for(s==null&&(p=O(H=T())),r=0;r<=v;++r)!(r<v&&a(u=o[r],r,o))===k&&((k=!k)?p.lineStart():p.lineEnd()),k&&p.point(+e(u,r,o),+t(u,r,o));if(H)return p=null,H+""||null}return m.x=function(o){return arguments.length?(e=typeof o=="function"?o:Ve(+o),m):e},m.y=function(o){return arguments.length?(t=typeof o=="function"?o:Ve(+o),m):t},m.defined=function(o){return arguments.length?(a=typeof o=="function"?o:Ve(!!o),m):a},m.curve=function(o){return arguments.length?(O=o,s!=null&&(p=O(s)),m):O},m.context=function(o){return arguments.length?(o==null?s=p=null:p=O(s=o),m):s},m}function To(){}function Wo(e){this._context=e}Wo.prototype={areaStart:To,areaEnd:To,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Cn(e){return new Wo(e)}function No(e,t,a){const s=new b(10).pow(t-a);return new b(1.0001).pow(e).mul(s)}const $n=ze({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,t){const a=B(1),s=B(""),O=B(""),p=y(()=>{var i,g,A;return u.sqrtPriceX64ToPrice((i=e.poolInfo)==null?void 0:i.current_sqrt_price,(g=e.poolInfo)==null?void 0:g.coinA.decimals,(A=e.poolInfo)==null?void 0:A.coinB.decimals).toString()}),T=y(()=>{let i=0;return e.direction?i=(Number(e.minPrice)/Number(p.value)-1)*100:i=(Number(e.minPrice)/Number(1/Number(p.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),m=y(()=>{let i=0;return e.direction?i=(Number(e.maxPrice)/Number(p.value)-1)*100:i=(Number(e.maxPrice)/Number(1/Number(p.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),o=Ge(),r=y(()=>o),v=y(()=>r.value.chainName?eo(r.value.chainName):{}),{TickMath:u,getNearestTickByTick:k}=v.value,H=()=>{const i=a.value/2;a.value=i,oe(e.poolInfo,i)},te=()=>{const i=a.value*2;a.value=i,oe(e.poolInfo,i)},ee=(i=[])=>{let g=6;const A=Math.abs(Number(i[0])-Number(i[i.length-1]));return A>=6?g=0:A>=1?g=1:A>=.1?g=2:A>=.01?g=3:A>=.001?g=4:A>=1e-4?g=5:A>=1e-5?g=6:A>=1e-6?g=7:A>=1e-7&&(g=8),g},oe=(i,g=1)=>{if(i&&i.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const A=Number(e.poolInfo.current_tick_index);let I=A+100*g,c=A-100*g,ie,G;if(e.maxPrice==="âˆž")G=v.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?G=u.priceToTickIndex(new b(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):G=u.priceToTickIndex(new b(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{G=443636}if(e.minPrice==="0")ie=v.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?ie=u.priceToTickIndex(new b(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):ie=u.priceToTickIndex(new b(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{ie=-443636}let ue=0;if(e.currentPriceTab!=="full range"){if(A>=ie&&A<=G){const E=A-ie,pe=G-A;ue=Math.max(Math.abs(E),Math.abs(pe))}else A<ie?ue=Math.abs(G-A):ue=Math.abs(A-ie);I=A+ue+100*g,c=A-ue-100*g}else{const E=(Math.abs(A)>5e3,2e4);I=A+E*g,c=A-E*g}c<-443636&&(c=-443636),I>443636&&(I=443636);const F=new b(i.liquidity).div(Math.pow(10,8)).toString(),$=e.tickList,L=[],U=[];let j={};for(let E=0;E<$.length;E++){if(j=$[E],j.index<=A&&j.index>=c){if(L.length<1&&E!==0){const pe=$[E-1];L.unshift({...pe,index:c})}L.unshift(j)}else if(j.index>A&&j.index<=I&&(U.push(j),L.length<1&&E!==0)){const pe=$[E-1];L.push({...pe,index:c})}if(j.index>I){const pe=$[E];if(U.push({...pe,index:I}),L.length<1&&E!==0){const _e=$[E-1];L.push({..._e,index:c})}break}}let ne="0";for(let E=L.length-1;E>=0;E--)ne=new b(ne).plus(new b(L[E].liquidityNet.toString()).div(Math.pow(10,8))).toString(),L[E].liquityAmount=ne;let V=F;for(let E=0;E<U.length;E++)V=new b(V).plus(new b(U[E].liquidityNet.toString()).div(Math.pow(10,8))).toString(),U[E].liquityAmount=V;let ae=[];const Z=$&&$.length>0?{index:A,liquityAmount:Number(F)}:{index:A,liquityAmount:0};(L.length>0||U.length>0)&&(ae=[...L.reverse(),Z,...U],e.direction||(ae=ae.reverse()));const ge=[];$.forEach(E=>{ge.push({...E,liquidityGross:E.liquidityGross.toString(),liquidityNet:E.liquidityNet.toString()})}),f(ae,c,I,ie,G,A)}};let l=B(!1);Bo(()=>{document.body.clientWidth<750?l.value=!1:l.value=!0,window.onresize=()=>{document.body.clientWidth<750?l.value=!1:l.value=!0,oe(e.poolInfo,a.value)}});const f=(i,g,A,I,c,ie)=>{let G,ue;e.direction?(G=e.before7dContractPriceLowest?u.priceToTickIndex(new b(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ue=e.before7dContractPriceHighest?u.priceToTickIndex(new b(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(G=e.before7dContractPriceLowest?u.priceToTickIndex(new b(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ue=e.before7dContractPriceHighest?u.priceToTickIndex(new b(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const F={top:30,right:35,bottom:20,left:55};let $,L;l.value,$=340-F.left-F.right,L=205-F.top-F.bottom;const U=A-g,j=parseInt(String(U/4));let ne=[g+j/4,g+j,g+2*j,A-j,A-j/4];const V=g,ae=A,Z=$/(ae-V);e.currentPriceTab==="full range"&&(ne=[g,g+2*j,A]);const ge=ne.map(N=>e.direction?No(N,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new b(1).div(No(N,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());ee(ge),to("#chart").selectAll("*").remove();const E=to("#chart").attr("width",$+F.left+F.right).attr("height",L+F.top+F.bottom).append("g").attr("transform",`translate(${F.left},${F.right})`),pe=xo(i,function(N){return Number(Math.abs(N.liquityAmount))})||0,_e=en().range([0,L]).domain([pe,0]);on().rangeRound([0,$]).padding(.1);const d=E.append("g").attr("id","barsBox").selectAll("rect").data(i).enter().append("rect");r.value.theme=="default"?d.attr("x",function(N,M){return M===0?0:e.direction?Math.abs(N.index-V)*Z:Math.abs(ae-N.index)*Z}).attr("y",function(N,M){return e.direction?M===i.length-1?0:_e(N.liquityAmount):M===i.length-1?0:_e(i[M+1].liquityAmount)}).attr("width",function(N,M){return M===0&&i.length===1&&N.liquityAmount>0?$:(e.direction,M!==i.length-1?Math.abs(i[M+1].index-N.index)*Z:0)}).attr("height",function(N,M){return M===0&&i.length===1&&N.liquityAmount>0?L:e.direction?M===i.length-1?0:L-_e(N.liquityAmount):M===i.length-1?0:L-_e(i[M+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):d.attr("x",function(N,M){return M===0?0:e.direction?Math.abs(N.index-V)*Z:Math.abs(ae-N.index)*Z}).attr("y",function(N,M){return e.direction?M===i.length-1?0:_e(Math.abs(N.liquityAmount)):M===i.length-1?0:_e(Math.abs(i[M+1].liquityAmount))}).attr("width",function(N,M){return M===0&&i.length===1&&N.liquityAmount>0?$:(e.direction,M!==i.length-1?Math.abs(i[M+1].index-N.index)*Z:0)}).attr("height",function(N,M){if(M===0&&i.length===1&&N.liquityAmount>0)return L;if(e.direction)return M===i.length-1?0:Number(N.liquityAmount)?L-_e(Math.abs(N.liquityAmount)):0;{if(M===i.length-1)return 0;const ce=L-_e(Math.abs(i[M+1].liquityAmount));return Number(i[M+1].liquityAmount)?ce:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const h=E.append("g");h.append("line").attr("x1",0).attr("y1",155).attr("x2",$).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),h.append("g");let q=0;e.direction?q=Math.abs(ie-V)*Z:q=Math.abs(ie-ae)*Z,(r.value.theme=="default"?E.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):E.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+q+", 0)"),to("#triangle").attr("width",8).attr("height",4);let X=[[0,0],[4,4],[8,0]],K=In().x(function(N){return N[0]}).y(function(N){return N[1]}).curve(Cn);const W=q-4;E.append("path").attr("d",K(X)).style("fill",r.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+W+", 0)");let z,Y,se,de;e.direction?(z=I<V?-100:parseInt(String(Math.abs(I-V)*Z)),Y=c<V?-100:parseInt(String(Math.abs(c-V)*Z)),se=G<V?-100:Math.abs(G-V)*Z,de=ue<V?-100:Math.abs(ue-V)*Z):(Y=I<V?-100:Math.abs(ae-I)*Z,z=c<V?-100:Math.abs(ae-c)*Z,de=G<V?-100:Math.abs(ae-G)*Z,se=ue<V?-100:Math.abs(ae-ue)*Z),e.minPrice==="0"&&(z=0),e.maxPrice==="âˆž"&&(Y=$),l.value?s.value=$-z+60+"px":s.value=$-z+52+"px",O.value=Y+74+"px",G&&se<$&&E.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+se+", 0)"),ue&&de<$&&E.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+de+", 0)");const ke=nn().extent([[0,0],[$,L]]).handleSize(30).on("end",Ae);E.append("g").attr("class","brush").call(ke).call(ke.move,[z,Y]);function Ae(N){if(!N.sourceEvent||!N.selection)return;l.value?s.value=$-N.selection[0]+60+"px":s.value=$-N.selection[0]+52+"px",O.value=N.selection[1]+74+"px";let M,ce,we=0,w=0;e.direction?(we=k(parseInt(String(N.selection[0]/Z+V)),Number(e.poolInfo.tickSpacing)),M=u.tickIndexToPrice(we,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),w=k(parseInt(String(N.selection[1]/Z+V)),Number(e.poolInfo.tickSpacing)),ce=u.tickIndexToPrice(w,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):(w=k(ae-N.selection[0]/Z,Number(e.poolInfo.tickSpacing)),M=1/u.tickIndexToPrice(w,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),we=k(ae-N.selection[1]/Z,Number(e.poolInfo.tickSpacing)),ce=1/u.tickIndexToPrice(we,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),t.emit("onChangeMinPrice",String(be(String(M),6))),t.emit("onChangeMaxPrice",String(be(String(ce),6)))}r.value.theme=="default"?to(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):to(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};B(""),ye(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([i,g,A,I])=>{i&&g&&A&&oe(i,a.value)},{immediate:!0});const P=B(!0);return ye(()=>e.chartLoading,(i,g)=>{i!==g&&(P.value=i)},{immediate:!0,deep:!0}),{store:r,loading:P,zoomOut:H,zoomIn:te,rangeSizeLower:T,rangeSizeUpper:m,rangeSizeLowerPosition:s,rangeSizeUpperPosition:O,decimalFormat:Qo,numberformat:Ko}}});const Sn=e=>(mo("data-v-59ae7c8b"),e=e(),vo(),e),Pn={class:"chart-box"},Tn={class:"chart"},Nn=Sn(()=>n("svg",{id:"chart"},null,-1)),Rn=[Nn];function On(e,t,a,s,O,p){return _(),S("div",Pn,[Te(n("div",Tn,Rn,512),[[Mo,!e.loading]])])}const Ho=Ye($n,[["render",On],["__scopeId","data-v-59ae7c8b"]]),qn=ze({components:{StatusBlock:Oo,NewPositionChart:Ho,TokenWarning:co},setup(e){const t=B(),a=B(),s=y(()=>{var i,g;return(g=(i=u.value)==null?void 0:i.poolInfo)==null?void 0:g.needReverse}),O=Ge(),p=y(()=>O),T=y(()=>p.value.currentExplorer),m=y(()=>p.value.theme),o=y(()=>p.value.chainName),r=oo(),v=y(()=>r),u=B({}),k=fo();ye(()=>[v.value.currentPositionInfo,o.value],([i,g])=>{var A;(g=="Aptos"&&i||g=="Sui"&&i&&(i==null?void 0:i.nftHash)==((A=k==null?void 0:k.query)==null?void 0:A.pos))&&(u.value=i,t.value=u.value.token_a,a.value=u.value.token_b)},{immediate:!0});const H=i=>{var g;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((g=v.value.tokensObj[i==null?void 0:i.address])==null?void 0:g.logo_url)||(m.value==="default"?xe("/image/coins/unknown.png"):xe("/image/coins/sui-unknown.png"))},te=y(()=>o.value?eo(o.value):{}),ee=B([]),oe=async i=>{const{list:g}=await te.value.getTicks(i),A=g?te.value.getTickDataFromUrlData(g):[];ee.value=A};ye(()=>[u.value,v.value.poolsObj],([i,g])=>{i&&!fe(i)&&i.poolInfo&&g&&!fe(g)&&oe(g[i.poolAddress])},{immediate:!0});const l=B(!0),f=(i,g)=>i!=="0"&&g!=="âˆž"?Me(1/(1-Number((i/g)**.25)),2)+"x":"1x",P=y(()=>u.value.minPrice&&u.value.maxPrice?f(u.value.minPrice,u.value.maxPrice):"--");return{needReverse:s,getCoinIcon:H,theme:m,indexStore:O,direct:l,addCommom:Q,decimalUi:be,tickList:ee,positionInfo:u,fromCoin:t,toCoin:a,getExplorerUrl:bo,lever:P,currentExplorer:T}}}),Ln=""+globalThis.__publicAssetsURL("image/aptos-price.png"),Bn=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),Mn=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),Un=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const We=e=>(mo("data-v-39ad5090"),e=e(),vo(),e),jn={class:"new-position-info"},En={class:"pool-info"},Dn={class:"left"},Fn={class:"coin-a"},Wn={alt:""},Hn={class:"coin-b"},Xn={alt:""},Gn={class:"position-name"},zn=["href"],Yn=We(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),Jn=[Yn],Qn={key:0,class:"pool-fee"},Kn=We(()=>n("span",null,"Fee tier",-1)),Zn={class:"right"},Vn={class:"h5-pool-info"},xn={class:"coin-info"},et={class:"coin-a"},ot={alt:""},nt={class:"coin-b"},tt={alt:""},it={class:"position-name"},at=["href"],st=We(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),lt=[st],rt={key:0,class:"pool-fee"},ut={class:"price-info"},dt={class:"price-and-chart"},ct={class:"left"},mt={class:"current-price"},vt=We(()=>n("span",null,"Current Price",-1)),ft={class:"coin-rate"},pt=We(()=>n("div",null,[n("svg",{class:"icon icon-up","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),ht=We(()=>n("div",null,[n("svg",{class:"icon icon-down","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),bt=[pt,ht],kt={key:0},gt={key:1},_t={key:0,class:"position-range"},wt=We(()=>n("div",{class:"position-range-title"}," Position Range ",-1)),yt={key:0},At={key:1},It={key:2,src:Ln,alt:""},Ct={key:3,src:Bn,alt:""},$t={key:4},St={key:5},Pt={key:1,class:"position-range position-range-warp"},Tt={key:0,class:"position-range-title"},Nt={key:1,class:"position-range-title"},Rt={key:2},Ot={key:3},qt={class:"price-img"},Lt={key:0,src:Mn,alt:""},Bt={key:1,src:Un,alt:""},Mt={key:4},Ut={key:5},jt={class:"lever"},Et=We(()=>n("div",{class:"lever-title"},"Leverage",-1)),Dt={class:"lever-text"},Ft={class:"right"},Wt=We(()=>n("div",{class:"chat-mask"},null,-1));function Ht(e,t,a,s,O,p){var v,u,k,H,te,ee,oe,l,f,P,i,g,A,I,c,ie,G,ue,F,$,L,U,j,ne,V,ae,Z,ge,E,pe;const T=co,m=Oo,o=Ho,r=yo("image");return _(),S("div",jn,[n("div",En,[n("div",Dn,[n("div",Fn,[Te(n("img",Wn,null,512),[[r,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),re(T,{address:e.needReverse?(H=(k=e.positionInfo)==null?void 0:k.token_b)==null?void 0:H.address:(u=(v=e.positionInfo)==null?void 0:v.token_a)==null?void 0:u.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",Hn,[Te(n("img",Xn,null,512),[[r,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),re(T,{address:e.needReverse?(l=(oe=e.positionInfo)==null?void 0:oe.token_a)==null?void 0:l.address:(ee=(te=e.positionInfo)==null?void 0:te.token_b)==null?void 0:ee.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",Gn,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(bo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},D((P=(f=e.positionInfo)==null?void 0:f.name)==null?void 0:P.split("|")[1]),9,zn)]),(_(),S("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[0]||(t[0]=_e=>e.indexStore.copy(e.positionInfo.nftHash||e.positionInfo.clmm_position_id))},Jn)),e.positionInfo.fee?(_(),S("div",Qn,[Kn,ve(" "+D(e.positionInfo.fee*100)+"% ",1)])):me("",!0)]),n("div",Zn,[re(m,{"current-status":(i=e.positionInfo)==null?void 0:i.currentStatus},null,8,["current-status"])])]),n("div",Vn,[n("div",null,[n("div",xn,[n("div",et,[Te(n("img",ot,null,512),[[r,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),re(T,{address:e.needReverse?(c=(I=e.positionInfo)==null?void 0:I.token_b)==null?void 0:c.address:(A=(g=e.positionInfo)==null?void 0:g.token_a)==null?void 0:A.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",nt,[Te(n("img",tt,null,512),[[r,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),re(T,{address:e.needReverse?(F=(ue=e.positionInfo)==null?void 0:ue.token_a)==null?void 0:F.address:(G=(ie=e.positionInfo)==null?void 0:ie.token_b)==null?void 0:G.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),n("div",it,[n("div",null,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(bo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},D((L=($=e.positionInfo)==null?void 0:$.name)==null?void 0:L.split("|")[1]),9,at),(_(),S("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[1]||(t[1]=_e=>e.indexStore.copy(e.positionInfo.nftHash))},lt))]),e.positionInfo.fee?(_(),S("div",rt,D(e.positionInfo.fee*100)+"%",1)):me("",!0)])]),re(m,{"current-status":(U=e.positionInfo)==null?void 0:U.currentStatus},null,8,["current-status"])]),n("div",ut,[n("div",dt,[n("div",ct,[n("div",mt,[n("div",null,[vt,n("div",ft,[n("div",{onClick:t[2]||(t[2]=_e=>e.direct=!e.direct)},bt)])]),(e.needReverse?!e.direct:e.direct)?(_(),S("div",kt,[ve(D(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(be))(e.positionInfo.currentPrice,6)))+" Â  ",1),n("span",null,D((j=e.toCoin)==null?void 0:j.symbol)+" per "+D((ne=e.fromCoin)==null?void 0:ne.symbol),1)])):(_(),S("div",gt,[ve(D(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(be))(e.positionInfo.currentPriceReverse,6)))+" Â  ",1),n("span",null,D((V=e.fromCoin)==null?void 0:V.symbol)+" per "+D((ae=e.toCoin)==null?void 0:ae.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(_(),S("div",_t,[wt,n("div",null,[(e.needReverse?!e.direct:e.direct)?(_(),S("div",yt,[ve(D(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(be))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,D(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(_(),S("div",At,[ve(D(((Z=e.positionInfo)==null?void 0:Z.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(be))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,D(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(_(),S("img",It)):(_(),S("img",Ct)),(e.needReverse?!e.direct:e.direct)?(_(),S("div",$t,[ve(D(((ge=e.positionInfo)==null?void 0:ge.maxPrice)!=="âˆž"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(be))(e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,D(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(_(),S("div",St,[ve(D(((E=e.positionInfo)==null?void 0:E.maxPrice)!=="âˆž"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(be))(1/e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,D(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(_(),S("div",Pt,[(e.needReverse?!e.direct:e.direct)?(_(),S("span",Tt," Position Range ")):(_(),S("span",Nt," Position Range ")),(e.needReverse?!e.direct:e.direct)?(_(),S("div",Rt,[ve(D(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(be))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,D(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(_(),S("div",Ot,[ve(D(e.positionInfo.maxPrice!=="âˆž"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(be))(1/e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,D(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),n("div",qt,[e.theme=="default"?(_(),S("img",Lt)):(_(),S("img",Bt))]),(e.needReverse?!e.direct:e.direct)?(_(),S("div",Mt,[ve(D(e.positionInfo.maxPrice!=="âˆž"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(be))(e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,D(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(_(),S("div",Ut,[ve(D(((pe=e.positionInfo)==null?void 0:pe.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(be))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,D(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),ve(" Â  ")]))])),n("div",jt,[Et,n("div",Dt,D(e.lever),1)])]),n("div",Ft,[re(o,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse&&e.positionInfo.maxPrice!=="âˆž"?1/e.positionInfo.maxPrice:e.positionInfo.minPrice,"max-price":e.needReverse&&e.positionInfo.minPrice!=0?1/e.positionInfo.minPrice:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),Wt])])])])}const Xo=Ye(qn,[["render",Ht],["__scopeId","data-v-39ad5090"]]),Xt=ze({components:{TokenWarning:co},setup(e,t){const{t:a}=Ao(),{$notify:s}=tn(),O=Ge(),p=y(()=>O),T=oo(),m=y(()=>T),o=B({}),r=B({}),v=B({}),u=y(()=>p.value.chainName),k=y(()=>u.value?eo(u.value):{}),H=fo(),te=B(!1),ee=async(d=null)=>{const h=d||o.value,q=m.value.addressLpTokens[h.poolAddress];if(q){const C=await k.value.getTickDataByIndex(q.ticks_handle,Number(h.tick_lower_index)),X=await k.value.getTickDataByIndex(q.ticks_handle,Number(h.tick_upper_index));let K={};u.value==="Aptos"?K=await k.value.getPosRewardersAmount({poolAddress:A.currentRoute.value.query.address,positionName:A.currentRoute.value.query.token,tickLowerData:C,tickUpperData:X}):K=await k.value.fetchPosRewardersAmount({poolAddress:h.poolAddress,positionId:h.pos_object_id||h.clmm_position_id,coinTypeA:h.coin_type_a||h.coinTypeA,coinTypeB:h.coin_type_b||h.coinTypeB,rewarderInfo:h.poolInfo.rewarder_infos});const W=[];let z=new b(0);K.forEach((Y,se)=>{var N,M;const de=(N=m.value.tokensObj[Y.coin_address])==null?void 0:N.decimals,ke=Y.amount_owed.toString();let Ae=new b(ke).div(Math.pow(10,de)).toString();if(u.value=="Aptos"&&Number(Ae)>999999999&&(Ae="0"),h.poolInfo[`rewarder_display${se+1}`]||Number(Ae)>0){const ce=m.value.tokensObj[Y.coin_address],we=((M=m.value.RATES[Y.coin_address])==null?void 0:M.price)||0,w=new b(Ae).mul(we).toString();z=new b(z).plus(w),W.push({...Y,...ce,amount:Number(Ae)>0?Se(Ae,de):0,amountUSD:Number(w)>0?Se(w,2):0,amountUSDText:w})}}),I.value=W}};ye(()=>[m.value.currentPositionInfo,u.value],([d,h])=>{var q;h=="Aptos"&&d?(o.value=d,r.value=d==null?void 0:d.token_a,v.value=d==null?void 0:d.token_b):h=="Sui"&&d&&(d==null?void 0:d.nftHash)==((q=H==null?void 0:H.query)==null?void 0:q.pos)&&(o.value=d,r.value=d==null?void 0:d.token_a,v.value=d==null?void 0:d.token_b,te.value=!1)},{immediate:!0}),ye(()=>[o.value,m.value.addressLpTokens],([d,h])=>{!fe(d)&&!fe(h)&&ee(d)},{immediate:!0});const oe=y(()=>{var d,h,q,C,X,K,W,z;if(o.value&&!fe(o.value)&&m.value.RATES){const Y=o.value.amountA*((h=m.value.RATES[(d=o.value)==null?void 0:d.token_a.address])==null?void 0:h.price),se=o.value.amountB*((C=m.value.RATES[(q=o.value)==null?void 0:q.token_b.address])==null?void 0:C.price);if((K=m.value.RATES[(X=o.value)==null?void 0:X.token_a.address])!=null&&K.price&&((z=m.value.RATES[(W=o.value)==null?void 0:W.token_b.address])!=null&&z.price)){const de=Number(Y+se);return de>0&&de<.01?"<0.01":Q(Me(Y+se,2),2)}else return" --"}else return" --"}),l=y(()=>{var d,h;return(h=(d=o.value)==null?void 0:d.poolInfo)==null?void 0:h.needReverse}),f=y(()=>m.value.RATES),P=y(()=>{var d,h;if(f.value&&r.value&&v.value&&!fe(f.value)&&!fe(r.value)&&!fe(v.value)){const q=[],C=Number(o.value.feeOwedA)||0,X=Number(o.value.feeOwedB)||0,K=new b(C).mul(((d=f.value[r.value.address])==null?void 0:d.price)||0),W=new b(X).mul(((h=f.value[v.value.address])==null?void 0:h.price)||0);return q.push({amount:C,amountUSD:K.toString()},{amount:X,amountUSD:W.toString()}),q}return[]}),i=y(()=>{var h,q;let d=new b(0);return(h=P.value)==null||h.forEach(C=>{d=d.add(new b(C.amountUSD))}),u.value=="Sui"&&((q=I.value)==null||q.forEach(C=>{d=d.add(new b(C.amountUSDText))})),d.toNumber()}),g=y(()=>{var h;let d=new b(0);return(h=I.value)==null||h.forEach(q=>{d=d.add(new b(q.amountUSDText))}),d.toNumber()}),A=lo(),I=B([]),{setIsShowSuccess:c,setIsShowRejected:ie,setIsShowWaiting:G,setTransactionDesc:ue,setTransactionTxid:F}=O,$=so(),L=y(()=>$),U=async()=>{te.value=!0;let d={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:I.value.length,collect_fee:!0};d.coinTypeC=I.value[0]?I.value[0].coin_address:"",d.coinTypeD=I.value[1]?I.value[1].coin_address:"",d.coinTypeE=I.value[2]?I.value[2].coin_address:"",G(!0),ue();try{let h;if(u.value==="Aptos"){const q=await k.value.getCollectRewarderTransactionPayload(d);h=await L.value.currentWallet.signAndSubmitTransaction(q)}else{d.pos_index=o.value.pos_object_id;const q=await k.value.getCollectRewarderTransactionPayload(d,o.value),C=await L.value.currentWallet.signAndExecuteTransactionBlock(q);h=k.value.handleTx(C)}if(h&&h.hash){F(h.hash),G(!1),c(!0);const q={title:"Claim",desc:"",hash:h.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};u.value!=="Aptos"&&(q.res=h.res),k.value.showTransitionPending(q),await k.value.watchTransaction(q)&&t.emit("getDetails")}else G(!1),ie(!0),te.value=!1}catch{G(!1),ie(!0),te.value=!1}},j=B(!1),ne=async()=>{j.value=!0;const d=I.value;let h={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:d.length};h.coinTypeC=d[0]?d[0].coin_address:"",h.coinTypeD=d[1]?d[1].coin_address:"",h.coinTypeE=d[2]?d[2].coin_address:"";try{let q;if(u.value==="Aptos"){const C=await k.value.getCollectRewarderTransactionPayload(h);q=await L.value.currentWallet.signAndSubmitTransaction(C)}else{h.pos_index=o.value.pos_object_id;const C=await k.value.getCollectRewarderTransactionPayload(h),X=await L.value.currentWallet.signAndExecuteTransactionBlock(C);q=k.value.handleTx(X)}if(q&&q.hash){F(q.hash),G(!1),c(!0);const C=d[0].amount+d[0].symbol,X=h.coinTypeD?" and "+d[1].amount+d[1].symbol:"",K=h.coinTypeE?" and "+d[2].amount+d[2].symbol:"",W={title:"Claim",desc:"",hash:q.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:d[0].address,numa:`+ ${Number(d[0].amount)}`,logoa:m.value.tokensObj&&d[0]&&d[0].address&&m.value.tokensObj[d[0].address]&&m.value.tokensObj[d[0].address].logoURI,tokenb:d[1]&&d[1].address,numb:h.coinTypeD?`+ ${Number(d[1].amount)}`:"",logob:h.coinTypeD?m.value.tokensObj&&d[1]&&d[1].address&&m.value.tokensObj[d[1].address]&&m.value.tokensObj[d[1].address].logoURI:"",tokenc:d[2]&&d[2].address,numc:h.coinTypeE?`+ ${Number(d[2].amount)}`:"",logoc:h.coinTypeE?m.value.tokensObj&&d[2]&&d[2].address&&m.value.tokensObj[d[2].address]&&m.value.tokensObj[d[2].address].logoURI:""},text:C+X+K};u.value!=="Aptos"&&(W.res=q.res),k.value.showTransitionPending(W),await k.value.watchTransaction(W)&&setTimeout(()=>{t.emit("getDetails"),k.value.getAccount(L.value.address)},3e3)}else G(!1),ie(!0);j.value=!1}catch{j.value=!1,G(!1),ie(!0)}},V=y(()=>m.value.positionDetailCurrentTab),ae=y(()=>{var q,C,X,K,W,z;const d=be(l.value?(C=o.value)==null?void 0:C.amountB:(q=o.value)==null?void 0:q.amountA,l.value?(z=(W=o.value)==null?void 0:W.token_b)==null?void 0:z.decimals:(K=(X=o.value)==null?void 0:X.token_a)==null?void 0:K.decimals),h=l.value?m.value.positionActionAmount.toCoinAmount||0:m.value.positionActionAmount.fromCoinAmount||0;if(V.value=="increase")return h?new b(d).add(new b(h)).toString():"";if(h){const Y=new b(d).minus(new b(h)).toString();return Y<0?"0":String(Y)}else return""}),Z=y(()=>{var q,C,X,K,W,z;const d=be(l.value?(C=o.value)==null?void 0:C.amountA:(q=o.value)==null?void 0:q.amountB,l.value?(z=(W=o.value)==null?void 0:W.token_a)==null?void 0:z.decimals:(K=(X=o.value)==null?void 0:X.token_b)==null?void 0:K.decimals),h=l.value?m.value.positionActionAmount.fromCoinAmount||0:m.value.positionActionAmount.toCoinAmount||0;if(V.value=="increase")return h?new b(d).add(new b(h)).toString():"";if(h){const Y=new b(d).minus(new b(h)).toString();return Y<0?"0":String(Y)}else return""}),ge=y(()=>l.value?m.value.positionActionAmount.toCoinAmount:m.value.positionActionAmount.fromCoinAmount),E=y(()=>l.value?m.value.positionActionAmount.fromCoinAmount:m.value.positionActionAmount.toCoinAmount),pe=d=>{var h;return(d==null?void 0:d.logoURI)||(d==null?void 0:d.logo_url)||((h=m.value.tokensObj[d==null?void 0:d.address])==null?void 0:h.logo_url)||(p.value.theme==="default"?xe("/image/coins/unknown.png"):xe("/image/coins/sui-unknown.png"))},_e=y(()=>{var K,W,z,Y,se,de,ke,Ae,N,M,ce,we;const{fromCoinAmount:d,toCoinAmount:h}=m.value.positionActionAmount,q=m.value.positionDetailCurrentTab,C=be(l.value?(W=o.value)==null?void 0:W.amountB:(K=o.value)==null?void 0:K.amountA,l.value?(de=(se=o.value)==null?void 0:se.token_b)==null?void 0:de.decimals:(Y=(z=o.value)==null?void 0:z.token_a)==null?void 0:Y.decimals),X=be(l.value?(Ae=o.value)==null?void 0:Ae.amountA:(ke=o.value)==null?void 0:ke.amountB,l.value?(we=(ce=o.value)==null?void 0:ce.token_a)==null?void 0:we.decimals:(M=(N=o.value)==null?void 0:N.token_b)==null?void 0:M.decimals);return u.value=="Sui"||q=="remove"&&u.value=="Aptos"&&d==C&&h==X});return{amountUSD:oe,needReverse:l,decimalUi:be,pendingFees:P,positionInfo:o,pendingRewarderArr:I,pendingYieldAmount:i,toClaim:async()=>{te.value=!0;const d=Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,h=Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;ue(a("newAdd.claimWaitingText",{from:l.value?h:d,and:Q(o.value.feeOwedA,o.value.token_a.decimals)==0||Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:l.value?d:h})),G(!0);let q;const C={pool:o.value.poolInfo,position:o.value};try{const X=await k.value.getCollectFeeTransactionPayload(C);if(u.value==="Aptos")q=await L.value.currentWallet.signAndSubmitTransaction(X);else{const K=await L.value.currentWallet.signAndExecuteTransactionBlock(X);q=k.value.handleTx(K)}if(q){F(q.hash),G(!1),c(!0);const K={title:"Claim",desc:"",hash:q.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_a.address&&m.value.tokensObj[o.value.token_a.address]&&m.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_b.address&&m.value.tokensObj[o.value.token_b.address]&&m.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${Q(o.value.feeOwedA,o.value.token_a.decimals)==0||Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};u.value!=="Aptos"&&(K.res=q.res),k.value.showTransitionPending(K),await k.value.watchTransaction(K)&&setTimeout(()=>{t.emit("getDetails")},1e3)}else G(!1),ie(!0),s.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:So.global.t("newAdd.claimFailed")},null)]),description:a("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});te.value=!1}catch{te.value=!1,G(!1),ie(!0),s.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:So.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:a("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},claimAll:U,fromCoin:r,toCoin:v,showNum:Se,claimLoading:te,addCommom:Q,afterBase:ae,afterQuote:Z,fromCoinAmount:ge,toCoinAmount:E,checkNullObj:fe,getCoinIcon:pe,chainName:u,isShowAfterAmount:_e,pendingRewarderAmount:g,toClaimRewards:ne,rewarderLoading:j}}});const Gt={class:"liquidity-card"},zt={class:"liquidity-title"},Yt={class:"liquidity-usd"},Jt=n("span",null,"Liquidity",-1),Qt={class:"liquidity-ratio"},Kt={class:"coin-ratio"},Zt={class:"coin-a-ratio"},Vt={class:"coin-b-ratio"},xt={class:"ratio-progress"},ei={class:"base-quote-num"},oi={class:"base-coin-num"},ni=n("span",null,"Base",-1),ti={alt:""},ii={key:0,class:"after"},ai={class:"quote-coin-num"},si=n("span",null,"Quote",-1),li={alt:""},ri={key:0,class:"after"},ui={class:"pending-yield"},di={class:"left"},ci={class:"pending-yield-title"},mi={key:0,class:"after"},vi={class:"right"},fi={class:"fees-rewards"},pi={class:"fees-rewards-item"},hi=n("span",null,"Fees",-1),bi={key:0,class:"after"},ki=n("span",null,"Fees",-1),gi={key:0,class:"after"},_i=n("span",null,"Mining Rewards",-1),wi={alt:""},yi={key:0,class:"after"},Ai={key:0,class:"pending-yield"},Ii={class:"left"},Ci=n("div",{class:"pending-yield-title"},"Pending rewards",-1),$i={key:0,class:"after"},Si={class:"right"},Pi={key:1,class:"fees-rewards"},Ti={class:"fees-rewards-item"},Ni=n("span",null,"Mining Rewards",-1),Ri={alt:""},Oi={key:0,class:"after"};function qi(e,t,a,s,O,p){var r,v,u,k,H,te,ee,oe,l,f,P,i,g,A,I,c,ie,G,ue,F,$,L,U,j,ne,V,ae,Z,ge,E,pe,_e,De,d,h,q,C,X,K,W,z,Y,se,de,ke,Ae,N,M,ce,we,w,x,R,le,he,$e,Ne,Ie,Re,je,Ee,He,Oe,Ue;const T=co,m=ro,o=yo("image");return _(),S("div",Gt,[n("div",zt,[n("div",Yt,[Jt,n("div",null,"$"+D(e.amountUSD),1)]),n("div",Qt,[n("div",Kt,[n("div",Zt,[n("span",null,D(e.needReverse?(v=e.toCoin)==null?void 0:v.symbol:(r=e.fromCoin)==null?void 0:r.symbol),1),ve(" "+D(e.needReverse?(k=e.positionInfo)==null?void 0:k.toPercent:(u=e.positionInfo)==null?void 0:u.fromPercent)+"% ",1)]),n("div",Vt,[n("span",null,D(e.needReverse?(te=e.fromCoin)==null?void 0:te.symbol:(H=e.toCoin)==null?void 0:H.symbol),1),ve(" "+D(e.needReverse?(oe=e.positionInfo)==null?void 0:oe.fromPercent:(ee=e.positionInfo)==null?void 0:ee.toPercent)+"% ",1)])]),n("div",xt,[n("div",{class:"from-percent",style:Po({width:e.needReverse?((f=e.positionInfo)==null?void 0:f.toPercent)+"%":((l=e.positionInfo)==null?void 0:l.fromPercent)+"%"})},null,4),n("div",{class:"to-percent",style:Po({width:e.needReverse?((i=e.positionInfo)==null?void 0:i.fromPercent)+"%":((P=e.positionInfo)==null?void 0:P.toPercent)+"%"})},null,4)])])]),n("div",ei,[n("div",oi,[ni,n("div",null,[Te(n("img",ti,null,512),[[o,(e.needReverse?(A=e.toCoin)==null?void 0:A.logo_url:(g=e.fromCoin)==null?void 0:g.logo_url)||e.getCoinIcon(e.needReverse?(c=e.positionInfo)==null?void 0:c.token_b:(I=e.positionInfo)==null?void 0:I.token_a)]]),re(T,{address:e.needReverse?(F=(ue=e.positionInfo)==null?void 0:ue.token_b)==null?void 0:F.address:(G=(ie=e.positionInfo)==null?void 0:ie.token_a)==null?void 0:G.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,D(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(be))(e.needReverse?(L=e.positionInfo)==null?void 0:L.amountB:($=e.positionInfo)==null?void 0:$.amountA,e.needReverse?(V=(ne=e.positionInfo)==null?void 0:ne.token_b)==null?void 0:V.decimals:(j=(U=e.positionInfo)==null?void 0:U.token_a)==null?void 0:j.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:J(fe))(e.positionInfo)?(_(),S("div",ii,D(("addCommom"in e?e.addCommom:J(Q))(e.afterBase))+" after ",1)):me("",!0)]),n("div",ai,[si,n("div",null,[Te(n("img",li,null,512),[[o,(e.needReverse?(Z=e.fromCoin)==null?void 0:Z.logo_url:(ae=e.toCoin)==null?void 0:ae.logo_url)||e.getCoinIcon(e.needReverse?(E=e.positionInfo)==null?void 0:E.token_a:(ge=e.positionInfo)==null?void 0:ge.token_b)]]),re(T,{address:e.needReverse?(d=(De=e.positionInfo)==null?void 0:De.token_a)==null?void 0:d.address:(_e=(pe=e.positionInfo)==null?void 0:pe.token_b)==null?void 0:_e.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,D(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(be))(e.needReverse?(q=e.positionInfo)==null?void 0:q.amountA:(h=e.positionInfo)==null?void 0:h.amountB,e.needReverse?(W=(K=e.positionInfo)==null?void 0:K.token_a)==null?void 0:W.decimals:(X=(C=e.positionInfo)==null?void 0:C.token_b)==null?void 0:X.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:J(fe))(e.positionInfo)?(_(),S("div",ri,D(("addCommom"in e?e.addCommom:J(Q))(e.afterQuote))+" after ",1)):me("",!0)])]),n("div",ui,[n("div",di,[n("div",ci,D(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),n("div",null,[ve(" $"+D(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Q))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(_(),S("span",mi,"$0 after")):me("",!0)])]),n("div",vi,[re(m,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.pendingYieldAmount==0,onClick:t[0]||(t[0]=Ce=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Be(()=>[ve("Claim")]),_:1},8,["loading","disabled"])])]),n("div",fi,[n("div",pi,[n("div",null,[hi,n("div",null,[Te(n("img",null,null,512),[[o,(e.needReverse?(Y=e.toCoin)==null?void 0:Y.logo_url:(z=e.fromCoin)==null?void 0:z.logo_url)||e.getCoinIcon(e.needReverse?(de=e.positionInfo)==null?void 0:de.token_b:(se=e.positionInfo)==null?void 0:se.token_a)]]),re(T,{address:e.needReverse?(M=(N=e.positionInfo)==null?void 0:N.token_b)==null?void 0:M.address:(Ae=(ke=e.positionInfo)==null?void 0:ke.token_a)==null?void 0:Ae.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,D(e.needReverse?("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedB,(x=(w=e.positionInfo)==null?void 0:w.token_b)==null?void 0:x.decimals):("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedA,(we=(ce=e.positionInfo)==null?void 0:ce.token_a)==null?void 0:we.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(fe))(e.positionInfo)&&e.isShowAfterAmount?(_(),S("div",bi," 0 after ")):me("",!0)]),n("div",null,[ki,n("div",null,[Te(n("img",null,null,512),[[o,(e.needReverse?(le=e.fromCoin)==null?void 0:le.logo_url:(R=e.toCoin)==null?void 0:R.logo_url)||e.getCoinIcon(e.needReverse?($e=e.positionInfo)==null?void 0:$e.token_a:(he=e.positionInfo)==null?void 0:he.token_b)]]),re(T,{address:e.needReverse?(je=(Re=e.positionInfo)==null?void 0:Re.token_a)==null?void 0:je.address:(Ie=(Ne=e.positionInfo)==null?void 0:Ne.token_b)==null?void 0:Ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,D(e.needReverse?("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedA,(Ue=(Oe=e.positionInfo)==null?void 0:Oe.token_a)==null?void 0:Ue.decimals):("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedB,(He=(Ee=e.positionInfo)==null?void 0:Ee.token_b)==null?void 0:He.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(fe))(e.positionInfo)&&e.isShowAfterAmount?(_(),S("div",gi," 0 after ")):me("",!0)]),e.chainName=="Sui"?(_(!0),S(io,{key:0},ao(e.pendingRewarderArr,Ce=>(_(),S("div",{key:Ce},[_i,n("div",null,[Te(n("img",wi,null,512),[[o,Ce.logo_url]]),re(T,{address:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,D(Ce.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(fe))(e.positionInfo)&&e.isShowAfterAmount?(_(),S("div",yi," 0 after ")):me("",!0)]))),128)):me("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(_(),S("div",Ai,[n("div",Ii,[Ci,n("div",null,[ve(" $"+D(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Q))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(_(),S("span",$i,"$0 after")):me("",!0)])]),n("div",Si,[re(m,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Be(()=>[ve("Claim")]),_:1},8,["loading","disabled","onClick"])])])):me("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(_(),S("div",Pi,[n("div",Ti,[(_(!0),S(io,null,ao(e.pendingRewarderArr,Ce=>(_(),S("div",{key:Ce},[Ni,n("div",null,[Te(n("img",Ri,null,512),[[o,Ce.logo_url]]),re(T,{address:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,D(Ce.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(fe))(e.positionInfo)&&e.isShowAfterAmount?(_(),S("div",Oi," 0 after ")):me("",!0)]))),128))])])):me("",!0)])}const Go=Ye(Xt,[["render",qi]]),Li=ze({components:{AssetsCard:po},setup(e,t){const a=B(""),s=B(""),O=Ge(),p=y(()=>O),T=y(()=>p.value.theme),m=oo(),o=y(()=>m),r=B(!1),v=B(!1),u=B(!0),k=y(()=>p.value.chainName),H=y(()=>k.value?eo(k.value):{}),te=so(),ee=y(()=>te),oe=y(()=>p.value.slippage),l=B(),f=B(),P=y(()=>ee.value.assets&&l.value&&ee.value.assets[l.value.address]?Co(ee.value.assets[l.value.address].balance,l.value.decimals):0),i=y(()=>ee.value.assets&&f.value&&ee.value.assets[f.value.address]?Co(ee.value.assets[f.value.address].balance,f.value.decimals):0),g=C=>{C==="fromCoin"?(u.value=!0,k.value==="Aptos"?a.value=P.value>0?l.value.symbol=="APT"?new b(Number(P.value)).sub(new b(.1)).lt(new b(0))?"0":new b(Number(P.value)).sub(new b(.1)).toString():String(P.value):"":a.value=P.value>0?l.value.symbol=="SUI"?new b(Number(P.value)).sub(new b(.05)).lt(new b(0))?"0":new b(Number(P.value)).sub(new b(.05)).toString():String(P.value):""):(u.value=!1,k.value==="Aptos"?s.value=i.value>0?f.value.symbol=="APT"?new b(Number(i.value)).sub(new b(.1)).lt(new b(0))?"0":new b(Number(i.value)).sub(new b(.1)).toString():String(i.value):"":s.value=i.value>0?f.value.symbol=="SUI"?new b(Number(i.value)).sub(new b(.05)).lt(new b(0))?"0":new b(Number(i.value)).sub(new b(.05)).toString():String(i.value):"")},A=C=>{C==="fromCoin"?(u.value=!0,a.value=Me(new b(Number(P.value)).div(2).toString(),l.value.decimals).toString()):(u.value=!1,s.value=Me(new b(Number(i.value)).div(2).toString(),f.value.decimals).toString())},I=B({}),c=B(!0),ie=B({}),G=B(),ue=B(),F=()=>{var M;if(!I.value||!a.value&&!s.value)return;const{TickMath:C,TickUtil:X}=H.value;let K=I.value.minPrice,W=I.value.maxPrice.indexOf("+")>0?"âˆž":I.value.maxPrice,z=Number(I.value.tick_lower_index),Y=Number(I.value.tick_upper_index);const se=Number(I.value.current_tick_index);let de,ke,Ae=Number(K).toString(),N=I.value.maxPrice.indexOf("+")>0||I.value.maxPrice==="âˆž"?"âˆž":Number(W);if(Ae=="0"&&N=="âˆž"?(z=Number(I.value.tick_lower_index),Y=Number(I.value.tick_upper_index)):(de=C.priceToSqrtPriceX64(new b(K),l.value.decimals,f.value.decimals),ke=C.priceToSqrtPriceX64(new b(W),l.value.decimals,f.value.decimals)),G.value=z,ue.value=Y,W!=="âˆž"&&z>=Y){r.value=!0,a.value="",v.value=!0,s.value="";return}if(W=="âˆž"||se>=z&&se<=Y){r.value=!1,v.value=!1;let ce;if(a.value||s.value){if(u.value){const he=new b(a.value).mul(Math.pow(10,l.value.decimals)).toString();ce=new qe(he)}else{const he=new b(s.value).mul(Math.pow(10,f.value.decimals)).toString();ce=new qe(he)}const{liquidityAmount:we,tokenMaxA:w,tokenMaxB:x,tokenMaxAOrigin:R,tokenMaxBOrigin:le}=H.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:l.value,tokenB:f.value,lowerTick:z,upperTick:Y,coinAmount:ce,iscoinA:c.value?u.value:!u.value,roundUp:!0,slippage:Number(oe.value)/100,curSqrtPrice:new qe(I.value.current_sqrt_price)});ie.value={liquidityAmount:we,tokenMaxA:w,tokenMaxB:x,tokenMaxAOrigin:R,tokenMaxBOrigin:le},c.value?u.value?s.value=Number(x)>0?x:"":a.value=Number(w)>0?w:"":u.value?s.value=w:a.value=x}}else if(se>Y){if(a.value="",r.value=!0,v.value=!1,a.value||s.value){let ce;const we=new b(s.value).mul(Math.pow(10,(M=f.value)==null?void 0:M.decimals)).toString();ce=new qe(we),ie.value={liquidityAmount:qo(de,ke,ce),tokenMaxA:0,tokenMaxB:s.value}}}else if(se<z){if(r.value=!1,v.value=!0,s.value="",a.value||s.value){let ce;const we=new b(a.value).mul(Math.pow(10,l.value.decimals)).toString();ce=new qe(we),ie.value={liquidityAmount:Lo(de,ke,ce),tokenMaxA:a.value,tokenMaxB:0}}}else r.value=!0,a.value="",v.value=!0,s.value="";m.setPositionActionAmount({fromCoinAmount:a,toCoinAmount:s})};ye(()=>o.value.currentPositionInfo,C=>{if(C&&!fe(C)){I.value=C,l.value=I.value.token_a,f.value=I.value.token_b;let X=Number(I.value.tick_lower_index),K=Number(I.value.tick_upper_index);const W=Number(I.value.current_tick_index);(C.maxPrice.indexOf("+")>0||C.maxPrice==="âˆž"?"âˆž":C.maxPrice)=="âˆž"||W>=X&&W<=K?(r.value=!1,v.value=!1):W>K?(a.value="",r.value=!0,v.value=!1):W<X?(r.value=!1,v.value=!0,s.value=""):(r.value=!0,a.value="",v.value=!0,s.value=""),F()}},{immediate:!0}),ye(a,(C,X)=>{C&&F(),C==""&&(s.value="")}),ye(s,(C,X)=>{C&&F(),C==""&&(a.value="")});const $=y(()=>{var C,X;return(X=(C=I.value)==null?void 0:C.poolInfo)==null?void 0:X.needReverse}),L=y(()=>o.value.RATES),U=y(()=>{var Y,se,de,ke;const C=((se=L.value[(Y=l.value)==null?void 0:Y.address])==null?void 0:se.price)||0,X=((ke=L.value[(de=f.value)==null?void 0:de.address])==null?void 0:ke.price)||0,K=new b(C).mul(new b(a.value||0)),W=new b(X).mul(new b(s.value||0)),z=K.add(W);return z.toNumber()?z.toNumber()>0&&z.toNumber()>.01?Q(z.toString(),2):"<0.01":"--"}),j=B(!1),{t:ne,locale:V}=Ao(),ae=y(()=>{const C=Number(a.value)>Number(P.value),X=Number(s.value)>Number(i.value);return!a.value&&!s.value?ne("button.enterAmount"):C?ne("button.insufficientBalance",{name:l.value.symbol}):X?ne("button.insufficientBalance",{name:f.value.symbol}):ne("newAdd.addMore")}),Z=y(()=>{const C=Number(a.value)>Number(P.value),X=Number(s.value)>Number(i.value);return!!(!a.value&&!s.value||C||X)}),{setIsShowSuccess:ge,setIsShowRejected:E,setIsShowWaiting:pe,setTransactionDesc:_e,setTransactionTxid:De,setPositiomNum:d}=O,h=B(!1);return{theme:T,showFromCoinLock:r,showToCoinLock:v,toCoinAmount:s,fromCoinAmount:a,fromCoinBlance:P,toCoinBlance:i,fromCoin:l,toCoin:f,maxBtnSelect:g,halfBtnSelect:A,fixedFromCoin:u,needReverse:$,totalAmount:U,wallet:ee,addLiquidityBtnText:ae,isShowLiquidityModal:j,indexStore:O,positionInfo:I,actionLoading:h,toAdd:async()=>{var Y,se,de,ke,Ae,N,M,ce,we,w;j.value=!1,h.value=!0,De("");const C=r.value?"":`${a.value} ${(Y=l.value)==null?void 0:Y.symbol}`,X=v.value?"":`${s.value} ${(se=f.value)==null?void 0:se.symbol}`;_e(ne("tips.increaseLiquiditySuccess",{from:$.value?X:C,and:!r.value&&!v.value?"and":"",to:$.value?C:X})),pe(!0);const K=u.value,W=I.value.poolInfo.rewarder_infos;let z={};z.coinTypeC=W[0]?W[0].coinAddress:"",z.coinTypeD=W[1]?W[1].coinAddress:"",z.coinTypeE=W[2]?W[2].coinAddress:"";try{const x=await H.value.getAddLiquidityTransactionPayload({pool:{poolAddress:I.value.poolAddress,token_a:I.value.token_a,token_b:I.value.token_b},amount:K?ie.value.tokenMaxA:ie.value.tokenMaxB,fix_amount_a:K,tick_lower:G.value,tick_upper:ue.value,index:k.value==="Aptos"?I.value.index:I.value.pos_object_id,slippage:Number(oe.value)/100,roundUp:!0,collect_fee:!0,...z,curSqrtPrice:new qe(I==null?void 0:I.value.poolInfo.current_sqrt_price),positionInfo:I});let R;if(k.value==="Aptos")R=await ee.value.currentWallet.signAndSubmitTransaction(x);else{const le=await ee.value.currentWallet.signAndExecuteTransactionBlock(x);R=H.value.handleTx(le)}if(R&&R.hash){De(R.hash),pe(!1),ge(!0);const le={title:"Supplied",desc:ne("tips.addLiquiditySuccessText",{from:r.value?"":`${a.value} ${(de=l.value)==null?void 0:de.symbol}`,and:!r.value&&!v.value?"and":"",to:v.value?"":`${s.value} ${(ke=f.value)==null?void 0:ke.symbol}`}),hash:R.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:$.value?`${(N=f.value)==null?void 0:N.address}`:`${(Ae=l.value)==null?void 0:Ae.address}`,numa:$.value?`- ${s.value}`:`- ${a.value}`,logoa:$.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&l.value&&l.value.address&&o.value.tokensObj[l.value.address]&&o.value.tokensObj[l.value.address].logoURI,tokenb:$.value?`${(ce=l.value)==null?void 0:ce.address}`:`${(M=f.value)==null?void 0:M.address}`,numb:$.value?`- ${a.value}`:`- ${s.value}`,logob:$.value?o.value.tokensObj&&l.value&&l.value.address&&o.value.tokensObj[l.value.address]&&o.value.tokensObj[l.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI},text:`Deopsit ${r.value?"":`${a.value} ${(we=l.value)==null?void 0:we.symbol}`} ${!r.value&&!v.value?"and":""} ${v.value?"":`${s.value} ${(w=f.value)==null?void 0:w.symbol}`}`};k.value!=="Aptos"&&(le.res=R.res),H.value.showTransitionPending(le),await H.value.watchTransaction(le)&&setTimeout(()=>{t.emit("getDetails"),H.value.getAccount(ee.value.address)},1e3),d()}else pe(!1),E(!0);a.value="",s.value="",h.value=!1}catch{a.value="",s.value="",h.value=!1,pe(!1),E(!0)}},addLiquidityBtnDisabled:Z,poolStore:m}}});const Bi={class:"new-position-asset"},Mi={class:"add-or-remove"},Ui={class:"liquidity-action-tab"},ji=n("div",{class:"increase tab-active"}," Increase ",-1),Ei={class:"card-item"},Di={class:"card-item"},Fi={key:0,class:"add",src:vn},Wi={key:1,class:"add",src:fn},Hi={class:"total-amount"},Xi=n("span",null,"Total Amount",-1);function Gi(e,t,a,s,O,p){var v;const T=po,m=cn,o=ro,r=mn;return _(),S("div",Bi,[n("div",Mi,[n("div",Ui,[ji,n("div",{class:"remove",onClick:t[0]||(t[0]=u=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),n("div",{class:ko(e.needReverse?"card-container reverse":"card-container")},[n("div",Ei,[re(T,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=u=>e.fromCoinAmount=u),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[2]||(t[2]=u=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=u=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=u=>{e.fromCoinAmount=u}),onOnFocus:t[5]||(t[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(_(),Le(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):me("",!0)]),n("div",Di,[re(T,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[6]||(t[6]=u=>e.toCoinAmount=u),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[7]||(t[7]=u=>e.maxBtnSelect("toCoin")),onOnHalf:t[8]||(t[8]=u=>e.halfBtnSelect("toCoin")),onOnInput:t[9]||(t[9]=u=>{e.toCoinAmount=u}),onOnFocus:t[10]||(t[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(_(),Le(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):me("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(_(),S("img",Fi)):me("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(_(),S("img",Wi)):me("",!0)],2),n("div",Hi,[Xi,n("span",null,"$"+D(e.totalAmount),1)])]),e.wallet.connected?(_(),Le(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:t[11]||(t[11]=u=>e.isShowLiquidityModal=!0)},{default:Be(()=>[n("span",null,D(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(_(),Le(o,{key:1,class:"big-btn",onClick:t[12]||(t[12]=u=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Be(()=>[n("span",null,D(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(_(),Le(r,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(v=e.positionInfo)==null?void 0:v.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:t[13]||(t[13]=u=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):me("",!0)])}const wo=Ye(Li,[["render",Gi]]),zi=ze({components:{AssetsCard:po},setup(e,t){const a=B(""),s=B(""),O=Ge(),p=y(()=>O),T=y(()=>p.value.theme),m=oo(),o=y(()=>m),r=B(!1),v=B(!1),u=B(!0),k=y(()=>p.value.chainName),H=y(()=>k.value?eo(k.value):{}),te=so(),ee=y(()=>te),oe=y(()=>p.value.slippage),l=B(),f=B(),P=y(()=>{var w,x;return(x=(w=c.value)==null?void 0:w.poolInfo)==null?void 0:x.needReverse}),i=y(()=>{var w;return be(c==null?void 0:c.value.amountA,(w=c==null?void 0:c.value.token_a)==null?void 0:w.decimals)}),g=y(()=>{var w;return be(c==null?void 0:c.value.amountB,(w=c==null?void 0:c.value.token_b)==null?void 0:w.decimals)}),A=w=>{w==="fromCoin"?u.value=!0:u.value=!1,U.value=100,ne({value:1})},I=w=>{w==="fromCoin"?(u.value=!0,a.value=Me(new b(Number(i.value)).div(2).toString(),l.value.decimals).toString()):(u.value=!1,s.value=Me(new b(Number(g.value)).div(2).toString(),f.value.decimals).toString()),$.value=!1},c=B({}),ie=B(!0),G=B({}),ue=B(),F=B(),$=B(!0),L=()=>{var He;if($.value||!c.value||!a.value&&!s.value||Number(a.value)>Number(i.value)||Number(s.value)>Number(g.value))return;if(a.value==i.value&&s.value==g.value){U.value=100,ne({value:1}),$.value=!0;return}const{TickMath:w,TickUtil:x}=H.value;let R=c.value.minPrice,le=c.value.maxPrice.indexOf("+")>0?"âˆž":c.value.maxPrice,he=Number(c.value.tick_lower_index),$e=Number(c.value.tick_upper_index);const Ne=Number(c.value.current_tick_index);let Ie,Re,je=Number(R).toString(),Ee=c.value.maxPrice.indexOf("+")>0||c.value.maxPrice==="âˆž"?"âˆž":Number(le);if(je=="0"&&Ee=="âˆž"?(he=Number(c.value.tick_lower_index),$e=Number(c.value.tick_upper_index)):(Ie=w.priceToSqrtPriceX64(new b(R),l.value.decimals,f.value.decimals),Re=w.priceToSqrtPriceX64(new b(le),l.value.decimals,f.value.decimals)),ue.value=he,F.value=$e,le!=="âˆž"&&he>=$e){r.value=!0,a.value="",v.value=!0,s.value="";return}if(le=="âˆž"||Ne>=he&&Ne<=$e){r.value=!1,v.value=!1;let Oe;if(a.value||s.value){if(u.value){const Ze=new b(a.value).mul(Math.pow(10,l.value.decimals)).toString();Oe=new qe(Ze)}else{const Ze=new b(s.value).mul(Math.pow(10,f.value.decimals)).toString();Oe=new qe(Ze)}const{liquidityAmount:Ue,tokenMaxA:Ce,tokenMaxB:Je,tokenMaxAOrigin:uo,tokenMaxBOrigin:Pe}=H.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:l.value,tokenB:f.value,lowerTick:he,upperTick:$e,coinAmount:Oe,iscoinA:ie.value?u.value:!u.value,roundUp:k.value!="Sui",slippage:Number(oe.value)/100,curSqrtPrice:new qe(c.value.current_sqrt_price)});G.value={liquidityAmount:Ue,tokenMaxA:Ce,tokenMaxB:Je,tokenMaxAOrigin:uo,tokenMaxBOrigin:Pe},ie.value?u.value?s.value=Number(Je)>0?Je:"":a.value=Number(Ce)>0?Ce:"":u.value?s.value=Ce:a.value=Je}}else if(Ne>$e){if(a.value="",r.value=!0,v.value=!1,a.value||s.value){let Oe;const Ue=new b(s.value).mul(Math.pow(10,(He=f.value)==null?void 0:He.decimals)).toString();Oe=new qe(Ue),G.value={liquidityAmount:qo(Ie,Re,Oe),tokenMaxA:0,tokenMaxB:s.value}}}else if(Ne<he){if(r.value=!1,v.value=!0,s.value="",a.value||s.value){let Oe;const Ue=new b(a.value).mul(Math.pow(10,l.value.decimals)).toString();Oe=new qe(Ue),G.value={liquidityAmount:Lo(Ie,Re,Oe),tokenMaxA:a.value,tokenMaxB:0}}}else r.value=!0,v.value=!0;$.value=!1,U.value=new b(G.value.liquidityAmount.toString()).div(c.value.liquidity).mul(100).toNumber().toFixed(2),j.value=G.value.liquidityAmount,m.setPositionActionAmount({fromCoinAmount:a,toCoinAmount:s})},U=B(50),j=B("0"),ne=w=>{if(!$.value)return;$.value=!0;const x=c.value.token_a.decimals,R=c.value.token_b.decimals,le=c.value.tick_lower_index,he=c.value.tick_upper_index,$e=$o.tickIndexToSqrtPriceX64(le),Ne=$o.tickIndexToSqrtPriceX64(he);let Ie="";w.value!==1?Ie=new b(c.value.liquidity).mul(w.value).toString():Ie=c.value.liquidity,Ie=Me(Ie,0)||"0",j.value=Ie;const Re=Zo.getCoinAmountFromLiquidity(new qe(Ie),new qe(c.value.current_sqrt_price),$e,Ne,k.value!="Sui"),je=new b(Re.coinA.toString()).div(Math.pow(10,x)).toString(),Ee=new b(Re.coinB.toString()).div(Math.pow(10,R)).toString();a.value=Number(je)>0?je:"",s.value=Number(Ee)>0?Ee:"",m.setPositionActionAmount({fromCoinAmount:a,toCoinAmount:s})};ye(()=>o.value.currentPositionInfo,w=>{if(w&&!fe(w)){c.value=w,l.value=c.value.token_a,f.value=c.value.token_b,ne({value:U.value/100});let x=Number(c.value.tick_lower_index),R=Number(c.value.tick_upper_index);const le=Number(c.value.current_tick_index);(w.maxPrice.indexOf("+")>0||w.maxPrice==="âˆž"?"âˆž":w.maxPrice)=="âˆž"||le>=x&&le<=R?(r.value=!1,v.value=!1):le>R?(a.value="",r.value=!0,v.value=!1):le<x?(r.value=!1,v.value=!0,s.value=""):(r.value=!0,a.value="",v.value=!0,s.value=""),L()}},{immediate:!0}),ye(a,(w,x)=>{w&&L(),w==""&&(s.value="",U.value=0)}),ye(s,(w,x)=>{w&&L(),w==""&&(a.value="",U.value=0)});const V=y(()=>o.value.RATES),ae=y(()=>{var $e,Ne,Ie,Re;const w=((Ne=V.value[($e=l.value)==null?void 0:$e.address])==null?void 0:Ne.price)||0,x=((Re=V.value[(Ie=f.value)==null?void 0:Ie.address])==null?void 0:Re.price)||0,R=new b(w).mul(new b(a.value||0)),le=new b(x).mul(new b(s.value||0)),he=R.add(le);return Q(he.toString(),2)}),Z=B(!1),{t:ge,locale:E}=Ao(),pe=y(()=>{const w=Number(a.value)>Number(i.value),x=Number(s.value)>Number(g.value);return!a.value&&!s.value?ge("button.enterAmount"):w||x?"Invalid Amount":ge("button.remove")}),_e=y(()=>{const w=Number(a.value)>Number(i.value),x=Number(s.value)>Number(g.value);return!!(!a.value&&!s.value||w||x)}),{setIsShowSuccess:De,setIsShowRejected:d,setIsShowWaiting:h,setTransactionDesc:q,setTransactionTxid:C,setPositiomNum:X,setTransactionDescText:K}=O,W=B(!1);ye(U,an((w,x)=>{w!==x&&(Number(w)>100?U.value=100:w&&c.value?(U.value=w,ne({value:U.value/100})):(a.value="",s.value=""))},300)),ye(oe,w=>{w&&c.value&&ne({value:U.value/100})});const z=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],Y=jo(),se=y(()=>Y),de=y(()=>se.value.status),ke=B(!1),Ae=w=>{w.sources.forEach(R=>{const{pool_address:le,position_index:he}=JSON.parse(R.blockchainAddress);le==c.value.poolAddress&&Number(he)==Number(c.value.index)&&(ke.value=!0)})},N=async()=>{await Y.getSources();let w;se.value.allSources.forEach(x=>{const{pool_address:R,position_index:le}=JSON.parse(x.blockchainAddress);R==c.value.poolAddress&&le==c.value.index&&(w=x.id)}),Y.deleteSource(w)};ye(()=>[se.value.sourceGroups,c.value],([w,x])=>{w&&w.sources&&w.sources.length>0&&x&&!fe(x)&&Ae(w)},{immediate:!0,deep:!0});const M=lo(),ce=fo();return{theme:T,showFromCoinLock:r,showToCoinLock:v,toCoinAmount:s,fromCoinAmount:a,fromCoinBlance:i,toCoinBlance:g,fromCoin:l,toCoin:f,maxBtnSelect:A,halfBtnSelect:I,fixedFromCoin:u,needReverse:P,totalAmount:ae,wallet:ee,addLiquidityBtnText:pe,isShowLiquidityModal:Z,indexStore:O,positionInfo:c,actionLoading:W,addLiquidityBtnDisabled:_e,sliderVal:U,ratioArr:z,setPercent:ne,poolStore:m,isSlider:$,toRemove:async()=>{var he,$e,Ne,Ie,Re,je,Ee,He,Oe,Ue,Ce,Je,uo;W.value=!0,C("");const w=Q(a.value,l.value.decimals)==0?"":`${be(a.value,l.value.decimals)} ${l.value.symbol}`,x=Q(s.value,f.value.decimals)==0?"":`${be(s.value,f.value.decimals)} ${f.value.symbol}`;q(ge("tips.removeLiquidiyText",{from:P.value?x:w,and:Q(a.value,l.value.decimals)==0||Q(s.value,f.value.decimals)==0?"":"and",to:P.value?w:x})),h(!0);const R=c.value.poolInfo.rewarder_infos,le=R&&R.length>0&&k.value=="Sui"||R&&R.length>0&&U.value==100?ge("modal.removeLiquidityText1"):ge("modal.removeLiquidityText2");K(le);try{let Pe={};Pe={pool:{...c.value.poolInfo,coinA:c.value.token_a,coinB:c.value.token_b},coinTypeA:c.value.poolInfo.coinTypeA,coinTypeB:c.value.poolInfo.coinTypeB,position:c.value,delta_liquidity:U.value==100?new qe(c.value.liquidity):new qe(Me(j.value,0)),slippage:Number(oe.value),rewards_num:R.length,positionInfo:c.value},Pe.coinTypeC=R[0]?R[0].coinAddress:"",Pe.coinTypeD=R[1]?R[1].coinAddress:"",Pe.coinTypeE=R[2]?R[2].coinAddress:"";const Ze=await H.value.getRemoveLiquidityTransactionPayload(Pe);let Fe;if(k.value==="Aptos")Fe=await ee.value.currentWallet.signAndSubmitTransaction(Ze);else{const no=await ee.value.currentWallet.signAndExecuteTransactionBlock(Ze);Fe=H.value.handleTx(no)}if(Fe&&Fe.hash){C(Fe.hash),h(!1),De(!0);const no={title:ge("common.removeLiquidity"),desc:"",hash:Fe.hash,descTransactions:`Remove ${a.value} ${(he=l.value)==null?void 0:he.symbol} and ${s.value} ${($e=f.value)==null?void 0:$e.symbol} 
             from the pool`,sender:ee.value.address,chainName:k.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:P.value?`${(Ie=f.value)==null?void 0:Ie.address}`:`${(Ne=l.value)==null?void 0:Ne.address}`,numa:P.value?`+ ${s.value}`:`+ ${a.value}`,logoa:P.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&l.value&&l.value.address&&o.value.tokensObj[l.value.address]&&o.value.tokensObj[l.value.address].logoURI,tokenb:P.value?`${(Re=l.value)==null?void 0:Re.address}`:`${(je=f.value)==null?void 0:je.address}`,numb:P.value?`+ ${a.value}`:`+ ${s.value}`,logob:P.value?o.value.tokensObj&&l.value&&l.value.address&&o.value.tokensObj[l.value.address]&&o.value.tokensObj[l.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI},text:`Withdraw ${a.value} ${(Ee=l.value)==null?void 0:Ee.symbol} and ${s.value} ${(He=f.value)==null?void 0:He.symbol}`};k.value!=="Aptos"&&(no.res=Fe.res),H.value.showTransitionPending(no);const Io=await H.value.watchTransaction(no);if(R.value&&R.value.length>0&&(Number((Oe=R[0])==null?void 0:Oe.amount)!==0||Pe.coinTypeD&&Number((Ue=R[1])==null?void 0:Ue.amount)!==0||Pe.coinTypeE&&Number((Ce=R[2])==null?void 0:Ce.amount)!==0)){const ho={title:ge("common.removeLiquidity"),desc:"",hash:Fe.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:R[0].symbol,numa:`+ ${Number(R[0].amount)}`,logoa:o.value.tokensObj&&R[0]&&R[0].address&&o.value.tokensObj[R[0].address]&&o.value.tokensObj[R[0].address].logoURI,tokenb:Pe.coinTypeD?R[1].symbol:"",numb:Pe.coinTypeD?`+ ${Number(R[1].amount)}`:"",logob:Pe.coinTypeD?o.value.tokensObj&&R[1]&&R[1].address&&o.value.tokensObj[R[1].address]&&o.value.tokensObj[R[1].address].logoURI:"",tokenc:Pe.coinTypeE?R[2].symbol:"",numc:Pe.coinTypeE?`+ ${Number(R[2].amount)}`:"",logoc:Pe.coinTypeE?o.value.tokensObj&&R[2]&&R[2].address&&o.value.tokensObj[R[2].address]&&o.value.tokensObj[R[2].address].logoURI:""},text:`Withdraw ${a.value} ${(Je=l.value)==null?void 0:Je.symbol} and ${s.value} ${(uo=f.value)==null?void 0:uo.symbol}`},Jo=await H.value.setTransations(ho)}if(Se(c.value.feeOwedA,c.value.token_a.decimals)!==0||Se(c.value.feeOwedB,c.value.token_b.decimals)!==0){const ho={title:"Claim",desc:"",hash:Fe.hash,chainName:k.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${c.value.token_a.symbol}`,numa:Q(c.value.feeOwedA,c.value.token_a.decimals)==0?"":`+ ${Se(c.value.feeOwedA,c.value.token_a.decimals)}`,logoa:Q(c.value.feeOwedA,c.value.token_a.decimals)==0?"":o.value.tokensObj&&c.value&&c.value.token_a.address&&o.value.tokensObj[c.value.token_a.address]&&o.value.tokensObj[c.value.token_a.address].logoURI,tokenb:`${c.value.token_b.symbol}`,numb:Q(c.value.feeOwedB,c.value.token_b.decimals)==0?"":`+ ${Se(c.value.feeOwedB,c.value.token_b.decimals)}`,logob:Q(c.value.feeOwedB,c.value.token_b.decimals)==0?"":o.value.tokensObj&&c.value&&c.value.token_b.address&&o.value.tokensObj[c.value.token_b.address]&&o.value.tokensObj[c.value.token_b.address].logoURI}},Jo=await H.value.setTransations(ho)}Io&&Number(U.value)==100&&de.value=="authenticated"&&ke.value&&(await Y.subscribePosition({pool_address:c.value.poolAddress,position_index:c.value.index},c.value.nftHash,!1),N()),Io&&(a.value="",s.value="",setTimeout(()=>{t.emit("getDetails")},3e3),setTimeout(()=>{t.emit("getDetails")},6e3),Number(U.value)==100&&ce.name=="new-position-detail"&&(k.value==="Aptos"?M.push("/position"):M.push("/pool/position")),U.value=0)}else h(!1),d(!0);W.value=!1}catch{W.value=!1,h(!1),d(!0)}},sFixD:Me}}});const Yi={class:"new-position-asset"},Ji={class:"add-or-remove"},Qi={class:"liquidity-action-tab"},Ki=n("div",{class:"remove tab-active"},"Remove",-1),Zi={class:"card-item"},Vi={key:0,class:"assets-card-mask"},xi={class:"card-item"},ea={key:0,class:"assets-card-mask"},oa={class:"remove-ratio"},na=n("div",{class:"remove-ratio-title"},"Amount",-1),ta={class:"remove-ratio-select"},ia={key:0,class:"ratio"},aa={key:1,class:"ratio"},sa={class:"ratio-list"},la=["onClick"];function ra(e,t,a,s,O,p){const T=po,m=sn,o=ro;return _(),S("div",Yi,[n("div",Ji,[n("div",Qi,[n("div",{class:"increase",onClick:t[0]||(t[0]=r=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),Ki]),n("div",{class:ko(e.needReverse?"card-container reverse":"card-container")},[n("div",Zi,[re(T,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=r=>e.fromCoinAmount=r),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[2]||(t[2]=r=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=r=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=r=>{e.fromCoinAmount=r,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(_(),S("div",Vi)):me("",!0)]),n("div",xi,[re(T,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[5]||(t[5]=r=>e.toCoinAmount=r),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[6]||(t[6]=r=>e.maxBtnSelect("toCoin")),onOnHalf:t[7]||(t[7]=r=>e.halfBtnSelect("toCoin")),onOnInput:t[8]||(t[8]=r=>{e.toCoinAmount=r,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(_(),S("div",ea)):me("",!0)])],2),n("div",oa,[na,n("div",ta,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(_(),S("div",ia,D(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:J(Me))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:J(Me))(e.sliderVal,2))+"% ",1)):(_(),S("div",aa," -- ")),n("div",sa,[(_(!0),S(io,null,ao(e.ratioArr,(r,v)=>(_(),S("div",{key:v,class:ko(["ratio-item",e.sliderVal==r.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=r.value}},D(r.name),11,la))),128))])]),re(m,{value:e.sliderVal,"onUpdate:value":t[9]||(t[9]=r=>e.sliderVal=r)},null,8,["value"])])]),e.wallet.connected?(_(),Le(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Be(()=>[n("span",null,D(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(_(),Le(o,{key:1,class:"big-btn",onClick:t[10]||(t[10]=r=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Be(()=>[n("span",null,D(e.$t("button.connectWallet")),1)]),_:1}))])}const ua=Ye(zi,[["render",ra]]),da=ze({setup(){const e=oo(),t=y(()=>e),a=Eo(),s=y(()=>a),O=lo(),p=y(()=>t.value.currentPositionInfo),T=B(),m=F=>{var $;return(($=t.value.tokensObj[F])==null?void 0:$.logo_url)||xe("/image/coins/sui-unknown.png")},o=Vo("Sui"),r=B(),v=async F=>{r.value=0;try{const $=await o.calculateFarmingRewards([{pool_id:F.pool_id,position_nft_id:F.id}]),L=[];let U=new b(0);$[F.id].forEach((j,ne)=>{var Z;const V=(Z=t.value.tokensObj[j.rewarder_type])==null?void 0:Z.decimals;let ae=new b(j.rewarder_amount).div(Math.pow(10,V)).toString();Number(ae)>0&&k.value.rewarders[ne]&&(U=U.add(ae),L.push({...j,rewarderAmount:ae,rewarderAmountPer:ae}))}),r.value=U,T.value=L}catch{}},u=y(()=>s.value.farmsPoolObj),k=y(()=>u.value[p.value.poolAddress]);ye(()=>[p.value,u.value,k.value],([F,$,L])=>{var U;!fe(F)&&F.positionSource=="farming"&&!fe(L)?v(F):!fe($)&&!fe(F)&&(T.value=(U=$[F.poolAddress])==null?void 0:U.rewarders)},{immediate:!0});const H=so(),te=y(()=>H),ee=Ge(),oe=eo("Sui"),{setIsShowSuccess:l,setIsShowRejected:f,setIsShowWaiting:P,setTransactionDesc:i,setTransactionTxid:g}=ee,A=B(!1),I=async()=>{A.value=!0,g(""),i("Claim rewards"),P(!0);const F={pool_id:p.value.pool_id,position_nft_id:p.value.id};try{const $=await o.harvestFarms(F),L=await te.value.currentWallet.signAndExecuteTransactionBlock($);let U=oe.handleTx(L);if(U&&U.hash){g(U.hash),P(!1),l(!0);let j={title:"Claim",res:U.res,hash:U.hash};oe.showTransitionPending(j),await oe.watchTransaction(j)&&setTimeout(()=>{v(p.value)},2e3)}else P(!1),f(!0);A.value=!1}catch{P(!1),f(!0),A.value=!1}},c=async()=>{A.value=!0,g(""),i(`Unstake ${p.value.name}`),P(!0);const F=p.value.pool_id,$=p.value.id;try{const L=await o.farmsWithdraw(F,$),U=await te.value.currentWallet.signAndExecuteTransactionBlock(L);let j=oe.handleTx(U);if(j&&j.hash){g(j.hash),P(!1),l(!0);let ne={res:j.res,title:"Unstake",hash:j.hash};oe.showTransitionPending(ne),await oe.watchTransaction(ne)&&setTimeout(()=>{O.replace(`/new-position-detail?token=${p.value.tokenName}&address=${p.value.clmm_pool_id}&pos=${p.value.clmm_position_id}`),t.value.setCurrentPositionInfo(p.value.clmm_pool_id,"",p.value.tokenName,"Sui",p.value.clmm_position_id),r.value=0,A.value=!1},2e3)}else P(!1),f(!0)}catch{P(!1),f(!0),A.value=!1}},ie=async()=>{A.value=!0,g(""),i(`Stake ${p.value.name}`),P(!0);const F={clmm_pool_id:p.value.poolAddress,clmm_position_id:p.value.pos_object_id,coinTypeA:p.value.coin_type_a,coinTypeB:p.value.coin_type_b},$=u.value[p.value.poolAddress].id;try{const L=await o.farmsDeposit(F,$),U=await te.value.currentWallet.signAndExecuteTransactionBlock(L);let j=oe.handleTx(U);if(j&&j.hash){g(j.hash),P(!1),l(!0);let ne={res:j.res,title:"Staked",hash:j.hash};oe.showTransitionPending(ne);const V=await oe.watchTransaction(ne);let ae;V&&setTimeout(async()=>{j.res.events.forEach(Z=>{Z.type.indexOf("::pool::DepositEvent")>-1&&(ae=Z.parsedJson.wrapped_position_id)}),O.replace(`/new-position-detail?position_nft_id=${ae}&positionSource=farming`),await t.value.setCurrentPositionInfo("","","","Sui",ae,"farming"),A.value=!1},2e3)}else P(!1),f(!0)}catch{P(!1),f(!0),A.value=!1}},G=y(()=>ee),ue=y(()=>G.value.addressLpTokens);return{getCoinIcon:m,rewardList:T,sFixD:Me,addCommom:Q,claim:I,unStake:c,loading:A,totalRewardAmount:r,currentPositionInfo:p,stake:ie,farmsPoolObj:u,addressLpTokens:ue,farmsPoolInfo:k}}});const Ke=e=>(mo("data-v-9b39419a"),e=e(),vo(),e),ca={key:0,class:"farms-position-detail"},ma={class:"farms-top"},va=Ke(()=>n("div",{class:"left"},[n("div",{class:"title"},"Farming"),n("div",{class:"desc"},"Stake Position to Earn")],-1)),fa={class:"right"},pa={class:"apr"},ha={class:"apr-tips-box"},ba=Ke(()=>n("span",null,"View",-1)),ka=Ke(()=>n("svg",{class:"arrow-icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_arrow"})],-1)),ga=[ba,ka],_a={class:"farms-bottom"},wa=Ke(()=>n("div",{class:"title"},"Farming Rewards",-1)),ya={key:0,class:"reward-list"},Aa={key:0,class:"rewards-item-bg"},Ia={class:"rewards-item-box"},Ca={alt:""},$a={key:1},Sa={class:"rewards-item-bg"},Pa={class:"rewards-item-box"},Ta={alt:""},Na=Ke(()=>n("span",null,"0",-1)),Ra={key:1,class:"reward-list"},Oa={key:0,class:"rewards-item-bg"},qa={class:"rewards-item-box"},La={alt:""},Ba=Ke(()=>n("span",null,"0",-1)),Ma={key:1},Ua={class:"rewards-item-bg"},ja={class:"rewards-item-box"},Ea={alt:""},Da=Ke(()=>n("span",null,"0",-1)),Fa={class:"actions-box"};function Wa(e,t,a,s,O,p){const T=pn,m=ro,o=ln,r=yo("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?(_(),S("div",ca,[n("div",ma,[va,n("div",fa,[n("div",pa,[ve(" APRÂ  "),n("span",null,[ve(D(("addCommom"in e?e.addCommom:J(Q))(e.farmsPoolInfo.total_apr*100,2))+"%Â  ",1),n("div",ha,[re(T,{"l-item":e.farmsPoolInfo,"rewarder-info":e.farmsPoolInfo.rewarder.rewardList},null,8,["l-item","rewarder-info"])])])]),n("div",{class:"view",onClick:t[0]||(t[0]=v=>e.$router.push("/farms"))},ga)])]),n("div",_a,[wa,e.rewardList&&e.rewardList.length>0?(_(),S("div",ya,[(_(!0),S(io,null,ao(e.rewardList,v=>(_(),S("div",{key:v,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(_(),S("div",Aa,[n("div",Ia,[Te(n("img",Ca,null,512),[[r,e.getCoinIcon(v.rewarder_type)]]),n("span",null,D(("addCommom"in e?e.addCommom:J(Q))(v.rewarderAmount||0)),1)])])):(_(),S("div",$a,[n("div",Sa,[n("div",Pa,[Te(n("img",Ta,null,512),[[r,e.getCoinIcon(v.reward_coin)]]),Na])])]))]))),128))])):(_(),S("div",Ra,[(_(!0),S(io,null,ao(e.currentPositionInfo.rewards,v=>(_(),S("div",{key:v,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(_(),S("div",Oa,[n("div",qa,[Te(n("img",La,null,512),[[r,e.getCoinIcon(v.rewarder_type)]]),Ba])])):(_(),S("div",Ma,[n("div",Ua,[n("div",ja,[Te(n("img",Ea,null,512),[[r,e.getCoinIcon(v.reward_coin)]]),Da])])]))]))),128))])),n("div",Fa,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?(_(),Le(m,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:Be(()=>[ve("Unstake")]),_:1},8,["loading","onClick"])):me("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?(_(),Le(o,{key:1},{title:Be(()=>[ve("Farming rewards are only available for active positions.")]),default:Be(()=>[re(m,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:Be(()=>[ve("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?(_(),Le(m,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:Be(()=>[ve("Stake")]),_:1},8,["loading","onClick"])):me("",!0),re(m,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:Uo(e.claim,["stop"])},{default:Be(()=>[ve("â†‘ Claim")]),_:1},8,["loading","disabled","onClick"])])])])):me("",!0)}const zo=Ye(da,[["render",Wa],["__scopeId","data-v-9b39419a"]]),Ha=ze({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const t=jo(),a=y(()=>t),s=y(()=>a.value.status),O=Ge();ye(()=>[a.value.targetGroups],v=>{},{immediate:!0});const p=B(!1);ye(()=>s.value,v=>{v=="authenticated",p.value=!1},{immediate:!0});const T=B(!1),m=async()=>{T.value=!T.value;const v={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},u=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;try{await t.subscribePosition(v,u,T.value)}catch{T.value=!T.value}},o=v=>{const u=v.sources;T.value=u.some(k=>JSON.parse(k.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(k.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))},r=lo();return ye(()=>[a.value.sourceGroups,e.positionInfo],([v,u])=>{var k,H,te,ee,oe,l;T.value=!1,v&&v.length>0&&v[0]&&u&&!fe(u)&&(((te=(H=(k=r==null?void 0:r.currentRoute)==null?void 0:k.value)==null?void 0:H.query)==null?void 0:te.token)==(u==null?void 0:u.name)||((l=(oe=(ee=r==null?void 0:r.currentRoute)==null?void 0:ee.value)==null?void 0:oe.query)==null?void 0:l.positionSource)=="farming")&&o(v[0])},{immediate:!0,deep:!0}),{importIcon:xe,isShowSetUp:p,changeSwitch:m,checked:T,notifiStatus:s,store:O}}});const Xa=e=>(mo("data-v-7878455d"),e=e(),vo(),e),Ga={class:"range-alerts"},za={class:"range-alerts-top"},Ya={class:"title"},Ja=Xa(()=>n("div",{class:"title-all"},[n("span",{class:"Range"},"Range Alerts")],-1)),Qa={key:1,class:"h5-switch-box"},Ka={class:"range-alerts-bottom"},Za={key:0,class:"pc-switch-box"};function Va(e,t,a,s,O,p){const T=ro,m=rn;return _(),S("div",Ga,[n("div",za,[n("div",Ya,[Ja,e.isShowSetUp||e.notifiStatus!=="authenticated"?(_(),Le(T,{key:0,class:"range-alerts-button",onClick:t[0]||(t[0]=Uo(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Be(()=>[ve(" Set up ")]),_:1})):me("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(_(),S("div",Qa,[re(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):me("",!0)])]),n("div",Ka,[ve(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(_(),S("div",Za,[re(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):me("",!0)])])}const Yo=Ye(Ha,[["render",Va],["__scopeId","data-v-7878455d"]]),xa=ze({components:{NewPositionTitle:Ro,NewPositionInfo:Xo,NewPositionLiquidity:Go,NewPositionAssetAdd:wo,NewPositionAssetRemove:wo,NewPositionNotifi:Yo,FarmsPositionDetail:zo},setup(){const e=B(),t=B(),a=B(),s=Ge(),O=y(()=>s),p=y(()=>O.value.chainName),T=oo(),m=y(()=>T),o=Eo(),r=lo();Bo(()=>{e.value={},T.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),m.value.setCurrentPositionLoading(!0),o.getFarmsPoolList()});const v=async()=>{m.value.setCurrentPositionLoading(!0);const l=r.currentRoute.value.query.token||"",f=r.currentRoute.value.query.collect||"",P=r.currentRoute.value.query.address||"",i=r.currentRoute.value.query.pos||"",g=r.currentRoute.value.query.id||"",A=r.currentRoute.value.query.positionSource||"",I=r.currentRoute.value.query.position_nft_id||"";p.value==="Aptos"?l&&f&&P&&m.value.setCurrentPositionInfo(P,f,l,p.value):l&&P&&i?m.value.setCurrentPositionInfo(P,f,l,p.value,i):g&&!A?m.value.setCurrentPositionInfo("","","",p.value,g):m.value.setCurrentPositionInfo("","","",p.value,I,A)};ye(()=>m.value.poolConfigObj,l=>{l&&!fe(l)&&v()},{immediate:!0});const u=y(()=>m.value.currentPositionLoading),k=y(()=>{var f,P,i;const l=((i=(P=(f=r==null?void 0:r.currentRoute)==null?void 0:f.value)==null?void 0:P.query)==null?void 0:i.address)||"";return l&&m.value.addressLpTokens&&!fe(m.value.addressLpTokens)&&m.value.addressLpTokens[l]?m.value.addressLpTokens[l]:null});ye(()=>k.value,(l,f)=>{l&&!fe(l)&&(e.value=l),l&&!fe(l)&&l.current_sqrt_price!==(f==null?void 0:f.current_sqrt_price)&&v()},{immediate:!0});const H=fo();ye(()=>[m.value.currentPositionInfo,p.value],([l,f])=>{var P;(f=="Aptos"&&l||f=="Sui"&&l&&(l==null?void 0:l.nftHash)==((P=H==null?void 0:H.query)==null?void 0:P.pos))&&(e.value=l,t.value=e.value.token_a,a.value=e.value.token_b)},{immediate:!0});const te=y(()=>m.value.positionDetailCurrentTab),ee=so();y(()=>ee),y(()=>O.value.theme);const oe=()=>{v()};return un(()=>{T.clearCurrentPositionInfo()}),{positionInfo:e,fromCoin:t,toCoin:a,getDetails:v,currentPositionLoading:u,positionDetailCurrentTab:te,clickRefresh:oe,chainName:p}}});const es={class:"new-position-detail"},os={class:"new-position-content"},ns={class:"left"},ts={class:"right"},is={class:"loading-global"};function as(e,t,a,s,O,p){const T=Ro,m=Xo,o=Go,r=wo,v=ua,u=zo,k=Yo,H=dn;return _(),S("div",es,[re(T,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),n("div",os,[n("div",ns,[re(m),re(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),n("div",ts,[e.positionDetailCurrentTab=="increase"?(_(),Le(r,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(_(),Le(v,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),re(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.chainName=="Sui"?(_(),Le(u,{key:2})):me("",!0),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="âˆž"&&e.chainName=="Sui"?(_(),Le(k,{key:3,"position-info":e.positionInfo},null,8,["position-info"])):me("",!0)])]),Te(n("div",is,[re(H)],512),[[Mo,e.currentPositionLoading]])])}const Bs=Ye(xa,[["render",as],["__scopeId","data-v-441cff21"]]);export{Bs as default};
