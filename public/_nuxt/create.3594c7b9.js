import{_ as io,a as Ga,b as Ja,c as ro,d as so}from"./new-liquidity-title.2d7a9487.js";import{i as Ge}from"./import-icon.de3e6c66.js";import{a as Ka,l as R,r as I,m as Ya,y as co,q as Z,a4 as vo,D as De,e as Za,z as xa,o as h,f as M,i as re,h as t,x as $,v as Ae,c as _e,w as Wa,j as be,B as mo,p as eo,k as ao,b as po,N as fo,s as go,Q as ko,C as ge,t as bo,u as Co,I as wo}from"./entry.83514ac3.js";/* empty css              */import{a as ho,u as oo,c as to}from"./sha256.ce3fdf76.js";import{b as no,u as lo,p as za,s as Ha,a as Xa,c as Qa,e as Ve,j as yo,d as So}from"./pool.6f004d8f.js";import{a as No}from"./new-add-or-create.404709b1.js";import{_ as Po,a as To,s as _o}from"./poolFee.af20175d.js";import{D as u}from"./decimal.0e8aa3f1.js";import{fromCoin as p,toCoin as d,fromCoinAmount as l,toCoinAmount as i,maxPrice as v,minPrice as g,createPoolInfo as s,showFromCoinLock as G,showToCoinLock as J,amountLock as ke,fixedFromCoin as S,currentPriceReverse as Je,currentPrice as te,initPrice as pe,direction as C,createPoolFromCoin as ue,createPoolToCoin as ie,isFullRange as oe,resetData as Ao,defaultMinPrice as Xe,defaultMaxPrice as Qe}from"./create-pool-data.9c433806.js";import{_ as qo,a as Ro}from"./icon-Add-Liquidity_2x.0acb06cb.js";import{_ as $o}from"./icon-selected_3x.09e9a6f0.js";import"./img-lock_2x.a28135f4.js";import"./lock.6065d510.js";/* empty css              */import"./token-warning.c0a2d32a.js";/* empty css              *//* empty css              */import"./refresh-icon.aba478e6.js";/* empty css              */import"./swap-setting.a282e8e5.js";/* empty css              */import"./status-block.43eff085.js";import"./notifi.786a243b.js";import"./useWhale.b7565dab.js";import"./index.3f6ce871.js";const Io=Ka({components:{NewLiquidityTile:io,NewLiquidityDepositRatio:Ga},setup(e,n){const he=ho(),Ce=oo(),F=R(()=>Ce),H=R(()=>F.value.chainName),O=R(()=>he),k=I(!1);I(),I(),I(),I(!1);const w=Ya(),{t:E,locale:ce}=co(),N=R(()=>H.value?no(H.value):{}),W=lo(),r=R(()=>W),x=R(()=>F.value.theme),L=R(()=>O.value.assets&&p.value&&O.value.assets[p.value.address]?za(O.value.assets[p.value.address].balance,p.value.decimals):"0"),U=R(()=>O.value.assets&&d.value&&O.value.assets[d.value.address]?za(O.value.assets[d.value.address].balance,d.value.decimals):"0"),je=a=>{a==="fromCoin"?(S.value=!0,H.value==="Aptos"?l.value=Number(L.value)>0?p.value.symbol=="APT"?new u(Number(L.value)).sub(new u(.1)).lt(new u(0))?"0":new u(Number(L.value)).sub(new u(.1)).toString():String(L.value):"":l.value=Number(L.value)>0?p.value.symbol=="SUI"?new u(Number(L.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(L.value)).sub(new u(.05)).toString():String(L.value):""):(S.value=!1,H.value==="Aptos"?i.value=Number(U.value)>0?d.value.symbol=="APT"?new u(Number(U.value)).sub(new u(.1)).lt(new u(0))?"0":new u(Number(U.value)).sub(new u(.1)).toString():String(U.value):"":i.value=Number(U.value)>0?d.value.symbol=="SUI"?new u(Number(U.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(U.value)).sub(new u(.05)).toString():String(U.value):"")},Ee=a=>{a==="fromCoin"?(S.value=!0,l.value=Number(L.value)>0?Ha(new u(Number(L.value)).div(2).toString(),p.value.decimals).toString():""):(S.value=!1,i.value=Number(U.value)>0?Ha(new u(Number(U.value)).div(2).toString(),d.value.decimals).toString():"")};Z(()=>[r.value.tokensObj,w.query],async([a])=>{if(a){const m=a;if(w&&w.query&&w.query.fromCoin&&w.query.fromCoin){const c=await N.value.getTokenBySymbol(m,w.query.fromCoin);p.value=c,ue.value=c}if(w&&w.query&&w.query.toCoin&&w.query.toCoin){const c=await N.value.getTokenBySymbol(m,w.query.toCoin);d.value=c,ie.value=c}}},{immediate:!0,deep:!0});const Q=I("--"),qe=R(()=>F.value.slippage),We=I(),ve=async()=>{if(!g.value&&!v.value)return!1;if(!l.value&&!i.value&&!g.value&&!v.value)return;const a=s.value||{};if(Qa(a))return;const{TickUtil:m,TickMath:c,getNearestTickByTick:f}=N.value,_=a==null?void 0:a.token_a.decimals,V=a==null?void 0:a.token_b.decimals;let P,q,A,y,B,z,j=a.current_tick_index,ee;if(a.token_a.address.toLowerCase()===p.value.address.toLowerCase()&&a.token_b.address.toLowerCase()===d.value.address.toLowerCase()?ee=!0:ee=!1,g.value==="0"&&v.value==="∞")A=m.getMinIndex(Number(a.tickSpacing)),y=m.getMaxIndex(Number(a.tickSpacing));else{ee?(P=Number(g.value),q=Number(v.value)):(P=new u(1).div(v.value).toString(),q=new u(1).div(g.value).toString());try{B=P==0?-443636:c.priceToTickIndex(new u(P),_,V)}catch{B=-443636}try{z=c.priceToTickIndex(new u(q),_,V)}catch{z=443636}A=f(B,Number(a.tickSpacing)),y=f(z,Number(a.tickSpacing))}if(v.value!=="∞"&&A>=y){G.value=!0,l.value="",J.value=!0,i.value="";return}if(j==y||j==A){G.value=!0,J.value=!0;return}if(v.value==="∞"||j>=A&&j<=y){G.value=!1,J.value=!1;let ae;if(l.value||i.value){if(S.value){const we=new u(l.value).mul(Math.pow(10,p.value.decimals)).toString();ae=new Ve(we)}else{const we=new u(i.value).mul(Math.pow(10,d.value.decimals)).toString();ae=new Ve(we)}const{liquidityAmount:K,tokenMaxA:Y,tokenMaxB:le,tokenMaxAOrigin:Oe,tokenMaxBOrigin:Ue}=N.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:a.token_a,tokenB:a.token_b,lowerTick:A,upperTick:y,coinAmount:ae,iscoinA:ee?S.value:!S.value,roundUp:!0,slippage:Number(qe.value)/100,curSqrtPrice:new Ve(a.current_sqrt_price)});We.value={liquidityAmount:K,tokenMaxA:Y,tokenMaxB:le,tokenMaxAOrigin:Oe,tokenMaxBOrigin:Ue},ee?S.value?i.value=Number(le)>0?le:"":l.value=Number(Y)>0?Y:"":S.value?i.value=Y:l.value=le}}else j>y?(G.value=!0,J.value=!0):j<A?(G.value=!0,J.value=!0):(G.value=!0,l.value="",J.value=!0,i.value="")};Z(()=>pe.value,a=>{a&&ve()},{immediate:!0}),Z(l,(a,m)=>{a==""&&S.value&&(i.value=""),a&&S.value&&!k.value&&ve()}),Z(i,(a,m)=>{a==""&&!S.value&&(l.value=""),a&&!S.value&&!k.value&&ve()}),Z(()=>oe.value,a=>{ve()},{immediate:!0});const ze=a=>{const m=a.replace(/[^\d.]/g,""),c="$"+Xa(m);k.value=!0,Q.value=c,a>0?b():(l.value="",i.value="")};Z([g,v],([a,m])=>{Number(a)!==0&&Number(m)!==0&&!k.value?ve():Number(a)!==0&&Number(m)!==0&&k.value?b():ve()},{immediate:!0});const Ke=()=>{const a=o.value&&o.value[p.value.address]&&o.value[p.value.address].price,m=o.value&&o.value[d.value.address]&&o.value[d.value.address].price;if(a&&m){const c=new u(l.value>0?l.value:0).mul(a),f=new u(i.value>0?i.value:0).mul(m),_=c.add(f).toNumber();Q.value=_>0&&_<.01?"$<0.01":"$"+Xa(_,2)}else Q.value="--"};Z(()=>[l.value,i.value,k.value],([a,m,c])=>{(a||m)&&!c?Ke():(!a||!m)&&!c&&(Q.value="--")},{immediate:!0});const o=R(()=>r.value.RATES),T=I(),b=async()=>{if(!g.value&&!v.value)return!1;if(!l.value&&!i.value&&!g.value&&!v.value)return;const a=s.value||{};if(Qa(a))return;const{TickUtil:m,TickMath:c,getNearestTickByTick:f}=N.value,_=a==null?void 0:a.token_a.decimals,V=a==null?void 0:a.token_b.decimals;let P,q,A,y,B,z,j;if(a.token_a.address.toLowerCase()===p.value.address.toLowerCase()&&a.token_b.address.toLowerCase()===d.value.address.toLowerCase()?j=!0:j=!1,g.value==="0"&&v.value==="∞")A=m.getMinIndex(Number(a.tickSpacing)),y=m.getMaxIndex(Number(a.tickSpacing));else{j?(P=Number(g.value),q=Number(v.value)):(P=new u(1).div(v.value).toString(),q=new u(1).div(g.value).toString());try{B=P==0?-443636:c.priceToTickIndex(new u(P),_,V)}catch{B=-443636}try{z=c.priceToTickIndex(new u(q),_,V)}catch{z=443636}A=f(B,Number(a.tickSpacing)),y=f(z,Number(a.tickSpacing))}const ee=o.value[a==null?void 0:a.token_a.address].price,ae=o.value[a==null?void 0:a.token_b.address].price;try{const{amountA:K,amountB:Y,tokenAmountsInfo:le}=await N.value.estCoinAmountsFromTotalAmount({lowerTick:A,upperTick:y,decimalsA:_,decimalsB:V,curSqrtPrice:new Ve(a.current_sqrt_price),totalAmount:Q.value,tokenPriceA:ee,tokenPriceB:ae});T.value=le,a.needReverse?C.value?(l.value=K,i.value=Y):(l.value=Y,i.value=K):(l.value=K,i.value=Y)}catch{}},ne=R(()=>{var c,f,_,V,P,q;const a=(_=o.value[(f=(c=p)==null?void 0:c.value)==null?void 0:f.address])==null?void 0:_.price,m=(q=o.value[(P=(V=d)==null?void 0:V.value)==null?void 0:P.address])==null?void 0:q.price;return!!(a&&m)}),D=()=>{n.emit("toggle")},X=I(!1),de=R(()=>{var a;return!p.value||!d.value?E("modal.selectTokenModalTitle"):!((a=w.query)!=null&&a.fee)&&to[H.value].hasCreatePool?"Select fee tier":!Number(l.value)&&!Number(i.value)?E("button.enterAmount"):Number(l.value)>Number(L.value)?E("button.insufficientBalance",{name:p.value.symbol}):Number(i.value)>Number(U.value)?E("button.insufficientBalance",{name:d.value.symbol}):v.value!=="∞"&&Number(g.value)>=Number(v.value)?E("newAdd.invalidRange"):E("newAdd.preview")}),Re=a=>{const m=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,2})?).*$");a.target.value=a.target.value.replace(m,"$1")},$e=R(()=>{var a;return!!(!l.value&&!i.value||Number(l.value)>Number(L.value)||Number(i.value)>Number(U.value)||de.value!==E("newAdd.preview")||!s.value&&!((a=s.value)!=null&&a.currentPrice)||Number(l.value)<=0&&Number(i.value)<=0||G.value||J.value)}),{setTransactionTxid:ye,setTransactionDesc:Ie,setIsShowWaiting:fe,setIsShowSuccess:Se,setIsShowRejected:Ne,setPositiomNum:Le}=Ce,Be=()=>{H.value=="Sui"&&Fe()},{$notify:Me}=vo(),Pe=I(!1),Fe=async()=>{var ee,ae,K,Y,le,Oe,Ue,we,Ye,Ze,xe,ea,aa,oa,ta,na,la,ua,ia,ra,sa,ca,va,da,ma,pa,fa,ga,ka,ba,Ca,wa,ha,ya,Sa,Na,Pa,Ta,_a,Aa,qa,Ra,$a,Ia,La,Ba,Ma,Fa,Oa,Ua,Da,Va,ja,Ea;X.value=!1;let a=!1;N.value.getIsSortedSymbols(ue.value.address,ie.value.address)&&(a=!0),ye("");const m=G.value?"":`${l.value} ${(ee=p.value)==null?void 0:ee.symbol}`,c=J.value?"":`${i.value} ${(ae=d.value)==null?void 0:ae.symbol}`;Ie(E("tips.increaseLiquiditySuccess",{from:!a&&!((Y=(K=s)==null?void 0:K.value)!=null&&Y.needReverse)||a&&((Oe=(le=s)==null?void 0:le.value)!=null&&Oe.needReverse)?m:c,and:!G.value&&!J.value?"and":"",to:!a&&!((we=(Ue=s)==null?void 0:Ue.value)!=null&&we.needReverse)||a&&((Ze=(Ye=s)==null?void 0:Ye.value)!=null&&Ze.needReverse)?c:m})),fe(!0);let f="",_="",V="",P="",q="",A="",y=0,B=0,z=!1,j;if(a||(ea=(xe=s)==null?void 0:xe.value)!=null&&ea.needReverse){const me=a&&!((oa=(aa=s)==null?void 0:aa.value)!=null&&oa.needReverse);f=me?(ra=(ia=(ua=s)==null?void 0:ua.value)==null?void 0:ia.token_b)==null?void 0:ra.address:(la=(na=(ta=s)==null?void 0:ta.value)==null?void 0:na.token_a)==null?void 0:la.address,_=me?(pa=(ma=(da=s)==null?void 0:da.value)==null?void 0:ma.token_a)==null?void 0:pa.address:(va=(ca=(sa=s)==null?void 0:sa.value)==null?void 0:ca.token_b)==null?void 0:va.address,V=me?(wa=(Ca=(ba=s)==null?void 0:ba.value)==null?void 0:Ca.token_b)==null?void 0:wa.decimals:(ka=(ga=(fa=s)==null?void 0:fa.value)==null?void 0:ga.token_a)==null?void 0:ka.decimals,P=me?(Ta=(Pa=(Na=s)==null?void 0:Na.value)==null?void 0:Pa.token_a)==null?void 0:Ta.decimals:(Sa=(ya=(ha=s)==null?void 0:ha.value)==null?void 0:ya.token_b)==null?void 0:Sa.decimals,(Aa=(_a=s)==null?void 0:_a.value)!=null&&Aa.needReverse?(q=C.value?l.value:i.value,A=C.value?i.value:l.value,y=C.value?Number(g.value):1/Number(v.value),B=C.value?Number(v.value):1/Number(g.value),z=C.value?S.value:!S.value,j=C.value?te.value:1/Number(te.value)):(q=C.value?i.value:l.value,A=C.value?l.value:i.value,y=C.value?1/Number(v.value):Number(g.value),B=C.value?1/Number(g.value):Number(v.value),z=C.value?!S.value:S.value,j=C.value?1/Number(te.value):te.value)}else f=($a=(Ra=(qa=s)==null?void 0:qa.value)==null?void 0:Ra.token_a)==null?void 0:$a.address,_=(Ba=(La=(Ia=s)==null?void 0:Ia.value)==null?void 0:La.token_b)==null?void 0:Ba.address,V=(Oa=(Fa=(Ma=s)==null?void 0:Ma.value)==null?void 0:Fa.token_a)==null?void 0:Oa.decimals,P=(Va=(Da=(Ua=s)==null?void 0:Ua.value)==null?void 0:Da.token_b)==null?void 0:Va.decimals,q=C.value?l.value:i.value,A=C.value?i.value:l.value,y=C.value?Number(g.value):1/Number(v.value),B=C.value?Number(v.value):1/Number(g.value),z=C.value?S.value:!S.value,j=C.value?te.value:1/Number(te.value);try{const me=await N.value.getCreatPoolTransactionPayload({coinTypeA:f,coinTypeB:_,decimalsA:V,decimalsB:P,amountA:q,amountB:A,minPrice:g.value=="0"&&v.value=="∞"?"0":y,maxPrice:g.value=="0"&&v.value=="∞"?"∞":B,fix_amount_a:z,tick_spacing:Number(s.value.tickSpacing),slippage:Number(qe.value)/100,price:j}),uo=await O.value.currentWallet.signAndExecuteTransactionBlock(me),Te=N.value.handleTx(uo);if(Te&&Te.hash){ye(Te.hash),fe(!1),Se(!0);const He={title:"Created pool",desc:"Pool created successfully ",hash:Te.hash,tit:"Pool Created",icon:"icon-icon-Position-Created",tokenInfo:{tokena:`${(ja=p.value)==null?void 0:ja.address}`,numa:G.value?"":`- ${l.value}`,logoa:r.value.tokensObj&&p.value&&p.value.address&&r.value.tokensObj[p.value.address]&&r.value.tokensObj[p.value.address].logoURI,tokenb:`${(Ea=d.value)==null?void 0:Ea.address}`,numb:J.value?"":`- ${i.value}`,logob:r.value.tokensObj&&d.value&&d.value.address&&r.value.tokensObj[d.value.address]&&r.value.tokensObj[d.value.address].logoURI},text:"Pool created successfully"};H.value!=="Aptos"&&(He.res=Te.res),N.value.showTransitionPending(He),(await N.value.watchTransaction(He,!0)).status&&(Se(!1),Pe.value=!0,setTimeout(()=>{W.setPoolConfigList(H.value,F.value.filterCoinsObj),N.value.getAccount(O.value.address)},1e3)),Le()}else fe(!1),Ne(!0);l.value="",i.value=""}catch(me){String(me).indexOf('Some("create_pool_internal") }, 1')>-1&&Me.error({icon:De("svg",{class:{icon:!0},"aria-hidden":!0},[De("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:De("div",{class:"notification-title"},[De("span",{innerHTML:"Pool already exists"},null)]),duration:4.5,description:"Something went wrong",class:"ant-notification-copy ant-notification-error"}),X.value=!1,W.setPoolConfigList(H.value,F.value.filterCoinsObj),l.value="",i.value="",fe(!1),Ne(!0)}};return Z(()=>s.value,a=>{},{immediate:!0}),{amountLock:ke,wallet:O,inputChange:Re,fromCoinAmount:l,toCoinAmount:i,fromCoin:p,toCoin:d,maxBtnSelect:je,halfBtnSelect:Ee,showFromCoinLock:G,showToCoinLock:J,fromCoinBlance:L,toCoinBlance:U,fixedFromCoin:S,isInputTotalAmount:k,toggle:D,theme:x,liquidityTotalAmount:Q,createPoolInfo:s,minPrice:g,maxPrice:v,currentPriceReverse:Je,currentPrice:te,onInput:ze,initPrice:pe,isShowtotalAmount:ne,direction:C,isShowLiquidityModal:X,createPoolBtnText:de,createPoolBtnDisabled:$e,toCreatePool:Be,isCreateSuccess:Pe}}});const Lo=e=>(eo("data-v-d7487599"),e=e(),ao(),e),Bo={class:"create-pool-right"},Mo={class:"card-container"},Fo={key:0,class:"lock"},Oo={class:"card-item"},Uo={class:"card-item"},Do={key:0,class:"total-amount"},Vo=Lo(()=>t("span",null,"Total Amount",-1));function jo(e,n,he,Ce,F,H){const O=xa("NewLiquidityTile"),k=Ja,w=ro,E=Ga,ce=No,N=mo,W=Po;return h(),M("div",Bo,[re(O),t("div",Mo,[e.amountLock||e.showFromCoinLock||e.showToCoinLock?(h(),M("div",Fo,[re(k)])):$("",!0),t("div",Oo,[re(w,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[0]||(n[0]=r=>e.fromCoinAmount=r),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:n[1]||(n[1]=r=>e.maxBtnSelect("fromCoin")),onOnHalf:n[2]||(n[2]=r=>e.halfBtnSelect("fromCoin")),onOnInput:n[3]||(n[3]=r=>{e.fromCoinAmount=r,e.fixedFromCoin=!0,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),t("div",Uo,[re(w,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[4]||(n[4]=r=>e.toCoinAmount=r),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:n[5]||(n[5]=r=>e.maxBtnSelect("toCoin")),onOnHalf:n[6]||(n[6]=r=>e.halfBtnSelect("toCoin")),onOnInput:n[7]||(n[7]=r=>{e.toCoinAmount=r,e.fixedFromCoin=!1,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(h(),M("img",{key:1,class:"add",src:qo,alt:"",onClick:n[8]||(n[8]=(...r)=>e.toggle&&e.toggle(...r))})):$("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(h(),M("img",{key:2,class:"add",src:Ro,alt:"",onClick:n[9]||(n[9]=(...r)=>e.toggle&&e.toggle(...r))})):$("",!0)]),e.isShowtotalAmount?(h(),M("div",Do,[Vo,t("span",null,Ae(e.liquidityTotalAmount)+" ",1)])):$("",!0),e.initPrice?(h(),_e(E,{key:1,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"create-pool-info":e.createPoolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":"custom","current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","create-pool-info","min-price","max-price","current-price","current-price-reverse"])):$("",!0),e.isShowLiquidityModal?(h(),_e(ce,{key:2,"pool-info":e.createPoolInfo,title:e.$t("newAdd.preview"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":"custom","min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,"is-create":!0,onCreatePool:e.toCreatePool,onOnClose:n[10]||(n[10]=r=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onCreatePool"])):$("",!0),e.wallet.connected?(h(),_e(N,{key:4,class:"add-liquidity-btn",disabled:e.wallet.connected?e.createPoolBtnDisabled:!1,onClick:n[12]||(n[12]=r=>e.isShowLiquidityModal=!0)},{default:Wa(()=>[be(Ae(e.createPoolBtnText),1)]),_:1},8,["disabled"])):(h(),_e(N,{key:3,class:"add-liquidity-btn",onClick:n[11]||(n[11]=r=>e.wallet.setIsShowWalletModal(!0))},{default:Wa(()=>[be(Ae(e.$t("button.connectWallet")),1)]),_:1})),e.isCreateSuccess?(h(),_e(W,{key:5,onOnClose:n[13]||(n[13]=r=>e.isCreateSuccess=!1)})):$("",!0)])}const Eo=Za(Io,[["render",jo],["__scopeId","data-v-d7487599"]]),Wo=Ka({components:{CreatePoolRight:Eo},setup(){const e=I(!0),n=I(!0),he=I(!0),Ce=I(!1),F=I("1"),H=I(!0),O=I(""),k=Ya(),w=po(),E=oo(),ce=R(()=>E),N=lo(),W=R(()=>N),r=R(()=>ce.value.chainName),x=R(()=>r.value?no(r.value):{}),L=I("");Z(()=>[w,W.value.tokensObj],async([o,T])=>{var b,ne,D;((b=w==null?void 0:w.currentRoute)==null?void 0:b.value.name)=="liquidity-create"&&T&&(p.value=W.value.tokensObj[k.query.fromCoin]||await x.value.getTokenBySymbol(T,k.query.fromCoin),d.value=W.value.tokensObj[k.query.toCoin]||await x.value.getTokenBySymbol(T,k.query.toCoin),L.value=k.query.fee!=="null"&&k.query.fee?k.query.fee:""),((ne=w==null?void 0:w.currentRoute)==null?void 0:ne.value.name)=="liquidity-create"&&((D=k==null?void 0:k.query)!=null&&D.fee)&&(pe.value="",l.value="",i.value="",oe.value=!0)},{immediate:!0,deep:!0}),Z(()=>[p.value,d.value,pe.value,L.value,g.value,v.value,l.value,i.value],([o,T,b,ne,D,X,de])=>{!o||!T?(F.value="1",e.value=!0,n.value=!0,ke.value=!0):ne?b?!D||!X?(F.value="4",e.value=!1,n.value=!1,ke.value=!0):de||(F.value="5",e.value=!1,n.value=!1,ke.value=!1):(F.value="3",e.value=!1,n.value=!0,ke.value=!0):(F.value="2",e.value=!0,n.value=!0,ke.value=!0)},{immediate:!0}),Z(()=>F.value,o=>{Number(o)<5&&(l.value="",i.value="")});const U=o=>{pe.value=o},je=o=>{var T;return(o==null?void 0:o.logoURI)||(o==null?void 0:o.logo_url)||((T=W.value.tokensObj[o==null?void 0:o.address])==null?void 0:T.logo_url)||(ce.value.theme==="default"?Ge("/image/coins/unknown.png"):Ge("/image/coins/sui-unknown.png"))},Ee=o=>{switch(o){case"1":return{top:"10%"};case"2":return{top:"29%"};case"3":return{top:"48%"};case"4":return{top:"67%"};case"5":return{top:"87%"}}};R(()=>to[r.value].hasCreatePool);const Q=async o=>{var Re,$e,ye,Ie,fe,Se,Ne,Le,Be,Me,Pe,Fe,a,m;o?(pe.value=o,te.value=o,Je.value=new u(1).div(new u(o)).toString()):(pe.value="",te.value="",Je.value="");let T,b;const ne=W.value.poolConfigList;for(let c=0;c<ne.length;c++){const f=ne[c];if(f.token_a.address.toUpperCase()===((ye=($e=(Re=ue)==null?void 0:Re.value)==null?void 0:$e.address)==null?void 0:ye.toUpperCase())&&f.token_b.address.toUpperCase()===((Se=(fe=(Ie=ie)==null?void 0:Ie.value)==null?void 0:fe.address)==null?void 0:Se.toUpperCase())){T=f.needReverse,b=f;break}else if(f.token_b.address.toUpperCase()===((Be=(Le=(Ne=ue)==null?void 0:Ne.value)==null?void 0:Le.address)==null?void 0:Be.toUpperCase())&&f.token_a.address.toUpperCase()===((Fe=(Pe=(Me=ie)==null?void 0:Me.value)==null?void 0:Pe.address)==null?void 0:Fe.toUpperCase())){T=f.needReverse,b=f;break}}let D=!1;await x.value.getIsSortedSymbols((a=ue.value)==null?void 0:a.address,(m=ie.value)==null?void 0:m.address)&&(D=!0);let X;D&&!C.value?X=!0:D&&C.value||!D&&C.value?X=!1:X=!0;const de=r.value=="Aptos"?To:_o;if(p.value&&d.value&&o){const c=b?b==null?void 0:b.token_a.decimals:D?ie.value.decimals:ue.value.decimals,f=b?b==null?void 0:b.token_b.decimals:D?ue.value.decimals:ie.value.decimals,_=o&&x.value.TickMath.priceToSqrtPriceX64(X?new u(1/o):new u(o),c,f),V=o&&x.value.TickMath.priceToSqrtPriceX64(new u(1).div(o),p.value.decimals,d.value.decimals),P=x.value.TickMath.priceToTickIndex(X?new u(1).div(o):new u(o),c,f),q=P-de[k.query.fee]*5,A=P+de[k.query.fee]*5,y=x.value.TickMath.tickIndexToPrice(q,c,f).toString(),B=x.value.TickMath.tickIndexToPrice(A,c,f).toString();oe.value?(g.value="0",v.value="∞"):X?(g.value=String(1/B),v.value=String(1/y),Xe.value=String(1/B),Qe.value=String(1/y)):(g.value=y,v.value=B,Xe.value=y,Qe.value=B);const z={token_a:b?b.token_a:D?ie.value:ue.value,token_b:b?b.token_b:D?ue.value:ie.value,isCreate:!0,tickSpacing:de[k.query.fee],currentPrice:o,current_sqrt_price:_,tick_lower:q,tick_upper:A,current_tick_index:P,currentPriceReverse:yo(String(1/o),6),reverse_current_sqrt_price:V,needReverse:T,fee:k.query.fee};s.value=z}else s.value=null,g.value="",v.value=""},qe=()=>{oe.value=!oe.value,Q(s.value.currentPrice)},We=o=>{oe.value?(oe.value=!1,Q(s.value.currentPrice)):g.value=o},ve=o=>{oe.value?(oe.value=!1,Q(s.value.currentPrice)):o=="0"?v.value="∞":v.value=o},ze=()=>{var T,b;C.value=!C.value;const o=p.value;p.value=d.value,d.value=o,s.value&&(Q(So(new u(1).div(s.value.currentPrice).toString(),(b=(T=d)==null?void 0:T.value)==null?void 0:b.decimals)),S.value?l.value=i.value:i.value=l.value)};return fo(()=>{Ao()}),{amountLock:ke,currentStep:F,sliderStyle:Ee,coinAmount:Ce,pricerange:O,fromCoin:p,toCoin:d,fee:L,direct:H,getCoinIcon:je,isSelectFullRange:he,onInput:U,store:ce,initPrice:pe,inputPriceLock:e,specifyPriceLock:n,changeCurrentPrice:Q,minPrice:g,maxPrice:v,defaultMinPrice:Xe,defaultMaxPrice:Qe,clickFullRange:qe,createPoolInfo:s,isFullRange:oe,priceRangeChangeMin:We,priceRangeChangeMax:ve,fromCoinAmount:l,toggle:ze,showFromCoinLock:G,showToCoinLock:J,inputChange:o=>{const T=C.value?d.value.decimals:p.value.decimals,b=new RegExp(`[^\\d-]*(\\d*(?:\\.\\d{0,${T}})?).*$`);o.target.value=o.target.value.replace(b,"$1")},currentPrice:te}}});const se=e=>(eo("data-v-1e7d0016"),e=e(),ao(),e),zo={class:"creat-pool-container"},Ho={class:"creat-pool-left"},Xo={class:"progress"},Qo=se(()=>t("div",{class:"slider-ratio-content"},null,-1)),Go=[Qo],Jo={class:"progress-text"},Ko={key:0},Yo={key:0},Zo={key:0},xo={key:0},et={key:0},at={class:"creat-pool-center"},ot={class:"title"},tt=se(()=>t("div",{class:"left"},"Set Initial Price",-1)),nt={class:"right"},lt={key:0,class:"token-box"},ut=se(()=>t("div",null,[t("svg",{class:"icon icon-up","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),it=se(()=>t("div",null,[t("svg",{class:"icon icon-down","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),rt=[ut,it],st={class:"content top-content"},ct=se(()=>t("div",{class:"top"},[t("span",null,"💡"),t("span",null,"Please set an initial price for this new pool to start.")],-1)),vt={class:"bottom"},dt={class:"input-div"},mt={key:0,class:"lock"},pt={class:"title"},ft=se(()=>t("div",{class:"left"},"Set Price Range",-1)),gt={class:"right"},kt={key:0,src:$o},bt=se(()=>t("span",null,"Full Range",-1)),Ct={class:"content bottom-content"},wt=se(()=>t("span",null,"💡",-1)),ht=se(()=>t("span",null,"Please specify a price range that you want to provide your liquidity within.",-1)),yt=[wt,ht],St={class:"bottom"},Nt={class:"set-price-box"},Pt={key:0,class:"lock"},Tt={key:1,class:"create-pool-warning"},_t={key:2,class:"position-tips"},At=["src"],qt={class:"error"},Rt={class:"creat-pool-right-container"};function $t(e,n,he,Ce,F,H){var N,W;const O=wo,k=Ja,w=so,E=xa("CreatePoolRight"),ce=go("image");return h(),M("div",zo,[t("div",Ho,[t("div",Xo,[t("div",{class:"slider-ratio",style:ko(e.sliderStyle(e.currentStep))},Go,4)]),t("div",Jo,[t("div",{class:ge(["row",Number(e.currentStep)>=1?"":"color-text"])},[e.currentStep>=1&&e.fromCoin&&e.toCoin?(h(),M("span",Ko,"✓")):$("",!0),be(" Select Tokens ")],2),t("div",{class:ge(["row",Number(e.currentStep)>=2?"":"color-text"])},[e.currentStep>=2&&e.fee?(h(),M("span",Yo,"✓")):$("",!0),be(" Select Fee Tier ")],2),t("div",{class:ge(["row",Number(e.currentStep)>=3?"":"color-text"])},[e.currentStep>=3&&e.initPrice?(h(),M("span",Zo,"✓")):$("",!0),be(" Set Initial Price ")],2),t("div",{class:ge(["row",Number(e.currentStep)>=4?"":"color-text"])},[e.currentStep>=4&&e.minPrice&&e.maxPrice?(h(),M("span",xo,"✓")):$("",!0),be(" Select Price Range ")],2),t("div",{class:ge(["row",Number(e.currentStep)>=5?"":"color-text"])},[e.currentStep>=5&&e.fromCoinAmount?(h(),M("span",et,"✓")):$("",!0),be(" Confirm Liquidity ")],2)])]),t("div",at,[t("div",ot,[tt,t("div",nt,[e.fromCoin&&e.toCoin?(h(),M("div",lt,[bo(t("img",null,null,512),[[ce,(N=e.fromCoin)==null?void 0:N.logo_url]]),t("span",null,Ae((W=e.fromCoin)==null?void 0:W.symbol),1),t("div",{class:"icon-change",onClick:n[0]||(n[0]=(...r)=>e.toggle&&e.toggle(...r))},rt)])):$("",!0)])]),t("div",st,[ct,t("div",vt,[t("div",dt,[re(O,{value:e.initPrice,type:"text",placeholder:"0.0",onChange:e.inputChange,onInput:n[1]||(n[1]=r=>e.changeCurrentPrice(r.target.value))},null,8,["value","onChange"])]),e.inputPriceLock?(h(),M("div",mt,[re(k)])):$("",!0)])]),t("div",pt,[ft,t("div",gt,[t("div",{class:ge(["radio",e.isFullRange?"active-radio":""]),onClick:n[2]||(n[2]=(...r)=>e.clickFullRange&&e.clickFullRange(...r))},[e.isFullRange?(h(),M("img",kt)):$("",!0)],2),bt])]),t("div",Ct,[t("div",{class:ge(["top",e.specifyPriceLock?"":"no-border"])},yt,2),t("div",St,[t("div",Nt,[re(w,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direct,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.createPoolInfo,loading:!1,"current-price-tab":"custom",onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","onOnChangeMinPrice","onOnChangeMaxPrice"])]),e.specifyPriceLock?(h(),M("div",Pt,[re(k)])):$("",!0),e.currentStep>=4&&(e.showFromCoinLock||e.showToCoinLock)&&Number(e.maxPrice)>Number(e.minPrice)?(h(),M("div",Tt," To create a new pool, the initial price you set must be within your price range. ")):$("",!0),e.currentStep>=4&&Number(e.minPrice)>Number(e.maxPrice)?(h(),M("div",_t,[t("img",{src:("importIcon"in e?e.importIcon:Co(Ge))("/image/icon-tips-error@2x.png"),alt:""},null,8,At),t("p",qt,Ae(e.$t("tips.positionError")),1)])):$("",!0)])])]),t("div",Rt,[re(E,{"create-pool-info":e.createPoolInfo,onToggle:e.toggle},null,8,["create-pool-info","onToggle"])])])}const ln=Za(Wo,[["render",$t],["__scopeId","data-v-1e7d0016"]]);export{ln as default};
