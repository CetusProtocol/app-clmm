import{_ as le}from"./new-position-title.8e5fb492.js";import{_ as ue}from"./token-warning.45a4fbb6.js";import{_ as re}from"./status-block.dc017ee0.js";import{_ as Yo}from"./auto-pool-apy-tips.8ade2079.js";import{u as Do,g as de,a as L,d as Oo,c as lo,s as to,b as Z,p as zo,e as Go,T as bo,f as me,h as ce,V as Vo,C as Ho}from"./pool.266f8bfb.js";import{u as qo,a as Ro}from"./sha256.0e82021f.js";import{i as go}from"./import-icon.de3e6c66.js";import{u as No,a as Zo}from"./autoPool.050d49dc.js";import{a as ko,l as d,r as S,m as Co,q as Q,e as So,s as Uo,o as c,f as w,h as e,t as vo,i as K,v as p,j as To,x as po,u as U,p as Bo,k as Lo,y as Eo,z as Jo,A as Wo,c as E,w as $o,B as Ko,C as ve,L as pe,I as fe,S as Qo,D as _e,b as xo,F as be,E as he,G as ye}from"./entry.ad49fe05.js";import{_ as Ie}from"./assets-card.535ea347.js";import{_ as $e}from"./coin-lock.efcc72f7.js";import{_ as oe,a as ee}from"./auto-pool-remove-modal.0edbcb10.js";import{D as f}from"./decimal.0bdeb344.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./back.39821057.js";import"./swap-setting.9686e2f2.js";/* empty css              */import"./icon-error_2x.68314f70.js";/* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.1993ed74.js";const ge=ko({components:{AutoPoolApyTips:Yo},setup(){const o=qo(),n=d(()=>o),M=Do(),q=d(()=>M),O=d(()=>n.value.theme),I=i=>{var t;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((t=q.value.tokensObj[i==null?void 0:i.address])==null?void 0:t.logo_url)||(O.value==="default"?go("/image/coins/unknown.png"):go("/image/coins/sui-unknown.png"))},y=S(!0),_=No(),v=d(()=>_),g=Co(),l=S();Q(()=>[v.value.positionInfoObj,g.params.id],([i,t])=>{i&&!lo(i)&&t&&(l.value=i[t])},{immediate:!0,deep:!0});const s=d(()=>{var i;return(i=l.value)==null?void 0:i.needReverse}),$=d(()=>{var i,t;return v.value.apyObj&&((t=v.value.apyObj[(i=l.value)==null?void 0:i.id])==null?void 0:t.tvl)||"--"}),u=d(()=>{var i,t;return v.value.apyObj&&((t=v.value.apyObj[(i=l.value)==null?void 0:i.id])==null?void 0:t.apr)||"--"});return{positionInfo:l,tvl:$,store:n,indexStore:o,needReverse:s,getCoinIcon:I,getExplorerUrl:de,addCommom:L,decimalUi:Oo,direct:y,apy:u}}});const wo=o=>(Bo("data-v-f35bbd0d"),o=o(),Lo(),o),ke={class:"auto-position-info"},Ce={class:"pool-info"},Se={class:"left"},we={class:"coin-a"},Ae={alt:""},Pe={class:"coin-b"},Te={alt:""},qe={class:"position-name"},Re={key:0,class:"pool-fee"},Ne=wo(()=>e("span",null,"Fee tier",-1)),Be={class:"right"},Le={class:"price-info"},Me={class:"current-price"},Oe=wo(()=>e("span",null,"Current Price",-1)),De={class:"coin-rate"},Ue=wo(()=>e("div",null,[e("svg",{class:"icon icon-up","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),je=wo(()=>e("div",null,[e("svg",{class:"icon icon-down","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Fe=[Ue,je],We={key:0},Ee={key:1},Xe={class:"apy-and-tvl"},ze={class:"apy"},Ve=wo(()=>e("div",{class:"apy-title"},"APY",-1)),He={class:"apy-text"},Ye={class:"tvl"},Ge=wo(()=>e("div",{class:"tvl-title"},"TVL",-1)),Ze={class:"tvl-text"};function Je(o,n,M,q,O,I){var l,s,$,u,i,t,a,k,A,b,H,B,C,V,j,X,P,eo,x,J,Y,oo,so,io,Ao,uo,ao,ro,yo,fo,mo,m,D;const y=ue,_=re,v=Yo,g=Uo("image");return c(),w("div",ke,[e("div",Ce,[e("div",Se,[e("div",we,[vo(e("img",Ae,null,512),[[g,o.needReverse?o.getCoinIcon((s=o.positionInfo)==null?void 0:s.token_b):o.getCoinIcon((l=o.positionInfo)==null?void 0:l.token_a)]]),K(y,{address:o.needReverse?(t=(i=o.positionInfo)==null?void 0:i.token_b)==null?void 0:t.address:(u=($=o.positionInfo)==null?void 0:$.token_a)==null?void 0:u.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",Pe,[vo(e("img",Te,null,512),[[g,o.needReverse?o.getCoinIcon((k=o.positionInfo)==null?void 0:k.token_a):o.getCoinIcon((a=o.positionInfo)==null?void 0:a.token_b)]]),K(y,{address:o.needReverse?(B=(H=o.positionInfo)==null?void 0:H.token_a)==null?void 0:B.address:(b=(A=o.positionInfo)==null?void 0:A.token_b)==null?void 0:b.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",qe,p(o.needReverse?(V=(C=o.positionInfo)==null?void 0:C.token_b)==null?void 0:V.symbol:(X=(j=o.positionInfo)==null?void 0:j.token_a)==null?void 0:X.symbol)+" - "+p(o.needReverse?(eo=(P=o.positionInfo)==null?void 0:P.token_a)==null?void 0:eo.symbol:(J=(x=o.positionInfo)==null?void 0:x.token_b)==null?void 0:J.symbol),1),(Y=o.positionInfo)!=null&&Y.fee?(c(),w("div",Re,[Ne,To(" "+p(((oo=o.positionInfo)==null?void 0:oo.fee)*100)+"% ",1)])):po("",!0)]),e("div",Be,[K(_,{"current-status":(so=o.positionInfo)==null?void 0:so.currentStatus},null,8,["current-status"])])]),e("div",Le,[e("div",Me,[e("div",null,[Oe,e("div",De,[e("div",{onClick:n[0]||(n[0]=co=>o.direct=!o.direct)},Fe)])]),(o.needReverse?!o.direct:o.direct)?(c(),w("div",We,[To(p(("addCommom"in o?o.addCommom:U(L))(("decimalUi"in o?o.decimalUi:U(Oo))((io=o.positionInfo)==null?void 0:io.price,6)))+"   ",1),e("span",null,p((uo=(Ao=o.positionInfo)==null?void 0:Ao.token_b)==null?void 0:uo.symbol)+" per "+p((ro=(ao=o.positionInfo)==null?void 0:ao.token_a)==null?void 0:ro.symbol),1)])):(c(),w("div",Ee,[To(p(("addCommom"in o?o.addCommom:U(L))(("decimalUi"in o?o.decimalUi:U(Oo))(1/((yo=o.positionInfo)==null?void 0:yo.price),6)))+"   ",1),e("span",null,p((mo=(fo=o.positionInfo)==null?void 0:fo.token_a)==null?void 0:mo.symbol)+" per "+p((D=(m=o.positionInfo)==null?void 0:m.token_b)==null?void 0:D.symbol),1)]))]),e("div",Xe,[e("div",ze,[Ve,e("div",He,[To(p(o.apy)+" ",1),K(v)])]),e("div",Ye,[Ge,e("div",Ze,"$"+p(("addCommom"in o?o.addCommom:U(L))(o.tvl,2)),1)])])])])}const ne=So(ge,[["render",Je],["__scopeId","data-v-f35bbd0d"]]),Ke=ko({setup(){const o=No(),n=d(()=>o),M=Co(),q=d(()=>n.value.positionInfoObj[M.params.id]),O=d(()=>{var v;return(v=q.value)==null?void 0:v.needReverse}),I=Ro(),y=d(()=>I);return{positionInfo:q,needReverse:O,addCommom:L,wallet:y,getCoinIcon:v=>(v==null?void 0:v.logoURI)||(v==null?void 0:v.logo_url)||go("/image/coins/sui-unknown.png")}}});const ho=o=>(Bo("data-v-ddd2440b"),o=o(),Lo(),o),Qe={class:"auto-position-liquidity"},xe={class:"my-liquidity"},on={class:"left"},en=ho(()=>e("div",null,"My Liquidity",-1)),nn={key:0},tn={key:1},sn={class:"right"},an=ho(()=>e("div",null,"My share",-1)),ln={key:0},un={key:1},rn={class:"my-liquidity-info"},dn={class:"lp-info"},mn={class:"lp-bg"},cn={alt:""},vn={key:0,class:"lp-num"},pn={key:1,class:"lp-num"},fn=ho(()=>e("div",{class:"assets-pooled-title"}," Pooled Assets ",-1)),_n={class:"assets-pooled"},bn={alt:""},hn={key:0},yn={key:1},In=ho(()=>e("p",null,"--",-1)),$n=ho(()=>e("p",null,"--",-1)),gn=[In,$n],kn={alt:""},Cn={key:0},Sn={key:1},wn=ho(()=>e("p",null,"--",-1)),An=ho(()=>e("p",null,"--",-1)),Pn=[wn,An];function Tn(o,n,M,q,O,I){var _,v,g,l,s,$,u,i,t,a,k,A,b,H,B,C,V,j,X,P,eo,x,J,Y,oo,so,io;const y=Uo("image");return c(),w("div",Qe,[e("div",xe,[e("div",on,[en,(_=o.wallet)!=null&&_.connected?(c(),w("div",nn,"$"+p(("addCommom"in o?o.addCommom:U(L))((v=o.positionInfo)==null?void 0:v.myLiquidityUSD)),1)):(c(),w("div",tn,"--"))]),e("div",sn,[an,(g=o.wallet)!=null&&g.connected?(c(),w("div",ln,p((l=o.positionInfo)==null?void 0:l.myShare)+"%",1)):(c(),w("div",un,"--%"))])]),e("div",rn,[e("div",dn,[e("div",mn,[vo(e("img",cn,null,512),[[y,(($=(s=o.positionInfo)==null?void 0:s.lpInfo)==null?void 0:$.logo_url)||o.getCoinIcon((u=o.positionInfo)==null?void 0:u.lpInfo)]])]),(i=o.wallet)!=null&&i.connected?(c(),w("div",vn,p(("addCommom"in o?o.addCommom:U(L))((t=o.positionInfo)==null?void 0:t.myLiquidity))+" LP",1)):(c(),w("div",pn,"-- LP"))]),fn,e("div",_n,[e("div",null,[vo(e("img",bn,null,512),[[y,o.needReverse?o.getCoinIcon((a=o.positionInfo)==null?void 0:a.token_b):o.getCoinIcon((k=o.positionInfo)==null?void 0:k.token_a)]]),(A=o.wallet)!=null&&A.connected?(c(),w("div",hn,[e("p",null,p((b=o.positionInfo)==null?void 0:b.myAmountAUSD),1),e("p",null,p(("addCommom"in o?o.addCommom:U(L))((H=o.positionInfo)==null?void 0:H.amountA))+" "+p(o.needReverse?(C=(B=o.positionInfo)==null?void 0:B.token_b)==null?void 0:C.symbol:(j=(V=o.positionInfo)==null?void 0:V.token_a)==null?void 0:j.symbol),1)])):(c(),w("div",yn,gn))]),e("div",null,[vo(e("img",kn,null,512),[[y,o.needReverse?o.getCoinIcon((X=o.positionInfo)==null?void 0:X.token_a):o.getCoinIcon((P=o.positionInfo)==null?void 0:P.token_b)]]),(eo=o.wallet)!=null&&eo.connected?(c(),w("div",Cn,[e("p",null,p((x=o.positionInfo)==null?void 0:x.myAmountBUSD),1),e("p",null,p(("addCommom"in o?o.addCommom:U(L))((J=o.positionInfo)==null?void 0:J.amountB))+" "+p(o.needReverse?(oo=(Y=o.positionInfo)==null?void 0:Y.token_a)==null?void 0:oo.symbol:(io=(so=o.positionInfo)==null?void 0:so.token_b)==null?void 0:io.symbol),1)])):(c(),w("div",Sn,Pn))])])])])}const te=So(Ke,[["render",Tn],["__scopeId","data-v-ddd2440b"]]),qn=ko({components:{AutoPoolAddModal:oe},setup(){const o=Ro(),n=S(!1),M=qo(),q=d(()=>M),O=d(()=>q.value.chainName),I=d(()=>o),y=No(),_=d(()=>y),v=Do(),g=d(()=>v),l=S(),s=Co();Q(()=>[_.value.positionInfoObj,s.params.id],([r,h])=>{r&&!lo(r)&&h&&(l.value=r[h])},{immediate:!0,deep:!0});const $=d(()=>{var r;return(r=l.value)==null?void 0:r.needReverse}),u=S(),i=S(),t=S(),a=S(),k=S(!0),A=d(()=>I.value.assets&&u.value&&I.value.assets[u.value.address]?zo(I.value.assets[u.value.address].balance,u.value.decimals):0),b=d(()=>I.value.assets&&i.value&&I.value.assets[i.value.address]?zo(I.value.assets[i.value.address].balance,i.value.decimals):0),H=r=>{r==="fromCoin"?(k.value=!0,t.value=A.value>0?u.value.symbol=="SUI"?new f(Number(A.value)).sub(new f(.05)).lt(new f(0))?"0":new f(Number(A.value)).sub(new f(.05)).toString():String(A.value):""):(k.value=!1,a.value=b.value>0?i.value.symbol=="SUI"?new f(Number(b.value)).sub(new f(.05)).lt(new f(0))?"0":new f(Number(b.value)).sub(new f(.05)).toString():String(b.value):"")},B=r=>{r==="fromCoin"?(k.value=!0,t.value=A.value>0?to(new f(Number(A.value)).div(2).toString(),u.value.decimals).toString():""):(k.value=!1,a.value=b.value>0?to(new f(Number(b.value)).div(2).toString(),i.value.decimals).toString():"")},C=d(()=>O.value?Go(O.value):{}),V=d(()=>q.value.slippage),j=S("--"),X=S("--"),P=r=>{const h=new f(l.value.autoPoolPositionInfo.liquidity),R=new f(r.toString());if(h.toNumber()>0&&R.toNumber()>0){const T=R.add(h),F=R.div(T).mul(100).toString(),N=me(F),z=N==-1?2:N+2,no=to(R.div(T).mul(100).toString(),z),G=new f(1).div(new f(Math.pow(10,l.value.lpInfo.decimals))).toString();Number(no)<Number(G)?j.value=`<${G}`:j.value=no}else R.toNumber()>0&&h.toNumber()<=0?j.value="100":j.value="--"},eo=r=>{const h=new f(r.toString()),R=h.mul(new f(V.value).div(100)),T=new f(Math.pow(10,l.value.lpInfo.decimals));X.value=to(h.minus(R).div(T).toString(),l.value.lpInfo.decimals)},x=S(!1),J=S(!1),Y=()=>{if(!l.value)return;const r=l.value.autoPoolPositionInfo.tick_lower_index,h=l.value.autoPoolPositionInfo.tick_upper_index,R=bo.sqrtPriceX64ToTickIndex(new Z(l.value.current_sqrt_price));R<r&&($.value?x.value=!0:J.value=!0),R>h&&($.value?J.value=!0:x.value=!0);let T;if(t.value||a.value){if(k.value){const W=new f(t.value).mul(Math.pow(10,u.value.decimals)).toString();T=new Z(W)}else{const W=new f(a.value).mul(Math.pow(10,i.value.decimals)).toString();T=new Z(W)}const{liquidityAmount:F,tokenMaxA:N,tokenMaxB:z,tokenMaxAOrigin:no,tokenMaxBOrigin:G}=C.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:u.value,tokenB:i.value,lowerTick:r,upperTick:h,coinAmount:T,iscoinA:k.value,roundUp:!0,slippage:Number(V.value)/100,curSqrtPrice:new Z(l.value.current_sqrt_price)});k.value?a.value=Number(z)>0?z:"":t.value=Number(N)>0?N:"",P(F),eo(F)}};Q(()=>l.value,r=>{r&&!lo(r)&&(u.value=r==null?void 0:r.token_a,i.value=r==null?void 0:r.token_b,x.value=!1,J.value=!1,Y())},{immediate:!0});const oo=d(()=>g.value.RATES),so=d(()=>{var r,h,R,T,F,N,z,no;if((h=oo.value[(r=u.value)==null?void 0:r.address])!=null&&h.price&&((T=oo.value[(R=i.value)==null?void 0:R.address])!=null&&T.price)){const G=new f(t.value||0).mul(new f((N=oo.value[(F=u.value)==null?void 0:F.address])==null?void 0:N.price)),W=new f(a.value||0).mul(new f((no=oo.value[(z=i.value)==null?void 0:z.address])==null?void 0:no.price));return Oo(G.add(W).toString(),2)}else return"--"});Q(t,(r,h)=>{r&&Y(),r==""&&(j.value="--",a.value="",X.value="--")}),Q(a,(r,h)=>{r&&Y(),r==""&&(t.value="",j.value="--",X.value="--")});const{t:io,locale:Ao}=Eo(),uo=d(()=>{const r=Number(t.value)>Number(A.value),h=Number(a.value)>Number(b.value);return!t.value&&!a.value?io("button.enterAmount"):r?io("button.insufficientBalance",{name:u.value.symbol}):h?io("button.insufficientBalance",{name:i.value.symbol}):"Add Liquidity"}),ao=d(()=>{const r=Number(t.value)>Number(A.value),h=Number(a.value)>Number(b.value);return!!(!t.value&&!a.value||r||h||t.value<=0&&a.value<=0)}),ro=S(!0),{setIsShowSuccess:yo,setIsShowRejected:fo,setIsShowWaiting:mo,setTransactionDesc:m,setTransactionTxid:D,setPositiomNum:co}=M,_o=Zo("Sui");return{wallet:I,positionInfo:l,isShowAddModal:n,needReverse:$,fromCoin:u,toCoin:i,fromCoinAmount:t,toCoinAmount:a,fromCoinBlance:A,toCoinBlance:b,fixedFromCoin:k,maxBtnSelect:H,halfBtnSelect:B,totalAmountUSD:so,addCommom:L,shareOfPool:j,minimumReceivedLP:X,addLiquidityBtnText:uo,addLiquidityBtnDisabled:ao,toAdd:async()=>{var no,G;n.value=!1,ro.value=!0,D("");const r=`${L(t.value)} ${(no=u.value)==null?void 0:no.symbol}`,h=`${L(a.value)} ${(G=i.value)==null?void 0:G.symbol}`;m(`Deposit ${t.value>0?r:""} ${a.value>0&&t.value>0?"and":""} ${a.value>0?h:""}`),mo(!0);const R=k.value,T=l.value.autoPoolPositionInfo.tick_lower_index,F=l.value.autoPoolPositionInfo.tick_upper_index;let N;if(k.value){const W=new f(t.value).mul(Math.pow(10,u.value.decimals)).toString();N=new Z(W)}else{const W=new f(a.value).mul(Math.pow(10,i.value.decimals)).toString();N=new Z(W)}const z=l.value.rewarderInfo.map(W=>W.coinAddress);try{const W={lowerTick:T,upperTick:F,coinAmount:N,fix_amount_a:R,slippage:Number(V.value)/100,curSqrtPrice:new Z(l.value.current_sqrt_price),id:l.value.id,clmm_pool:l.value.autoPoolPositionInfo.pool,lp_token_type:l.value.lp_token_type,coinTypeA:l.value.autoPoolPositionInfo.coin_type_a,coinTypeB:l.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:z},Xo=await _o.deposit(W),ae=await I.value.currentWallet.signAndExecuteTransactionBlock(Xo);let Po=C.value.handleTx(ae);if(Po&&Po.hash){D(Po.hash),mo(!1),yo(!0);const Fo={title:"Supplied",desc:`Deposit ${t.value>0?r:""} ${a.value>0&&t.value>0?"and":""} ${a.value>0?h:""}`,hash:Po.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",text:`Deposit ${t.value>0?r:""} ${a.value>0&&t.value>0?"and":""} ${a.value>0?h:""}`};O.value!=="Aptos"&&(Fo.res=Po.res),C.value.showTransitionPending(Fo),await C.value.watchTransaction(Fo)&&setTimeout(()=>{y.updatePositionItem(l.value.id),C.value.getAccount(I.value.address)},1e3),co()}else mo(!1),fo(!0);t.value="",a.value="",ro.value=!1}catch{t.value="",a.value="",ro.value=!1,mo(!1),fo(!0)}},showToCoinLock:J,showFromCoinLock:x}}});const Mo=o=>(Bo("data-v-3857f699"),o=o(),Lo(),o),Rn={class:"auto-pool-add"},Nn={class:"auto-pool-add-content"},Bn={class:"liquidity-action-tab"},Ln=Mo(()=>e("div",{class:"increase tab-active"},"Add",-1)),Mn={class:"card-item"},On={class:"card-item"},Dn={class:"add-info"},Un={class:"total-amount"},jn=Mo(()=>e("span",null,"Total Amount",-1)),Fn={class:"total-amount"},Wn=Mo(()=>e("span",null,"Share of Pool",-1)),En={class:"total-amount"},Xn=Mo(()=>e("span",null,"Minimum Received LP",-1)),zn=Mo(()=>e("span",null,"Pool Closed",-1));function Vn(o,n,M,q,O,I){var l,s,$,u,i;const y=Ie,_=$e,v=Ko,g=oe;return c(),w("div",Rn,[e("div",Nn,[e("div",Bn,[Ln,e("div",{class:"remove",onClick:n[0]||(n[0]=Jo(t=>o.$emit("changeCurrentTab"),["stop"]))},"Remove")]),e("div",{class:Wo(o.needReverse?"card-container reverse":"card-container")},[e("div",Mn,[K(y,{modelValue:o.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=t=>o.fromCoinAmount=t),"input-value":o.fromCoinAmount,"coin-symbol":o.fromCoin?o.fromCoin.symbol:null,"coin-name":o.fromCoin?o.fromCoin.name:null,balance:o.fromCoinBlance,"coin-icon":o.fromCoin?o.fromCoin.logoURI:"",address:o.fromCoin?o.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:n[2]||(n[2]=t=>o.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=t=>o.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=t=>{o.fromCoinAmount=t}),onOnFocus:n[5]||(n[5]=()=>{o.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showFromCoinLock?(c(),E(_,{key:0})):po("",!0)]),e("div",On,[K(y,{modelValue:o.toCoinAmount,"onUpdate:modelValue":n[6]||(n[6]=t=>o.toCoinAmount=t),"input-value":o.toCoinAmount,"coin-symbol":o.toCoin?o.toCoin.symbol:null,"coin-name":o.toCoin?o.toCoin.name:null,balance:o.toCoinBlance,"swap-direct":"To","coin-icon":o.toCoin?o.toCoin.logoURI:"",address:o.toCoin?o.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:n[7]||(n[7]=t=>o.maxBtnSelect("toCoin")),onOnHalf:n[8]||(n[8]=t=>o.halfBtnSelect("toCoin")),onOnInput:n[9]||(n[9]=t=>{o.toCoinAmount=t}),onOnFocus:n[10]||(n[10]=()=>{o.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showToCoinLock?(c(),E(_,{key:0})):po("",!0)])],2),e("div",Dn,[e("div",Un,[jn,e("span",null,"$"+p(("addCommom"in o?o.addCommom:U(L))(o.totalAmountUSD)),1)]),e("div",Fn,[Wn,e("span",null,p(o.shareOfPool)+"%",1)]),e("div",En,[Xn,e("span",null,p(("addCommom"in o?o.addCommom:U(L))(o.minimumReceivedLP))+" "+p(o.needReverse?(l=o.toCoin)==null?void 0:l.symbol:(s=o.fromCoin)==null?void 0:s.symbol)+"-"+p(o.needReverse?($=o.fromCoin)==null?void 0:$.symbol:(u=o.toCoin)==null?void 0:u.symbol),1)])])]),(i=o.positionInfo)!=null&&i.is_pause?(c(),E(v,{key:0,class:"big-btn liquidity-btn",disabled:!0},{default:$o(()=>[zn]),_:1})):o.wallet.connected?(c(),E(v,{key:1,class:"big-btn liquidity-btn",disabled:o.addLiquidityBtnDisabled,onClick:n[11]||(n[11]=t=>o.isShowAddModal=!0)},{default:$o(()=>[e("span",null,p(o.addLiquidityBtnText),1)]),_:1},8,["disabled"])):(c(),E(v,{key:2,class:"big-btn",onClick:n[12]||(n[12]=t=>o.wallet.setIsShowWalletModal(!0))},{default:$o(()=>[e("span",null,p(o.$t("button.connectWallet")),1)]),_:1})),o.isShowAddModal?(c(),E(g,{key:3,"pool-info":o.positionInfo,"from-coin":o.needReverse?o.positionInfo.token_b:o.positionInfo.token_a,"to-coin":o.needReverse?o.positionInfo.token_a:o.positionInfo.token_b,"from-coin-amount":o.needReverse?o.toCoinAmount:o.fromCoinAmount,"to-coin-amount":o.needReverse?o.fromCoinAmount:o.toCoinAmount,"total-amount":o.totalAmountUSD,"share-of-pool":o.shareOfPool,"minimum-received-l-p":o.minimumReceivedLP,onOnClose:n[13]||(n[13]=t=>o.isShowAddModal=!1),onToAdd:o.toAdd},null,8,["pool-info","from-coin","to-coin","from-coin-amount","to-coin-amount","total-amount","share-of-pool","minimum-received-l-p","onToAdd"])):po("",!0)])}const se=So(qn,[["render",Vn],["__scopeId","data-v-3857f699"]]),Hn=ko({props:{inputValue:{type:String,default:""},balance:{type:String,default:""},lpDecimals:{type:String,default:""},fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},inputDisabled:{type:Boolean,default:!1},positionInfo:{default:()=>({})}},setup(o,n){const{t:M,locale:q}=Eo(),O=qo(),I=d(()=>O),y=d(()=>new f(Number(o.balance)).div(2)),_=ve(pe,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0});function v(){this.$emit("onSelect")}const g=b=>{const H=new RegExp(`[^\\d-]*(\\d*(?:\\.\\d{0,${o.lpDecimals&&o.lpDecimals}})?).*$`);b.target.value=b.target.value.replace(H,"$1")},l=Ro(),s=d(()=>l),$=Do(),u=d(()=>$),i=d(()=>u.value.tokensWarningObj);Q(()=>u.value.RATES,b=>{},{immediate:!0});const t=d(()=>u.value.tokensObj),a=d(()=>I.value.theme);return{route:Co(),theme:a,tokensObj:t,pool:u,halfBalance:y,t:M,addCommom:L,store:I,wallet:s,indicator:_,inputChange:g,importIcon:go,selectCoin:v,formatNumber:ce,tokensWarningObj:i,checkNullObj:lo,getCoinIcon:b=>(b==null?void 0:b.logoURI)||(b==null?void 0:b.logo_url)||go("/image/coins/sui-unknown.png")}}});const Yn=o=>(Bo("data-v-afb7957e"),o=o(),Lo(),o),Gn={class:"card"},Zn={class:"top"},Jn={key:1,class:"input-div"},Kn={key:0},Qn={class:"left"},xn={class:"loading-token"},ot={class:"lp-bg"},et={key:0,alt:""},nt={class:"bottom"},tt=Yn(()=>e("div",null,null,-1)),st={class:"top"},it={class:"right"};function at(o,n,M,q,O,I){const y=fe,_=Qo,v=Uo("image");return c(),w("div",Gn,[e("div",Zn,[o.inputDisabled?(c(),w("div",Jn,[o.inputValue?(c(),w("span",Kn,p(o.inputValue),1)):(c(),E(_,{key:1,indicator:o.indicator},null,8,["indicator"]))])):(c(),E(y,{key:0,value:o.inputValue=="InsufficientLiquidity"?"":o.inputValue,placeholder:"0.0",disabled:o.inputDisabled,onChange:o.inputChange,onInput:n[0]||(n[0]=g=>o.$emit("onInput",g.target.value)),onFocus:n[1]||(n[1]=g=>o.$emit("onFocus"))},null,8,["value","disabled","onChange"])),e("div",Qn,[e("div",xn,[e("div",ot,[o.positionInfo&&!("checkNullObj"in o?o.checkNullObj:U(lo))(o.positionInfo)&&o.positionInfo.lpInfo?vo((c(),w("img",et,null,512)),[[v,o.getCoinIcon(o.positionInfo.lpInfo)]]):po("",!0)]),e("p",null,p(o.fromCoin.symbol)+" - "+p(o.toCoin.symbol),1)])])]),e("div",nt,[tt,e("div",st,[e("div",it,[To(p(o.$t("common.balance"))+" ",1),e("span",{class:"balance",onClick:n[2]||(n[2]=g=>o.$emit("onMax"))},p(o.wallet.connected?("addCommom"in o?o.addCommom:U(L))(o.balance,o.lpDecimals):"0"),1)])])])])}const lt=So(Hn,[["render",at],["__scopeId","data-v-afb7957e"]]),ut=ko({components:{AutoPoolRemoveModal:ee},setup(){const o=Ro(),n=d(()=>o),M=qo(),q=d(()=>M),O=d(()=>q.value.slippage),I=d(()=>q.value.chainName),y=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],_=S(25),v=Co(),g=No(),l=d(()=>g),s=d(()=>l.value.positionInfoObj[v.params.id]),$=d(()=>{var m;return(m=s.value)==null?void 0:m.needReverse}),u=S(),i=S(),t=S(!1),a=S(),k=d(()=>{var m;return(m=s.value)==null?void 0:m.myLiquidity}),A=S(!0),b=d(()=>I.value?Go(I.value):{}),H=Zo("Sui"),B=S("--"),C=S("--"),V=S("--"),j=()=>{if(A.value||!s.value)return;if(!a.value){B.value="--",C.value="--",_.value=0;return}if(Number(a.value)>Number(k.value))return;if(Number(a.value)*Math.pow(10,s.value.decimals)==Number(k.value)){_.value=100,P({value:1}),A.value=!0;return}const m=new f(a.value).mul(Math.pow(10,s.value.lpInfo.decimals)).toString(),D=new f(a.value).div(new f(k.value)).mul(100),co=s.value.tick_lower_index,_o=s.value.tick_upper_index,Io=s.value.token_a.decimals,r=s.value.token_b.decimals,h=bo.tickIndexToSqrtPriceX64(co),R=bo.tickIndexToSqrtPriceX64(_o),T=Vo.get_share_liquidity_by_amount({liquidity:s.value.liquidity,total_supply:s.value.total_supply},m.toString()),F=Ho.getCoinAmountFromLiquidity(new Z(T),new Z(s.value.object.current_sqrt_price),h,R,!1),N=new f(F.coinA.toString()).div(Math.pow(10,Io)).toString(),z=new f(F.coinB.toString()).div(Math.pow(10,r)).toString();B.value=Number(N)>0?N:"--",C.value=Number(z)>0?z:"--",_.value=D.toString(),V.value=to(m,0),X.value=to(T,0)},X=S(),P=m=>{if(!A.value)return;A.value=!0;const D=s.value.token_a.decimals,co=s.value.token_b.decimals,_o=s.value.tick_lower_index,Io=s.value.tick_upper_index,r=bo.tickIndexToSqrtPriceX64(_o),h=bo.tickIndexToSqrtPriceX64(Io);let R="",T;m.value!==1?T=new f(s.value.myLiquidity).mul(Math.pow(10,s.value.lpInfo.decimals)).mul(m.value).toString():T=new f(s.value.myLiquidity).mul(Math.pow(10,s.value.lpInfo.decimals)).toString(),a.value=new f(T).div(Math.pow(10,s.value.lpInfo.decimals)),R=Vo.get_share_liquidity_by_amount({liquidity:s.value.liquidity,total_supply:s.value.total_supply},T),V.value=to(T,0),X.value=to(R,0);const F=Ho.getCoinAmountFromLiquidity(new Z(R),new Z(s.value.object.current_sqrt_price),r,h,!1),N=new f(F.coinA.toString()).div(Math.pow(10,D)).toString(),z=new f(F.coinB.toString()).div(Math.pow(10,co)).toString();B.value=Number(N)>0?N:"--",C.value=Number(z)>0?z:"--"};Q(_,_e((m,D)=>{m!==D&&(Number(m)>100?_.value=100:m&&s.value?(_.value=m,P({value:_.value/100})):(B.value="--",C.value="--"))},300)),Q(()=>a.value,m=>{j()},{immediate:!0});const eo=xo(),{setIsShowSuccess:x,setIsShowRejected:J,setIsShowWaiting:Y,setTransactionDesc:oo,setTransactionTxid:so,setPositiomNum:io,setTransactionDescText:Ao}=M,uo=S(!1),{t:ao}=Eo(),ro=async()=>{var T,F;uo.value=!0,so("");const m=Number(B.value)>0?`${L(B.value,u.value.decimals)} ${u.value.symbol}`:"",D=Number(C.value)>0?`${L(C.value,i.value.decimals)} ${i.value.symbol}`:"";oo(ao("tips.removeLiquidiyText",{from:$.value?D:m,and:Number(B.value)>0&&Number(C.value)>0?"and":"",to:$.value?m:D})),Y(!0);const co=ao("modal.removeLiquidityText2");Ao(co);const _o=s.value.autoPoolPositionInfo.tick_lower_index,Io=s.value.autoPoolPositionInfo.tick_upper_index,r=bo.tickIndexToSqrtPriceX64(_o),h=bo.tickIndexToSqrtPriceX64(Io),R=s.value.rewarderInfo.map(N=>N.coinAddress);try{const N={lowerSqrtPrice:r,upperSqrtPrice:h,lpTokenAmount:new Z(V.value),liquidity:new Z(X.value),curSqrtPrice:new Z(s.value.object.current_sqrt_price),slippage:Number(O.value)/100,id:s.value.id,clmm_pool:s.value.autoPoolPositionInfo.pool,lp_token_type:s.value.lp_token_type,coinTypeA:s.value.autoPoolPositionInfo.coin_type_a,coinTypeB:s.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:R},z=await H.remove(N),no=await n.value.currentWallet.signAndExecuteTransactionBlock(z);let G=b.value.handleTx(no);if(G&&G.hash){so(G.hash),Y(!1),x(!0);const W={title:ao("common.removeLiquidity"),desc:"",hash:G.hash,descTransactions:`Remove ${m} ${Number(B.value)>0&&Number(C.value)>0?"and":""} ${D} from the pool`,sender:n.value.address,chainName:"Sui",tit:"Liquidity Removed",icon:"icon-icon-Removed",text:`Withdraw ${B.value} ${(T=u.value)==null?void 0:T.symbol} and ${C.value} ${(F=i.value)==null?void 0:F.symbol}`};W.res=G.res,b.value.showTransitionPending(W),await b.value.watchTransaction(W)&&(B.value="",C.value="",a.value="",_.value=0,setTimeout(()=>{g.updatePositionItem(s.value.id),b.value.getAccount(n.value.address)},1e3),Number(_.value)==100&&v.name=="auto-pool-detail"&&eo.push("/vaults"))}else Y(!1),J(!0);uo.value=!1}catch{uo.value=!1,Y(!1),J(!0)}};Q(()=>s.value,(m,D)=>{m&&!lo(m)&&(u.value=m==null?void 0:m.token_a,i.value=m==null?void 0:m.token_b,(!D||D&&D.address!==m.address)&&P({value:_.value/100}))},{immediate:!0});const yo=d(()=>{const m=Number(a.value)>Number(k.value);return!a.value||a.value<=0?ao("button.enterAmount"):m?"Invalid Amount":ao("button.remove")}),fo=d(()=>{const m=Number(a.value)>Number(k.value);return!!(!a.value||a.value<=0||m)});return{removeLiquidityBtnText:yo,removeLiquidityBtnDisabled:fo,wallet:n,ratioArr:y,positionInfo:s,isShowRemoveModal:t,needReverse:$,fromCoin:u,toCoin:i,lpAmount:a,lpBalance:k,sliderVal:_,sFixD:to,isSlider:A,fromCoinAmount:B,toCoinAmount:C,setPercent:P,toRemove:ro,addCommom:L,getCoinIcon:m=>(m==null?void 0:m.logoURI)||(m==null?void 0:m.logo_url)||go("/image/coins/sui-unknown.png")}}});const jo=o=>(Bo("data-v-a476b0c1"),o=o(),Lo(),o),rt={class:"auto-pool-add"},dt={class:"auto-pool-add-content"},mt={class:"liquidity-action-tab"},ct=jo(()=>e("div",{class:"remove tab-active"},"Remove",-1)),vt={class:"card-item"},pt={class:"remove-ratio"},ft=jo(()=>e("div",{class:"remove-ratio-title"},"Amount",-1)),_t={class:"remove-ratio-select"},bt={key:0,class:"ratio"},ht={key:1,class:"ratio"},yt={class:"ratio-list"},It=["onClick"],$t={class:"est-receive"},gt=jo(()=>e("div",{class:"est-receive-title"},"Estimated Receive",-1)),kt={class:"token-a"},Ct={alt:""},St={class:"token-a"},wt={alt:""},At=jo(()=>e("span",null,"Pool Closed",-1));function Pt(o,n,M,q,O,I){var s,$,u,i,t,a,k,A,b,H,B,C,V,j,X;const y=lt,_=ye,v=Ko,g=ee,l=Uo("image");return c(),w("div",rt,[e("div",dt,[e("div",mt,[e("div",{class:"increase",onClick:n[0]||(n[0]=Jo(P=>o.$emit("changeCurrentTab"),["stop"]))},"Add"),ct]),e("div",{class:Wo(o.needReverse?"card-container reverse":"card-container")},[e("div",vt,[K(y,{modelValue:o.lpAmount,"onUpdate:modelValue":n[1]||(n[1]=P=>o.lpAmount=P),"input-value":o.lpAmount,balance:o.lpBalance,"from-coin":o.needReverse?o.toCoin:o.fromCoin,"to-coin":o.needReverse?o.fromCoin:o.toCoin,"position-info":o.positionInfo,"lp-decimals":($=(s=o.positionInfo)==null?void 0:s.lpInfo)==null?void 0:$.decimals,onOnMax:n[2]||(n[2]=()=>{o.sliderVal=100,o.setPercent({value:1})}),onOnInput:n[3]||(n[3]=P=>{o.isSlider=!1,o.lpAmount=P})},null,8,["modelValue","input-value","balance","from-coin","to-coin","position-info","lp-decimals"])])],2),e("div",pt,[ft,e("div",_t,[Number(o.lpBalance)>=Number(o.lpAmount)?(c(),w("div",bt,p(o.sliderVal>0&&Number(("sFixD"in o?o.sFixD:U(to))(o.sliderVal,2))<.01?"<0.01":("sFixD"in o?o.sFixD:U(to))(o.sliderVal,2))+"% ",1)):(c(),w("div",ht,"--")),e("div",yt,[(c(!0),w(be,null,he(o.ratioArr,(P,eo)=>(c(),w("div",{key:eo,class:Wo(["ratio-item",o.sliderVal==P.value?"ratio-item-active":""]),onClick:()=>{o.isSlider=!0,o.sliderVal=P.value}},p(P.name),11,It))),128))])]),K(_,{value:o.sliderVal,"onUpdate:value":n[4]||(n[4]=P=>o.sliderVal=P)},null,8,["value"])]),e("div",$t,[gt,e("div",kt,[e("div",null,p(("addCommom"in o?o.addCommom:U(L))(o.fromCoinAmount)),1),e("div",null,[vo(e("img",Ct,null,512),[[l,o.needReverse?o.getCoinIcon((u=o.positionInfo)==null?void 0:u.token_b):o.getCoinIcon((i=o.positionInfo)==null?void 0:i.token_a)]]),e("span",null,p(o.needReverse?(a=(t=o.positionInfo)==null?void 0:t.token_b)==null?void 0:a.symbol:(A=(k=o.positionInfo)==null?void 0:k.token_a)==null?void 0:A.symbol),1)])]),e("div",St,[e("div",null,p(("addCommom"in o?o.addCommom:U(L))(o.toCoinAmount)),1),e("div",null,[vo(e("img",wt,null,512),[[l,o.needReverse?o.getCoinIcon((b=o.positionInfo)==null?void 0:b.token_a):o.getCoinIcon((H=o.positionInfo)==null?void 0:H.token_b)]]),e("span",null,p(o.needReverse?(C=(B=o.positionInfo)==null?void 0:B.token_a)==null?void 0:C.symbol:(j=(V=o.positionInfo)==null?void 0:V.token_b)==null?void 0:j.symbol),1)])])])]),(X=o.positionInfo)!=null&&X.is_pause?(c(),E(v,{key:0,class:"big-btn liquidity-btn",disabled:!0},{default:$o(()=>[At]),_:1})):o.wallet.connected?(c(),E(v,{key:1,class:"big-btn liquidity-btn",disabled:o.removeLiquidityBtnDisabled,onClick:o.toRemove},{default:$o(()=>[e("span",null,p(o.removeLiquidityBtnText),1)]),_:1},8,["disabled","onClick"])):(c(),E(v,{key:2,class:"big-btn",onClick:n[5]||(n[5]=P=>o.wallet.setIsShowWalletModal(!0))},{default:$o(()=>[e("span",null,p(o.$t("button.connectWallet")),1)]),_:1})),o.isShowRemoveModal?(c(),E(g,{key:3,"pool-info":o.positionInfo,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b,onOnClose:n[6]||(n[6]=P=>o.isShowRemoveModal=!1)},null,8,["pool-info","from-coin","to-coin"])):po("",!0)])}const ie=So(ut,[["render",Pt],["__scopeId","data-v-a476b0c1"]]),Tt=ko({components:{AutoPoolAdd:se,AutoPositionInfo:ne,AutoPositionLiquidity:te,AutoPoolRemove:ie},setup(){const o=S("add"),n=Ro(),M=d(()=>n),q=No(),O=d(()=>q),I=Do(),y=d(()=>I);Q(()=>y.value.poolConfigList,u=>{u&&u.length>0&&q.getAutoPoolList()},{immediate:!0}),Q(()=>[M.value.address,O.value.autoPoolList,y.value.poolConfigList],([u,i,t])=>{u&&i&&i.length>0&&t&&t.length>0&&q.getMyAutoPoolPosition()},{immediate:!0});const _=Co(),v=d(()=>O.value.positionInfoObj[_.params.id]||{});Q(()=>_.query.action,u=>{u&&(o.value=u)},{immediate:!0});const g=xo();Q(()=>M.value.address,u=>{u||g.push("/vaults")},{immediate:!0});const l=qo(),s=d(()=>l);return{currentTab:o,positionInfo:v,clickRefresh:()=>{q.getAutoPoolAPY(),q.getAutoPoolList(),I.setPoolConfigList(s.value.chainName,s.value.filterCoinsObj)},checkNullObj:lo}}});const qt={class:"auto-increase-liquidity"},Rt={class:"auto-increase-liquidity-content pc-content"},Nt={class:"left"},Bt={class:"right"},Lt={class:"auto-increase-liquidity-content h5-content"},Mt={class:"left"},Ot={class:"right"};function Dt(o,n,M,q,O,I){const y=le,_=ne,v=te,g=se,l=ie,s=Qo;return c(),w("div",qt,[K(y,{onClickRefresh:o.clickRefresh},null,8,["onClickRefresh"]),e("div",Rt,[e("div",Nt,[K(_),K(v)]),e("div",Bt,[o.currentTab=="add"?(c(),E(g,{key:0,onChangeCurrentTab:n[0]||(n[0]=$=>o.currentTab="remove")})):(c(),E(l,{key:1,onChangeCurrentTab:n[1]||(n[1]=$=>o.currentTab="add")}))]),("checkNullObj"in o?o.checkNullObj:U(lo))(o.positionInfo)?(c(),E(s,{key:0})):po("",!0)]),e("div",Lt,[e("div",Mt,[K(_),o.currentTab=="add"?(c(),E(g,{key:0,onChangeCurrentTab:n[2]||(n[2]=$=>o.currentTab="remove")})):(c(),E(l,{key:1,onChangeCurrentTab:n[3]||(n[3]=$=>o.currentTab="add")}))]),e("div",Ot,[K(v)]),("checkNullObj"in o?o.checkNullObj:U(lo))(o.positionInfo)?(c(),E(s,{key:0})):po("",!0)])])}const rs=So(Tt,[["render",Dt],["__scopeId","data-v-f53d3908"]]);export{rs as default};
