import{_ as Ro}from"./new-position-title.be459dbb.js";import{_ as co}from"./token-warning.611d7ed6.js";import{_ as Oo}from"./status-block.3da98b73.js";import{j as Qo,n as Ko,d as be,e as to,u as io,a as J,g as bo,c as fe,s as Me,r as $e,b as Oe,p as Co,J as qo,K as Lo,T as $o,C as Zo,m as Vo}from"./pool.3a232f6a.js";import{s as so,m as xo,l as en,b as on,a as nn}from"./transform.c672907f.js";import{D as b}from"./decimal.0bdeb344.js";import{u as Ye,a as lo}from"./sha256.4b5cdcb3.js";import{a as Je,r as L,l as A,H as Bo,q as we,e as Qe,o as w,f as S,t as Se,N as Mo,h as n,p as mo,k as vo,m as fo,s as yo,i as se,u as Y,v as F,j as ve,x as de,y as Ao,a4 as tn,b as ro,C as Xe,L as an,a8 as So,O as Po,w as Le,F as Ve,E as oo,B as uo,M as sn,A as ko,c as qe,D as ln,G as rn,z as Uo,P as un,$ as dn,K as cn,S as mn}from"./entry.7f57c35c.js";import{i as no}from"./import-icon.de3e6c66.js";/* empty css              */import{_ as po}from"./assets-card.8e373722.js";import{_ as vn}from"./coin-lock.0e1996de.js";import{a as fn}from"./new-add-or-create.766c6875.js";import{_ as pn,a as hn}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              *//* empty css              */import{u as jo}from"./notifi.febf032e.js";import{_ as bn}from"./apr-tips.b17ee021.js";import{u as Eo}from"./farms.fe46088e.js";/* empty css              *//* empty css              */import"./back.6b85ac05.js";import"./swap-setting.93d5a8ac.js";/* empty css              */import"./icon-error_2x.e69ab005.js";import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.65de7013.js";import"./useWhale.0c68c762.js";import"./icon_rewards_2x.8dd0bfd1.js";const go=Math.PI,_o=2*go,Ze=1e-6,kn=_o-Ze;function Do(e){this._+=e[0];for(let t=1,a=e.length;t<a;++t)this._+=arguments[t]+e[t]}function gn(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Do;const a=10**t;return function(s){this._+=s[0];for(let O=1,p=s.length;O<p;++O)this._+=Math.round(arguments[O]*a)/a+s[O]}}class _n{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Do:gn(t)}moveTo(t,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+a}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,a){this._append`L${this._x1=+t},${this._y1=+a}`}quadraticCurveTo(t,a,s,O){this._append`Q${+t},${+a},${this._x1=+s},${this._y1=+O}`}bezierCurveTo(t,a,s,O,p,T){this._append`C${+t},${+a},${+s},${+O},${this._x1=+p},${this._y1=+T}`}arcTo(t,a,s,O,p){if(t=+t,a=+a,s=+s,O=+O,p=+p,p<0)throw new Error(`negative radius: ${p}`);let T=this._x1,m=this._y1,o=s-t,l=O-a,v=T-t,u=m-a,k=v*v+u*u;if(this._x1===null)this._append`M${this._x1=t},${this._y1=a}`;else if(k>Ze)if(!(Math.abs(u*o-l*v)>Ze)||!p)this._append`L${this._x1=t},${this._y1=a}`;else{let X=s-T,te=O-m,ee=o*o+l*l,oe=X*X+te*te,r=Math.sqrt(ee),f=Math.sqrt(k),N=p*Math.tan((go-Math.acos((ee+k-oe)/(2*r*f)))/2),i=N/f,_=N/r;Math.abs(i-1)>Ze&&this._append`L${t+i*v},${a+i*u}`,this._append`A${p},${p},0,0,${+(u*X>v*te)},${this._x1=t+_*o},${this._y1=a+_*l}`}}arc(t,a,s,O,p,T){if(t=+t,a=+a,s=+s,T=!!T,s<0)throw new Error(`negative radius: ${s}`);let m=s*Math.cos(O),o=s*Math.sin(O),l=t+m,v=a+o,u=1^T,k=T?O-p:p-O;this._x1===null?this._append`M${l},${v}`:(Math.abs(this._x1-l)>Ze||Math.abs(this._y1-v)>Ze)&&this._append`L${l},${v}`,s&&(k<0&&(k=k%_o+_o),k>kn?this._append`A${s},${s},0,1,${u},${t-m},${a-o}A${s},${s},0,1,${u},${this._x1=l},${this._y1=v}`:k>Ze&&this._append`A${s},${s},0,${+(k>=go)},${u},${this._x1=t+s*Math.cos(p)},${this._y1=a+s*Math.sin(p)}`)}rect(t,a,s,O){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+a}h${s=+s}v${+O}h${-s}Z`}toString(){return this._}}function eo(e){return function(){return e}}function wn(e){let t=3;return e.digits=function(a){if(!arguments.length)return t;if(a==null)t=null;else{const s=Math.floor(a);if(!(s>=0))throw new RangeError(`invalid digits: ${a}`);t=s}return e},()=>new _n(t)}function yn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Fo(e){this._context=e}Fo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function An(e){return new Fo(e)}function In(e){return e[0]}function Cn(e){return e[1]}function $n(e,t){var a=eo(!0),s=null,O=An,p=null,T=wn(m);e=typeof e=="function"?e:e===void 0?In:eo(e),t=typeof t=="function"?t:t===void 0?Cn:eo(t);function m(o){var l,v=(o=yn(o)).length,u,k=!1,X;for(s==null&&(p=O(X=T())),l=0;l<=v;++l)!(l<v&&a(u=o[l],l,o))===k&&((k=!k)?p.lineStart():p.lineEnd()),k&&p.point(+e(u,l,o),+t(u,l,o));if(X)return p=null,X+""||null}return m.x=function(o){return arguments.length?(e=typeof o=="function"?o:eo(+o),m):e},m.y=function(o){return arguments.length?(t=typeof o=="function"?o:eo(+o),m):t},m.defined=function(o){return arguments.length?(a=typeof o=="function"?o:eo(!!o),m):a},m.curve=function(o){return arguments.length?(O=o,s!=null&&(p=O(s)),m):O},m.context=function(o){return arguments.length?(o==null?s=p=null:p=O(s=o),m):s},m}function To(){}function Wo(e){this._context=e}Wo.prototype={areaStart:To,areaEnd:To,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Sn(e){return new Wo(e)}function No(e,t,a){const s=new b(10).pow(t-a);return new b(1.0001).pow(e).mul(s)}const Pn=Je({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,t){const a=L(1),s=L(""),O=L(""),p=A(()=>{var i,_,I;return u.sqrtPriceX64ToPrice((i=e.poolInfo)==null?void 0:i.current_sqrt_price,(_=e.poolInfo)==null?void 0:_.coinA.decimals,(I=e.poolInfo)==null?void 0:I.coinB.decimals).toString()}),T=A(()=>{let i=0;return e.direction?i=(Number(e.minPrice)/Number(p.value)-1)*100:i=(Number(e.minPrice)/Number(1/Number(p.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),m=A(()=>{let i=0;return e.direction?i=(Number(e.maxPrice)/Number(p.value)-1)*100:i=(Number(e.maxPrice)/Number(1/Number(p.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),o=Ye(),l=A(()=>o),v=A(()=>l.value.chainName?to(l.value.chainName):{}),{TickMath:u,getNearestTickByTick:k}=v.value,X=()=>{const i=a.value/2;a.value=i,oe(e.poolInfo,i)},te=()=>{const i=a.value*2;a.value=i,oe(e.poolInfo,i)},ee=(i=[])=>{let _=6;const I=Math.abs(Number(i[0])-Number(i[i.length-1]));return I>=6?_=0:I>=1?_=1:I>=.1?_=2:I>=.01?_=3:I>=.001?_=4:I>=1e-4?_=5:I>=1e-5?_=6:I>=1e-6?_=7:I>=1e-7&&(_=8),_},oe=(i,_=1)=>{if(i&&i.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const I=Number(e.poolInfo.current_tick_index);let C=I+100*_,c=I-100*_,ie,G;if(e.maxPrice==="∞")G=v.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?G=u.priceToTickIndex(new b(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):G=u.priceToTickIndex(new b(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{G=443636}if(e.minPrice==="0")ie=v.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?ie=u.priceToTickIndex(new b(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):ie=u.priceToTickIndex(new b(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{ie=-443636}let re=0;if(e.currentPriceTab!=="full range"){if(I>=ie&&I<=G){const D=I-ie,pe=G-I;re=Math.max(Math.abs(D),Math.abs(pe))}else I<ie?re=Math.abs(G-I):re=Math.abs(I-ie);C=I+re+100*_,c=I-re-100*_}else{const D=(Math.abs(I)>5e3,2e4);C=I+D*_,c=I-D*_}c<-443636&&(c=-443636),C>443636&&(C=443636);const W=new b(i.liquidity).div(Math.pow(10,8)).toString(),$=e.tickList,q=[],M=[];let E={};for(let D=0;D<$.length;D++){if(E=$[D],E.index<=I&&E.index>=c){if(q.length<1&&D!==0){const pe=$[D-1];q.unshift({...pe,index:c})}q.unshift(E)}else if(E.index>I&&E.index<=C&&(M.push(E),q.length<1&&D!==0)){const pe=$[D-1];q.push({...pe,index:c})}if(E.index>C){const pe=$[D];if(M.push({...pe,index:C}),q.length<1&&D!==0){const ge=$[D-1];q.push({...ge,index:c})}break}}let ne="0";for(let D=q.length-1;D>=0;D--)ne=new b(ne).plus(new b(q[D].liquidityNet.toString()).div(Math.pow(10,8))).toString(),q[D].liquityAmount=ne;let V=W;for(let D=0;D<M.length;D++)V=new b(V).plus(new b(M[D].liquidityNet.toString()).div(Math.pow(10,8))).toString(),M[D].liquityAmount=V;let ae=[];const Q=$&&$.length>0?{index:I,liquityAmount:Number(W)}:{index:I,liquityAmount:0};(q.length>0||M.length>0)&&(ae=[...q.reverse(),Q,...M],e.direction||(ae=ae.reverse()));const ke=[];$.forEach(D=>{ke.push({...D,liquidityGross:D.liquidityGross.toString(),liquidityNet:D.liquidityNet.toString()})}),f(ae,c,C,ie,G,I)}};let r=L(!1);Bo(()=>{document.body.clientWidth<750?r.value=!1:r.value=!0,window.onresize=()=>{document.body.clientWidth<750?r.value=!1:r.value=!0,oe(e.poolInfo,a.value)}});const f=(i,_,I,C,c,ie)=>{let G,re;e.direction?(G=e.before7dContractPriceLowest?u.priceToTickIndex(new b(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",re=e.before7dContractPriceHighest?u.priceToTickIndex(new b(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(G=e.before7dContractPriceLowest?u.priceToTickIndex(new b(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",re=e.before7dContractPriceHighest?u.priceToTickIndex(new b(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const W={top:30,right:35,bottom:20,left:55};let $,q;r.value,$=340-W.left-W.right,q=205-W.top-W.bottom;const M=I-_,E=parseInt(String(M/4));let ne=[_+E/4,_+E,_+2*E,I-E,I-E/4];const V=_,ae=I,Q=$/(ae-V);e.currentPriceTab==="full range"&&(ne=[_,_+2*E,I]);const ke=ne.map(P=>e.direction?No(P,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new b(1).div(No(P,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());ee(ke),so("#chart").selectAll("*").remove();const D=so("#chart").attr("width",$+W.left+W.right).attr("height",q+W.top+W.bottom).append("g").attr("transform",`translate(${W.left},${W.right})`),pe=xo(i,function(P){return Number(Math.abs(P.liquityAmount))})||0,ge=en().range([0,q]).domain([pe,0]);on().rangeRound([0,$]).padding(.1);const Be=D.append("g").attr("id","barsBox").selectAll("rect").data(i).enter().append("rect");l.value.theme=="default"?Be.attr("x",function(P,B){return B===0?0:e.direction?Math.abs(P.index-V)*Q:Math.abs(ae-P.index)*Q}).attr("y",function(P,B){return e.direction?B===i.length-1?0:ge(P.liquityAmount):B===i.length-1?0:ge(i[B+1].liquityAmount)}).attr("width",function(P,B){return B===0&&i.length===1&&P.liquityAmount>0?$:(e.direction,B!==i.length-1?Math.abs(i[B+1].index-P.index)*Q:0)}).attr("height",function(P,B){return B===0&&i.length===1&&P.liquityAmount>0?q:e.direction?B===i.length-1?0:q-ge(P.liquityAmount):B===i.length-1?0:q-ge(i[B+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):Be.attr("x",function(P,B){return B===0?0:e.direction?Math.abs(P.index-V)*Q:Math.abs(ae-P.index)*Q}).attr("y",function(P,B){return e.direction?B===i.length-1?0:ge(Math.abs(P.liquityAmount)):B===i.length-1?0:ge(Math.abs(i[B+1].liquityAmount))}).attr("width",function(P,B){return B===0&&i.length===1&&P.liquityAmount>0?$:(e.direction,B!==i.length-1?Math.abs(i[B+1].index-P.index)*Q:0)}).attr("height",function(P,B){if(B===0&&i.length===1&&P.liquityAmount>0)return q;if(e.direction)return B===i.length-1?0:Number(P.liquityAmount)?q-ge(Math.abs(P.liquityAmount)):0;{if(B===i.length-1)return 0;const ue=q-ge(Math.abs(i[B+1].liquityAmount));return Number(i[B+1].liquityAmount)?ue:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const d=D.append("g");d.append("line").attr("x1",0).attr("y1",155).attr("x2",$).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),d.append("g");let g=0;e.direction?g=Math.abs(ie-V)*Q:g=Math.abs(ie-ae)*Q,(l.value.theme=="default"?D.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):D.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+g+", 0)"),so("#triangle").attr("width",8).attr("height",4);let U=[[0,0],[4,4],[8,0]],Z=$n().x(function(P){return P[0]}).y(function(P){return P[1]}).curve(Sn);const j=g-4;D.append("path").attr("d",Z(U)).style("fill",l.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+j+", 0)");let H,K,x,ce;e.direction?(H=C<V?-100:parseInt(String(Math.abs(C-V)*Q)),K=c<V?-100:parseInt(String(Math.abs(c-V)*Q)),x=G<V?-100:Math.abs(G-V)*Q,ce=re<V?-100:Math.abs(re-V)*Q):(K=C<V?-100:Math.abs(ae-C)*Q,H=c<V?-100:Math.abs(ae-c)*Q,ce=G<V?-100:Math.abs(ae-G)*Q,x=re<V?-100:Math.abs(ae-re)*Q),e.minPrice==="0"&&(H=0),e.maxPrice==="∞"&&(K=$),r.value?s.value=$-H+60+"px":s.value=$-H+52+"px",O.value=K+74+"px",G&&x<$&&D.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+x+", 0)"),re&&ce<$&&D.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ce+", 0)");const me=nn().extent([[0,0],[$,q]]).handleSize(30).on("end",Pe);D.append("g").attr("class","brush").call(me).call(me.move,[H,K]);function Pe(P){if(!P.sourceEvent||!P.selection)return;r.value?s.value=$-P.selection[0]+60+"px":s.value=$-P.selection[0]+52+"px",O.value=P.selection[1]+74+"px";let B,ue,_e=0,y=0;e.direction?(_e=k(parseInt(String(P.selection[0]/Q+V)),Number(e.poolInfo.tickSpacing)),B=u.tickIndexToPrice(_e,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),y=k(parseInt(String(P.selection[1]/Q+V)),Number(e.poolInfo.tickSpacing)),ue=u.tickIndexToPrice(y,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):(y=k(ae-P.selection[0]/Q,Number(e.poolInfo.tickSpacing)),B=1/u.tickIndexToPrice(y,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),_e=k(ae-P.selection[1]/Q,Number(e.poolInfo.tickSpacing)),ue=1/u.tickIndexToPrice(_e,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),t.emit("onChangeMinPrice",String(be(String(B),6))),t.emit("onChangeMaxPrice",String(be(String(ue),6)))}l.value.theme=="default"?so(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):so(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};L(""),we(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([i,_,I,C])=>{i&&_&&I&&oe(i,a.value)},{immediate:!0});const N=L(!0);return we(()=>e.chartLoading,(i,_)=>{i!==_&&(N.value=i)},{immediate:!0,deep:!0}),{store:l,loading:N,zoomOut:X,zoomIn:te,rangeSizeLower:T,rangeSizeUpper:m,rangeSizeLowerPosition:s,rangeSizeUpperPosition:O,decimalFormat:Qo,numberformat:Ko}}});const Tn=e=>(mo("data-v-59ae7c8b"),e=e(),vo(),e),Nn={class:"chart-box"},Rn={class:"chart"},On=Tn(()=>n("svg",{id:"chart"},null,-1)),qn=[On];function Ln(e,t,a,s,O,p){return w(),S("div",Nn,[Se(n("div",Rn,qn,512),[[Mo,!e.loading]])])}const Ho=Qe(Pn,[["render",Ln],["__scopeId","data-v-59ae7c8b"]]),Bn=Je({components:{StatusBlock:Oo,NewPositionChart:Ho,TokenWarning:co},setup(e){const t=L(),a=L(),s=A(()=>{var i,_;return(_=(i=u.value)==null?void 0:i.poolInfo)==null?void 0:_.needReverse}),O=Ye(),p=A(()=>O),T=A(()=>p.value.currentExplorer),m=A(()=>p.value.theme),o=A(()=>p.value.chainName),l=io(),v=A(()=>l),u=L({}),k=fo();we(()=>[v.value.currentPositionInfo,o.value],([i,_])=>{var I;(_=="Aptos"&&i||_=="Sui"&&i&&(i==null?void 0:i.nftHash)==((I=k==null?void 0:k.query)==null?void 0:I.pos))&&(u.value=i,t.value=u.value.token_a,a.value=u.value.token_b)},{immediate:!0});const X=i=>{var _;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((_=v.value.tokensObj[i==null?void 0:i.address])==null?void 0:_.logo_url)||(m.value==="default"?no("/image/coins/unknown.png"):no("/image/coins/sui-unknown.png"))},te=A(()=>o.value?to(o.value):{}),ee=L([]),oe=async i=>{const{list:_}=await te.value.getTicks(i),I=_?te.value.getTickDataFromUrlData(_):[];ee.value=I};we(()=>[u.value,v.value.poolsObj],([i,_])=>{i&&!fe(i)&&i.poolInfo&&_&&!fe(_)&&oe(_[i.poolAddress])},{immediate:!0});const r=L(!0),f=(i,_)=>i!=="0"&&_!=="∞"?Me(1/(1-Number((i/_)**.25)),2)+"x":"1x",N=A(()=>u.value.minPrice&&u.value.maxPrice?f(u.value.minPrice,u.value.maxPrice):"--");return{needReverse:s,getCoinIcon:X,theme:m,indexStore:O,direct:r,addCommom:J,decimalUi:be,tickList:ee,positionInfo:u,fromCoin:t,toCoin:a,getExplorerUrl:bo,lever:N,currentExplorer:T}}}),Mn=""+globalThis.__publicAssetsURL("image/aptos-price.png"),Un=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),jn=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),En=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Ge=e=>(mo("data-v-39ad5090"),e=e(),vo(),e),Dn={class:"new-position-info"},Fn={class:"pool-info"},Wn={class:"left"},Hn={class:"coin-a"},Xn={alt:""},Gn={class:"coin-b"},zn={alt:""},Yn={class:"position-name"},Jn=["href"],Qn=Ge(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),Kn=[Qn],Zn={key:0,class:"pool-fee"},Vn=Ge(()=>n("span",null,"Fee tier",-1)),xn={class:"right"},et={class:"h5-pool-info"},ot={class:"coin-info"},nt={class:"coin-a"},tt={alt:""},it={class:"coin-b"},at={alt:""},st={class:"position-name"},lt=["href"],rt=Ge(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),ut=[rt],dt={key:0,class:"pool-fee"},ct={class:"price-info"},mt={class:"price-and-chart"},vt={class:"left"},ft={class:"current-price"},pt=Ge(()=>n("span",null,"Current Price",-1)),ht={class:"coin-rate"},bt=Ge(()=>n("div",null,[n("svg",{class:"icon icon-up","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),kt=Ge(()=>n("div",null,[n("svg",{class:"icon icon-down","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),gt=[bt,kt],_t={key:0},wt={key:1},yt={key:0,class:"position-range"},At=Ge(()=>n("div",{class:"position-range-title"}," Position Range ",-1)),It={key:0},Ct={key:1},$t={key:2,src:Mn,alt:""},St={key:3,src:Un,alt:""},Pt={key:4},Tt={key:5},Nt={key:1,class:"position-range position-range-warp"},Rt={key:0,class:"position-range-title"},Ot={key:1,class:"position-range-title"},qt={key:2},Lt={key:3},Bt={class:"price-img"},Mt={key:0,src:jn,alt:""},Ut={key:1,src:En,alt:""},jt={key:4},Et={key:5},Dt={class:"lever"},Ft=Ge(()=>n("div",{class:"lever-title"},"Leverage",-1)),Wt={class:"lever-text"},Ht={class:"right"},Xt=Ge(()=>n("div",{class:"chat-mask"},null,-1));function Gt(e,t,a,s,O,p){var v,u,k,X,te,ee,oe,r,f,N,i,_,I,C,c,ie,G,re,W,$,q,M,E,ne,V,ae,Q,ke,D,pe;const T=co,m=Oo,o=Ho,l=yo("image");return w(),S("div",Dn,[n("div",Fn,[n("div",Wn,[n("div",Hn,[Se(n("img",Xn,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),se(T,{address:e.needReverse?(X=(k=e.positionInfo)==null?void 0:k.token_b)==null?void 0:X.address:(u=(v=e.positionInfo)==null?void 0:v.token_a)==null?void 0:u.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",Gn,[Se(n("img",zn,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),se(T,{address:e.needReverse?(r=(oe=e.positionInfo)==null?void 0:oe.token_a)==null?void 0:r.address:(ee=(te=e.positionInfo)==null?void 0:te.token_b)==null?void 0:ee.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",Yn,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:Y(bo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},F((N=(f=e.positionInfo)==null?void 0:f.name)==null?void 0:N.split("|")[1]),9,Jn)]),(w(),S("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[0]||(t[0]=ge=>e.indexStore.copy(e.positionInfo.nftHash||e.positionInfo.clmm_position_id))},Kn)),e.positionInfo.fee?(w(),S("div",Zn,[Vn,ve(" "+F(e.positionInfo.fee*100)+"% ",1)])):de("",!0)]),n("div",xn,[se(m,{"current-status":(i=e.positionInfo)==null?void 0:i.currentStatus},null,8,["current-status"])])]),n("div",et,[n("div",null,[n("div",ot,[n("div",nt,[Se(n("img",tt,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),se(T,{address:e.needReverse?(c=(C=e.positionInfo)==null?void 0:C.token_b)==null?void 0:c.address:(I=(_=e.positionInfo)==null?void 0:_.token_a)==null?void 0:I.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",it,[Se(n("img",at,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),se(T,{address:e.needReverse?(W=(re=e.positionInfo)==null?void 0:re.token_a)==null?void 0:W.address:(G=(ie=e.positionInfo)==null?void 0:ie.token_b)==null?void 0:G.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),n("div",st,[n("div",null,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:Y(bo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},F((q=($=e.positionInfo)==null?void 0:$.name)==null?void 0:q.split("|")[1]),9,lt),(w(),S("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[1]||(t[1]=ge=>e.indexStore.copy(e.positionInfo.nftHash))},ut))]),e.positionInfo.fee?(w(),S("div",dt,F(e.positionInfo.fee*100)+"%",1)):de("",!0)])]),se(m,{"current-status":(M=e.positionInfo)==null?void 0:M.currentStatus},null,8,["current-status"])]),n("div",ct,[n("div",mt,[n("div",vt,[n("div",ft,[n("div",null,[pt,n("div",ht,[n("div",{onClick:t[2]||(t[2]=ge=>e.direct=!e.direct)},gt)])]),(e.needReverse?!e.direct:e.direct)?(w(),S("div",_t,[ve(F(("addCommom"in e?e.addCommom:Y(J))(("decimalUi"in e?e.decimalUi:Y(be))(e.positionInfo.currentPrice,6)))+"   ",1),n("span",null,F((E=e.toCoin)==null?void 0:E.symbol)+" per "+F((ne=e.fromCoin)==null?void 0:ne.symbol),1)])):(w(),S("div",wt,[ve(F(("addCommom"in e?e.addCommom:Y(J))(("decimalUi"in e?e.decimalUi:Y(be))(e.positionInfo.currentPriceReverse,6)))+"   ",1),n("span",null,F((V=e.fromCoin)==null?void 0:V.symbol)+" per "+F((ae=e.toCoin)==null?void 0:ae.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(w(),S("div",yt,[At,n("div",null,[(e.needReverse?!e.direct:e.direct)?(w(),S("div",It,[ve(F(("addCommom"in e?e.addCommom:Y(J))(("decimalUi"in e?e.decimalUi:Y(be))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(w(),S("div",Ct,[ve(F(((Q=e.positionInfo)==null?void 0:Q.minPrice)!=="0"?("addCommom"in e?e.addCommom:Y(J))(("decimalUi"in e?e.decimalUi:Y(be))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(w(),S("img",$t)):(w(),S("img",St)),(e.needReverse?!e.direct:e.direct)?(w(),S("div",Pt,[ve(F(((ke=e.positionInfo)==null?void 0:ke.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:Y(J))(("decimalUi"in e?e.decimalUi:Y(be))(e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(w(),S("div",Tt,[ve(F(((D=e.positionInfo)==null?void 0:D.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:Y(J))(("decimalUi"in e?e.decimalUi:Y(be))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(w(),S("div",Nt,[(e.needReverse?!e.direct:e.direct)?(w(),S("span",Rt," Position Range ")):(w(),S("span",Ot," Position Range ")),(e.needReverse?!e.direct:e.direct)?(w(),S("div",qt,[ve(F(("addCommom"in e?e.addCommom:Y(J))(("decimalUi"in e?e.decimalUi:Y(be))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(w(),S("div",Lt,[ve(F(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:Y(J))(("decimalUi"in e?e.decimalUi:Y(be))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),n("div",Bt,[e.theme=="default"?(w(),S("img",Mt)):(w(),S("img",Ut))]),(e.needReverse?!e.direct:e.direct)?(w(),S("div",jt,[ve(F(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:Y(J))(("decimalUi"in e?e.decimalUi:Y(be))(e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(w(),S("div",Et,[ve(F(((pe=e.positionInfo)==null?void 0:pe.minPrice)!=="0"?("addCommom"in e?e.addCommom:Y(J))(("decimalUi"in e?e.decimalUi:Y(be))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),ve("   ")]))])),n("div",Dt,[Ft,n("div",Wt,F(e.lever),1)])]),n("div",Ht,[se(o,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse&&e.positionInfo.maxPrice!=="∞"?1/e.positionInfo.maxPrice:e.positionInfo.minPrice,"max-price":e.needReverse&&e.positionInfo.minPrice!=0?1/e.positionInfo.minPrice:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),Xt])])])])}const Xo=Qe(Bn,[["render",Gt],["__scopeId","data-v-39ad5090"]]),zt=Je({components:{TokenWarning:co},setup(e,t){const{t:a}=Ao(),{$notify:s}=tn(),O=Ye(),p=A(()=>O),T=io(),m=A(()=>T),o=L({}),l=L({}),v=L({}),u=A(()=>p.value.chainName),k=A(()=>u.value?to(u.value):{}),X=fo(),te=L(!1),ee=async(d=null)=>{const g=d||o.value,h=m.value.addressLpTokens[g.poolAddress];if(h){const U=await k.value.getTickDataByIndex(h.ticks_handle,Number(g.tick_lower_index)),Z=await k.value.getTickDataByIndex(h.ticks_handle,Number(g.tick_upper_index));let j={};u.value==="Aptos"?j=await k.value.getPosRewardersAmount({poolAddress:I.currentRoute.value.query.address,positionName:I.currentRoute.value.query.token,tickLowerData:U,tickUpperData:Z}):j=await k.value.fetchPosRewardersAmount({poolAddress:g.poolAddress,positionId:g.pos_object_id||g.clmm_position_id,coinTypeA:g.coin_type_a||g.coinTypeA,coinTypeB:g.coin_type_b||g.coinTypeB,rewarderInfo:g.poolInfo.rewarder_infos});const H=[];let K=new b(0);j.forEach((x,ce)=>{var B,ue;const me=(B=m.value.tokensObj[x.coin_address])==null?void 0:B.decimals,Pe=x.amount_owed.toString();let P=new b(Pe).div(Math.pow(10,me)).toString();if(u.value=="Aptos"&&Number(P)>999999999&&(P="0"),g.poolInfo[`rewarder_display${ce+1}`]||Number(P)>0){const _e=m.value.tokensObj[x.coin_address],y=((ue=m.value.RATES[x.coin_address])==null?void 0:ue.price)||0,z=new b(P).mul(y).toString();K=new b(K).plus(z),H.push({...x,..._e,amount:Number(P)>0?$e(P,me):0,amountUSD:Number(z)>0?$e(z,2):0,amountUSDText:z})}}),C.value=H}};we(()=>[m.value.currentPositionInfo,u.value],([d,g])=>{var h;g=="Aptos"&&d?(o.value=d,l.value=d==null?void 0:d.token_a,v.value=d==null?void 0:d.token_b):g=="Sui"&&d&&(d==null?void 0:d.nftHash)==((h=X==null?void 0:X.query)==null?void 0:h.pos)&&(o.value=d,l.value=d==null?void 0:d.token_a,v.value=d==null?void 0:d.token_b,te.value=!1)},{immediate:!0}),we(()=>[o.value,m.value.addressLpTokens],([d,g])=>{!fe(d)&&!fe(g)&&ee(d)},{immediate:!0});const oe=A(()=>{var d,g,h,U,Z,j,H,K;if(o.value&&!fe(o.value)&&m.value.RATES){const x=o.value.amountA*((g=m.value.RATES[(d=o.value)==null?void 0:d.token_a.address])==null?void 0:g.price),ce=o.value.amountB*((U=m.value.RATES[(h=o.value)==null?void 0:h.token_b.address])==null?void 0:U.price);if((j=m.value.RATES[(Z=o.value)==null?void 0:Z.token_a.address])!=null&&j.price&&((K=m.value.RATES[(H=o.value)==null?void 0:H.token_b.address])!=null&&K.price)){const me=Number(x+ce);return me>0&&me<.01?"<0.01":J(Me(x+ce,2),2)}else return" --"}else return" --"}),r=A(()=>{var d,g;return(g=(d=o.value)==null?void 0:d.poolInfo)==null?void 0:g.needReverse}),f=A(()=>m.value.RATES),N=A(()=>{var d,g;if(f.value&&l.value&&v.value&&!fe(f.value)&&!fe(l.value)&&!fe(v.value)){const h=[],U=Number(o.value.feeOwedA)||0,Z=Number(o.value.feeOwedB)||0,j=new b(U).mul(((d=f.value[l.value.address])==null?void 0:d.price)||0),H=new b(Z).mul(((g=f.value[v.value.address])==null?void 0:g.price)||0);return h.push({amount:U,amountUSD:j.toString()},{amount:Z,amountUSD:H.toString()}),h}return[]}),i=A(()=>{var g,h;let d=new b(0);return(g=N.value)==null||g.forEach(U=>{d=d.add(new b(U.amountUSD))}),u.value=="Sui"&&((h=C.value)==null||h.forEach(U=>{d=d.add(new b(U.amountUSDText))})),d.toNumber()}),_=A(()=>{var g;let d=new b(0);return(g=C.value)==null||g.forEach(h=>{d=d.add(new b(h.amountUSDText))}),d.toNumber()}),I=ro(),C=L([]),{setIsShowSuccess:c,setIsShowRejected:ie,setIsShowWaiting:G,setTransactionDesc:re,setTransactionTxid:W}=O,$=lo(),q=A(()=>$),M=async()=>{te.value=!0;let d={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:C.value.length,collect_fee:!0};d.coinTypeC=C.value[0]?C.value[0].coin_address:"",d.coinTypeD=C.value[1]?C.value[1].coin_address:"",d.coinTypeE=C.value[2]?C.value[2].coin_address:"",G(!0),re();try{let g;if(u.value==="Aptos"){const h=await k.value.getCollectRewarderTransactionPayload(d);g=await q.value.currentWallet.signAndSubmitTransaction(h)}else{d.pos_index=o.value.pos_object_id;const h=await k.value.getCollectRewarderTransactionPayload(d,o.value),U=await q.value.currentWallet.signAndExecuteTransactionBlock(h);g=k.value.handleTx(U)}if(g&&g.hash){W(g.hash),G(!1),c(!0);const h={title:"Claim",desc:"",hash:g.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};u.value!=="Aptos"&&(h.res=g.res),k.value.showTransitionPending(h),await k.value.watchTransaction(h)&&t.emit("getDetails")}else G(!1),ie(!0),te.value=!1}catch{G(!1),ie(!0),te.value=!1}},E=L(!1),ne=async()=>{E.value=!0;const d=C.value;let g={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:d.length};g.coinTypeC=d[0]?d[0].coin_address:"",g.coinTypeD=d[1]?d[1].coin_address:"",g.coinTypeE=d[2]?d[2].coin_address:"";try{let h;if(u.value==="Aptos"){const U=await k.value.getCollectRewarderTransactionPayload(g);h=await q.value.currentWallet.signAndSubmitTransaction(U)}else{g.pos_index=o.value.pos_object_id;const U=await k.value.getCollectRewarderTransactionPayload(g),Z=await q.value.currentWallet.signAndExecuteTransactionBlock(U);h=k.value.handleTx(Z)}if(h&&h.hash){W(h.hash),G(!1),c(!0);const U=d[0].amount+d[0].symbol,Z=g.coinTypeD?" and "+d[1].amount+d[1].symbol:"",j=g.coinTypeE?" and "+d[2].amount+d[2].symbol:"",H={title:"Claim",desc:"",hash:h.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:d[0].address,numa:`+ ${Number(d[0].amount)}`,logoa:m.value.tokensObj&&d[0]&&d[0].address&&m.value.tokensObj[d[0].address]&&m.value.tokensObj[d[0].address].logoURI,tokenb:d[1]&&d[1].address,numb:g.coinTypeD?`+ ${Number(d[1].amount)}`:"",logob:g.coinTypeD?m.value.tokensObj&&d[1]&&d[1].address&&m.value.tokensObj[d[1].address]&&m.value.tokensObj[d[1].address].logoURI:"",tokenc:d[2]&&d[2].address,numc:g.coinTypeE?`+ ${Number(d[2].amount)}`:"",logoc:g.coinTypeE?m.value.tokensObj&&d[2]&&d[2].address&&m.value.tokensObj[d[2].address]&&m.value.tokensObj[d[2].address].logoURI:""},text:U+Z+j};u.value!=="Aptos"&&(H.res=h.res),k.value.showTransitionPending(H),await k.value.watchTransaction(H)&&setTimeout(()=>{t.emit("getDetails"),k.value.getAccount(q.value.address)},3e3)}else G(!1),ie(!0);E.value=!1}catch{E.value=!1,G(!1),ie(!0)}},V=A(()=>m.value.positionDetailCurrentTab),ae=A(()=>{var h,U,Z,j,H,K;const d=be(r.value?(U=o.value)==null?void 0:U.amountB:(h=o.value)==null?void 0:h.amountA,r.value?(K=(H=o.value)==null?void 0:H.token_b)==null?void 0:K.decimals:(j=(Z=o.value)==null?void 0:Z.token_a)==null?void 0:j.decimals),g=r.value?m.value.positionActionAmount.toCoinAmount||0:m.value.positionActionAmount.fromCoinAmount||0;if(V.value=="increase")return g?new b(d).add(new b(g)).toString():"";if(g){const x=new b(d).minus(new b(g)).toString();return x<0?"0":String(x)}else return""}),Q=A(()=>{var h,U,Z,j,H,K;const d=be(r.value?(U=o.value)==null?void 0:U.amountA:(h=o.value)==null?void 0:h.amountB,r.value?(K=(H=o.value)==null?void 0:H.token_a)==null?void 0:K.decimals:(j=(Z=o.value)==null?void 0:Z.token_b)==null?void 0:j.decimals),g=r.value?m.value.positionActionAmount.fromCoinAmount||0:m.value.positionActionAmount.toCoinAmount||0;if(V.value=="increase")return g?new b(d).add(new b(g)).toString():"";if(g){const x=new b(d).minus(new b(g)).toString();return x<0?"0":String(x)}else return""}),ke=A(()=>r.value?m.value.positionActionAmount.toCoinAmount:m.value.positionActionAmount.fromCoinAmount),D=A(()=>r.value?m.value.positionActionAmount.fromCoinAmount:m.value.positionActionAmount.toCoinAmount),pe=d=>{var g;return(d==null?void 0:d.logoURI)||(d==null?void 0:d.logo_url)||((g=m.value.tokensObj[d==null?void 0:d.address])==null?void 0:g.logo_url)||(p.value.theme==="default"?no("/image/coins/unknown.png"):no("/image/coins/sui-unknown.png"))},ge=A(()=>{var j,H,K,x,ce,me,Pe,P,B,ue,_e,y;const{fromCoinAmount:d,toCoinAmount:g}=m.value.positionActionAmount,h=m.value.positionDetailCurrentTab,U=be(r.value?(H=o.value)==null?void 0:H.amountB:(j=o.value)==null?void 0:j.amountA,r.value?(me=(ce=o.value)==null?void 0:ce.token_b)==null?void 0:me.decimals:(x=(K=o.value)==null?void 0:K.token_a)==null?void 0:x.decimals),Z=be(r.value?(P=o.value)==null?void 0:P.amountA:(Pe=o.value)==null?void 0:Pe.amountB,r.value?(y=(_e=o.value)==null?void 0:_e.token_a)==null?void 0:y.decimals:(ue=(B=o.value)==null?void 0:B.token_b)==null?void 0:ue.decimals);return u.value=="Sui"||h=="remove"&&u.value=="Aptos"&&d==U&&g==Z}),je=async()=>{te.value=!0;const d=J(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${$e(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,g=J(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${$e(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;re(a("newAdd.claimWaitingText",{from:r.value?g:d,and:J(o.value.feeOwedA,o.value.token_a.decimals)==0||J(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:r.value?d:g})),G(!0);let h;const U={pool:o.value.poolInfo,position:o.value};try{const Z=await k.value.getCollectFeeTransactionPayload(U);if(u.value==="Aptos")h=await q.value.currentWallet.signAndSubmitTransaction(Z);else{const j=await q.value.currentWallet.signAndExecuteTransactionBlock(Z);h=k.value.handleTx(j)}if(h){W(h.hash),G(!1),c(!0);const j={title:"Claim",desc:"",hash:h.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:J(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${$e(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:J(o.value.feeOwedA,o.value.token_a.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_a.address&&m.value.tokensObj[o.value.token_a.address]&&m.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:J(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${$e(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:J(o.value.feeOwedB,o.value.token_b.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_b.address&&m.value.tokensObj[o.value.token_b.address]&&m.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${J(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${$e(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${J(o.value.feeOwedA,o.value.token_a.decimals)==0||J(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${J(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${$e(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};u.value!=="Aptos"&&(j.res=h.res),k.value.showTransitionPending(j),await k.value.watchTransaction(j)&&setTimeout(()=>{t.emit("getDetails")},1e3)}else G(!1),ie(!0),s.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:So.global.t("newAdd.claimFailed")},null)]),description:a("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});te.value=!1}catch{te.value=!1,G(!1),ie(!0),s.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:So.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:a("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},Be=Xe(an,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0});return{amountUSD:oe,needReverse:r,decimalUi:be,pendingFees:N,positionInfo:o,pendingRewarderArr:C,pendingYieldAmount:i,toClaim:je,claimAll:M,fromCoin:l,toCoin:v,showNum:$e,claimLoading:te,addCommom:J,afterBase:ae,afterQuote:Q,fromCoinAmount:ke,toCoinAmount:D,checkNullObj:fe,getCoinIcon:pe,chainName:u,isShowAfterAmount:ge,pendingRewarderAmount:_,toClaimRewards:ne,rewarderLoading:E,indicator:Be}}});const Yt={class:"liquidity-card"},Jt={class:"liquidity-title"},Qt={class:"liquidity-usd"},Kt=n("span",null,"Liquidity",-1),Zt={class:"liquidity-ratio"},Vt={class:"coin-ratio"},xt={class:"coin-a-ratio"},ei={class:"coin-b-ratio"},oi={class:"ratio-progress"},ni={class:"base-quote-num"},ti={class:"base-coin-num"},ii=n("span",null,"Base",-1),ai={alt:""},si={key:0,class:"after"},li={class:"quote-coin-num"},ri=n("span",null,"Quote",-1),ui={alt:""},di={key:0,class:"after"},ci={class:"pending-yield"},mi={class:"left"},vi={class:"pending-yield-title"},fi={key:0,class:"after"},pi={class:"right"},hi={class:"fees-rewards"},bi={class:"fees-rewards-item"},ki=n("span",null,"Fees",-1),gi={key:0,class:"after"},_i=n("span",null,"Fees",-1),wi={key:0,class:"after"},yi=n("span",null,"Mining Rewards",-1),Ai={style:{"margin-top":"5px"}},Ii={alt:""},Ci=n("span",null,"Mining Rewards",-1),$i={alt:""},Si={key:0,class:"after"},Pi={key:0,class:"pending-yield"},Ti={class:"left"},Ni=n("div",{class:"pending-yield-title"},"Pending rewards",-1),Ri={key:0,class:"after"},Oi={class:"right"},qi={key:1,class:"fees-rewards"},Li={class:"fees-rewards-item"},Bi=n("span",null,"Mining Rewards",-1),Mi={alt:""},Ui={key:0,class:"after"};function ji(e,t,a,s,O,p){var v,u,k,X,te,ee,oe,r,f,N,i,_,I,C,c,ie,G,re,W,$,q,M,E,ne,V,ae,Q,ke,D,pe,ge,je,Be,d,g,h,U,Z,j,H,K,x,ce,me,Pe,P,B,ue,_e,y,z,R,le,he,Ce,Te,Ae,Ne,Ee,De,ze,Re,Ue,Fe,We,Ke,Ie;const T=co,m=uo,o=sn,l=yo("image");return w(),S("div",Yt,[n("div",Jt,[n("div",Qt,[Kt,n("div",null,"$"+F(e.amountUSD),1)]),n("div",Zt,[n("div",Vt,[n("div",xt,[n("span",null,F(e.needReverse?(u=e.toCoin)==null?void 0:u.symbol:(v=e.fromCoin)==null?void 0:v.symbol),1),ve(" "+F(e.needReverse?(X=e.positionInfo)==null?void 0:X.toPercent:(k=e.positionInfo)==null?void 0:k.fromPercent)+"% ",1)]),n("div",ei,[n("span",null,F(e.needReverse?(ee=e.fromCoin)==null?void 0:ee.symbol:(te=e.toCoin)==null?void 0:te.symbol),1),ve(" "+F(e.needReverse?(r=e.positionInfo)==null?void 0:r.fromPercent:(oe=e.positionInfo)==null?void 0:oe.toPercent)+"% ",1)])]),n("div",oi,[n("div",{class:"from-percent",style:Po({width:e.needReverse?((N=e.positionInfo)==null?void 0:N.toPercent)+"%":((f=e.positionInfo)==null?void 0:f.fromPercent)+"%"})},null,4),n("div",{class:"to-percent",style:Po({width:e.needReverse?((_=e.positionInfo)==null?void 0:_.fromPercent)+"%":((i=e.positionInfo)==null?void 0:i.toPercent)+"%"})},null,4)])])]),n("div",ni,[n("div",ti,[ii,n("div",null,[Se(n("img",ai,null,512),[[l,(e.needReverse?(C=e.toCoin)==null?void 0:C.logo_url:(I=e.fromCoin)==null?void 0:I.logo_url)||e.getCoinIcon(e.needReverse?(ie=e.positionInfo)==null?void 0:ie.token_b:(c=e.positionInfo)==null?void 0:c.token_a)]]),se(T,{address:e.needReverse?($=(W=e.positionInfo)==null?void 0:W.token_b)==null?void 0:$.address:(re=(G=e.positionInfo)==null?void 0:G.token_a)==null?void 0:re.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(("addCommom"in e?e.addCommom:Y(J))(("decimalUi"in e?e.decimalUi:Y(be))(e.needReverse?(M=e.positionInfo)==null?void 0:M.amountB:(q=e.positionInfo)==null?void 0:q.amountA,e.needReverse?(ae=(V=e.positionInfo)==null?void 0:V.token_b)==null?void 0:ae.decimals:(ne=(E=e.positionInfo)==null?void 0:E.token_a)==null?void 0:ne.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:Y(fe))(e.positionInfo)?(w(),S("div",si,F(("addCommom"in e?e.addCommom:Y(J))(e.afterBase))+" after ",1)):de("",!0)]),n("div",li,[ri,n("div",null,[Se(n("img",ui,null,512),[[l,(e.needReverse?(ke=e.fromCoin)==null?void 0:ke.logo_url:(Q=e.toCoin)==null?void 0:Q.logo_url)||e.getCoinIcon(e.needReverse?(pe=e.positionInfo)==null?void 0:pe.token_a:(D=e.positionInfo)==null?void 0:D.token_b)]]),se(T,{address:e.needReverse?(d=(Be=e.positionInfo)==null?void 0:Be.token_a)==null?void 0:d.address:(je=(ge=e.positionInfo)==null?void 0:ge.token_b)==null?void 0:je.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(("addCommom"in e?e.addCommom:Y(J))(("decimalUi"in e?e.decimalUi:Y(be))(e.needReverse?(h=e.positionInfo)==null?void 0:h.amountA:(g=e.positionInfo)==null?void 0:g.amountB,e.needReverse?(H=(j=e.positionInfo)==null?void 0:j.token_a)==null?void 0:H.decimals:(Z=(U=e.positionInfo)==null?void 0:U.token_b)==null?void 0:Z.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:Y(fe))(e.positionInfo)?(w(),S("div",di,F(("addCommom"in e?e.addCommom:Y(J))(e.afterQuote))+" after ",1)):de("",!0)])]),n("div",ci,[n("div",mi,[n("div",vi,F(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),n("div",null,[ve(" $"+F(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:Y(J))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(w(),S("span",fi,"$0 after")):de("",!0)])]),n("div",pi,[se(m,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.pendingYieldAmount==0,onClick:t[0]||(t[0]=ye=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Le(()=>[ve("Claim")]),_:1},8,["loading","disabled"])])]),n("div",hi,[n("div",bi,[n("div",null,[ki,n("div",null,[Se(n("img",null,null,512),[[l,(e.needReverse?(x=e.toCoin)==null?void 0:x.logo_url:(K=e.fromCoin)==null?void 0:K.logo_url)||e.getCoinIcon(e.needReverse?(me=e.positionInfo)==null?void 0:me.token_b:(ce=e.positionInfo)==null?void 0:ce.token_a)]]),se(T,{address:e.needReverse?(ue=(B=e.positionInfo)==null?void 0:B.token_b)==null?void 0:ue.address:(P=(Pe=e.positionInfo)==null?void 0:Pe.token_a)==null?void 0:P.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(e.needReverse?("showNum"in e?e.showNum:Y($e))(e.positionInfo.feeOwedB,(R=(z=e.positionInfo)==null?void 0:z.token_b)==null?void 0:R.decimals):("showNum"in e?e.showNum:Y($e))(e.positionInfo.feeOwedA,(y=(_e=e.positionInfo)==null?void 0:_e.token_a)==null?void 0:y.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Y(fe))(e.positionInfo)&&e.isShowAfterAmount?(w(),S("div",gi," 0 after ")):de("",!0)]),n("div",null,[_i,n("div",null,[Se(n("img",null,null,512),[[l,(e.needReverse?(he=e.fromCoin)==null?void 0:he.logo_url:(le=e.toCoin)==null?void 0:le.logo_url)||e.getCoinIcon(e.needReverse?(Te=e.positionInfo)==null?void 0:Te.token_a:(Ce=e.positionInfo)==null?void 0:Ce.token_b)]]),se(T,{address:e.needReverse?(De=(Ee=e.positionInfo)==null?void 0:Ee.token_a)==null?void 0:De.address:(Ne=(Ae=e.positionInfo)==null?void 0:Ae.token_b)==null?void 0:Ne.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(e.needReverse?("showNum"in e?e.showNum:Y($e))(e.positionInfo.feeOwedA,(Fe=(Ue=e.positionInfo)==null?void 0:Ue.token_a)==null?void 0:Fe.decimals):("showNum"in e?e.showNum:Y($e))(e.positionInfo.feeOwedB,(Re=(ze=e.positionInfo)==null?void 0:ze.token_b)==null?void 0:Re.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Y(fe))(e.positionInfo)&&e.isShowAfterAmount?(w(),S("div",wi," 0 after ")):de("",!0)]),e.chainName=="Sui"?(w(),S(Ve,{key:0},[e.pendingRewarderArr.length==0&&((Ie=(Ke=(We=e.positionInfo)==null?void 0:We.poolInfo)==null?void 0:Ke.rewarderInfo)==null?void 0:Ie.length)>0?(w(!0),S(Ve,{key:0},oo(e.positionInfo.poolInfo.rewarderInfo,ye=>(w(),S("div",{key:ye.coinAddress},[yi,n("div",Ai,[Se(n("img",Ii,null,512),[[l,e.getCoinIcon({address:ye.coinAddress})]]),se(T,{address:ye.coinAddress,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),se(o,{class:"upgrade-text-skeleton",loading:!0,active:"",paragraph:!1})])]))),128)):de("",!0),(w(!0),S(Ve,null,oo(e.pendingRewarderArr,ye=>(w(),S("div",{key:ye},[Ci,n("div",null,[Se(n("img",$i,null,512),[[l,ye.logo_url]]),se(T,{address:ye.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(ye.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Y(fe))(e.positionInfo)&&e.isShowAfterAmount?(w(),S("div",Si," 0 after ")):de("",!0)]))),128))],64)):de("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(w(),S("div",Pi,[n("div",Ti,[Ni,n("div",null,[ve(" $"+F(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:Y(J))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(w(),S("span",Ri,"$0 after")):de("",!0)])]),n("div",Oi,[se(m,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Le(()=>[ve("Claim")]),_:1},8,["loading","disabled","onClick"])])])):de("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(w(),S("div",qi,[n("div",Li,[(w(!0),S(Ve,null,oo(e.pendingRewarderArr,ye=>(w(),S("div",{key:ye},[Bi,n("div",null,[Se(n("img",Mi,null,512),[[l,ye.logo_url]]),se(T,{address:ye.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(ye.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Y(fe))(e.positionInfo)&&e.isShowAfterAmount?(w(),S("div",Ui," 0 after ")):de("",!0)]))),128))])])):de("",!0)])}const Go=Qe(zt,[["render",ji]]),Ei=Je({components:{AssetsCard:po},setup(e,t){const a=L(""),s=L(""),O=Ye(),p=A(()=>O),T=A(()=>p.value.theme),m=io(),o=A(()=>m),l=L(!1),v=L(!1),u=L(!0),k=A(()=>p.value.chainName),X=A(()=>k.value?to(k.value):{}),te=lo(),ee=A(()=>te),oe=A(()=>p.value.slippage),r=L(),f=L(),N=A(()=>ee.value.assets&&r.value&&ee.value.assets[r.value.address]?Co(ee.value.assets[r.value.address].balance,r.value.decimals):0),i=A(()=>ee.value.assets&&f.value&&ee.value.assets[f.value.address]?Co(ee.value.assets[f.value.address].balance,f.value.decimals):0),_=h=>{h==="fromCoin"?(u.value=!0,k.value==="Aptos"?a.value=N.value>0?r.value.symbol=="APT"?new b(Number(N.value)).sub(new b(.1)).lt(new b(0))?"0":new b(Number(N.value)).sub(new b(.1)).toString():String(N.value):"":a.value=N.value>0?r.value.symbol=="SUI"?new b(Number(N.value)).sub(new b(.05)).lt(new b(0))?"0":new b(Number(N.value)).sub(new b(.05)).toString():String(N.value):""):(u.value=!1,k.value==="Aptos"?s.value=i.value>0?f.value.symbol=="APT"?new b(Number(i.value)).sub(new b(.1)).lt(new b(0))?"0":new b(Number(i.value)).sub(new b(.1)).toString():String(i.value):"":s.value=i.value>0?f.value.symbol=="SUI"?new b(Number(i.value)).sub(new b(.05)).lt(new b(0))?"0":new b(Number(i.value)).sub(new b(.05)).toString():String(i.value):"")},I=h=>{h==="fromCoin"?(u.value=!0,a.value=Me(new b(Number(N.value)).div(2).toString(),r.value.decimals).toString()):(u.value=!1,s.value=Me(new b(Number(i.value)).div(2).toString(),f.value.decimals).toString())},C=L({}),c=L(!0),ie=L({}),G=L(),re=L(),W=()=>{var B;if(!C.value||!a.value&&!s.value)return;const{TickMath:h,TickUtil:U}=X.value;let Z=C.value.minPrice,j=C.value.maxPrice.indexOf("+")>0?"∞":C.value.maxPrice,H=Number(C.value.tick_lower_index),K=Number(C.value.tick_upper_index);const x=Number(C.value.current_tick_index);let ce,me,Pe=Number(Z).toString(),P=C.value.maxPrice.indexOf("+")>0||C.value.maxPrice==="∞"?"∞":Number(j);if(Pe=="0"&&P=="∞"?(H=Number(C.value.tick_lower_index),K=Number(C.value.tick_upper_index)):(ce=h.priceToSqrtPriceX64(new b(Z),r.value.decimals,f.value.decimals),me=h.priceToSqrtPriceX64(new b(j),r.value.decimals,f.value.decimals)),G.value=H,re.value=K,j!=="∞"&&H>=K){l.value=!0,a.value="",v.value=!0,s.value="";return}if(j=="∞"||x>=H&&x<=K){l.value=!1,v.value=!1;let ue;if(a.value||s.value){if(u.value){const he=new b(a.value).mul(Math.pow(10,r.value.decimals)).toString();ue=new Oe(he)}else{const he=new b(s.value).mul(Math.pow(10,f.value.decimals)).toString();ue=new Oe(he)}const{liquidityAmount:_e,tokenMaxA:y,tokenMaxB:z,tokenMaxAOrigin:R,tokenMaxBOrigin:le}=X.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:r.value,tokenB:f.value,lowerTick:H,upperTick:K,coinAmount:ue,iscoinA:c.value?u.value:!u.value,roundUp:!0,slippage:Number(oe.value)/100,curSqrtPrice:new Oe(C.value.current_sqrt_price)});ie.value={liquidityAmount:_e,tokenMaxA:y,tokenMaxB:z,tokenMaxAOrigin:R,tokenMaxBOrigin:le},c.value?u.value?s.value=Number(z)>0?z:"":a.value=Number(y)>0?y:"":u.value?s.value=y:a.value=z}}else if(x>K){if(a.value="",l.value=!0,v.value=!1,a.value||s.value){let ue;const _e=new b(s.value).mul(Math.pow(10,(B=f.value)==null?void 0:B.decimals)).toString();ue=new Oe(_e),ie.value={liquidityAmount:qo(ce,me,ue),tokenMaxA:0,tokenMaxB:s.value}}}else if(x<H){if(l.value=!1,v.value=!0,s.value="",a.value||s.value){let ue;const _e=new b(a.value).mul(Math.pow(10,r.value.decimals)).toString();ue=new Oe(_e),ie.value={liquidityAmount:Lo(ce,me,ue),tokenMaxA:a.value,tokenMaxB:0}}}else l.value=!0,a.value="",v.value=!0,s.value="";m.setPositionActionAmount({fromCoinAmount:a,toCoinAmount:s})};we(()=>o.value.currentPositionInfo,h=>{if(h&&!fe(h)){C.value=h,r.value=C.value.token_a,f.value=C.value.token_b;let U=Number(C.value.tick_lower_index),Z=Number(C.value.tick_upper_index);const j=Number(C.value.current_tick_index);(h.maxPrice.indexOf("+")>0||h.maxPrice==="∞"?"∞":h.maxPrice)=="∞"||j>=U&&j<=Z?(l.value=!1,v.value=!1):j>Z?(a.value="",l.value=!0,v.value=!1):j<U?(l.value=!1,v.value=!0,s.value=""):(l.value=!0,a.value="",v.value=!0,s.value=""),W()}},{immediate:!0}),we(a,(h,U)=>{h&&W(),h==""&&(s.value="")}),we(s,(h,U)=>{h&&W(),h==""&&(a.value="")});const $=A(()=>{var h,U;return(U=(h=C.value)==null?void 0:h.poolInfo)==null?void 0:U.needReverse}),q=A(()=>o.value.RATES),M=A(()=>{var K,x,ce,me;const h=((x=q.value[(K=r.value)==null?void 0:K.address])==null?void 0:x.price)||0,U=((me=q.value[(ce=f.value)==null?void 0:ce.address])==null?void 0:me.price)||0,Z=new b(h).mul(new b(a.value||0)),j=new b(U).mul(new b(s.value||0)),H=Z.add(j);return H.toNumber()?H.toNumber()>0&&H.toNumber()>.01?J(H.toString(),2):"<0.01":"--"}),E=L(!1),{t:ne,locale:V}=Ao(),ae=A(()=>{const h=Number(a.value)>Number(N.value),U=Number(s.value)>Number(i.value);return!a.value&&!s.value?ne("button.enterAmount"):h?ne("button.insufficientBalance",{name:r.value.symbol}):U?ne("button.insufficientBalance",{name:f.value.symbol}):ne("newAdd.addMore")}),Q=A(()=>{const h=Number(a.value)>Number(N.value),U=Number(s.value)>Number(i.value);return!!(!a.value&&!s.value||h||U)}),{setIsShowSuccess:ke,setIsShowRejected:D,setIsShowWaiting:pe,setTransactionDesc:ge,setTransactionTxid:je,setPositiomNum:Be}=O,d=L(!1);return{theme:T,showFromCoinLock:l,showToCoinLock:v,toCoinAmount:s,fromCoinAmount:a,fromCoinBlance:N,toCoinBlance:i,fromCoin:r,toCoin:f,maxBtnSelect:_,halfBtnSelect:I,fixedFromCoin:u,needReverse:$,totalAmount:M,wallet:ee,addLiquidityBtnText:ae,isShowLiquidityModal:E,indexStore:O,positionInfo:C,actionLoading:d,toAdd:async()=>{var K,x,ce,me,Pe,P,B,ue,_e,y;E.value=!1,d.value=!0,je("");const h=l.value?"":`${a.value} ${(K=r.value)==null?void 0:K.symbol}`,U=v.value?"":`${s.value} ${(x=f.value)==null?void 0:x.symbol}`;ge(ne("tips.increaseLiquiditySuccess",{from:$.value?U:h,and:!l.value&&!v.value?"and":"",to:$.value?h:U})),pe(!0);const Z=u.value,j=C.value.poolInfo.rewarder_infos;let H={};H.coinTypeC=j[0]?j[0].coinAddress:"",H.coinTypeD=j[1]?j[1].coinAddress:"",H.coinTypeE=j[2]?j[2].coinAddress:"";try{const z=await X.value.getAddLiquidityTransactionPayload({pool:{poolAddress:C.value.poolAddress,token_a:C.value.token_a,token_b:C.value.token_b},amount:Z?ie.value.tokenMaxA:ie.value.tokenMaxB,fix_amount_a:Z,tick_lower:G.value,tick_upper:re.value,index:k.value==="Aptos"?C.value.index:C.value.pos_object_id,slippage:Number(oe.value)/100,roundUp:!0,collect_fee:!0,...H,curSqrtPrice:new Oe(C==null?void 0:C.value.poolInfo.current_sqrt_price),positionInfo:C});let R;if(k.value==="Aptos")R=await ee.value.currentWallet.signAndSubmitTransaction(z);else{const le=await ee.value.currentWallet.signAndExecuteTransactionBlock(z);R=X.value.handleTx(le)}if(R&&R.hash){je(R.hash),pe(!1),ke(!0);const le={title:"Supplied",desc:ne("tips.addLiquiditySuccessText",{from:l.value?"":`${a.value} ${(ce=r.value)==null?void 0:ce.symbol}`,and:!l.value&&!v.value?"and":"",to:v.value?"":`${s.value} ${(me=f.value)==null?void 0:me.symbol}`}),hash:R.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:$.value?`${(P=f.value)==null?void 0:P.address}`:`${(Pe=r.value)==null?void 0:Pe.address}`,numa:$.value?`- ${s.value}`:`- ${a.value}`,logoa:$.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI,tokenb:$.value?`${(ue=r.value)==null?void 0:ue.address}`:`${(B=f.value)==null?void 0:B.address}`,numb:$.value?`- ${a.value}`:`- ${s.value}`,logob:$.value?o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI},text:`Deopsit ${l.value?"":`${a.value} ${(_e=r.value)==null?void 0:_e.symbol}`} ${!l.value&&!v.value?"and":""} ${v.value?"":`${s.value} ${(y=f.value)==null?void 0:y.symbol}`}`};k.value!=="Aptos"&&(le.res=R.res),X.value.showTransitionPending(le),await X.value.watchTransaction(le)&&setTimeout(()=>{t.emit("getDetails"),X.value.getAccount(ee.value.address)},1e3),Be()}else pe(!1),D(!0);a.value="",s.value="",d.value=!1}catch{a.value="",s.value="",d.value=!1,pe(!1),D(!0)}},addLiquidityBtnDisabled:Q,poolStore:m}}});const Di={class:"new-position-asset"},Fi={class:"add-or-remove"},Wi={class:"liquidity-action-tab"},Hi=n("div",{class:"increase tab-active"}," Increase ",-1),Xi={class:"card-item"},Gi={class:"card-item"},zi={key:0,class:"add",src:pn},Yi={key:1,class:"add",src:hn},Ji={class:"total-amount"},Qi=n("span",null,"Total Amount",-1);function Ki(e,t,a,s,O,p){var v;const T=po,m=vn,o=uo,l=fn;return w(),S("div",Di,[n("div",Fi,[n("div",Wi,[Hi,n("div",{class:"remove",onClick:t[0]||(t[0]=u=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),n("div",{class:ko(e.needReverse?"card-container reverse":"card-container")},[n("div",Xi,[se(T,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=u=>e.fromCoinAmount=u),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[2]||(t[2]=u=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=u=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=u=>{e.fromCoinAmount=u}),onOnFocus:t[5]||(t[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(w(),qe(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):de("",!0)]),n("div",Gi,[se(T,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[6]||(t[6]=u=>e.toCoinAmount=u),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[7]||(t[7]=u=>e.maxBtnSelect("toCoin")),onOnHalf:t[8]||(t[8]=u=>e.halfBtnSelect("toCoin")),onOnInput:t[9]||(t[9]=u=>{e.toCoinAmount=u}),onOnFocus:t[10]||(t[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(w(),qe(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):de("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(w(),S("img",zi)):de("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(w(),S("img",Yi)):de("",!0)],2),n("div",Ji,[Qi,n("span",null,"$"+F(e.totalAmount),1)])]),e.wallet.connected?(w(),qe(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:t[11]||(t[11]=u=>e.isShowLiquidityModal=!0)},{default:Le(()=>[n("span",null,F(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(w(),qe(o,{key:1,class:"big-btn",onClick:t[12]||(t[12]=u=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,F(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(w(),qe(l,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(v=e.positionInfo)==null?void 0:v.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:t[13]||(t[13]=u=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):de("",!0)])}const wo=Qe(Ei,[["render",Ki]]),Zi=Je({components:{AssetsCard:po},setup(e,t){const a=L(""),s=L(""),O=Ye(),p=A(()=>O),T=A(()=>p.value.theme),m=io(),o=A(()=>m),l=L(!1),v=L(!1),u=L(!0),k=A(()=>p.value.chainName),X=A(()=>k.value?to(k.value):{}),te=lo(),ee=A(()=>te),oe=A(()=>p.value.slippage),r=L(),f=L(),N=A(()=>{var y,z;return(z=(y=c.value)==null?void 0:y.poolInfo)==null?void 0:z.needReverse}),i=A(()=>{var y;return be(c==null?void 0:c.value.amountA,(y=c==null?void 0:c.value.token_a)==null?void 0:y.decimals)}),_=A(()=>{var y;return be(c==null?void 0:c.value.amountB,(y=c==null?void 0:c.value.token_b)==null?void 0:y.decimals)}),I=y=>{y==="fromCoin"?u.value=!0:u.value=!1,M.value=100,ne({value:1})},C=y=>{y==="fromCoin"?(u.value=!0,a.value=Me(new b(Number(i.value)).div(2).toString(),r.value.decimals).toString()):(u.value=!1,s.value=Me(new b(Number(_.value)).div(2).toString(),f.value.decimals).toString()),$.value=!1},c=L({}),ie=L(!0),G=L({}),re=L(),W=L(),$=L(!0),q=()=>{var ze;if($.value||!c.value||!a.value&&!s.value||Number(a.value)>Number(i.value)||Number(s.value)>Number(_.value))return;if(a.value==i.value&&s.value==_.value){M.value=100,ne({value:1}),$.value=!0;return}const{TickMath:y,TickUtil:z}=X.value;let R=c.value.minPrice,le=c.value.maxPrice.indexOf("+")>0?"∞":c.value.maxPrice,he=Number(c.value.tick_lower_index),Ce=Number(c.value.tick_upper_index);const Te=Number(c.value.current_tick_index);let Ae,Ne,Ee=Number(R).toString(),De=c.value.maxPrice.indexOf("+")>0||c.value.maxPrice==="∞"?"∞":Number(le);if(Ee=="0"&&De=="∞"?(he=Number(c.value.tick_lower_index),Ce=Number(c.value.tick_upper_index)):(Ae=y.priceToSqrtPriceX64(new b(R),r.value.decimals,f.value.decimals),Ne=y.priceToSqrtPriceX64(new b(le),r.value.decimals,f.value.decimals)),re.value=he,W.value=Ce,le!=="∞"&&he>=Ce){l.value=!0,a.value="",v.value=!0,s.value="";return}if(le=="∞"||Te>=he&&Te<=Ce){l.value=!1,v.value=!1;let Re;if(a.value||s.value){if(u.value){const ye=new b(a.value).mul(Math.pow(10,r.value.decimals)).toString();Re=new Oe(ye)}else{const ye=new b(s.value).mul(Math.pow(10,f.value.decimals)).toString();Re=new Oe(ye)}const{liquidityAmount:Ue,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ke,tokenMaxBOrigin:Ie}=X.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:r.value,tokenB:f.value,lowerTick:he,upperTick:Ce,coinAmount:Re,iscoinA:ie.value?u.value:!u.value,roundUp:k.value!="Sui",slippage:Number(oe.value)/100,curSqrtPrice:new Oe(c.value.current_sqrt_price)});G.value={liquidityAmount:Ue,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ke,tokenMaxBOrigin:Ie},ie.value?u.value?s.value=Number(We)>0?We:"":a.value=Number(Fe)>0?Fe:"":u.value?s.value=Fe:a.value=We}}else if(Te>Ce){if(a.value="",l.value=!0,v.value=!1,a.value||s.value){let Re;const Ue=new b(s.value).mul(Math.pow(10,(ze=f.value)==null?void 0:ze.decimals)).toString();Re=new Oe(Ue),G.value={liquidityAmount:qo(Ae,Ne,Re),tokenMaxA:0,tokenMaxB:s.value}}}else if(Te<he){if(l.value=!1,v.value=!0,s.value="",a.value||s.value){let Re;const Ue=new b(a.value).mul(Math.pow(10,r.value.decimals)).toString();Re=new Oe(Ue),G.value={liquidityAmount:Lo(Ae,Ne,Re),tokenMaxA:a.value,tokenMaxB:0}}}else l.value=!0,v.value=!0;$.value=!1,M.value=new b(G.value.liquidityAmount.toString()).div(c.value.liquidity).mul(100).toNumber().toFixed(2),E.value=G.value.liquidityAmount,m.setPositionActionAmount({fromCoinAmount:a,toCoinAmount:s})},M=L(50),E=L("0"),ne=y=>{if(!$.value)return;$.value=!0;const z=c.value.token_a.decimals,R=c.value.token_b.decimals,le=c.value.tick_lower_index,he=c.value.tick_upper_index,Ce=$o.tickIndexToSqrtPriceX64(le),Te=$o.tickIndexToSqrtPriceX64(he);let Ae="";y.value!==1?Ae=new b(c.value.liquidity).mul(y.value).toString():Ae=c.value.liquidity,Ae=Me(Ae,0)||"0",E.value=Ae;const Ne=Zo.getCoinAmountFromLiquidity(new Oe(Ae),new Oe(c.value.current_sqrt_price),Ce,Te,k.value!="Sui"),Ee=new b(Ne.coinA.toString()).div(Math.pow(10,z)).toString(),De=new b(Ne.coinB.toString()).div(Math.pow(10,R)).toString();a.value=Number(Ee)>0?Ee:"",s.value=Number(De)>0?De:"",m.setPositionActionAmount({fromCoinAmount:a,toCoinAmount:s})};we(()=>o.value.currentPositionInfo,y=>{if(y&&!fe(y)){c.value=y,r.value=c.value.token_a,f.value=c.value.token_b,ne({value:M.value/100});let z=Number(c.value.tick_lower_index),R=Number(c.value.tick_upper_index);const le=Number(c.value.current_tick_index);(y.maxPrice.indexOf("+")>0||y.maxPrice==="∞"?"∞":y.maxPrice)=="∞"||le>=z&&le<=R?(l.value=!1,v.value=!1):le>R?(a.value="",l.value=!0,v.value=!1):le<z?(l.value=!1,v.value=!0,s.value=""):(l.value=!0,a.value="",v.value=!0,s.value=""),q()}},{immediate:!0}),we(a,(y,z)=>{y&&q(),y==""&&(s.value="",M.value=0)}),we(s,(y,z)=>{y&&q(),y==""&&(a.value="",M.value=0)});const V=A(()=>o.value.RATES),ae=A(()=>{var Ce,Te,Ae,Ne;const y=((Te=V.value[(Ce=r.value)==null?void 0:Ce.address])==null?void 0:Te.price)||0,z=((Ne=V.value[(Ae=f.value)==null?void 0:Ae.address])==null?void 0:Ne.price)||0,R=new b(y).mul(new b(a.value||0)),le=new b(z).mul(new b(s.value||0)),he=R.add(le);return J(he.toString(),2)}),Q=L(!1),{t:ke,locale:D}=Ao(),pe=A(()=>{const y=Number(a.value)>Number(i.value),z=Number(s.value)>Number(_.value);return!a.value&&!s.value?ke("button.enterAmount"):y||z?"Invalid Amount":ke("button.remove")}),ge=A(()=>{const y=Number(a.value)>Number(i.value),z=Number(s.value)>Number(_.value);return!!(!a.value&&!s.value||y||z)}),{setIsShowSuccess:je,setIsShowRejected:Be,setIsShowWaiting:d,setTransactionDesc:g,setTransactionTxid:h,setPositiomNum:U,setTransactionDescText:Z}=O,j=L(!1);we(M,ln((y,z)=>{y!==z&&(Number(y)>100?M.value=100:y&&c.value?(M.value=y,ne({value:M.value/100})):(a.value="",s.value=""))},300)),we(oe,y=>{y&&c.value&&ne({value:M.value/100})});const H=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],K=jo(),x=A(()=>K),ce=A(()=>x.value.status),me=L(!1),Pe=y=>{y.sources.forEach(R=>{const{pool_address:le,position_index:he}=JSON.parse(R.blockchainAddress);le==c.value.poolAddress&&Number(he)==Number(c.value.index)&&(me.value=!0)})},P=async()=>{await K.getSources();let y;x.value.allSources.forEach(z=>{const{pool_address:R,position_index:le}=JSON.parse(z.blockchainAddress);R==c.value.poolAddress&&le==c.value.index&&(y=z.id)}),K.deleteSource(y)};we(()=>[x.value.sourceGroups,c.value],([y,z])=>{y&&y.sources&&y.sources.length>0&&z&&!fe(z)&&Pe(y)},{immediate:!0,deep:!0});const B=ro(),ue=fo();return{theme:T,showFromCoinLock:l,showToCoinLock:v,toCoinAmount:s,fromCoinAmount:a,fromCoinBlance:i,toCoinBlance:_,fromCoin:r,toCoin:f,maxBtnSelect:I,halfBtnSelect:C,fixedFromCoin:u,needReverse:N,totalAmount:ae,wallet:ee,addLiquidityBtnText:pe,isShowLiquidityModal:Q,indexStore:O,positionInfo:c,actionLoading:j,addLiquidityBtnDisabled:ge,sliderVal:M,ratioArr:H,setPercent:ne,poolStore:m,isSlider:$,toRemove:async()=>{var he,Ce,Te,Ae,Ne,Ee,De,ze,Re,Ue,Fe,We,Ke;j.value=!0,h("");const y=J(a.value,r.value.decimals)==0?"":`${be(a.value,r.value.decimals)} ${r.value.symbol}`,z=J(s.value,f.value.decimals)==0?"":`${be(s.value,f.value.decimals)} ${f.value.symbol}`;g(ke("tips.removeLiquidiyText",{from:N.value?z:y,and:J(a.value,r.value.decimals)==0||J(s.value,f.value.decimals)==0?"":"and",to:N.value?y:z})),d(!0);const R=c.value.poolInfo.rewarder_infos,le=R&&R.length>0&&k.value=="Sui"||R&&R.length>0&&M.value==100?ke("modal.removeLiquidityText1"):ke("modal.removeLiquidityText2");Z(le);try{let Ie={};Ie={pool:{...c.value.poolInfo,coinA:c.value.token_a,coinB:c.value.token_b},coinTypeA:c.value.poolInfo.coinTypeA,coinTypeB:c.value.poolInfo.coinTypeB,position:c.value,delta_liquidity:M.value==100?new Oe(c.value.liquidity):new Oe(Me(E.value,0)),slippage:Number(oe.value),rewards_num:R.length,positionInfo:c.value},Ie.coinTypeC=R[0]?R[0].coinAddress:"",Ie.coinTypeD=R[1]?R[1].coinAddress:"",Ie.coinTypeE=R[2]?R[2].coinAddress:"";const ye=await X.value.getRemoveLiquidityTransactionPayload(Ie);let He;if(k.value==="Aptos")He=await ee.value.currentWallet.signAndSubmitTransaction(ye);else{const ao=await ee.value.currentWallet.signAndExecuteTransactionBlock(ye);He=X.value.handleTx(ao)}if(He&&He.hash){h(He.hash),d(!1),je(!0);const ao={title:ke("common.removeLiquidity"),desc:"",hash:He.hash,descTransactions:`Remove ${a.value} ${(he=r.value)==null?void 0:he.symbol} and ${s.value} ${(Ce=f.value)==null?void 0:Ce.symbol} 
             from the pool`,sender:ee.value.address,chainName:k.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:N.value?`${(Ae=f.value)==null?void 0:Ae.address}`:`${(Te=r.value)==null?void 0:Te.address}`,numa:N.value?`+ ${s.value}`:`+ ${a.value}`,logoa:N.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI,tokenb:N.value?`${(Ne=r.value)==null?void 0:Ne.address}`:`${(Ee=f.value)==null?void 0:Ee.address}`,numb:N.value?`+ ${a.value}`:`+ ${s.value}`,logob:N.value?o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI},text:`Withdraw ${a.value} ${(De=r.value)==null?void 0:De.symbol} and ${s.value} ${(ze=f.value)==null?void 0:ze.symbol}`};k.value!=="Aptos"&&(ao.res=He.res),X.value.showTransitionPending(ao);const Io=await X.value.watchTransaction(ao);if(R.value&&R.value.length>0&&(Number((Re=R[0])==null?void 0:Re.amount)!==0||Ie.coinTypeD&&Number((Ue=R[1])==null?void 0:Ue.amount)!==0||Ie.coinTypeE&&Number((Fe=R[2])==null?void 0:Fe.amount)!==0)){const ho={title:ke("common.removeLiquidity"),desc:"",hash:He.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:R[0].symbol,numa:`+ ${Number(R[0].amount)}`,logoa:o.value.tokensObj&&R[0]&&R[0].address&&o.value.tokensObj[R[0].address]&&o.value.tokensObj[R[0].address].logoURI,tokenb:Ie.coinTypeD?R[1].symbol:"",numb:Ie.coinTypeD?`+ ${Number(R[1].amount)}`:"",logob:Ie.coinTypeD?o.value.tokensObj&&R[1]&&R[1].address&&o.value.tokensObj[R[1].address]&&o.value.tokensObj[R[1].address].logoURI:"",tokenc:Ie.coinTypeE?R[2].symbol:"",numc:Ie.coinTypeE?`+ ${Number(R[2].amount)}`:"",logoc:Ie.coinTypeE?o.value.tokensObj&&R[2]&&R[2].address&&o.value.tokensObj[R[2].address]&&o.value.tokensObj[R[2].address].logoURI:""},text:`Withdraw ${a.value} ${(We=r.value)==null?void 0:We.symbol} and ${s.value} ${(Ke=f.value)==null?void 0:Ke.symbol}`},Jo=await X.value.setTransations(ho)}if($e(c.value.feeOwedA,c.value.token_a.decimals)!==0||$e(c.value.feeOwedB,c.value.token_b.decimals)!==0){const ho={title:"Claim",desc:"",hash:He.hash,chainName:k.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${c.value.token_a.symbol}`,numa:J(c.value.feeOwedA,c.value.token_a.decimals)==0?"":`+ ${$e(c.value.feeOwedA,c.value.token_a.decimals)}`,logoa:J(c.value.feeOwedA,c.value.token_a.decimals)==0?"":o.value.tokensObj&&c.value&&c.value.token_a.address&&o.value.tokensObj[c.value.token_a.address]&&o.value.tokensObj[c.value.token_a.address].logoURI,tokenb:`${c.value.token_b.symbol}`,numb:J(c.value.feeOwedB,c.value.token_b.decimals)==0?"":`+ ${$e(c.value.feeOwedB,c.value.token_b.decimals)}`,logob:J(c.value.feeOwedB,c.value.token_b.decimals)==0?"":o.value.tokensObj&&c.value&&c.value.token_b.address&&o.value.tokensObj[c.value.token_b.address]&&o.value.tokensObj[c.value.token_b.address].logoURI}},Jo=await X.value.setTransations(ho)}Io&&Number(M.value)==100&&ce.value=="authenticated"&&me.value&&(await K.subscribePosition({pool_address:c.value.poolAddress,position_index:c.value.index},c.value.nftHash,!1),P()),Io&&(a.value="",s.value="",setTimeout(()=>{t.emit("getDetails")},3e3),setTimeout(()=>{t.emit("getDetails")},6e3),Number(M.value)==100&&ue.name=="new-position-detail"&&(k.value==="Aptos"?B.push("/position"):B.push("/pool/position")),M.value=0)}else d(!1),Be(!0);j.value=!1}catch{j.value=!1,d(!1),Be(!0)}},sFixD:Me}}});const Vi={class:"new-position-asset"},xi={class:"add-or-remove"},ea={class:"liquidity-action-tab"},oa=n("div",{class:"remove tab-active"},"Remove",-1),na={class:"card-item"},ta={key:0,class:"assets-card-mask"},ia={class:"card-item"},aa={key:0,class:"assets-card-mask"},sa={class:"remove-ratio"},la=n("div",{class:"remove-ratio-title"},"Amount",-1),ra={class:"remove-ratio-select"},ua={key:0,class:"ratio"},da={key:1,class:"ratio"},ca={class:"ratio-list"},ma=["onClick"];function va(e,t,a,s,O,p){const T=po,m=rn,o=uo;return w(),S("div",Vi,[n("div",xi,[n("div",ea,[n("div",{class:"increase",onClick:t[0]||(t[0]=l=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),oa]),n("div",{class:ko(e.needReverse?"card-container reverse":"card-container")},[n("div",na,[se(T,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=l=>e.fromCoinAmount=l),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[2]||(t[2]=l=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=l=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=l=>{e.fromCoinAmount=l,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(w(),S("div",ta)):de("",!0)]),n("div",ia,[se(T,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[5]||(t[5]=l=>e.toCoinAmount=l),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[6]||(t[6]=l=>e.maxBtnSelect("toCoin")),onOnHalf:t[7]||(t[7]=l=>e.halfBtnSelect("toCoin")),onOnInput:t[8]||(t[8]=l=>{e.toCoinAmount=l,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(w(),S("div",aa)):de("",!0)])],2),n("div",sa,[la,n("div",ra,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(w(),S("div",ua,F(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:Y(Me))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:Y(Me))(e.sliderVal,2))+"% ",1)):(w(),S("div",da," -- ")),n("div",ca,[(w(!0),S(Ve,null,oo(e.ratioArr,(l,v)=>(w(),S("div",{key:v,class:ko(["ratio-item",e.sliderVal==l.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=l.value}},F(l.name),11,ma))),128))])]),se(m,{value:e.sliderVal,"onUpdate:value":t[9]||(t[9]=l=>e.sliderVal=l)},null,8,["value"])])]),e.wallet.connected?(w(),qe(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Le(()=>[n("span",null,F(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(w(),qe(o,{key:1,class:"big-btn",onClick:t[10]||(t[10]=l=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,F(e.$t("button.connectWallet")),1)]),_:1}))])}const fa=Qe(Zi,[["render",va]]),pa=Je({setup(){const e=io(),t=A(()=>e),a=Eo(),s=A(()=>a),O=ro(),p=A(()=>t.value.currentPositionInfo),T=L(),m=W=>{var $;return(($=t.value.tokensObj[W])==null?void 0:$.logo_url)||no("/image/coins/sui-unknown.png")},o=Vo("Sui"),l=L(),v=async W=>{l.value=0;try{const $=await o.calculateFarmingRewards([{pool_id:W.pool_id,position_nft_id:W.id}]),q=[];let M=new b(0);$[W.id].forEach((E,ne)=>{var Q;const V=(Q=t.value.tokensObj[E.rewarder_type])==null?void 0:Q.decimals;let ae=new b(E.rewarder_amount).div(Math.pow(10,V)).toString();Number(ae)>0&&k.value.rewarders[ne]&&(M=M.add(ae),q.push({...E,rewarderAmount:ae,rewarderAmountPer:ae}))}),l.value=M,T.value=q}catch{}},u=A(()=>s.value.farmsPoolObj),k=A(()=>u.value[p.value.poolAddress]);we(()=>[p.value,u.value,k.value],([W,$,q])=>{var M;!fe(W)&&W.positionSource=="farming"&&!fe(q)?v(W):!fe($)&&!fe(W)&&(T.value=(M=$[W.poolAddress])==null?void 0:M.rewarders)},{immediate:!0});const X=lo(),te=A(()=>X),ee=Ye(),oe=to("Sui"),{setIsShowSuccess:r,setIsShowRejected:f,setIsShowWaiting:N,setTransactionDesc:i,setTransactionTxid:_}=ee,I=L(!1),C=async()=>{I.value=!0,_(""),i("Claim rewards"),N(!0);const W={pool_id:p.value.pool_id,position_nft_id:p.value.id};try{const $=await o.harvestFarms(W),q=await te.value.currentWallet.signAndExecuteTransactionBlock($);let M=oe.handleTx(q);if(M&&M.hash){_(M.hash),N(!1),r(!0);let E={title:"Claim",res:M.res,hash:M.hash};oe.showTransitionPending(E),await oe.watchTransaction(E)&&setTimeout(()=>{v(p.value)},2e3)}else N(!1),f(!0);I.value=!1}catch{N(!1),f(!0),I.value=!1}},c=async()=>{I.value=!0,_(""),i(`Unstake ${p.value.name}`),N(!0);const W=p.value.pool_id,$=p.value.id;try{const q=await o.farmsWithdraw(W,$),M=await te.value.currentWallet.signAndExecuteTransactionBlock(q);let E=oe.handleTx(M);if(E&&E.hash){_(E.hash),N(!1),r(!0);let ne={res:E.res,title:"Unstake",hash:E.hash};oe.showTransitionPending(ne),await oe.watchTransaction(ne)&&setTimeout(()=>{O.replace(`/new-position-detail?token=${p.value.tokenName}&address=${p.value.clmm_pool_id}&pos=${p.value.clmm_position_id}`),t.value.setCurrentPositionInfo(p.value.clmm_pool_id,"",p.value.tokenName,"Sui",p.value.clmm_position_id),l.value=0,I.value=!1},2e3)}else N(!1),f(!0)}catch{N(!1),f(!0),I.value=!1}},ie=async()=>{I.value=!0,_(""),i(`Stake ${p.value.name}`),N(!0);const W={clmm_pool_id:p.value.poolAddress,clmm_position_id:p.value.pos_object_id,coinTypeA:p.value.coin_type_a,coinTypeB:p.value.coin_type_b},$=u.value[p.value.poolAddress].id;try{const q=await o.farmsDeposit(W,$),M=await te.value.currentWallet.signAndExecuteTransactionBlock(q);let E=oe.handleTx(M);if(E&&E.hash){_(E.hash),N(!1),r(!0);let ne={res:E.res,title:"Staked",hash:E.hash};oe.showTransitionPending(ne);const V=await oe.watchTransaction(ne);let ae;V&&setTimeout(async()=>{E.res.events.forEach(Q=>{Q.type.indexOf("::pool::DepositEvent")>-1&&(ae=Q.parsedJson.wrapped_position_id)}),O.replace(`/new-position-detail?position_nft_id=${ae}&positionSource=farming`),await t.value.setCurrentPositionInfo("","","","Sui",ae,"farming"),I.value=!1},2e3)}else N(!1),f(!0)}catch{N(!1),f(!0),I.value=!1}},G=A(()=>ee),re=A(()=>G.value.addressLpTokens);return{getCoinIcon:m,rewardList:T,sFixD:Me,addCommom:J,claim:C,unStake:c,loading:I,totalRewardAmount:l,currentPositionInfo:p,stake:ie,farmsPoolObj:u,addressLpTokens:re,farmsPoolInfo:k}}});const xe=e=>(mo("data-v-9b39419a"),e=e(),vo(),e),ha={key:0,class:"farms-position-detail"},ba={class:"farms-top"},ka=xe(()=>n("div",{class:"left"},[n("div",{class:"title"},"Farming"),n("div",{class:"desc"},"Stake Position to Earn")],-1)),ga={class:"right"},_a={class:"apr"},wa={class:"apr-tips-box"},ya=xe(()=>n("span",null,"View",-1)),Aa=xe(()=>n("svg",{class:"arrow-icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_arrow"})],-1)),Ia=[ya,Aa],Ca={class:"farms-bottom"},$a=xe(()=>n("div",{class:"title"},"Farming Rewards",-1)),Sa={key:0,class:"reward-list"},Pa={key:0,class:"rewards-item-bg"},Ta={class:"rewards-item-box"},Na={alt:""},Ra={key:1},Oa={class:"rewards-item-bg"},qa={class:"rewards-item-box"},La={alt:""},Ba=xe(()=>n("span",null,"0",-1)),Ma={key:1,class:"reward-list"},Ua={key:0,class:"rewards-item-bg"},ja={class:"rewards-item-box"},Ea={alt:""},Da=xe(()=>n("span",null,"0",-1)),Fa={key:1},Wa={class:"rewards-item-bg"},Ha={class:"rewards-item-box"},Xa={alt:""},Ga=xe(()=>n("span",null,"0",-1)),za={class:"actions-box"};function Ya(e,t,a,s,O,p){const T=bn,m=uo,o=un,l=yo("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?(w(),S("div",ha,[n("div",ba,[ka,n("div",ga,[n("div",_a,[ve(" APR  "),n("span",null,[ve(F(("addCommom"in e?e.addCommom:Y(J))(e.farmsPoolInfo.total_apr*100,2))+"%  ",1),n("div",wa,[se(T,{"l-item":e.farmsPoolInfo,"rewarder-info":e.farmsPoolInfo.rewarder.rewardList},null,8,["l-item","rewarder-info"])])])]),n("div",{class:"view",onClick:t[0]||(t[0]=v=>e.$router.push("/farms"))},Ia)])]),n("div",Ca,[$a,e.rewardList&&e.rewardList.length>0?(w(),S("div",Sa,[(w(!0),S(Ve,null,oo(e.rewardList,v=>(w(),S("div",{key:v,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(w(),S("div",Pa,[n("div",Ta,[Se(n("img",Na,null,512),[[l,e.getCoinIcon(v.rewarder_type)]]),n("span",null,F(("addCommom"in e?e.addCommom:Y(J))(v.rewarderAmount||0)),1)])])):(w(),S("div",Ra,[n("div",Oa,[n("div",qa,[Se(n("img",La,null,512),[[l,e.getCoinIcon(v.reward_coin)]]),Ba])])]))]))),128))])):(w(),S("div",Ma,[(w(!0),S(Ve,null,oo(e.currentPositionInfo.rewards,v=>(w(),S("div",{key:v,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(w(),S("div",Ua,[n("div",ja,[Se(n("img",Ea,null,512),[[l,e.getCoinIcon(v.rewarder_type)]]),Da])])):(w(),S("div",Fa,[n("div",Wa,[n("div",Ha,[Se(n("img",Xa,null,512),[[l,e.getCoinIcon(v.reward_coin)]]),Ga])])]))]))),128))])),n("div",za,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?(w(),qe(m,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:Le(()=>[ve("Unstake")]),_:1},8,["loading","onClick"])):de("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?(w(),qe(o,{key:1},{title:Le(()=>[ve("Farming rewards are only available for active positions.")]),default:Le(()=>[se(m,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:Le(()=>[ve("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?(w(),qe(m,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:Le(()=>[ve("Stake")]),_:1},8,["loading","onClick"])):de("",!0),se(m,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:Uo(e.claim,["stop"])},{default:Le(()=>[ve("↑ Claim")]),_:1},8,["loading","disabled","onClick"])])])])):de("",!0)}const zo=Qe(pa,[["render",Ya],["__scopeId","data-v-9b39419a"]]),Ja=Je({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const t=jo(),a=A(()=>t),s=A(()=>a.value.status),O=Ye();we(()=>[a.value.targetGroups],v=>{},{immediate:!0});const p=L(!1);we(()=>s.value,v=>{v=="authenticated",p.value=!1},{immediate:!0});const T=L(!1),m=async()=>{T.value=!T.value;const v={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},u=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;try{await t.subscribePosition(v,u,T.value)}catch{T.value=!T.value}},o=v=>{const u=v.sources;T.value=u.some(k=>JSON.parse(k.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(k.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))},l=ro();return we(()=>[a.value.sourceGroups,e.positionInfo],([v,u])=>{var k,X,te,ee,oe,r;T.value=!1,v&&v.length>0&&v[0]&&u&&!fe(u)&&(((te=(X=(k=l==null?void 0:l.currentRoute)==null?void 0:k.value)==null?void 0:X.query)==null?void 0:te.token)==(u==null?void 0:u.name)||((r=(oe=(ee=l==null?void 0:l.currentRoute)==null?void 0:ee.value)==null?void 0:oe.query)==null?void 0:r.positionSource)=="farming")&&o(v[0])},{immediate:!0,deep:!0}),{importIcon:no,isShowSetUp:p,changeSwitch:m,checked:T,notifiStatus:s,store:O}}});const Qa=e=>(mo("data-v-7878455d"),e=e(),vo(),e),Ka={class:"range-alerts"},Za={class:"range-alerts-top"},Va={class:"title"},xa=Qa(()=>n("div",{class:"title-all"},[n("span",{class:"Range"},"Range Alerts")],-1)),es={key:1,class:"h5-switch-box"},os={class:"range-alerts-bottom"},ns={key:0,class:"pc-switch-box"};function ts(e,t,a,s,O,p){const T=uo,m=dn;return w(),S("div",Ka,[n("div",Za,[n("div",Va,[xa,e.isShowSetUp||e.notifiStatus!=="authenticated"?(w(),qe(T,{key:0,class:"range-alerts-button",onClick:t[0]||(t[0]=Uo(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Le(()=>[ve(" Set up ")]),_:1})):de("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(w(),S("div",es,[se(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):de("",!0)])]),n("div",os,[ve(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(w(),S("div",ns,[se(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):de("",!0)])])}const Yo=Qe(Ja,[["render",ts],["__scopeId","data-v-7878455d"]]),is=Je({components:{NewPositionTitle:Ro,NewPositionInfo:Xo,NewPositionLiquidity:Go,NewPositionAssetAdd:wo,NewPositionAssetRemove:wo,NewPositionNotifi:Yo,FarmsPositionDetail:zo},setup(){const e=L(),t=L(),a=L(),s=Ye(),O=A(()=>s),p=A(()=>O.value.chainName),T=io(),m=A(()=>T),o=Eo(),l=ro();Bo(()=>{e.value={},T.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),m.value.setCurrentPositionLoading(!0),o.getFarmsPoolList()});const v=async()=>{m.value.setCurrentPositionLoading(!0);const r=l.currentRoute.value.query.token||"",f=l.currentRoute.value.query.collect||"",N=l.currentRoute.value.query.address||"",i=l.currentRoute.value.query.pos||"",_=l.currentRoute.value.query.id||"",I=l.currentRoute.value.query.positionSource||"",C=l.currentRoute.value.query.position_nft_id||"";p.value==="Aptos"?r&&f&&N&&m.value.setCurrentPositionInfo(N,f,r,p.value):r&&N&&i?m.value.setCurrentPositionInfo(N,f,r,p.value,i):_&&!I?m.value.setCurrentPositionInfo("","","",p.value,_):m.value.setCurrentPositionInfo("","","",p.value,C,I)};we(()=>m.value.poolConfigObj,r=>{r&&!fe(r)&&v()},{immediate:!0});const u=A(()=>m.value.currentPositionLoading),k=A(()=>{var f,N,i;const r=((i=(N=(f=l==null?void 0:l.currentRoute)==null?void 0:f.value)==null?void 0:N.query)==null?void 0:i.address)||"";return r&&m.value.addressLpTokens&&!fe(m.value.addressLpTokens)&&m.value.addressLpTokens[r]?m.value.addressLpTokens[r]:null});we(()=>k.value,(r,f)=>{r&&!fe(r)&&(e.value=r),r&&!fe(r)&&r.current_sqrt_price!==(f==null?void 0:f.current_sqrt_price)&&v()},{immediate:!0});const X=fo();we(()=>[m.value.currentPositionInfo,p.value],([r,f])=>{var N;(f=="Aptos"&&r||f=="Sui"&&r&&(r==null?void 0:r.nftHash)==((N=X==null?void 0:X.query)==null?void 0:N.pos))&&(e.value=r,t.value=e.value.token_a,a.value=e.value.token_b)},{immediate:!0});const te=A(()=>m.value.positionDetailCurrentTab),ee=lo();A(()=>ee),A(()=>O.value.theme);const oe=()=>{v()};return cn(()=>{T.clearCurrentPositionInfo()}),{positionInfo:e,fromCoin:t,toCoin:a,getDetails:v,currentPositionLoading:u,positionDetailCurrentTab:te,clickRefresh:oe,chainName:p}}});const as={class:"new-position-detail"},ss={class:"new-position-content"},ls={class:"left"},rs={class:"right"},us={class:"loading-global"};function ds(e,t,a,s,O,p){const T=Ro,m=Xo,o=Go,l=wo,v=fa,u=zo,k=Yo,X=mn;return w(),S("div",as,[se(T,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),n("div",ss,[n("div",ls,[se(m),se(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),n("div",rs,[e.positionDetailCurrentTab=="increase"?(w(),qe(l,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(w(),qe(v,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),se(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.chainName=="Sui"?(w(),qe(u,{key:2})):de("",!0),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="∞"&&e.chainName=="Sui"?(w(),qe(k,{key:3,"position-info":e.positionInfo},null,8,["position-info"])):de("",!0)])]),Se(n("div",us,[se(X)],512),[[Mo,e.currentPositionLoading]])])}const Ds=Qe(is,[["render",ds],["__scopeId","data-v-441cff21"]]);export{Ds as default};
