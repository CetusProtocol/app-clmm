import{_ as Co}from"./back.0df8053d.js";import{_ as $o}from"./coin-pair-name.9092f8da.js";import{_ as Ro}from"./status-block.9a52d6b9.js";import{_ as To}from"./network-tips.8920f199.js";import{_ as Bo}from"./swap-setting.59375a92.js";import{a as qo,L as Po,r as a,F as Lo,v as C,N as Uo,G as Do,aj as jo,z as Oo,w as D,s as Vo,ay as Eo,ad as j,H as d,i as Mo,W as fo,az as Wo,R as to,A as ho,k as _o,Y as O,b as Fo,o as w,e as V,l as A,f as e,t as i,q as ao,c as Io,h as lo,a0 as zo,a1 as Xo,y as $,m as Go,C as Ho,E as Yo,I as Jo,aA as Ko,B as Qo,p as Zo,j as xo,a3 as oe}from"./entry.ddd36fdb.js";import{p as uo}from"./precision.1cd464a0.js";const ee=qo({setup(){const{t:o,locale:c}=Po();let ro=a(!1),T=a(!1);const E=a(!1),co=()=>{J(),E.value=!0,setTimeout(()=>{E.value=!1},1e3)},x=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],oo=Lo(),M=a(""),W=a(""),F=a(""),z=a(""),X=a(""),G=a(""),H=a(""),l=a(""),t=C(()=>oo),u=a({}),r=a({}),s=a(t.value.currentPositionInfo||{}),bo=Uo(),Y=C(()=>bo),B=Do();jo(()=>{Y.value.connected||B.push("/position")});const N=Oo(),J=async()=>{t.value.setCurrentPositionLoading(!0);const n=B.currentRoute.value.query.token||"",p=B.currentRoute.value.query.collect||"";n&&p&&(M.value=p,W.value=B.currentRoute.value.query.address,F.value=n,t.value.setCurrentPositionInfo(W.value,M.value,F.value),s.value=t.value.currentPositionInfo)};D(()=>t.value.addressLpTokens,n=>{O(n)||J()},{immediate:!0}),D(()=>t.value.currentPositionInfo,n=>{n&&(s.value=t.value.currentPositionInfo,u.value=s.value.token_a,r.value=s.value.token_b,io({value:I.value/100}))});const I=a(50),m=a(0),v=a(0),eo=a(0),so=Vo(),ko=C(()=>so),no=C(()=>so.slippage);D(I,Eo((n,p)=>{Number(n)>100?I.value=100:n&&s.value&&(I.value=n,io({value:I.value/100}))},300)),D(no,n=>{n&&s.value&&io({value:I.value/100})});const io=n=>{const p=s.value.token_a.decimals,b=s.value.token_b.decimals,g=s.value.tick_lower_index,f=s.value.tick_upper_index,h=fo.tickIndexToSqrtPriceX64(g),q=fo.tickIndexToSqrtPriceX64(f);eo.value=s.value.liquidity*Number(n.value);const _=Wo.getCoinAmountFromLiquidity(new to(eo.value),new to(s.value.current_sqrt_price),h,q,!0),y=Number(_.coinA.toString())/Math.pow(10,p),P=Number(_.coinB.toString())/Math.pow(10,b);m.value=y,v.value=P;const k=t.value.RATES[t.value.newTokenObj[s.value.token_a.address].name.toUpperCase()].price,L=t.value.RATES[t.value.newTokenObj[s.value.token_b.address].name.toUpperCase()].price;z.value=Number(m.value*k)<.01?"<0.01":d(m.value*k,2),X.value=Number(v.value*L)<.01?"<0.01":d(v.value*L,2);const U=uo.minus(Number(s.value.amountA),Number(m.value))*k;G.value=Number(U)<.01?"<0.01":d(U,2);const S=uo.minus(Number(s.value.amountB),Number(v.value))*L;H.value=Number(S)<.01?"<0.01":d(S,2);const Z=Number(ho(U,2))+Number(ho(S,2));l.value=Number(Z)<.01?"<0.01":d(Z,2)},{setIsShowSuccess:go,setIsShowRejected:mo,setIsShowWaiting:K,setTransactionDesc:yo,setTransactionTxid:vo,setPositiomNum:os}=so,wo=async()=>{var n,p,b,g;T.value=!0,vo(""),yo(o("tips.removeLiquidiyText",{from:d(m.value,u.value.decimals)==0?"":`${j(m.value,u.value.decimals)} ${u.value.symbol}`,and:d(m.value,u.value.decimals)==0||d(v.value,r.value.decimals)==0?"":"and",to:d(v.value,r.value.decimals)==0?"":`${j(v.value,r.value.decimals)} ${r.value.symbol}`})),K(!0);try{let f={};f={pool:{...s.value.poolInfo,coinA:s.value.token_a,coinB:s.value.token_b},coinTypeA:s.value.poolInfo.coinTypeA,coinTypeB:s.value.poolInfo.coinTypeB,position:s.value,delta_liquidity:new to(_o(eo.value,0)),slippage:Number(no.value),rewards_num:Q.value.length};const h=Q.value;f.coinTypeC=h[0]?h[0].coin_address:"",f.coinTypeD=h[1]?h[1].coin_address:"",f.coinTypeE=h[2]?h[2].coin_address:"";const q=await N.getRemoveLiquidityTransactionPayload(f);let _;if(_=await Y.value.currentWallet.signAndSubmitTransaction(q),_&&_.hash){vo(_.hash),K(!1),go(!0);const y={title:o("common.removeLiquidity"),desc:o("tips.removeSuccessText",{from:d(m.value,u.value.decimals)==0?"":`${j(m.value,u.value.decimals)} ${u.value.symbol}`,and:d(m.value,u.value.decimals)==0||d(v.value,r.value.decimals)==0?"":"and",to:d(v.value,r.value.decimals)==0?"":`${j(v.value,r.value.decimals)} ${r.value.symbol}`}),hash:_.hash,descTransactions:`Remove ${m.value} ${(n=u.value)==null?void 0:n.symbol} and ${v.value} ${(p=r.value)==null?void 0:p.symbol} 
             from the pool`,sender:Y.value.address,chainName:ko.value.chainName,tit:`${I.value==100?"Closed":"Modified"} Position: ${s.value.poolInfo.symbol}`,text:`Withdraw ${m.value} ${(b=u.value)==null?void 0:b.symbol} and ${v.value} ${(g=r.value)==null?void 0:g.symbol}`};N.showTransitionPending(y),await N.watchTransaction(y)&&(setTimeout(()=>{J()},3e3),setTimeout(()=>{J()},6e3),Number(I.value)==100&&B.push("/position"))}else K(!1),mo(!0);T.value=!1}catch{T.value=!1,K(!1),mo(!0)}},Ao=C(()=>t.value.tokensObj&&u.value.address&&t.value.tokensObj[u.value.address]&&t.value.tokensObj[u.value.address].logoURI),No=C(()=>t.value.tokensObj&&r.value.address&&t.value.tokensObj[r.value.address]&&t.value.tokensObj[r.value.address].logoURI),So=a(0),Q=a([]);return D(()=>[s.value,t.value.addressLpTokens,t.value.newTokenObj,t.value.RATES],async([n,p,b,g])=>{if(!O(n)&&!O(p)&&!O(b)&&!O(g)){const f=p[n.poolAddress],h=await N.getTickDataByIndex(f.ticks_handle,Number(n.tick_lower_index)),q=await N.getTickDataByIndex(f.ticks_handle,Number(n.tick_upper_index)),_=await N.getPosRewardersAmount({poolAddress:n.poolAddress,positionName:n.tokenName,tickLowerData:h,tickUpperData:q}),y=[];let P=0;_.forEach(k=>{const L=b[k.coin_address].decimals,U=b[k.coin_address],S=Number(k.amount_owed.toString())/Math.pow(10,L),Z=g[b[k.coin_address].name.toUpperCase()].price,po=S*Z;P+=po,y.push({...k,...U,amount:S,amountUSD:po})}),Q.value=y,So.value=Number(_o(P,2))}},{immediate:!0}),{removeAmountARates:G,removeAmountBRates:H,removeAmountRates:l,receiveAmountARates:z,receiveAmountBRates:X,showNum:j,fromCoinUrl:Ao,toCoinUrl:No,precision:uo,addCommom:d,loading:T,wallet:Y,toRemove:wo,fromCoinAmount:m,toCoinAmount:v,pools:t,refresh:E,amountArr:x,sliderVal:I,positionInfo:s,slippage:no,importIcon:Mo,clickRefresh:co,isShowSwapSetting:ro,pendingRewarderArr:Q}}});const R=o=>(Zo("data-v-c469dde7"),o=o(),xo(),o),se={class:"remove-liquidity"},ne={class:"remove-liquidity-top"},ie={class:"remove-title"},te={class:"right title-right"},ae=R(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),le=R(()=>e("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),ue=[le],re={class:"remove-liquidity-center"},de={class:"top"},ce={class:"left"},me={class:"right"},ve={class:"fee"},pe={class:"bottom"},fe={class:"add-amount"},he={class:"add-amount-header"},_e={class:"amount-list"},Ie=["onClick"],be={class:"slider-box"},ke={class:"receive"},ge={class:"receiveTit"},ye={class:"item"},we={class:"left"},Ae=["src"],Ne={class:"right"},Se={class:"item"},Ce={class:"left"},$e=["src"],Re={class:"right"},Te={class:"remove-liquidity-bottom-box"},Be={class:"induction remove-liquidity-bottom"},qe={class:"item"},Pe=R(()=>e("div",{class:"induction-text"},"Fees",-1)),Le={class:"induction-value"},Ue=["src"],De=R(()=>e("div",{class:"induction-text"},null,-1)),je={class:"induction-value"},Oe=["src"],Ve=R(()=>e("svg",{"aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-Remove"})],-1)),Ee={key:0,class:"receive"},Me={class:"receiveTit"},We=R(()=>e("div",{class:"left"},"Remaining in Position",-1)),Fe={class:"right"},ze={class:"item"},Xe={class:"left"},Ge=["src"],He={class:"right"},Ye={class:"item"},Je={class:"left"},Ke=["src"],Qe={class:"right"},Ze={class:"loading-global"};function xe(o,c,ro,T,E,co){const x=Co,oo=$o,M=Ro,W=Jo,F=Ko,z=Qo,X=To,G=Bo,H=oe;return w(),V("div",se,[A(x),e("div",ne,[e("div",ie,i(o.$t("common.removeLiquidity")),1),e("div",te,[e("div",{class:"slippage-icon",onClick:c[0]||(c[0]=l=>o.isShowSwapSetting=!0)},[ae,e("span",null,i(o.slippage)+"%",1)]),(w(),V("svg",{"aria-hidden":"true",class:ao(o.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:c[1]||(c[1]=(...l)=>o.clickRefresh&&o.clickRefresh(...l))},ue,2))])]),e("div",re,[e("div",de,[e("div",ce,[o.positionInfo?(w(),Io(oo,{key:0,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b},null,8,["from-coin","to-coin"])):lo("",!0),e("div",me,[e("div",ve,i(o.positionInfo.fee)+"%",1)])]),A(M,{"current-status":o.positionInfo.currentStatus||""},null,8,["current-status"])]),e("div",pe,[e("div",fe,[e("div",he,[e("span",null,i(o.$t("common.amount")),1),e("div",_e,[(w(!0),V(zo,null,Xo(o.amountArr,(l,t)=>(w(),V("div",{key:t,class:ao(["amount-item",o.sliderVal==l.value?"amount-item-active":""]),onClick:u=>o.sliderVal=l.value},i(l.name),11,Ie))),128))])]),e("div",be,[A(W,{value:o.sliderVal,"onUpdate:value":c[2]||(c[2]=l=>o.sliderVal=l),oninpu:"value=value.replace(/[^\\d]/g,'')",suffix:"%"},null,8,["value"]),A(F,{value:o.sliderVal,"onUpdate:value":c[3]||(c[3]=l=>o.sliderVal=l)},null,8,["value"])])])])]),e("div",ke,[e("div",ge,i(o.$t("newAdd.receive")),1),e("div",ye,[e("div",we,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Ae),e("span",null,i(o.showNum(o.fromCoinAmount,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),$(" "+i(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)]),e("div",Ne,"\u2248 $"+i(o.receiveAmountARates),1)]),e("div",Se,[e("div",Ce,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,$e),e("span",null,i(o.showNum(o.toCoinAmount,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),$(" "+i(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)]),e("div",Re,"\u2248 $"+i(o.receiveAmountBRates),1)])]),e("div",Te,[e("div",Be,[e("div",qe,[Pe,e("div",Le,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Ue),$(" "+i(o.showNum(o.positionInfo&&o.positionInfo.feeOwedA,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals))+" "+i(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)])]),e("div",{class:ao(o.pendingRewarderArr.length>0?"item item-boder":"item")},[De,e("div",je,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,Oe),$(" "+i(o.showNum(o.positionInfo&&o.positionInfo.feeOwedB,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals))+" "+i(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)])],2)])]),A(z,{disabled:o.wallet.connected?Number(o.sliderVal)==0||o.loading:!1,class:"remove-btn big-btn",onClick:c[4]||(c[4]=l=>o.wallet.connected?o.toRemove():o.wallet.setIsShowWalletModal(!0))},{default:Go(()=>[Ve,e("span",null,i(o.wallet.connected?o.$t("button.remove"):o.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),A(X),o.sliderVal<100?(w(),V("div",Ee,[e("div",Me,[We,e("div",Fe,"$"+i(o.removeAmountRates),1)]),e("div",ze,[e("div",Xe,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Ge),e("span",null,i(o.showNum(o.precision.minus(Number(o.positionInfo.amountA),Number(o.fromCoinAmount)),o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),$(" "+i(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)]),e("div",He,"\u2248 $"+i(o.removeAmountARates),1)]),e("div",Ye,[e("div",Je,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,Ke),e("span",null,i(o.showNum(o.precision.minus(Number(o.positionInfo.amountB),Number(o.toCoinAmount)),o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),$(" "+i(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)]),e("div",Qe,"\u2248 $"+i(o.removeAmountBRates),1)])])):lo("",!0),o.isShowSwapSetting?(w(),Io(G,{key:1,onOnClose:c[5]||(c[5]=l=>o.isShowSwapSetting=!1)})):lo("",!0),Ho(e("div",Ze,[A(H)],512),[[Yo,o.pools.currentPositionLoading]])])}const us=Fo(ee,[["render",xe],["__scopeId","data-v-c469dde7"]]);export{us as default};
