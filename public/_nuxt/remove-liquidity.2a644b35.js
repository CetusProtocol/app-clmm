import{_ as To}from"./back.1b8af33b.js";import{_ as qo}from"./coin-pair-name.56b770f8.js";import{_ as Bo}from"./status-block.4031ebcb.js";import{_ as Po}from"./network-tips.afb9f144.js";import{_ as Lo}from"./swap-setting.9ffa5de2.js";import{a as Uo,L as Do,r as l,F as Oo,v as B,N as jo,G as Vo,ak as Eo,z as Mo,w as j,s as Wo,ay as Fo,ae as io,H as I,i as zo,W as fo,az as Xo,R as ao,A as ho,k as _o,Y as V,b as Go,o as g,e as N,l as C,f as e,t as s,q as lo,c as Io,h as Z,a1 as ko,a2 as bo,y as S,m as Ho,C as Yo,E as Jo,I as Ko,aA as Qo,B as Zo,p as xo,j as oe,a4 as ee}from"./entry.0790269b.js";import{p as ro}from"./precision.1cd464a0.js";const se=Uo({setup(){const{t:o,locale:r}=Do();let uo=l(!1),L=l(!1);const E=l(!1),co=()=>{J(),E.value=!0,setTimeout(()=>{E.value=!1},1e3)},x=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],oo=Oo(),M=l(""),W=l(""),F=l(""),z=l(""),X=l(""),G=l(""),H=l(""),a=l(""),n=B(()=>oo),u=l({}),c=l({}),t=l(n.value.currentPositionInfo||{}),go=jo(),Y=B(()=>go),U=Vo();Eo(()=>{Y.value.connected||U.push("/position")});const R=Mo(),J=async()=>{n.value.setCurrentPositionLoading(!0);const i=U.currentRoute.value.query.token||"",d=U.currentRoute.value.query.collect||"";i&&d&&(M.value=d,W.value=U.currentRoute.value.query.address,F.value=i,n.value.setCurrentPositionInfo(W.value,M.value,F.value),t.value=n.value.currentPositionInfo)};j(()=>n.value.addressLpTokens,i=>{V(i)||J()},{immediate:!0}),j(()=>n.value.currentPositionInfo,i=>{i&&(t.value=n.value.currentPositionInfo,u.value=t.value.token_a,c.value=t.value.token_b,to({value:k.value/100}))});const k=l(50),m=l(0),v=l(0),eo=l(0),so=Wo(),yo=B(()=>so),no=B(()=>so.slippage);j(k,Fo((i,d)=>{Number(i)>100?k.value=100:i&&t.value&&(k.value=i,to({value:k.value/100}))},300)),j(no,i=>{i&&t.value&&to({value:k.value/100})});const to=i=>{const d=t.value.token_a.decimals,b=t.value.token_b.decimals,y=t.value.tick_lower_index,w=t.value.tick_upper_index,p=fo.tickIndexToSqrtPriceX64(y),f=fo.tickIndexToSqrtPriceX64(w);eo.value=t.value.liquidity*Number(i.value);const T=Xo.getCoinAmountFromLiquidity(new ao(eo.value),new ao(t.value.current_sqrt_price),p,f,!0),h=Number(T.coinA.toString())/Math.pow(10,d),A=Number(T.coinB.toString())/Math.pow(10,b);m.value=h,v.value=A;const _=n.value.RATES[n.value.newTokenObj[t.value.token_a.address].name.toUpperCase()].price,D=n.value.RATES[n.value.newTokenObj[t.value.token_b.address].name.toUpperCase()].price;z.value=Number(m.value*_)<.01?"<0.01":I(m.value*_,2),X.value=Number(v.value*D)<.01?"<0.01":I(v.value*D,2);const O=ro.minus(Number(t.value.amountA),Number(m.value))*_;G.value=Number(O)<.01?"<0.01":I(O,2);const q=ro.minus(Number(t.value.amountB),Number(v.value))*D;H.value=Number(q)<.01?"<0.01":I(q,2);const Q=Number(ho(O,2))+Number(ho(q,2));a.value=Number(Q)<.01?"<0.01":I(Q,2)},{setIsShowSuccess:wo,setIsShowRejected:mo,setIsShowWaiting:K,setTransactionDesc:Ao,setTransactionTxid:vo,setPositiomNum:ts,setTransactionDescText:No}=so,Co=async()=>{var d,b,y,w;L.value=!0,vo(""),Ao(o("tips.removeLiquidiyText",{from:I(m.value,u.value.decimals)==0?"":`${io(m.value,u.value.decimals)} ${u.value.symbol}`,and:I(m.value,u.value.decimals)==0||I(v.value,c.value.decimals)==0?"":"and",to:I(v.value,c.value.decimals)==0?"":`${io(v.value,c.value.decimals)} ${c.value.symbol}`})),K(!0);const i=$.value&&$.value.length>0?o("modal.removeLiquidityText1"):o("modal.removeLiquidityText2");No(i);try{let p={};p={pool:{...t.value.poolInfo,coinA:t.value.token_a,coinB:t.value.token_b},coinTypeA:t.value.poolInfo.coinTypeA,coinTypeB:t.value.poolInfo.coinTypeB,position:t.value,delta_liquidity:new ao(_o(eo.value,0)),slippage:Number(no.value),rewards_num:$.value.length};const f=$.value;p.coinTypeC=f[0]?f[0].coin_address:"",p.coinTypeD=f[1]?f[1].coin_address:"",p.coinTypeE=f[2]?f[2].coin_address:"";const T=await R.getRemoveLiquidityTransactionPayload(p);let h;if(h=await Y.value.currentWallet.signAndSubmitTransaction(T),h&&h.hash){vo(h.hash),K(!1),wo(!0);const A={title:o("common.removeLiquidity"),desc:"",hash:h.hash,descTransactions:`Remove ${m.value} ${(d=u.value)==null?void 0:d.symbol} and ${v.value} ${(b=c.value)==null?void 0:b.symbol} 
             from the pool`,sender:Y.value.address,chainName:yo.value.chainName,tit:`${k.value==100?"Closed":"Modified"} Position: ${t.value.poolInfo.symbol}`,text:`Withdraw ${m.value} ${(y=u.value)==null?void 0:y.symbol} and ${v.value} ${(w=c.value)==null?void 0:w.symbol}`};R.showTransitionPending(A),await R.watchTransaction(A)&&(setTimeout(()=>{J()},3e3),setTimeout(()=>{J()},6e3),Number(k.value)==100&&U.push("/position"))}else K(!1),mo(!0);L.value=!1}catch{L.value=!1,K(!1),mo(!0)}},So=B(()=>n.value.tokensObj&&u.value.address&&n.value.tokensObj[u.value.address]&&n.value.tokensObj[u.value.address].logoURI),Ro=B(()=>n.value.tokensObj&&c.value.address&&n.value.tokensObj[c.value.address]&&n.value.tokensObj[c.value.address].logoURI),$o=l(0),$=l([]);return j(()=>[t.value,n.value.addressLpTokens,n.value.newTokenObj,n.value.RATES],async([i,d,b,y])=>{if(!V(i)&&!V(d)&&!V(b)&&!V(y)){const w=d[i.poolAddress],p=await R.getTickDataByIndex(w.ticks_handle,Number(i.tick_lower_index)),f=await R.getTickDataByIndex(w.ticks_handle,Number(i.tick_upper_index)),T=await R.getPosRewardersAmount({poolAddress:i.poolAddress,positionName:i.tokenName,tickLowerData:p,tickUpperData:f}),h=[];let A=0;T.forEach(_=>{const D=b[_.coin_address].decimals,O=b[_.coin_address],q=Number(_.amount_owed.toString())/Math.pow(10,D),Q=y[b[_.coin_address].name.toUpperCase()].price,po=q*Q;A+=po,h.push({..._,...O,amount:q,amountUSD:po})}),$.value=h,$o.value=Number(_o(A,2))}},{immediate:!0}),{removeAmountARates:G,removeAmountBRates:H,removeAmountRates:a,receiveAmountARates:z,receiveAmountBRates:X,showNum:io,fromCoinUrl:So,toCoinUrl:Ro,precision:ro,addCommom:I,loading:L,wallet:Y,toRemove:Co,fromCoinAmount:m,toCoinAmount:v,pools:n,refresh:E,amountArr:x,sliderVal:k,positionInfo:t,slippage:no,importIcon:zo,clickRefresh:co,isShowSwapSetting:uo,pendingRewarderArr:$}}});const P=o=>(xo("data-v-cf9fac23"),o=o(),oe(),o),ne={class:"remove-liquidity"},te={class:"remove-liquidity-top"},ie={class:"remove-title"},ae={class:"right title-right"},le=P(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),re=P(()=>e("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),ue=[re],de={class:"remove-liquidity-center"},ce={class:"top"},me={class:"left"},ve={class:"right"},pe={class:"fee"},fe={class:"bottom"},he={class:"add-amount"},_e={class:"add-amount-header"},Ie={class:"amount-list"},ke=["onClick"],be={class:"slider-box"},ge={class:"receive"},ye={class:"receiveTit"},we={class:"item"},Ae={class:"left"},Ne=["src"],Ce={class:"right"},Se={class:"item"},Re={class:"left"},$e=["src"],Te={class:"right"},qe={class:"remove-liquidity-bottom-box"},Be={class:"induction remove-liquidity-bottom"},Pe={class:"item"},Le=P(()=>e("div",{class:"induction-text"},"Fees",-1)),Ue={class:"induction-value"},De=["src"],Oe=P(()=>e("div",{class:"induction-text"},null,-1)),je={class:"induction-value"},Ve=["src"],Ee={class:"induction-text"},Me={class:"induction-value"},We=["src"],Fe=P(()=>e("svg",{"aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-Remove"})],-1)),ze={key:0,class:"receive"},Xe={class:"receiveTit"},Ge=P(()=>e("div",{class:"left"},"Remaining in Position",-1)),He={class:"right"},Ye={class:"item"},Je={class:"left"},Ke=["src"],Qe={class:"right"},Ze={class:"item"},xe={class:"left"},os=["src"],es={class:"right"},ss={class:"loading-global"};function ns(o,r,uo,L,E,co){const x=To,oo=qo,M=Bo,W=Ko,F=Qo,z=Zo,X=Po,G=Lo,H=ee;return g(),N("div",ne,[C(x),e("div",te,[e("div",ie,s(o.$t("common.removeLiquidity")),1),e("div",ae,[e("div",{class:"slippage-icon",onClick:r[0]||(r[0]=a=>o.isShowSwapSetting=!0)},[le,e("span",null,s(o.slippage)+"%",1)]),(g(),N("svg",{"aria-hidden":"true",class:lo(o.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:r[1]||(r[1]=(...a)=>o.clickRefresh&&o.clickRefresh(...a))},ue,2))])]),e("div",de,[e("div",ce,[e("div",me,[o.positionInfo?(g(),Io(oo,{key:0,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b},null,8,["from-coin","to-coin"])):Z("",!0),e("div",ve,[e("div",pe,s(o.positionInfo.fee)+"%",1)])]),C(M,{"current-status":o.positionInfo.currentStatus||""},null,8,["current-status"])]),e("div",fe,[e("div",he,[e("div",_e,[e("span",null,s(o.$t("common.amount")),1),e("div",Ie,[(g(!0),N(ko,null,bo(o.amountArr,(a,n)=>(g(),N("div",{key:n,class:lo(["amount-item",o.sliderVal==a.value?"amount-item-active":""]),onClick:u=>o.sliderVal=a.value},s(a.name),11,ke))),128))])]),e("div",be,[C(W,{value:o.sliderVal,"onUpdate:value":r[2]||(r[2]=a=>o.sliderVal=a),oninpu:"value=value.replace(/[^\\d]/g,'')",suffix:"%"},null,8,["value"]),C(F,{value:o.sliderVal,"onUpdate:value":r[3]||(r[3]=a=>o.sliderVal=a)},null,8,["value"])])])])]),e("div",ge,[e("div",ye,s(o.$t("newAdd.receive")),1),e("div",we,[e("div",Ae,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Ne),e("span",null,s(o.showNum(o.fromCoinAmount,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),S(" "+s(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)]),e("div",Ce,"\u2248 $"+s(o.receiveAmountARates),1)]),e("div",Se,[e("div",Re,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,$e),e("span",null,s(o.showNum(o.toCoinAmount,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),S(" "+s(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)]),e("div",Te,"\u2248 $"+s(o.receiveAmountBRates),1)])]),e("div",qe,[e("div",Be,[e("div",Pe,[Le,e("div",Ue,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,De),S(" "+s(o.showNum(o.positionInfo&&o.positionInfo.feeOwedA,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals))+" "+s(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)])]),e("div",{class:lo(o.pendingRewarderArr.length>0?"item item-boder":"item")},[Oe,e("div",je,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,Ve),S(" "+s(o.showNum(o.positionInfo&&o.positionInfo.feeOwedB,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals))+" "+s(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)])],2),o.positionInfo.is_display_rewarder?(g(!0),N(ko,{key:0},bo(o.pendingRewarderArr,(a,n)=>(g(),N("div",{class:"item",key:a},[e("div",Ee,s(n==0?"Rewards":""),1),e("div",Me,[e("img",{src:a.logoURI},null,8,We),S(" "+s(a.amount>1e-6?a.amount:"<0.000001")+" "+s(a.symbol),1)])]))),128)):Z("",!0)])]),C(z,{disabled:o.wallet.connected?Number(o.sliderVal)==0||o.loading:!1,class:"remove-btn big-btn",onClick:r[4]||(r[4]=a=>o.wallet.connected?o.toRemove():o.wallet.setIsShowWalletModal(!0))},{default:Ho(()=>[Fe,e("span",null,s(o.wallet.connected?o.$t("button.remove"):o.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),C(X),o.sliderVal<100?(g(),N("div",ze,[e("div",Xe,[Ge,e("div",He,"$"+s(o.removeAmountRates),1)]),e("div",Ye,[e("div",Je,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Ke),e("span",null,s(o.showNum(o.precision.minus(Number(o.positionInfo.amountA),Number(o.fromCoinAmount)),o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),S(" "+s(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)]),e("div",Qe,"\u2248 $"+s(o.removeAmountARates),1)]),e("div",Ze,[e("div",xe,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,os),e("span",null,s(o.showNum(o.precision.minus(Number(o.positionInfo.amountB),Number(o.toCoinAmount)),o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),S(" "+s(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)]),e("div",es,"\u2248 $"+s(o.removeAmountBRates),1)])])):Z("",!0),o.isShowSwapSetting?(g(),Io(G,{key:1,onOnClose:r[5]||(r[5]=a=>o.isShowSwapSetting=!1)})):Z("",!0),Yo(e("div",ss,[C(H)],512),[[Jo,o.pools.currentPositionLoading]])])}const ms=Go(se,[["render",ns],["__scopeId","data-v-cf9fac23"]]);export{ms as default};
