import{_ as Go}from"./back.d31f3863.js";import{_ as zo}from"./swap-setting.db3772bd.js";import{u as Fe,a as uo}from"./sha256.747633b4.js";import{a as We,r as N,m as _,e as He,o as A,f as B,h as t,v as U,c as Be,x as me,p as no,k as to,C as Yo,D as we,b as io,i as se,z as lo,y as Po,t as qe,G as No,E as ro,q as Ro,u as z,j as Ae,l as wo,a0 as Jo,a1 as ze,a6 as Ao,H as Io,w as Qe,F as po,s as ho,B as co,a7 as Qo,a8 as Zo,K as Ko,Y as Vo,M as xo,J as en}from"./entry.f0c17699.js";import{u as Ve,c as he,a as ao,b as on,n as nn,d as pe,e as Y,q as bo,s as Me,h as Se,p as Co,f as Oe,A as Oo,B as qo,T as $o,C as tn}from"./pool.154ed6b2.js";import{_ as mo}from"./token-warning.6b123ca1.js";import{_ as Bo}from"./status-block.daa628db.js";import{s as eo,m as an,l as sn,b as ln,a as un,_ as rn}from"./transform.09b729b3.js";import{D as b}from"./decimal.0e8aa3f1.js";import{i as oo}from"./import-icon.de3e6c66.js";import{_ as vo}from"./assets-card.50e807a8.js";import{b as dn}from"./new-add-or-create.f2fe906c.js";import{_ as cn,a as mn}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              *//* empty css              */import{u as Lo}from"./notifi.02c1060c.js";/* empty css              *//* empty css              *//* empty css              */import"./img-lock_2x.34b3841a.js";/* empty css              */import"./useWhale.8c5b79d9.js";import"./index.baf2ea12.js";const ko=Math.PI,go=2*ko,Je=1e-6,vn=go-Je;function Mo(e){this._+=e[0];for(let n=1,i=e.length;n<i;++n)this._+=arguments[n]+e[n]}function fn(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return Mo;const i=10**n;return function(a){this._+=a[0];for(let C=1,w=a.length;C<w;++C)this._+=Math.round(arguments[C]*i)/i+a[C]}}class pn{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?Mo:fn(n)}moveTo(n,i){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,i){this._append`L${this._x1=+n},${this._y1=+i}`}quadraticCurveTo(n,i,a,C){this._append`Q${+n},${+i},${this._x1=+a},${this._y1=+C}`}bezierCurveTo(n,i,a,C,w,S){this._append`C${+n},${+i},${+a},${+C},${this._x1=+w},${this._y1=+S}`}arcTo(n,i,a,C,w){if(n=+n,i=+i,a=+a,C=+C,w=+w,w<0)throw new Error(`negative radius: ${w}`);let S=this._x1,u=this._y1,o=a-n,d=C-i,v=S-n,c=u-i,h=v*v+c*c;if(this._x1===null)this._append`M${this._x1=n},${this._y1=i}`;else if(h>Je)if(!(Math.abs(c*o-d*v)>Je)||!w)this._append`L${this._x1=n},${this._y1=i}`;else{let E=a-S,V=C-u,x=o*o+d*d,te=E*E+V*V,f=Math.sqrt(x),m=Math.sqrt(h),k=w*Math.tan((ko-Math.acos((x+h-te)/(2*f*m)))/2),s=k/m,$=k/f;Math.abs(s-1)>Je&&this._append`L${n+s*v},${i+s*c}`,this._append`A${w},${w},0,0,${+(c*E>v*V)},${this._x1=n+$*o},${this._y1=i+$*d}`}}arc(n,i,a,C,w,S){if(n=+n,i=+i,a=+a,S=!!S,a<0)throw new Error(`negative radius: ${a}`);let u=a*Math.cos(C),o=a*Math.sin(C),d=n+u,v=i+o,c=1^S,h=S?C-w:w-C;this._x1===null?this._append`M${d},${v}`:(Math.abs(this._x1-d)>Je||Math.abs(this._y1-v)>Je)&&this._append`L${d},${v}`,a&&(h<0&&(h=h%go+go),h>vn?this._append`A${a},${a},0,1,${c},${n-u},${i-o}A${a},${a},0,1,${c},${this._x1=d},${this._y1=v}`:h>Je&&this._append`A${a},${a},0,${+(h>=ko)},${c},${this._x1=n+a*Math.cos(w)},${this._y1=i+a*Math.sin(w)}`)}rect(n,i,a,C){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+i}h${a=+a}v${+C}h${-a}Z`}toString(){return this._}}function Ke(e){return function(){return e}}function hn(e){let n=3;return e.digits=function(i){if(!arguments.length)return n;if(i==null)n=null;else{const a=Math.floor(i);if(!(a>=0))throw new RangeError(`invalid digits: ${i}`);n=a}return e},()=>new pn(n)}function bn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Uo(e){this._context=e}Uo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:this._context.lineTo(e,n);break}}};function kn(e){return new Uo(e)}function gn(e){return e[0]}function _n(e){return e[1]}function wn(e,n){var i=Ke(!0),a=null,C=kn,w=null,S=hn(u);e=typeof e=="function"?e:e===void 0?gn:Ke(e),n=typeof n=="function"?n:n===void 0?_n:Ke(n);function u(o){var d,v=(o=bn(o)).length,c,h=!1,E;for(a==null&&(w=C(E=S())),d=0;d<=v;++d)!(d<v&&i(c=o[d],d,o))===h&&((h=!h)?w.lineStart():w.lineEnd()),h&&w.point(+e(c,d,o),+n(c,d,o));if(E)return w=null,E+""||null}return u.x=function(o){return arguments.length?(e=typeof o=="function"?o:Ke(+o),u):e},u.y=function(o){return arguments.length?(n=typeof o=="function"?o:Ke(+o),u):n},u.defined=function(o){return arguments.length?(i=typeof o=="function"?o:Ke(!!o),u):i},u.curve=function(o){return arguments.length?(C=o,a!=null&&(w=C(a)),u):C},u.context=function(o){return arguments.length?(o==null?a=w=null:w=C(a=o),u):a},u}function So(){}function jo(e){this._context=e}jo.prototype={areaStart:So,areaEnd:So,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,n){e=+e,n=+n,this._point?this._context.lineTo(e,n):(this._point=1,this._context.moveTo(e,n))}};function yn(e){return new jo(e)}const An=We({setup(){const e=Fe(),n=N(!1),i=_(()=>e);return{slippage:_(()=>i.value.slippage),isShowSwapSetting:n}}});const In=e=>(no("data-v-82585f8b"),e=e(),to(),e),Cn=In(()=>t("svg",{class:"icon","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1));function $n(e,n,i,a,C,w){const S=zo;return A(),B("div",{class:"slippage-icon",onClick:n[1]||(n[1]=u=>e.isShowSwapSetting=!0)},[Cn,t("span",null,U(e.slippage)+"%",1),e.isShowSwapSetting?(A(),Be(S,{key:0,onOnClose:n[0]||(n[0]=u=>e.isShowSwapSetting=!1)})):me("",!0)])}const Sn=He(An,[["render",$n],["__scopeId","data-v-82585f8b"]]),Tn=We({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,n){const i=N(!1),a=N(null),C=N(0),w=N(20),S=Ve(),u=Fe(),o=N(!1);Yo(()=>{clearInterval(a.value)});const d=()=>{a.value=setInterval(()=>{var te;o.value||C.value<w.value&&(C.value+=1,C.value===w.value&&((te=e==null?void 0:e.poolInfo)!=null&&te.poolAddress&&S.updateCurrentPools(e.poolInfo.poolAddress,u.chainName),C.value=0))},1e3)},v=_(()=>u.slippage),c=()=>{n.emit("clearAll")},h=N(!1),E=()=>{C.value=0,h.value=!0,n.emit("clickRefresh"),setTimeout(()=>{h.value=!1},1e3)};we(()=>e.poolInfo,te=>{te&&!a.value&&d()},{immediate:!0});const V=io(),x=_(()=>u.chainName);return{clickRefresh:E,isShowSwapSetting:i,countdown:C,autoRefreshTime:w,slippage:v,clearAll:c,checkNullObj:he,router:V,loading:o,chainName:x,refresh:h}}});const Pn=e=>(no("data-v-ca768f9b"),e=e(),to(),e),Nn={class:"new-position-title"},Rn={class:"left"},On={class:"right"},qn=Pn(()=>t("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),Bn=[qn];function Ln(e,n,i,a,C,w){const S=Go,u=Sn;return A(),B("div",Nn,[t("div",Rn,[se(S)]),t("div",On,[se(u),(A(),B("svg",{"aria-hidden":"true",class:lo(e.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:n[0]||(n[0]=(...o)=>e.clickRefresh&&e.clickRefresh(...o))},Bn,2))])])}const Do=He(Tn,[["render",Ln],["__scopeId","data-v-ca768f9b"]]);function To(e,n,i){const a=new b(10).pow(n-i);return new b(1.0001).pow(e).mul(a)}const Mn=We({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,n){const i=N(1),a=N(""),C=N(""),w=_(()=>{var s,$,O;return c.sqrtPriceX64ToPrice((s=e.poolInfo)==null?void 0:s.current_sqrt_price,($=e.poolInfo)==null?void 0:$.coinA.decimals,(O=e.poolInfo)==null?void 0:O.coinB.decimals).toString()}),S=_(()=>{let s=0;return e.direction?s=(Number(e.minPrice)/Number(w.value)-1)*100:s=(Number(e.minPrice)/Number(1/Number(w.value))-1)*100,s=s>0&&s<.1?.1:s,s=s<0&&s>-.1?-.1:s,s}),u=_(()=>{let s=0;return e.direction?s=(Number(e.maxPrice)/Number(w.value)-1)*100:s=(Number(e.maxPrice)/Number(1/Number(w.value))-1)*100,s=s>0&&s<.1?.1:s,s=s<0&&s>-.1?-.1:s,s}),o=Fe(),d=_(()=>o),v=_(()=>d.value.chainName?ao(d.value.chainName):{}),{TickMath:c,getNearestTickByTick:h}=v.value,E=()=>{const s=i.value/2;i.value=s,te(e.poolInfo,s)},V=()=>{const s=i.value*2;i.value=s,te(e.poolInfo,s)},x=(s=[])=>{let $=6;const O=Math.abs(Number(s[0])-Number(s[s.length-1]));return O>=6?$=0:O>=1?$=1:O>=.1?$=2:O>=.01?$=3:O>=.001?$=4:O>=1e-4?$=5:O>=1e-5?$=6:O>=1e-6?$=7:O>=1e-7&&($=8),$},te=(s,$=1)=>{if(s&&s.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const O=Number(e.poolInfo.current_tick_index);let I=O+100*$,r=O-100*$,ee,X;if(e.maxPrice==="∞")X=v.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?X=c.priceToTickIndex(new b(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):X=c.priceToTickIndex(new b(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{X=443636}if(e.minPrice==="0")ee=v.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?ee=c.priceToTickIndex(new b(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):ee=c.priceToTickIndex(new b(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{ee=-443636}let de=0;if(e.currentPriceTab!=="full range"){if(O>=ee&&O<=X){const M=O-ee,ve=X-O;de=Math.max(Math.abs(M),Math.abs(ve))}else O<ee?de=Math.abs(X-O):de=Math.abs(O-ee);I=O+de+100*$,r=O-de-100*$}else{const M=(Math.abs(O)>5e3,2e4);I=O+M*$,r=O-M*$}r<-443636&&(r=-443636),I>443636&&(I=443636);const oe=new b(s.liquidity).div(Math.pow(10,8)).toString(),L=e.tickList,F=[],Q=[];let ne={};for(let M=0;M<L.length;M++){if(ne=L[M],ne.index<=O&&ne.index>=r){if(F.length<1&&M!==0){const ve=L[M-1];F.unshift({...ve,index:r})}F.unshift(ne)}else if(ne.index>O&&ne.index<=I&&(Q.push(ne),F.length<1&&M!==0)){const ve=L[M-1];F.push({...ve,index:r})}if(ne.index>I){const ve=L[M];if(Q.push({...ve,index:I}),F.length<1&&M!==0){const ge=L[M-1];F.push({...ge,index:r})}break}}let le="0";for(let M=F.length-1;M>=0;M--)le=new b(le).plus(new b(F[M].liquidityNet.toString()).div(Math.pow(10,8))).toString(),F[M].liquityAmount=le;let K=oe;for(let M=0;M<Q.length;M++)K=new b(K).plus(new b(Q[M].liquidityNet.toString()).div(Math.pow(10,8))).toString(),Q[M].liquityAmount=K;let ce=[];const Z=L&&L.length>0?{index:O,liquityAmount:Number(oe)}:{index:O,liquityAmount:0};(F.length>0||Q.length>0)&&(ce=[...F.reverse(),Z,...Q],e.direction||(ce=ce.reverse()));const ke=[];L.forEach(M=>{ke.push({...M,liquidityGross:M.liquidityGross.toString(),liquidityNet:M.liquidityNet.toString()})}),m(ce,r,I,ee,X,O)}};let f=N(!1);Po(()=>{document.body.clientWidth<750?f.value=!1:f.value=!0,window.onresize=()=>{document.body.clientWidth<750?f.value=!1:f.value=!0,te(e.poolInfo,i.value)}});const m=(s,$,O,I,r,ee)=>{let X,de;e.direction?(X=e.before7dContractPriceLowest?c.priceToTickIndex(new b(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",de=e.before7dContractPriceHighest?c.priceToTickIndex(new b(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(X=e.before7dContractPriceLowest?c.priceToTickIndex(new b(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",de=e.before7dContractPriceHighest?c.priceToTickIndex(new b(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const oe={top:30,right:35,bottom:20,left:55};let L,F;f.value,L=340-oe.left-oe.right,F=205-oe.top-oe.bottom;const Q=O-$,ne=parseInt(String(Q/4));let le=[$+ne/4,$+ne,$+2*ne,O-ne,O-ne/4];const K=$,ce=O,Z=L/(ce-K);e.currentPriceTab==="full range"&&(le=[$,$+2*ne,O]);const ke=le.map(T=>e.direction?To(T,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new b(1).div(To(T,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());x(ke),eo("#chart").selectAll("*").remove();const M=eo("#chart").attr("width",L+oe.left+oe.right).attr("height",F+oe.top+oe.bottom).append("g").attr("transform",`translate(${oe.left},${oe.right})`),ve=an(s,function(T){return Number(Math.abs(T.liquityAmount))})||0,ge=sn().range([0,F]).domain([ve,0]);ln().rangeRound([0,L]).padding(.1);const l=M.append("g").attr("id","barsBox").selectAll("rect").data(s).enter().append("rect");d.value.theme=="default"?l.attr("x",function(T,q){return q===0?0:e.direction?Math.abs(T.index-K)*Z:Math.abs(ce-T.index)*Z}).attr("y",function(T,q){return e.direction?q===s.length-1?0:ge(T.liquityAmount):q===s.length-1?0:ge(s[q+1].liquityAmount)}).attr("width",function(T,q){return q===0&&s.length===1&&T.liquityAmount>0?L:(e.direction,q!==s.length-1?Math.abs(s[q+1].index-T.index)*Z:0)}).attr("height",function(T,q){return q===0&&s.length===1&&T.liquityAmount>0?F:e.direction?q===s.length-1?0:F-ge(T.liquityAmount):q===s.length-1?0:F-ge(s[q+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):l.attr("x",function(T,q){return q===0?0:e.direction?Math.abs(T.index-K)*Z:Math.abs(ce-T.index)*Z}).attr("y",function(T,q){return e.direction?q===s.length-1?0:ge(Math.abs(T.liquityAmount)):q===s.length-1?0:ge(Math.abs(s[q+1].liquityAmount))}).attr("width",function(T,q){return q===0&&s.length===1&&T.liquityAmount>0?L:(e.direction,q!==s.length-1?Math.abs(s[q+1].index-T.index)*Z:0)}).attr("height",function(T,q){if(q===0&&s.length===1&&T.liquityAmount>0)return F;if(e.direction)return q===s.length-1?0:Number(T.liquityAmount)?F-ge(Math.abs(T.liquityAmount)):0;{if(q===s.length-1)return 0;const re=F-ge(Math.abs(s[q+1].liquityAmount));return Number(s[q+1].liquityAmount)?re:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const p=M.append("g");p.append("line").attr("x1",0).attr("y1",155).attr("x2",L).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),p.append("g");let R=0;e.direction?R=Math.abs(ee-K)*Z:R=Math.abs(ee-ce)*Z,(d.value.theme=="default"?M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+R+", 0)"),eo("#triangle").attr("width",8).attr("height",4);let D=[[0,0],[4,4],[8,0]],G=wn().x(function(T){return T[0]}).y(function(T){return T[1]}).curve(yn);const j=R-4;M.append("path").attr("d",G(D)).style("fill",d.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+j+", 0)");let W,H,ie,ue;e.direction?(W=I<K?-100:parseInt(String(Math.abs(I-K)*Z)),H=r<K?-100:parseInt(String(Math.abs(r-K)*Z)),ie=X<K?-100:Math.abs(X-K)*Z,ue=de<K?-100:Math.abs(de-K)*Z):(H=I<K?-100:Math.abs(ce-I)*Z,W=r<K?-100:Math.abs(ce-r)*Z,ue=X<K?-100:Math.abs(ce-X)*Z,ie=de<K?-100:Math.abs(ce-de)*Z),e.minPrice==="0"&&(W=0),e.maxPrice==="∞"&&(H=L),f.value?a.value=L-W+60+"px":a.value=L-W+52+"px",C.value=H+74+"px",X&&ie<L&&M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ie+", 0)"),de&&ue<L&&M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ue+", 0)");const be=un().extent([[0,0],[L,F]]).handleSize(30).on("end",ye);M.append("g").attr("class","brush").call(be).call(be.move,[W,H]);function ye(T){if(!T.sourceEvent||!T.selection)return;f.value?a.value=L-T.selection[0]+60+"px":a.value=L-T.selection[0]+52+"px",C.value=T.selection[1]+74+"px";let q,re,_e=0,g=0;e.direction?(_e=h(parseInt(String(T.selection[0]/Z+K)),Number(e.poolInfo.tickSpacing)),q=c.tickIndexToPrice(_e,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),g=h(parseInt(String(T.selection[1]/Z+K)),Number(e.poolInfo.tickSpacing)),re=c.tickIndexToPrice(g,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):(g=h(ce-T.selection[0]/Z,Number(e.poolInfo.tickSpacing)),q=1/c.tickIndexToPrice(g,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),_e=h(ce-T.selection[1]/Z,Number(e.poolInfo.tickSpacing)),re=1/c.tickIndexToPrice(_e,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),n.emit("onChangeMinPrice",String(pe(String(q),6))),n.emit("onChangeMaxPrice",String(pe(String(re),6)))}d.value.theme=="default"?eo(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):eo(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};N(""),we(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([s,$,O,I])=>{s&&$&&O&&te(s,i.value)},{immediate:!0});const k=N(!0);return we(()=>e.chartLoading,(s,$)=>{s!==$&&(k.value=s)},{immediate:!0,deep:!0}),{store:d,loading:k,zoomOut:E,zoomIn:V,rangeSizeLower:S,rangeSizeUpper:u,rangeSizeLowerPosition:a,rangeSizeUpperPosition:C,decimalFormat:on,numberformat:nn}}});const Un=e=>(no("data-v-59ae7c8b"),e=e(),to(),e),jn={class:"chart-box"},Dn={class:"chart"},En=Un(()=>t("svg",{id:"chart"},null,-1)),Fn=[En];function Wn(e,n,i,a,C,w){return A(),B("div",jn,[qe(t("div",Dn,Fn,512),[[No,!e.loading]])])}const Eo=He(Mn,[["render",Wn],["__scopeId","data-v-59ae7c8b"]]),Hn=We({components:{StatusBlock:Bo,NewPositionChart:Eo,TokenWarning:mo},setup(e){const n=N(),i=N(),a=_(()=>{var k,s;return(s=(k=v.value)==null?void 0:k.poolInfo)==null?void 0:s.needReverse}),C=Fe(),w=_(()=>C),S=_(()=>w.value.theme),u=_(()=>w.value.chainName),o=Ve(),d=_(()=>o),v=N({}),c=ro();we(()=>[d.value.currentPositionInfo,u.value],([k,s])=>{var $;(s=="Aptos"&&k||s=="Sui"&&k&&(k==null?void 0:k.nftHash)==(($=c==null?void 0:c.query)==null?void 0:$.pos))&&(v.value=k,n.value=v.value.token_a,i.value=v.value.token_b)},{immediate:!0});const h=k=>{var s;return(k==null?void 0:k.logoURI)||(k==null?void 0:k.logo_url)||((s=d.value.tokensObj[k==null?void 0:k.address])==null?void 0:s.logo_url)||(S.value==="default"?oo("/image/coins/unknown.png"):oo("/image/coins/sui-unknown.png"))},E=_(()=>u.value?ao(u.value):{}),V=N([]),x=async k=>{const s=await E.value.getTicks(k),$=s?E.value.getTickDataFromUrlData(s):[];V.value=$};we(()=>[v.value,d.value.poolsObj],([k,s])=>{k&&!he(k)&&k.poolInfo&&s&&!he(s)&&x(s[k.poolAddress])},{immediate:!0});const te=N(!0),f=(k,s)=>k!=="0"&&s!=="∞"?Me(1/(1-Number((k/s)**.25)),2)+"x":"1x",m=_(()=>v.value.minPrice&&v.value.maxPrice?f(v.value.minPrice,v.value.maxPrice):"--");return{needReverse:a,getCoinIcon:h,theme:S,indexStore:C,direct:te,addCommom:Y,decimalUi:pe,tickList:V,positionInfo:v,fromCoin:n,toCoin:i,getExplorerUrl:bo,lever:m}}}),Xn=""+globalThis.__publicAssetsURL("image/aptos-price.png"),Gn=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),zn=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),Yn=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Xe=e=>(no("data-v-f9690e82"),e=e(),to(),e),Jn={class:"new-position-info"},Qn={class:"pool-info"},Zn={class:"left"},Kn={class:"coin-a"},Vn={alt:""},xn={class:"coin-b"},et={alt:""},ot={class:"position-name"},nt=["href"],tt=Xe(()=>t("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),it=[tt],at={key:0,class:"pool-fee"},st=Xe(()=>t("span",null,"Fee tier",-1)),lt={class:"right"},ut={class:"h5-pool-info"},rt={class:"coin-info"},dt={class:"coin-a"},ct={alt:""},mt={class:"coin-b"},vt={alt:""},ft={class:"position-name"},pt=["href"],ht=Xe(()=>t("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),bt=[ht],kt={key:0,class:"pool-fee"},gt={class:"price-info"},_t={class:"price-and-chart"},wt={class:"left"},yt={class:"current-price"},At=Xe(()=>t("span",null,"Current Price",-1)),It={class:"coin-rate"},Ct=Xe(()=>t("div",null,[t("svg",{class:"icon icon-up","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),$t=Xe(()=>t("div",null,[t("svg",{class:"icon icon-down","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),St=[Ct,$t],Tt={key:0},Pt={key:1},Nt={key:0,class:"position-range"},Rt=Xe(()=>t("div",{class:"position-range-title"}," Position Range ",-1)),Ot={key:0},qt={key:1},Bt={key:2,src:Xn,alt:""},Lt={key:3,src:Gn,alt:""},Mt={key:4},Ut={key:5},jt={key:1,class:"position-range position-range-warp"},Dt={key:0,class:"position-range-title"},Et={key:1,class:"position-range-title"},Ft={key:2},Wt={key:3},Ht={class:"price-img"},Xt={key:0,src:zn,alt:""},Gt={key:1,src:Yn,alt:""},zt={key:4},Yt={key:5},Jt={class:"lever"},Qt=Xe(()=>t("div",{class:"lever-title"},"Leverage",-1)),Zt={class:"lever-text"},Kt={class:"right"},Vt=Xe(()=>t("div",{class:"chat-mask"},null,-1));function xt(e,n,i,a,C,w){var v,c,h,E,V,x,te,f,m,k,s,$,O,I,r,ee,X,de,oe,L,F,Q,ne,le,K,ce,Z,ke,M,ve;const S=mo,u=Bo,o=Eo,d=Ro("image");return A(),B("div",Jn,[t("div",Qn,[t("div",Zn,[t("div",Kn,[qe(t("img",Vn,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),se(S,{address:e.needReverse?(E=(h=e.positionInfo)==null?void 0:h.token_b)==null?void 0:E.address:(c=(v=e.positionInfo)==null?void 0:v.token_a)==null?void 0:c.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),t("div",xn,[qe(t("img",et,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),se(S,{address:e.needReverse?(f=(te=e.positionInfo)==null?void 0:te.token_a)==null?void 0:f.address:(x=(V=e.positionInfo)==null?void 0:V.token_b)==null?void 0:x.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),t("div",ot,[t("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:z(bo))("nftAddress",e.positionInfo.nftHash),target:"_blank"},U((k=(m=e.positionInfo)==null?void 0:m.name)==null?void 0:k.split("|")[1]),9,nt)]),(A(),B("svg",{class:"copy-icon","aria-hidden":"true",onClick:n[0]||(n[0]=ge=>e.indexStore.copy(e.positionInfo.nftHash))},it)),e.positionInfo.fee?(A(),B("div",at,[st,Ae(" "+U(e.positionInfo.fee*100)+"% ",1)])):me("",!0)]),t("div",lt,[se(u,{"current-status":(s=e.positionInfo)==null?void 0:s.currentStatus},null,8,["current-status"])])]),t("div",ut,[t("div",null,[t("div",rt,[t("div",dt,[qe(t("img",ct,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),se(S,{address:e.needReverse?(r=(I=e.positionInfo)==null?void 0:I.token_b)==null?void 0:r.address:(O=($=e.positionInfo)==null?void 0:$.token_a)==null?void 0:O.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),t("div",mt,[qe(t("img",vt,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),se(S,{address:e.needReverse?(oe=(de=e.positionInfo)==null?void 0:de.token_a)==null?void 0:oe.address:(X=(ee=e.positionInfo)==null?void 0:ee.token_b)==null?void 0:X.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),t("div",ft,[t("div",null,[t("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:z(bo))("nftAddress",e.positionInfo.nftHash),target:"_blank"},U((F=(L=e.positionInfo)==null?void 0:L.name)==null?void 0:F.split("|")[1]),9,pt),(A(),B("svg",{class:"copy-icon","aria-hidden":"true",onClick:n[1]||(n[1]=ge=>e.indexStore.copy(e.positionInfo.nftHash))},bt))]),e.positionInfo.fee?(A(),B("div",kt,U(e.positionInfo.fee*100)+"%",1)):me("",!0)])]),se(u,{"current-status":(Q=e.positionInfo)==null?void 0:Q.currentStatus},null,8,["current-status"])]),t("div",gt,[t("div",_t,[t("div",wt,[t("div",yt,[t("div",null,[At,t("div",It,[t("div",{onClick:n[2]||(n[2]=ge=>e.direct=!e.direct)},St)])]),(e.needReverse?!e.direct:e.direct)?(A(),B("div",Tt,[Ae(U(("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(e.positionInfo.currentPrice,6)))+"   ",1),t("span",null,U((ne=e.toCoin)==null?void 0:ne.symbol)+" per "+U((le=e.fromCoin)==null?void 0:le.symbol),1)])):(A(),B("div",Pt,[Ae(U(("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(1/e.positionInfo.currentPrice,6)))+"   ",1),t("span",null,U((K=e.fromCoin)==null?void 0:K.symbol)+" per "+U((ce=e.toCoin)==null?void 0:ce.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(A(),B("div",Nt,[Rt,t("div",null,[(e.needReverse?!e.direct:e.direct)?(A(),B("div",Ot,[Ae(U(("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(e.positionInfo.minPrice,6)))+" ",1),t("span",null,U(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(A(),B("div",qt,[Ae(U(((Z=e.positionInfo)==null?void 0:Z.minPrice)!=="0"?("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(1/e.positionInfo.minPrice,6)):0)+" ",1),t("span",null,U(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(A(),B("img",Bt)):(A(),B("img",Lt)),(e.needReverse?!e.direct:e.direct)?(A(),B("div",Mt,[Ae(U(((ke=e.positionInfo)==null?void 0:ke.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(e.positionInfo.maxPrice,6)):"∞")+" ",1),t("span",null,U(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(A(),B("div",Ut,[Ae(U(((M=e.positionInfo)==null?void 0:M.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),t("span",null,U(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(A(),B("div",jt,[(e.needReverse?!e.direct:e.direct)?(A(),B("span",Dt," Position Range ")):(A(),B("span",Et," Position Range ")),(e.needReverse?!e.direct:e.direct)?(A(),B("div",Ft,[Ae(U(("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(e.positionInfo.minPrice,6)))+" ",1),t("span",null,U(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(A(),B("div",Wt,[Ae(U(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),t("span",null,U(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),t("div",Ht,[e.theme=="default"?(A(),B("img",Xt)):(A(),B("img",Gt))]),(e.needReverse?!e.direct:e.direct)?(A(),B("div",zt,[Ae(U(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(e.positionInfo.maxPrice,6)):"∞")+" ",1),t("span",null,U(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(A(),B("div",Yt,[Ae(U(((ve=e.positionInfo)==null?void 0:ve.minPrice)!=="0"?("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(1/e.positionInfo.minPrice,6)):0)+" ",1),t("span",null,U(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),Ae("   ")]))])),t("div",Jt,[Qt,t("div",Zt,U(e.lever),1)])]),t("div",Kt,[se(o,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse&&e.positionInfo.maxPrice!=="∞"?1/e.positionInfo.maxPrice:e.positionInfo.minPrice,"max-price":e.needReverse&&e.positionInfo.minPrice!=0?1/e.positionInfo.minPrice:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),Vt])])])])}const Fo=He(Hn,[["render",xt],["__scopeId","data-v-f9690e82"]]),ei=We({components:{TokenWarning:mo},setup(e,n){const{t:i}=wo(),{$notify:a}=Jo(),C=Fe(),w=_(()=>C),S=Ve(),u=_(()=>S),o=N({}),d=N({}),v=N({}),c=_(()=>w.value.chainName),h=_(()=>c.value?ao(c.value):{}),E=ro(),V=N(!1),x=async(l=null)=>{const p=l||o.value,R=u.value.addressLpTokens[p.poolAddress];if(R){const y=await h.value.getTickDataByIndex(R.ticks_handle,Number(p.tick_lower_index)),D=await h.value.getTickDataByIndex(R.ticks_handle,Number(p.tick_upper_index));let G={};c.value==="Aptos"?G=await h.value.getPosRewardersAmount({poolAddress:O.currentRoute.value.query.address,positionName:O.currentRoute.value.query.token,tickLowerData:y,tickUpperData:D}):G=await h.value.fetchPosRewardersAmount({poolAddress:p.poolAddress,positionId:p.pos_object_id,coinTypeA:p.coin_type_a,coinTypeB:p.coin_type_b,rewarderInfo:p.poolInfo.rewarder_infos});const j=[];let W=new b(0);G.forEach((H,ie)=>{var T,q;const ue=(T=u.value.tokensObj[H.coin_address])==null?void 0:T.decimals,be=H.amount_owed.toString();let ye=new b(be).div(Math.pow(10,ue)).toString();if(c.value=="Aptos"&&Number(ye)>999999999&&(ye="0"),p.poolInfo[`rewarder_display${ie+1}`]||Number(ye)>0){const re=u.value.tokensObj[H.coin_address],_e=((q=u.value.RATES[H.coin_address])==null?void 0:q.price)||0,g=new b(ye).mul(_e).toString();W=new b(W).plus(g),j.push({...H,...re,amount:Number(ye)>0?Se(ye,ue):0,amountUSD:Number(g)>0?Se(g,2):0,amountUSDText:g})}}),I.value=j}};we(()=>[u.value.currentPositionInfo,c.value],([l,p])=>{var R;p=="Aptos"&&l?(o.value=l,d.value=l==null?void 0:l.token_a,v.value=l==null?void 0:l.token_b):p=="Sui"&&l&&(l==null?void 0:l.nftHash)==((R=E==null?void 0:E.query)==null?void 0:R.pos)&&(o.value=l,d.value=l==null?void 0:l.token_a,v.value=l==null?void 0:l.token_b,V.value=!1)},{immediate:!0}),we(()=>[o.value,u.value.addressLpTokens],([l,p])=>{!he(l)&&!he(p)&&x(l)},{immediate:!0});const te=_(()=>{var l,p,R,y,D,G,j,W;if(o.value&&!he(o.value)&&u.value.RATES){const H=o.value.amountA*((p=u.value.RATES[(l=o.value)==null?void 0:l.token_a.address])==null?void 0:p.price),ie=o.value.amountB*((y=u.value.RATES[(R=o.value)==null?void 0:R.token_b.address])==null?void 0:y.price);if((G=u.value.RATES[(D=o.value)==null?void 0:D.token_a.address])!=null&&G.price&&((W=u.value.RATES[(j=o.value)==null?void 0:j.token_b.address])!=null&&W.price)){const ue=Number(H+ie);return ue>0&&ue<.01?"<0.01":Y(Me(H+ie,2),2)}else return" --"}else return" --"}),f=_(()=>{var l,p;return(p=(l=o.value)==null?void 0:l.poolInfo)==null?void 0:p.needReverse}),m=_(()=>u.value.RATES),k=_(()=>{var l,p;if(m.value&&d.value&&v.value&&!he(m.value)&&!he(d.value)&&!he(v.value)){const R=[],y=Number(o.value.feeOwedA)||0,D=Number(o.value.feeOwedB)||0,G=new b(y).mul(((l=m.value[d.value.address])==null?void 0:l.price)||0),j=new b(D).mul(((p=m.value[v.value.address])==null?void 0:p.price)||0);return R.push({amount:y,amountUSD:G.toString()},{amount:D,amountUSD:j.toString()}),R}return[]}),s=_(()=>{var p,R;let l=new b(0);return(p=k.value)==null||p.forEach(y=>{l=l.add(new b(y.amountUSD))}),c.value=="Sui"&&((R=I.value)==null||R.forEach(y=>{l=l.add(new b(y.amountUSDText))})),l.toNumber()}),$=_(()=>{var p;let l=new b(0);return(p=I.value)==null||p.forEach(R=>{l=l.add(new b(R.amountUSDText))}),l.toNumber()}),O=io(),I=N([]),{setIsShowSuccess:r,setIsShowRejected:ee,setIsShowWaiting:X,setTransactionDesc:de,setTransactionTxid:oe}=C,L=uo(),F=_(()=>L),Q=async()=>{V.value=!0;let l={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:I.value.length,collect_fee:!0};l.coinTypeC=I.value[0]?I.value[0].coin_address:"",l.coinTypeD=I.value[1]?I.value[1].coin_address:"",l.coinTypeE=I.value[2]?I.value[2].coin_address:"",X(!0),de();try{let p;if(c.value==="Aptos"){const R=await h.value.getCollectRewarderTransactionPayload(l);p=await F.value.currentWallet.signAndSubmitTransaction(R)}else{l.pos_index=o.value.pos_object_id;const R=await h.value.getCollectRewarderTransactionPayload(l),y=await F.value.currentWallet.signAndExecuteTransactionBlock(R);p=h.value.handleTx(y)}if(p&&p.hash){oe(p.hash),X(!1),r(!0);const R={title:"Claim",desc:"",hash:p.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};c.value!=="Aptos"&&(R.res=p.res),h.value.showTransitionPending(R),await h.value.watchTransaction(R)&&n.emit("getDetails")}else X(!1),ee(!0),V.value=!1}catch{X(!1),ee(!0),V.value=!1}},ne=N(!1),le=async()=>{ne.value=!0;const l=I.value;let p={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:l.length};p.coinTypeC=l[0]?l[0].coin_address:"",p.coinTypeD=l[1]?l[1].coin_address:"",p.coinTypeE=l[2]?l[2].coin_address:"";try{let R;if(c.value==="Aptos"){const y=await h.value.getCollectRewarderTransactionPayload(p);R=await F.value.currentWallet.signAndSubmitTransaction(y)}else{p.pos_index=o.value.pos_object_id;const y=await h.value.getCollectRewarderTransactionPayload(p),D=await F.value.currentWallet.signAndExecuteTransactionBlock(y);R=h.value.handleTx(D)}if(R&&R.hash){oe(R.hash),X(!1),r(!0);const y=l[0].amount+l[0].symbol,D=p.coinTypeD?" and "+l[1].amount+l[1].symbol:"",G=p.coinTypeE?" and "+l[2].amount+l[2].symbol:"",j={title:"Claim",desc:"",hash:R.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:l[0].address,numa:`+ ${Number(l[0].amount)}`,logoa:u.value.tokensObj&&l[0]&&l[0].address&&u.value.tokensObj[l[0].address]&&u.value.tokensObj[l[0].address].logoURI,tokenb:l[1]&&l[1].address,numb:p.coinTypeD?`+ ${Number(l[1].amount)}`:"",logob:p.coinTypeD?u.value.tokensObj&&l[1]&&l[1].address&&u.value.tokensObj[l[1].address]&&u.value.tokensObj[l[1].address].logoURI:"",tokenc:l[2]&&l[2].address,numc:p.coinTypeE?`+ ${Number(l[2].amount)}`:"",logoc:p.coinTypeE?u.value.tokensObj&&l[2]&&l[2].address&&u.value.tokensObj[l[2].address]&&u.value.tokensObj[l[2].address].logoURI:""},text:y+D+G};c.value!=="Aptos"&&(j.res=R.res),h.value.showTransitionPending(j),await h.value.watchTransaction(j)&&setTimeout(()=>{n.emit("getDetails"),h.value.getAccount(F.value.address)},3e3)}else X(!1),ee(!0);ne.value=!1}catch{ne.value=!1,X(!1),ee(!0)}},K=_(()=>u.value.positionDetailCurrentTab),ce=_(()=>{var R,y,D,G,j,W;const l=pe(f.value?(y=o.value)==null?void 0:y.amountB:(R=o.value)==null?void 0:R.amountA,f.value?(W=(j=o.value)==null?void 0:j.token_b)==null?void 0:W.decimals:(G=(D=o.value)==null?void 0:D.token_a)==null?void 0:G.decimals),p=f.value?u.value.positionActionAmount.toCoinAmount||0:u.value.positionActionAmount.fromCoinAmount||0;if(K.value=="increase")return p?new b(l).add(new b(p)).toString():"";if(p){const H=new b(l).minus(new b(p)).toString();return H<0?"0":String(H)}else return""}),Z=_(()=>{var R,y,D,G,j,W;const l=pe(f.value?(y=o.value)==null?void 0:y.amountA:(R=o.value)==null?void 0:R.amountB,f.value?(W=(j=o.value)==null?void 0:j.token_a)==null?void 0:W.decimals:(G=(D=o.value)==null?void 0:D.token_b)==null?void 0:G.decimals),p=f.value?u.value.positionActionAmount.fromCoinAmount||0:u.value.positionActionAmount.toCoinAmount||0;if(K.value=="increase")return p?new b(l).add(new b(p)).toString():"";if(p){const H=new b(l).minus(new b(p)).toString();return H<0?"0":String(H)}else return""}),ke=_(()=>f.value?u.value.positionActionAmount.toCoinAmount:u.value.positionActionAmount.fromCoinAmount),M=_(()=>f.value?u.value.positionActionAmount.fromCoinAmount:u.value.positionActionAmount.toCoinAmount),ve=l=>{var p;return(l==null?void 0:l.logoURI)||(l==null?void 0:l.logo_url)||((p=u.value.tokensObj[l==null?void 0:l.address])==null?void 0:p.logo_url)||(w.value.theme==="default"?oo("/image/coins/unknown.png"):oo("/image/coins/sui-unknown.png"))},ge=_(()=>{var G,j,W,H,ie,ue,be,ye,T,q,re,_e;const{fromCoinAmount:l,toCoinAmount:p}=u.value.positionActionAmount,R=u.value.positionDetailCurrentTab,y=pe(f.value?(j=o.value)==null?void 0:j.amountB:(G=o.value)==null?void 0:G.amountA,f.value?(ue=(ie=o.value)==null?void 0:ie.token_b)==null?void 0:ue.decimals:(H=(W=o.value)==null?void 0:W.token_a)==null?void 0:H.decimals),D=pe(f.value?(ye=o.value)==null?void 0:ye.amountA:(be=o.value)==null?void 0:be.amountB,f.value?(_e=(re=o.value)==null?void 0:re.token_a)==null?void 0:_e.decimals:(q=(T=o.value)==null?void 0:T.token_b)==null?void 0:q.decimals);return c.value=="Sui"||R=="remove"&&c.value=="Aptos"&&l==y&&p==D});return{amountUSD:te,needReverse:f,decimalUi:pe,pendingFees:k,positionInfo:o,pendingRewarderArr:I,pendingYieldAmount:s,toClaim:async()=>{V.value=!0;const l=Y(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,p=Y(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;de(i("newAdd.claimWaitingText",{from:f.value?p:l,and:Y(o.value.feeOwedA,o.value.token_a.decimals)==0||Y(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:f.value?l:p})),X(!0);let R;const y={pool:o.value.poolInfo,position:o.value};try{const D=await h.value.getCollectFeeTransactionPayload(y);if(c.value==="Aptos")R=await F.value.currentWallet.signAndSubmitTransaction(D);else{const G=await F.value.currentWallet.signAndExecuteTransactionBlock(D);R=h.value.handleTx(G)}if(R){oe(R.hash),X(!1),r(!0);const G={title:"Claim",desc:"",hash:R.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:Y(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:Y(o.value.feeOwedA,o.value.token_a.decimals)==0?"":u.value.tokensObj&&o.value&&o.value.token_a.address&&u.value.tokensObj[o.value.token_a.address]&&u.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:Y(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:Y(o.value.feeOwedB,o.value.token_b.decimals)==0?"":u.value.tokensObj&&o.value&&o.value.token_b.address&&u.value.tokensObj[o.value.token_b.address]&&u.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${Y(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${Y(o.value.feeOwedA,o.value.token_a.decimals)==0||Y(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${Y(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};c.value!=="Aptos"&&(G.res=R.res),h.value.showTransitionPending(G),await h.value.watchTransaction(G)&&setTimeout(()=>{n.emit("getDetails")},1e3)}else X(!1),ee(!0),a.error({icon:ze("svg",{class:{icon:!0},"aria-hidden":!0},[ze("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:ze("div",{class:"notification-title"},[ze("span",{innerHTML:Ao.global.t("newAdd.claimFailed")},null)]),description:i("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});V.value=!1}catch{V.value=!1,X(!1),ee(!0),a.error({icon:ze("svg",{class:{icon:!0},"aria-hidden":!0},[ze("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:ze("div",{class:"notification-title"},[ze("span",{innerHTML:Ao.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:i("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},claimAll:Q,fromCoin:d,toCoin:v,showNum:Se,claimLoading:V,addCommom:Y,afterBase:ce,afterQuote:Z,fromCoinAmount:ke,toCoinAmount:M,checkNullObj:he,getCoinIcon:ve,chainName:c,isShowAfterAmount:ge,pendingRewarderAmount:$,toClaimRewards:le,rewarderLoading:ne}}});const oi={class:"liquidity-card"},ni={class:"liquidity-title"},ti={class:"liquidity-usd"},ii=t("span",null,"Liquidity",-1),ai={class:"liquidity-ratio"},si={class:"coin-ratio"},li={class:"coin-a-ratio"},ui={class:"coin-b-ratio"},ri={class:"ratio-progress"},di={class:"base-quote-num"},ci={class:"base-coin-num"},mi=t("span",null,"Base",-1),vi={alt:""},fi={key:0,class:"after"},pi={class:"quote-coin-num"},hi=t("span",null,"Quote",-1),bi={alt:""},ki={key:0,class:"after"},gi={class:"pending-yield"},_i={class:"left"},wi={class:"pending-yield-title"},yi={key:0,class:"after"},Ai={class:"right"},Ii={class:"fees-rewards"},Ci={class:"fees-rewards-item"},$i=t("span",null,"Fees",-1),Si={key:0,class:"after"},Ti=t("span",null,"Fees",-1),Pi={key:0,class:"after"},Ni=t("span",null,"Bonus",-1),Ri={alt:""},Oi={key:0,class:"after"},qi={key:0,class:"pending-yield"},Bi={class:"left"},Li=t("div",{class:"pending-yield-title"},"Pending rewards",-1),Mi={key:0,class:"after"},Ui={class:"right"},ji={key:1,class:"fees-rewards"},Di={class:"fees-rewards-item"},Ei=t("span",null,"Bonus",-1),Fi={alt:""},Wi={key:0,class:"after"};function Hi(e,n,i,a,C,w){var d,v,c,h,E,V,x,te,f,m,k,s,$,O,I,r,ee,X,de,oe,L,F,Q,ne,le,K,ce,Z,ke,M,ve,ge,De,l,p,R,y,D,G,j,W,H,ie,ue,be,ye,T,q,re,_e,g,J,P,ae,fe,$e,Pe,Ie,Ne,Ue,je,Ge,Re,Le;const S=mo,u=co,o=Ro("image");return A(),B("div",oi,[t("div",ni,[t("div",ti,[ii,t("div",null,"$"+U(e.amountUSD),1)]),t("div",ai,[t("div",si,[t("div",li,[t("span",null,U(e.needReverse?(v=e.toCoin)==null?void 0:v.symbol:(d=e.fromCoin)==null?void 0:d.symbol),1),Ae(" "+U(e.needReverse?(h=e.positionInfo)==null?void 0:h.toPercent:(c=e.positionInfo)==null?void 0:c.fromPercent)+"% ",1)]),t("div",ui,[t("span",null,U(e.needReverse?(V=e.fromCoin)==null?void 0:V.symbol:(E=e.toCoin)==null?void 0:E.symbol),1),Ae(" "+U(e.needReverse?(te=e.positionInfo)==null?void 0:te.fromPercent:(x=e.positionInfo)==null?void 0:x.toPercent)+"% ",1)])]),t("div",ri,[t("div",{class:"from-percent",style:Io({width:e.needReverse?((m=e.positionInfo)==null?void 0:m.toPercent)+"%":((f=e.positionInfo)==null?void 0:f.fromPercent)+"%"})},null,4),t("div",{class:"to-percent",style:Io({width:e.needReverse?((s=e.positionInfo)==null?void 0:s.fromPercent)+"%":((k=e.positionInfo)==null?void 0:k.toPercent)+"%"})},null,4)])])]),t("div",di,[t("div",ci,[mi,t("div",null,[qe(t("img",vi,null,512),[[o,(e.needReverse?(O=e.toCoin)==null?void 0:O.logo_url:($=e.fromCoin)==null?void 0:$.logo_url)||e.getCoinIcon(e.needReverse?(r=e.positionInfo)==null?void 0:r.token_b:(I=e.positionInfo)==null?void 0:I.token_a)]]),se(S,{address:e.needReverse?(oe=(de=e.positionInfo)==null?void 0:de.token_b)==null?void 0:oe.address:(X=(ee=e.positionInfo)==null?void 0:ee.token_a)==null?void 0:X.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,U(("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(e.needReverse?(F=e.positionInfo)==null?void 0:F.amountB:(L=e.positionInfo)==null?void 0:L.amountA,e.needReverse?(K=(le=e.positionInfo)==null?void 0:le.token_b)==null?void 0:K.decimals:(ne=(Q=e.positionInfo)==null?void 0:Q.token_a)==null?void 0:ne.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:z(he))(e.positionInfo)?(A(),B("div",fi,U(("addCommom"in e?e.addCommom:z(Y))(e.afterBase))+" after ",1)):me("",!0)]),t("div",pi,[hi,t("div",null,[qe(t("img",bi,null,512),[[o,(e.needReverse?(Z=e.fromCoin)==null?void 0:Z.logo_url:(ce=e.toCoin)==null?void 0:ce.logo_url)||e.getCoinIcon(e.needReverse?(M=e.positionInfo)==null?void 0:M.token_a:(ke=e.positionInfo)==null?void 0:ke.token_b)]]),se(S,{address:e.needReverse?(l=(De=e.positionInfo)==null?void 0:De.token_a)==null?void 0:l.address:(ge=(ve=e.positionInfo)==null?void 0:ve.token_b)==null?void 0:ge.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,U(("addCommom"in e?e.addCommom:z(Y))(("decimalUi"in e?e.decimalUi:z(pe))(e.needReverse?(R=e.positionInfo)==null?void 0:R.amountA:(p=e.positionInfo)==null?void 0:p.amountB,e.needReverse?(j=(G=e.positionInfo)==null?void 0:G.token_a)==null?void 0:j.decimals:(D=(y=e.positionInfo)==null?void 0:y.token_b)==null?void 0:D.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:z(he))(e.positionInfo)?(A(),B("div",ki,U(("addCommom"in e?e.addCommom:z(Y))(e.afterQuote))+" after ",1)):me("",!0)])]),t("div",gi,[t("div",_i,[t("div",wi,U(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),t("div",null,[Ae(" $"+U(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:z(Y))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(A(),B("span",yi,"$0 after")):me("",!0)])]),t("div",Ai,[se(u,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.pendingYieldAmount==0,onClick:n[0]||(n[0]=Ce=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Qe(()=>[Ae("Claim")]),_:1},8,["loading","disabled"])])]),t("div",Ii,[t("div",Ci,[t("div",null,[$i,t("div",null,[qe(t("img",null,null,512),[[o,(e.needReverse?(H=e.toCoin)==null?void 0:H.logo_url:(W=e.fromCoin)==null?void 0:W.logo_url)||e.getCoinIcon(e.needReverse?(ue=e.positionInfo)==null?void 0:ue.token_b:(ie=e.positionInfo)==null?void 0:ie.token_a)]]),se(S,{address:e.needReverse?(q=(T=e.positionInfo)==null?void 0:T.token_b)==null?void 0:q.address:(ye=(be=e.positionInfo)==null?void 0:be.token_a)==null?void 0:ye.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,U(e.needReverse?("showNum"in e?e.showNum:z(Se))(e.positionInfo.feeOwedB,(J=(g=e.positionInfo)==null?void 0:g.token_b)==null?void 0:J.decimals):("showNum"in e?e.showNum:z(Se))(e.positionInfo.feeOwedA,(_e=(re=e.positionInfo)==null?void 0:re.token_a)==null?void 0:_e.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:z(he))(e.positionInfo)&&e.isShowAfterAmount?(A(),B("div",Si," 0 after ")):me("",!0)]),t("div",null,[Ti,t("div",null,[qe(t("img",null,null,512),[[o,(e.needReverse?(ae=e.fromCoin)==null?void 0:ae.logo_url:(P=e.toCoin)==null?void 0:P.logo_url)||e.getCoinIcon(e.needReverse?($e=e.positionInfo)==null?void 0:$e.token_a:(fe=e.positionInfo)==null?void 0:fe.token_b)]]),se(S,{address:e.needReverse?(Ue=(Ne=e.positionInfo)==null?void 0:Ne.token_a)==null?void 0:Ue.address:(Ie=(Pe=e.positionInfo)==null?void 0:Pe.token_b)==null?void 0:Ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,U(e.needReverse?("showNum"in e?e.showNum:z(Se))(e.positionInfo.feeOwedA,(Le=(Re=e.positionInfo)==null?void 0:Re.token_a)==null?void 0:Le.decimals):("showNum"in e?e.showNum:z(Se))(e.positionInfo.feeOwedB,(Ge=(je=e.positionInfo)==null?void 0:je.token_b)==null?void 0:Ge.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:z(he))(e.positionInfo)&&e.isShowAfterAmount?(A(),B("div",Pi," 0 after ")):me("",!0)]),e.chainName=="Sui"?(A(!0),B(po,{key:0},ho(e.pendingRewarderArr,Ce=>(A(),B("div",{key:Ce},[Ni,t("div",null,[qe(t("img",Ri,null,512),[[o,Ce.logo_url]]),se(S,{address:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,U(Ce.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:z(he))(e.positionInfo)&&e.isShowAfterAmount?(A(),B("div",Oi," 0 after ")):me("",!0)]))),128)):me("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(A(),B("div",qi,[t("div",Bi,[Li,t("div",null,[Ae(" $"+U(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:z(Y))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(A(),B("span",Mi,"$0 after")):me("",!0)])]),t("div",Ui,[se(u,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Qe(()=>[Ae("Claim")]),_:1},8,["loading","disabled","onClick"])])])):me("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(A(),B("div",ji,[t("div",Di,[(A(!0),B(po,null,ho(e.pendingRewarderArr,Ce=>(A(),B("div",{key:Ce},[Ei,t("div",null,[qe(t("img",Fi,null,512),[[o,Ce.logo_url]]),se(S,{address:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,U(Ce.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:z(he))(e.positionInfo)&&e.isShowAfterAmount?(A(),B("div",Wi," 0 after ")):me("",!0)]))),128))])])):me("",!0)])}const Wo=He(ei,[["render",Hi]]),Xi=We({components:{AssetsCard:vo},setup(e,n){const i=N(""),a=N(""),C=Fe(),w=_(()=>C),S=_(()=>w.value.theme),u=Ve(),o=_(()=>u),d=N(!1),v=N(!1),c=N(!0),h=_(()=>w.value.chainName),E=_(()=>h.value?ao(h.value):{}),V=uo(),x=_(()=>V),te=_(()=>w.value.slippage),f=N(),m=N(),k=_(()=>x.value.assets&&f.value&&x.value.assets[f.value.address]?Co(x.value.assets[f.value.address].balance,f.value.decimals):0),s=_(()=>x.value.assets&&m.value&&x.value.assets[m.value.address]?Co(x.value.assets[m.value.address].balance,m.value.decimals):0),$=y=>{y==="fromCoin"?(c.value=!0,h.value==="Aptos"?i.value=k.value>0?f.value.symbol=="APT"?new b(Number(k.value)).sub(new b(.1)).lt(new b(0))?"0":new b(Number(k.value)).sub(new b(.1)).toString():String(k.value):"":i.value=k.value>0?f.value.symbol=="SUI"?new b(Number(k.value)).sub(new b(.05)).lt(new b(0))?"0":new b(Number(k.value)).sub(new b(.05)).toString():String(k.value):""):(c.value=!1,h.value==="Aptos"?a.value=s.value>0?m.value.symbol=="APT"?new b(Number(s.value)).sub(new b(.1)).lt(new b(0))?"0":new b(Number(s.value)).sub(new b(.1)).toString():String(s.value):"":a.value=s.value>0?m.value.symbol=="SUI"?new b(Number(s.value)).sub(new b(.05)).lt(new b(0))?"0":new b(Number(s.value)).sub(new b(.05)).toString():String(s.value):"")},O=y=>{y==="fromCoin"?(c.value=!0,i.value=Me(new b(Number(k.value)).div(2).toString(),f.value.decimals).toString()):(c.value=!1,a.value=Me(new b(Number(s.value)).div(2).toString(),m.value.decimals).toString())},I=N({}),r=N(!0),ee=N({}),X=N(),de=N(),oe=()=>{var q;if(!I.value||!i.value&&!a.value)return;const{TickMath:y,TickUtil:D}=E.value;let G=I.value.minPrice,j=I.value.maxPrice.indexOf("+")>0?"∞":I.value.maxPrice,W=Number(I.value.tick_lower_index),H=Number(I.value.tick_upper_index);const ie=Number(I.value.current_tick_index);let ue,be,ye=Number(G).toString(),T=I.value.maxPrice.indexOf("+")>0||I.value.maxPrice==="∞"?"∞":Number(j);if(ye=="0"&&T=="∞"?(W=Number(I.value.tick_lower_index),H=Number(I.value.tick_upper_index)):(ue=y.priceToSqrtPriceX64(new b(G),f.value.decimals,m.value.decimals),be=y.priceToSqrtPriceX64(new b(j),f.value.decimals,m.value.decimals)),X.value=W,de.value=H,j!=="∞"&&W>=H){d.value=!0,i.value="",v.value=!0,a.value="";return}if(j=="∞"||ie>=W&&ie<=H){d.value=!1,v.value=!1;let re;if(i.value||a.value){if(c.value){const fe=new b(i.value).mul(Math.pow(10,f.value.decimals)).toString();re=new Oe(fe)}else{const fe=new b(a.value).mul(Math.pow(10,m.value.decimals)).toString();re=new Oe(fe)}const{liquidityAmount:_e,tokenMaxA:g,tokenMaxB:J,tokenMaxAOrigin:P,tokenMaxBOrigin:ae}=E.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:f.value,tokenB:m.value,lowerTick:W,upperTick:H,coinAmount:re,iscoinA:r.value?c.value:!c.value,roundUp:!0,slippage:Number(te.value)/100,curSqrtPrice:new Oe(I.value.current_sqrt_price)});ee.value={liquidityAmount:_e,tokenMaxA:g,tokenMaxB:J,tokenMaxAOrigin:P,tokenMaxBOrigin:ae},r.value?c.value?a.value=Number(J)>0?J:"":i.value=Number(g)>0?g:"":c.value?a.value=g:i.value=J}}else if(ie>H){if(i.value="",d.value=!0,v.value=!1,i.value||a.value){let re;const _e=new b(a.value).mul(Math.pow(10,(q=m.value)==null?void 0:q.decimals)).toString();re=new Oe(_e),ee.value={liquidityAmount:Oo(ue,be,re),tokenMaxA:0,tokenMaxB:a.value}}}else if(ie<W){if(d.value=!1,v.value=!0,a.value="",i.value||a.value){let re;const _e=new b(i.value).mul(Math.pow(10,f.value.decimals)).toString();re=new Oe(_e),ee.value={liquidityAmount:qo(ue,be,re),tokenMaxA:i.value,tokenMaxB:0}}}else d.value=!0,i.value="",v.value=!0,a.value="";u.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:a})};we(()=>o.value.currentPositionInfo,y=>{if(y&&!he(y)){I.value=y,f.value=I.value.token_a,m.value=I.value.token_b;let D=Number(I.value.tick_lower_index),G=Number(I.value.tick_upper_index);const j=Number(I.value.current_tick_index);(y.maxPrice.indexOf("+")>0||y.maxPrice==="∞"?"∞":y.maxPrice)=="∞"||j>=D&&j<=G?(d.value=!1,v.value=!1):j>G?(i.value="",d.value=!0,v.value=!1):j<D?(d.value=!1,v.value=!0,a.value=""):(d.value=!0,i.value="",v.value=!0,a.value=""),oe()}},{immediate:!0}),we(i,(y,D)=>{y&&oe(),y==""&&(a.value="")}),we(a,(y,D)=>{y&&oe(),y==""&&(i.value="")});const L=_(()=>{var y,D;return(D=(y=I.value)==null?void 0:y.poolInfo)==null?void 0:D.needReverse}),F=_(()=>o.value.RATES),Q=_(()=>{var H,ie,ue,be;const y=((ie=F.value[(H=f.value)==null?void 0:H.address])==null?void 0:ie.price)||0,D=((be=F.value[(ue=m.value)==null?void 0:ue.address])==null?void 0:be.price)||0,G=new b(y).mul(new b(i.value||0)),j=new b(D).mul(new b(a.value||0)),W=G.add(j);return W.toNumber()?W.toNumber()>0&&W.toNumber()>.01?Y(W.toString(),2):"<0.01":"--"}),ne=N(!1),{t:le,locale:K}=wo(),ce=_(()=>{const y=Number(i.value)>Number(k.value),D=Number(a.value)>Number(s.value);return!i.value&&!a.value?le("button.enterAmount"):y?le("button.insufficientBalance",{name:f.value.symbol}):D?le("button.insufficientBalance",{name:m.value.symbol}):le("newAdd.addMore")}),Z=_(()=>{const y=Number(i.value)>Number(k.value),D=Number(a.value)>Number(s.value);return!!(!i.value&&!a.value||y||D)}),{setIsShowSuccess:ke,setIsShowRejected:M,setIsShowWaiting:ve,setTransactionDesc:ge,setTransactionTxid:De,setPositiomNum:l}=C,p=N(!1);return{theme:S,showFromCoinLock:d,showToCoinLock:v,toCoinAmount:a,fromCoinAmount:i,fromCoinBlance:k,toCoinBlance:s,fromCoin:f,toCoin:m,maxBtnSelect:$,halfBtnSelect:O,fixedFromCoin:c,needReverse:L,totalAmount:Q,wallet:x,addLiquidityBtnText:ce,isShowLiquidityModal:ne,indexStore:C,positionInfo:I,actionLoading:p,toAdd:async()=>{var H,ie,ue,be,ye,T,q,re,_e,g;ne.value=!1,p.value=!0,De("");const y=d.value?"":`${i.value} ${(H=f.value)==null?void 0:H.symbol}`,D=v.value?"":`${a.value} ${(ie=m.value)==null?void 0:ie.symbol}`;ge(le("tips.increaseLiquiditySuccess",{from:L.value?D:y,and:!d.value&&!v.value?"and":"",to:L.value?y:D})),ve(!0);const G=c.value,j=I.value.poolInfo.rewarder_infos;let W={};W.coinTypeC=j[0]?j[0].coinAddress:"",W.coinTypeD=j[1]?j[1].coinAddress:"",W.coinTypeE=j[2]?j[2].coinAddress:"";try{const J=await E.value.getAddLiquidityTransactionPayload({pool:{poolAddress:I.value.poolAddress,token_a:I.value.token_a,token_b:I.value.token_b},amount:G?ee.value.tokenMaxA:ee.value.tokenMaxB,fix_amount_a:G,tick_lower:X.value,tick_upper:de.value,index:h.value==="Aptos"?I.value.index:I.value.pos_object_id,slippage:Number(te.value)/100,roundUp:!0,collect_fee:!0,...W,curSqrtPrice:new Oe(I==null?void 0:I.value.poolInfo.current_sqrt_price)});let P;if(h.value==="Aptos")P=await x.value.currentWallet.signAndSubmitTransaction(J);else{const ae=await x.value.currentWallet.signAndExecuteTransactionBlock(J);P=E.value.handleTx(ae)}if(P&&P.hash){De(P.hash),ve(!1),ke(!0);const ae={title:"Supplied",desc:le("tips.addLiquiditySuccessText",{from:d.value?"":`${i.value} ${(ue=f.value)==null?void 0:ue.symbol}`,and:!d.value&&!v.value?"and":"",to:v.value?"":`${a.value} ${(be=m.value)==null?void 0:be.symbol}`}),hash:P.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:L.value?`${(T=m.value)==null?void 0:T.address}`:`${(ye=f.value)==null?void 0:ye.address}`,numa:L.value?`- ${a.value}`:`- ${i.value}`,logoa:L.value?o.value.tokensObj&&m.value&&m.value.address&&o.value.tokensObj[m.value.address]&&o.value.tokensObj[m.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI,tokenb:L.value?`${(re=f.value)==null?void 0:re.address}`:`${(q=m.value)==null?void 0:q.address}`,numb:L.value?`- ${i.value}`:`- ${a.value}`,logob:L.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&m.value&&m.value.address&&o.value.tokensObj[m.value.address]&&o.value.tokensObj[m.value.address].logoURI},text:`Deopsit ${d.value?"":`${i.value} ${(_e=f.value)==null?void 0:_e.symbol}`} ${!d.value&&!v.value?"and":""} ${v.value?"":`${a.value} ${(g=m.value)==null?void 0:g.symbol}`}`};h.value!=="Aptos"&&(ae.res=P.res),E.value.showTransitionPending(ae),await E.value.watchTransaction(ae)&&setTimeout(()=>{n.emit("getDetails"),E.value.getAccount(x.value.address)},1e3),l()}else ve(!1),M(!0);i.value="",a.value="",p.value=!1}catch{i.value="",a.value="",p.value=!1,ve(!1),M(!0)}},addLiquidityBtnDisabled:Z,poolStore:u}}});const Gi={class:"new-position-asset"},zi={class:"add-or-remove"},Yi={class:"liquidity-action-tab"},Ji=t("div",{class:"increase tab-active"}," Increase ",-1),Qi={class:"card-item"},Zi={class:"card-item"},Ki={key:0,class:"add",src:cn},Vi={key:1,class:"add",src:mn},xi={class:"total-amount"},ea=t("span",null,"Total Amount",-1);function oa(e,n,i,a,C,w){var v;const S=vo,u=rn,o=co,d=dn;return A(),B("div",Gi,[t("div",zi,[t("div",Yi,[Ji,t("div",{class:"remove",onClick:n[0]||(n[0]=c=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),t("div",{class:lo(e.needReverse?"card-container reverse":"card-container")},[t("div",Qi,[se(S,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=c=>e.fromCoinAmount=c),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:n[2]||(n[2]=c=>e.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=c=>e.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=c=>{e.fromCoinAmount=c}),onOnFocus:n[5]||(n[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(A(),Be(u,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):me("",!0)]),t("div",Zi,[se(S,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[6]||(n[6]=c=>e.toCoinAmount=c),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:n[7]||(n[7]=c=>e.maxBtnSelect("toCoin")),onOnHalf:n[8]||(n[8]=c=>e.halfBtnSelect("toCoin")),onOnInput:n[9]||(n[9]=c=>{e.toCoinAmount=c}),onOnFocus:n[10]||(n[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(A(),Be(u,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):me("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(A(),B("img",Ki)):me("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(A(),B("img",Vi)):me("",!0)],2),t("div",xi,[ea,t("span",null,"$"+U(e.totalAmount),1)])]),e.wallet.connected?(A(),Be(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:n[11]||(n[11]=c=>e.isShowLiquidityModal=!0)},{default:Qe(()=>[t("span",null,U(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(A(),Be(o,{key:1,class:"big-btn",onClick:n[12]||(n[12]=c=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Qe(()=>[t("span",null,U(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(A(),Be(d,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(v=e.positionInfo)==null?void 0:v.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:n[13]||(n[13]=c=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):me("",!0)])}const _o=He(Xi,[["render",oa]]),na=We({components:{AssetsCard:vo},setup(e,n){const i=N(""),a=N(""),C=Fe(),w=_(()=>C),S=_(()=>w.value.theme),u=Ve(),o=_(()=>u),d=N(!1),v=N(!1),c=N(!0),h=_(()=>w.value.chainName),E=_(()=>h.value?ao(h.value):{}),V=uo(),x=_(()=>V),te=_(()=>w.value.slippage),f=N(),m=N(),k=_(()=>{var g,J;return(J=(g=r.value)==null?void 0:g.poolInfo)==null?void 0:J.needReverse}),s=_(()=>{var g;return pe(r==null?void 0:r.value.amountA,(g=r==null?void 0:r.value.token_a)==null?void 0:g.decimals)}),$=_(()=>{var g;return pe(r==null?void 0:r.value.amountB,(g=r==null?void 0:r.value.token_b)==null?void 0:g.decimals)}),O=g=>{g==="fromCoin"?c.value=!0:c.value=!1,Q.value=100,le({value:1})},I=g=>{g==="fromCoin"?(c.value=!0,i.value=Me(new b(Number(s.value)).div(2).toString(),f.value.decimals).toString()):(c.value=!1,a.value=Me(new b(Number($.value)).div(2).toString(),m.value.decimals).toString()),L.value=!1},r=N({}),ee=N(!0),X=N({}),de=N(),oe=N(),L=N(!0),F=()=>{var Ge;if(L.value||!r.value||!i.value&&!a.value||Number(i.value)>Number(s.value)||Number(a.value)>Number($.value))return;if(i.value==s.value&&a.value==$.value){Q.value=100,le({value:1}),L.value=!0;return}const{TickMath:g,TickUtil:J}=E.value;let P=r.value.minPrice,ae=r.value.maxPrice.indexOf("+")>0?"∞":r.value.maxPrice,fe=Number(r.value.tick_lower_index),$e=Number(r.value.tick_upper_index);const Pe=Number(r.value.current_tick_index);let Ie,Ne,Ue=Number(P).toString(),je=r.value.maxPrice.indexOf("+")>0||r.value.maxPrice==="∞"?"∞":Number(ae);if(Ue=="0"&&je=="∞"?(fe=Number(r.value.tick_lower_index),$e=Number(r.value.tick_upper_index)):(Ie=g.priceToSqrtPriceX64(new b(P),f.value.decimals,m.value.decimals),Ne=g.priceToSqrtPriceX64(new b(ae),f.value.decimals,m.value.decimals)),de.value=fe,oe.value=$e,ae!=="∞"&&fe>=$e){d.value=!0,i.value="",v.value=!0,a.value="";return}if(ae=="∞"||Pe>=fe&&Pe<=$e){d.value=!1,v.value=!1;let Re;if(i.value||a.value){if(c.value){const Ze=new b(i.value).mul(Math.pow(10,f.value.decimals)).toString();Re=new Oe(Ze)}else{const Ze=new b(a.value).mul(Math.pow(10,m.value.decimals)).toString();Re=new Oe(Ze)}const{liquidityAmount:Le,tokenMaxA:Ce,tokenMaxB:Ye,tokenMaxAOrigin:so,tokenMaxBOrigin:Te}=E.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:f.value,tokenB:m.value,lowerTick:fe,upperTick:$e,coinAmount:Re,iscoinA:ee.value?c.value:!c.value,roundUp:h.value!="Sui",slippage:Number(te.value)/100,curSqrtPrice:new Oe(r.value.current_sqrt_price)});X.value={liquidityAmount:Le,tokenMaxA:Ce,tokenMaxB:Ye,tokenMaxAOrigin:so,tokenMaxBOrigin:Te},ee.value?c.value?a.value=Number(Ye)>0?Ye:"":i.value=Number(Ce)>0?Ce:"":c.value?a.value=Ce:i.value=Ye}}else if(Pe>$e){if(i.value="",d.value=!0,v.value=!1,i.value||a.value){let Re;const Le=new b(a.value).mul(Math.pow(10,(Ge=m.value)==null?void 0:Ge.decimals)).toString();Re=new Oe(Le),X.value={liquidityAmount:Oo(Ie,Ne,Re),tokenMaxA:0,tokenMaxB:a.value}}}else if(Pe<fe){if(d.value=!1,v.value=!0,a.value="",i.value||a.value){let Re;const Le=new b(i.value).mul(Math.pow(10,f.value.decimals)).toString();Re=new Oe(Le),X.value={liquidityAmount:qo(Ie,Ne,Re),tokenMaxA:i.value,tokenMaxB:0}}}else d.value=!0,v.value=!0;L.value=!1,Q.value=new b(X.value.liquidityAmount.toString()).div(r.value.liquidity).mul(100).toNumber().toFixed(2),ne.value=X.value.liquidityAmount,u.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:a})},Q=N(50),ne=N("0"),le=g=>{if(!L.value)return;L.value=!0;const J=r.value.token_a.decimals,P=r.value.token_b.decimals,ae=r.value.tick_lower_index,fe=r.value.tick_upper_index,$e=$o.tickIndexToSqrtPriceX64(ae),Pe=$o.tickIndexToSqrtPriceX64(fe);let Ie="";g.value!==1?Ie=new b(r.value.liquidity).mul(g.value).toString():Ie=r.value.liquidity,Ie=Me(Ie,0)||"0",ne.value=Ie;const Ne=tn.getCoinAmountFromLiquidity(new Oe(Ie),new Oe(r.value.current_sqrt_price),$e,Pe,h.value!="Sui"),Ue=new b(Ne.coinA.toString()).div(Math.pow(10,J)).toString(),je=new b(Ne.coinB.toString()).div(Math.pow(10,P)).toString();i.value=Number(Ue)>0?Ue:"",a.value=Number(je)>0?je:"",u.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:a})};we(()=>o.value.currentPositionInfo,g=>{if(g&&!he(g)){r.value=g,f.value=r.value.token_a,m.value=r.value.token_b,le({value:Q.value/100});let J=Number(r.value.tick_lower_index),P=Number(r.value.tick_upper_index);const ae=Number(r.value.current_tick_index);(g.maxPrice.indexOf("+")>0||g.maxPrice==="∞"?"∞":g.maxPrice)=="∞"||ae>=J&&ae<=P?(d.value=!1,v.value=!1):ae>P?(i.value="",d.value=!0,v.value=!1):ae<J?(d.value=!1,v.value=!0,a.value=""):(d.value=!0,i.value="",v.value=!0,a.value=""),F()}},{immediate:!0}),we(i,(g,J)=>{g&&F(),g==""&&(a.value="",Q.value=0)}),we(a,(g,J)=>{g&&F(),g==""&&(i.value="",Q.value=0)});const K=_(()=>o.value.RATES),ce=_(()=>{var $e,Pe,Ie,Ne;const g=((Pe=K.value[($e=f.value)==null?void 0:$e.address])==null?void 0:Pe.price)||0,J=((Ne=K.value[(Ie=m.value)==null?void 0:Ie.address])==null?void 0:Ne.price)||0,P=new b(g).mul(new b(i.value||0)),ae=new b(J).mul(new b(a.value||0)),fe=P.add(ae);return Y(fe.toString(),2)}),Z=N(!1),{t:ke,locale:M}=wo(),ve=_(()=>{const g=Number(i.value)>Number(s.value),J=Number(a.value)>Number($.value);return!i.value&&!a.value?ke("button.enterAmount"):g||J?"Invalid Amount":ke("button.remove")}),ge=_(()=>{const g=Number(i.value)>Number(s.value),J=Number(a.value)>Number($.value);return!!(!i.value&&!a.value||g||J)}),{setIsShowSuccess:De,setIsShowRejected:l,setIsShowWaiting:p,setTransactionDesc:R,setTransactionTxid:y,setPositiomNum:D,setTransactionDescText:G}=C,j=N(!1);we(Q,Qo((g,J)=>{g!==J&&(Number(g)>100?Q.value=100:g&&r.value?(Q.value=g,le({value:Q.value/100})):(i.value="",a.value=""))},300)),we(te,g=>{g&&r.value&&le({value:Q.value/100})});const W=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],H=Lo(),ie=_(()=>H),ue=_(()=>ie.value.status),be=N(!1),ye=g=>{g.sources.forEach(P=>{const{pool_address:ae,position_index:fe}=JSON.parse(P.blockchainAddress);ae==r.value.poolAddress&&Number(fe)==Number(r.value.index)&&(be.value=!0)})},T=async()=>{await H.getSources();let g;ie.value.allSources.forEach(J=>{const{pool_address:P,position_index:ae}=JSON.parse(J.blockchainAddress);P==r.value.poolAddress&&ae==r.value.index&&(g=J.id)}),H.deleteSource(g)};we(()=>[ie.value.sourceGroups,r.value],([g,J])=>{g&&g.sources&&g.sources.length>0&&J&&!he(J)&&ye(g)},{immediate:!0,deep:!0});const q=io(),re=ro();return{theme:S,showFromCoinLock:d,showToCoinLock:v,toCoinAmount:a,fromCoinAmount:i,fromCoinBlance:s,toCoinBlance:$,fromCoin:f,toCoin:m,maxBtnSelect:O,halfBtnSelect:I,fixedFromCoin:c,needReverse:k,totalAmount:ce,wallet:x,addLiquidityBtnText:ve,isShowLiquidityModal:Z,indexStore:C,positionInfo:r,actionLoading:j,addLiquidityBtnDisabled:ge,sliderVal:Q,ratioArr:W,setPercent:le,poolStore:u,isSlider:L,toRemove:async()=>{var fe,$e,Pe,Ie,Ne,Ue,je,Ge,Re,Le,Ce,Ye,so;j.value=!0,y("");const g=Y(i.value,f.value.decimals)==0?"":`${pe(i.value,f.value.decimals)} ${f.value.symbol}`,J=Y(a.value,m.value.decimals)==0?"":`${pe(a.value,m.value.decimals)} ${m.value.symbol}`;R(ke("tips.removeLiquidiyText",{from:k.value?J:g,and:Y(i.value,f.value.decimals)==0||Y(a.value,m.value.decimals)==0?"":"and",to:k.value?g:J})),p(!0);const P=r.value.poolInfo.rewarder_infos,ae=P&&P.length>0&&h.value=="Sui"||P&&P.length>0&&Q.value==100?ke("modal.removeLiquidityText1"):ke("modal.removeLiquidityText2");G(ae);try{let Te={};Te={pool:{...r.value.poolInfo,coinA:r.value.token_a,coinB:r.value.token_b},coinTypeA:r.value.poolInfo.coinTypeA,coinTypeB:r.value.poolInfo.coinTypeB,position:r.value,delta_liquidity:Q.value==100?new Oe(r.value.liquidity):new Oe(Me(ne.value,0)),slippage:Number(te.value),rewards_num:P.length},Te.coinTypeC=P[0]?P[0].coinAddress:"",Te.coinTypeD=P[1]?P[1].coinAddress:"",Te.coinTypeE=P[2]?P[2].coinAddress:"";const Ze=await E.value.getRemoveLiquidityTransactionPayload(Te);let Ee;if(h.value==="Aptos")Ee=await x.value.currentWallet.signAndSubmitTransaction(Ze);else{const xe=await x.value.currentWallet.signAndExecuteTransactionBlock(Ze);Ee=E.value.handleTx(xe)}if(Ee&&Ee.hash){y(Ee.hash),p(!1),De(!0);const xe={title:ke("common.removeLiquidity"),desc:"",hash:Ee.hash,descTransactions:`Remove ${i.value} ${(fe=f.value)==null?void 0:fe.symbol} and ${a.value} ${($e=m.value)==null?void 0:$e.symbol} 
             from the pool`,sender:x.value.address,chainName:h.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:k.value?`${(Ie=m.value)==null?void 0:Ie.address}`:`${(Pe=f.value)==null?void 0:Pe.address}`,numa:k.value?`+ ${a.value}`:`+ ${i.value}`,logoa:k.value?o.value.tokensObj&&m.value&&m.value.address&&o.value.tokensObj[m.value.address]&&o.value.tokensObj[m.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI,tokenb:k.value?`${(Ne=f.value)==null?void 0:Ne.address}`:`${(Ue=m.value)==null?void 0:Ue.address}`,numb:k.value?`+ ${i.value}`:`+ ${a.value}`,logob:k.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&m.value&&m.value.address&&o.value.tokensObj[m.value.address]&&o.value.tokensObj[m.value.address].logoURI},text:`Withdraw ${i.value} ${(je=f.value)==null?void 0:je.symbol} and ${a.value} ${(Ge=m.value)==null?void 0:Ge.symbol}`};h.value!=="Aptos"&&(xe.res=Ee.res),E.value.showTransitionPending(xe);const yo=await E.value.watchTransaction(xe);if(P.value&&P.value.length>0&&(Number((Re=P[0])==null?void 0:Re.amount)!==0||Te.coinTypeD&&Number((Le=P[1])==null?void 0:Le.amount)!==0||Te.coinTypeE&&Number((Ce=P[2])==null?void 0:Ce.amount)!==0)){const fo={title:ke("common.removeLiquidity"),desc:"",hash:Ee.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:P[0].symbol,numa:`+ ${Number(P[0].amount)}`,logoa:o.value.tokensObj&&P[0]&&P[0].address&&o.value.tokensObj[P[0].address]&&o.value.tokensObj[P[0].address].logoURI,tokenb:Te.coinTypeD?P[1].symbol:"",numb:Te.coinTypeD?`+ ${Number(P[1].amount)}`:"",logob:Te.coinTypeD?o.value.tokensObj&&P[1]&&P[1].address&&o.value.tokensObj[P[1].address]&&o.value.tokensObj[P[1].address].logoURI:"",tokenc:Te.coinTypeE?P[2].symbol:"",numc:Te.coinTypeE?`+ ${Number(P[2].amount)}`:"",logoc:Te.coinTypeE?o.value.tokensObj&&P[2]&&P[2].address&&o.value.tokensObj[P[2].address]&&o.value.tokensObj[P[2].address].logoURI:""},text:`Withdraw ${i.value} ${(Ye=f.value)==null?void 0:Ye.symbol} and ${a.value} ${(so=m.value)==null?void 0:so.symbol}`},Xo=await E.value.setTransations(fo)}if(Se(r.value.feeOwedA,r.value.token_a.decimals)!==0||Se(r.value.feeOwedB,r.value.token_b.decimals)!==0){const fo={title:"Claim",desc:"",hash:Ee.hash,chainName:h.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${r.value.token_a.symbol}`,numa:Y(r.value.feeOwedA,r.value.token_a.decimals)==0?"":`+ ${Se(r.value.feeOwedA,r.value.token_a.decimals)}`,logoa:Y(r.value.feeOwedA,r.value.token_a.decimals)==0?"":o.value.tokensObj&&r.value&&r.value.token_a.address&&o.value.tokensObj[r.value.token_a.address]&&o.value.tokensObj[r.value.token_a.address].logoURI,tokenb:`${r.value.token_b.symbol}`,numb:Y(r.value.feeOwedB,r.value.token_b.decimals)==0?"":`+ ${Se(r.value.feeOwedB,r.value.token_b.decimals)}`,logob:Y(r.value.feeOwedB,r.value.token_b.decimals)==0?"":o.value.tokensObj&&r.value&&r.value.token_b.address&&o.value.tokensObj[r.value.token_b.address]&&o.value.tokensObj[r.value.token_b.address].logoURI}},Xo=await E.value.setTransations(fo)}yo&&Number(Q.value)==100&&ue.value=="authenticated"&&be.value&&(await H.subscribePosition({pool_address:r.value.poolAddress,position_index:r.value.index},r.value.nftHash,!1),T()),yo&&(i.value="",a.value="",setTimeout(()=>{n.emit("getDetails")},3e3),setTimeout(()=>{n.emit("getDetails")},6e3),Number(Q.value)==100&&re.name=="new-position-detail"&&(h.value==="Aptos"?q.push("/position"):q.push("/pool/position")),Q.value=0)}else p(!1),l(!0);j.value=!1}catch{j.value=!1,p(!1),l(!0)}},sFixD:Me}}});const ta={class:"new-position-asset"},ia={class:"add-or-remove"},aa={class:"liquidity-action-tab"},sa=t("div",{class:"remove tab-active"},"Remove",-1),la={class:"card-item"},ua={key:0,class:"assets-card-mask"},ra={class:"card-item"},da={key:0,class:"assets-card-mask"},ca={class:"remove-ratio"},ma=t("div",{class:"remove-ratio-title"},"Amount",-1),va={class:"remove-ratio-select"},fa={key:0,class:"ratio"},pa={key:1,class:"ratio"},ha={class:"ratio-list"},ba=["onClick"];function ka(e,n,i,a,C,w){const S=vo,u=Zo,o=co;return A(),B("div",ta,[t("div",ia,[t("div",aa,[t("div",{class:"increase",onClick:n[0]||(n[0]=d=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),sa]),t("div",{class:lo(e.needReverse?"card-container reverse":"card-container")},[t("div",la,[se(S,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=d=>e.fromCoinAmount=d),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:n[2]||(n[2]=d=>e.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=d=>e.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=d=>{e.fromCoinAmount=d,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(A(),B("div",ua)):me("",!0)]),t("div",ra,[se(S,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[5]||(n[5]=d=>e.toCoinAmount=d),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:n[6]||(n[6]=d=>e.maxBtnSelect("toCoin")),onOnHalf:n[7]||(n[7]=d=>e.halfBtnSelect("toCoin")),onOnInput:n[8]||(n[8]=d=>{e.toCoinAmount=d,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(A(),B("div",da)):me("",!0)])],2),t("div",ca,[ma,t("div",va,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(A(),B("div",fa,U(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:z(Me))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:z(Me))(e.sliderVal,2))+"% ",1)):(A(),B("div",pa," -- ")),t("div",ha,[(A(!0),B(po,null,ho(e.ratioArr,(d,v)=>(A(),B("div",{key:v,class:lo(["ratio-item",e.sliderVal==d.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=d.value}},U(d.name),11,ba))),128))])]),se(u,{value:e.sliderVal,"onUpdate:value":n[9]||(n[9]=d=>e.sliderVal=d)},null,8,["value"])])]),e.wallet.connected?(A(),Be(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Qe(()=>[t("span",null,U(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(A(),Be(o,{key:1,class:"big-btn",onClick:n[10]||(n[10]=d=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Qe(()=>[t("span",null,U(e.$t("button.connectWallet")),1)]),_:1}))])}const ga=He(na,[["render",ka]]),_a=We({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const n=Lo(),i=_(()=>n),a=_(()=>i.value.status),C=Fe();we(()=>[i.value.targetGroups],v=>{},{immediate:!0});const w=N(!1);we(()=>a.value,v=>{v=="authenticated",w.value=!1},{immediate:!0});const S=N(!1),u=async()=>{S.value=!S.value;const v={pool_address:e.positionInfo.poolAddress,position_index:e.positionInfo.index},c=e.positionInfo.nftHash;try{await n.subscribePosition(v,c,S.value)}catch{S.value=!S.value}},o=v=>{const c=v.sources;S.value=c.some(h=>JSON.parse(h.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(h.blockchainAddress).position_index)==Number(e.positionInfo.index))},d=io();return we(()=>[i.value.sourceGroups,e.positionInfo],([v,c])=>{var h,E,V;S.value=!1,v&&v.length>0&&v[0]&&c&&!he(c)&&((V=(E=(h=d==null?void 0:d.currentRoute)==null?void 0:h.value)==null?void 0:E.query)==null?void 0:V.token)==(c==null?void 0:c.name)&&o(v[0])},{immediate:!0,deep:!0}),{importIcon:oo,isShowSetUp:w,changeSwitch:u,checked:S,notifiStatus:a,store:C}}});const wa=e=>(no("data-v-8f838b7e"),e=e(),to(),e),ya={class:"range-alerts"},Aa={class:"range-alerts-top"},Ia={class:"title"},Ca=wa(()=>t("div",{class:"title-all"},[t("span",{class:"Range"},"Range Alerts")],-1)),$a={key:1,class:"h5-switch-box"},Sa={class:"range-alerts-bottom"},Ta={key:0,class:"pc-switch-box"};function Pa(e,n,i,a,C,w){const S=co,u=Vo;return A(),B("div",ya,[t("div",Aa,[t("div",Ia,[Ca,e.isShowSetUp||e.notifiStatus!=="authenticated"?(A(),Be(S,{key:0,class:"range-alerts-button",onClick:n[0]||(n[0]=Ko(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Qe(()=>[Ae(" Set up ")]),_:1})):me("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(A(),B("div",$a,[se(u,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):me("",!0)])]),t("div",Sa,[Ae(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(A(),B("div",Ta,[se(u,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):me("",!0)])])}const Ho=He(_a,[["render",Pa],["__scopeId","data-v-8f838b7e"]]),Na=We({components:{NewPositionTitle:Do,NewPositionInfo:Fo,NewPositionLiquidity:Wo,NewPositionAssetAdd:_o,NewPositionAssetRemove:_o,NewPositionNotifi:Ho},setup(){const e=N(),n=N(),i=N(),a=Fe(),C=_(()=>a),w=_(()=>C.value.chainName),S=Ve(),u=_(()=>S),o=io();Po(()=>{e.value={},S.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),u.value.setCurrentPositionLoading(!0)});const d=async()=>{u.value.setCurrentPositionLoading(!0);const m=o.currentRoute.value.query.token||"",k=o.currentRoute.value.query.collect||"",s=o.currentRoute.value.query.address||"",$=o.currentRoute.value.query.pos||"",O=o.currentRoute.value.query.id||"";w.value==="Aptos"?m&&k&&s&&u.value.setCurrentPositionInfo(s,k,m,w.value):m&&s&&$?u.value.setCurrentPositionInfo(s,k,m,w.value,$):O&&u.value.setCurrentPositionInfo("","","",w.value,O)};we(()=>u.value.poolConfigObj,m=>{m&&!he(m)&&d()},{immediate:!0});const v=_(()=>u.value.currentPositionLoading),c=_(()=>{var k,s,$;const m=(($=(s=(k=o==null?void 0:o.currentRoute)==null?void 0:k.value)==null?void 0:s.query)==null?void 0:$.address)||"";return m&&u.value.addressLpTokens&&!he(u.value.addressLpTokens)&&u.value.addressLpTokens[m]?u.value.addressLpTokens[m]:null});we(()=>c.value,(m,k)=>{m&&!he(m)&&(e.value=m),m&&!he(m)&&m.current_sqrt_price!==(k==null?void 0:k.current_sqrt_price)&&d()},{immediate:!0});const h=ro();we(()=>[u.value.currentPositionInfo,w.value],([m,k])=>{var s;(k=="Aptos"&&m||k=="Sui"&&m&&(m==null?void 0:m.nftHash)==((s=h==null?void 0:h.query)==null?void 0:s.pos))&&(e.value=m,n.value=e.value.token_a,i.value=e.value.token_b)},{immediate:!0});const E=_(()=>u.value.positionDetailCurrentTab),V=uo(),x=_(()=>V),te=_(()=>C.value.theme);return xo(()=>{x.value.connected||(te.value==="default"?o.push("/position"):o.push("/pool/position"))}),{positionInfo:e,fromCoin:n,toCoin:i,getDetails:d,currentPositionLoading:v,positionDetailCurrentTab:E,clickRefresh:()=>{d()},chainName:w}}});const Ra={class:"new-position-detail"},Oa={class:"new-position-content"},qa={class:"left"},Ba={class:"right"},La={class:"loading-global"};function Ma(e,n,i,a,C,w){const S=Do,u=Fo,o=Wo,d=_o,v=ga,c=Ho,h=en;return A(),B("div",Ra,[se(S,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),t("div",Oa,[t("div",qa,[se(u),se(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),t("div",Ba,[e.positionDetailCurrentTab=="increase"?(A(),Be(d,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(A(),Be(v,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),se(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="∞"&&e.chainName=="Sui"?(A(),Be(c,{key:2,"position-info":e.positionInfo},null,8,["position-info"])):me("",!0)])]),qe(t("div",La,[se(h)],512),[[No,e.currentPositionLoading]])])}const ss=He(Na,[["render",Ma],["__scopeId","data-v-6904756a"]]);export{ss as default};
