import{_ as mo}from"./refresh-icon.592b5268.js";import{_ as vo,a as fo}from"./coin-select.1a058287.js";import{a as po,_ as bo}from"./network-tips.a92e6a61.js";import{a as be,j as qe,u as Se,i as ne,f as _,g as we,r as Fe,_ as Co,v as je,b as go,D as C,s as ge,p as Me,c as he}from"./import-icon.595a6b0d.js";import{a as Qe,M as ho,J as Ke,f as w,r as d,i as ye,H as Ao,o as g,c as Y,y as ue,k as o,t as i,v as x,j as y,u as ee,m as ce,x as V,B as ze,p as ke,q as Ie,T as wo,w as Z,l as $,L as So,N as yo,b as ko,e as Io,W as Ae,h as Le,G as No,z as Bo}from"./entry.9c1d4bf3.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./img-no-Positions_2x.e4de9d60.js";const We={SUI:{symbol:"SUI",name:"Sui Coin",decimals:8,balance:0,address:"0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet::BTC"},sBTC:{symbol:"sBTC",name:"Wrapped BTC",decimals:8,balance:0,address:"0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet::BTC"},sETH:{symbol:"sETH",name:"Wrapped Ether",decimals:8,balance:0,address:"0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet::ETH"},USDC:{symbol:"USDC",name:"USDC Coin",decimals:6,balance:12e3,address:"0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet::USDC"},USDT:{symbol:"USDT",name:"Tether USD",decimals:6,balance:1e4,address:"0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet::USDT"}},Oo={"USDT-USDC":{symbol:"USDT-USDC",name:"USDT-USDC",decimals:6,coinA:We.USDT,coinB:We.USDC,feeDenominator:"10000",feeNumerator:"1",fee:"0.01",address:"0x1ce98d89494e9d3d7935bc3bd5fc714fc2abb99db3f024162552c4ba172f4d28::amm_swap::PoolLiquidityCoin<0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet::USDT,0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet::USDC>"}};function To(e,t){const m=Object.values(Oo).filter(v=>e===v.coinA.symbol&&t===v.coinB.symbol||e===v.coinB.symbol&&t===v.coinA.symbol);return m&&m[0]||null}const Uo=Qe({components:{Modal:ho},props:{fromCoin:{type:Object,required:!0},toCoin:{type:Object,required:!0},fromCoinAmount:{type:String,required:!0},toCoinAmount:{type:String,required:!0},impact:{type:Number,required:!0},fee:{type:String,required:!0},fixedFromCoin:{type:Boolean,required:!0},formatFee:{type:String,default:""}},emits:["to-swap","on-close"],setup(e,t){const{t:m,locale:v}=Ke(),N=be(),R=qe();w(()=>R);const c=w(()=>{const u=To(e.fromCoin.symbol,e.toCoin.symbol);return we(Fe(e.fromCoinAmount).mul(Fe(u.fee).div(100)).toString(),e.fromCoin.decimals)}),O=d(N.slippage||.5),I=d(!0),J=d(!1);function G(u){I.value=u}const L=async()=>{t.emit("to-swap")},Q=Se(),k=w(()=>Q),K=w(()=>k.value.tokensObj&&e.fromCoin.address&&k.value.tokensObj[e.fromCoin.address]&&k.value.tokensObj[e.fromCoin.address].logoURI),W=w(()=>k.value.tokensObj&&e.toCoin.address&&k.value.tokensObj[e.toCoin.address]&&k.value.tokensObj[e.toCoin.address].logoURI),h=be(),p=w(()=>h);return{fromCoinUrl:K,toCoinUrl:W,t:m,importIcon:ne,fixD:_,decimalFormat:we,direct:I,changeDirect:G,rateChange:J,clickNextBtn:L,slippage:O,liquidityProviderFee:c,getCoinIcon:u=>{var S;return(u==null?void 0:u.logoURI)||(u==null?void 0:u.logo_url)||((S=k.value.tokensObj[u==null?void 0:u.address])==null?void 0:S.logo_url)||(p.value.theme==="default"?ne("/image/coins/unknown.png"):ne("/image/coins/sui-unknown.png"))}}}});const Ne=e=>(ke("data-v-7e64b12b"),e=e(),Ie(),e),Do=Ne(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),Ro={class:"swap-confirm-container"},$o={class:"card-content"},Eo={class:"top"},Po={class:"coin"},_o=["src"],Fo=Ne(()=>o("div",{class:"svg-box"},[o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-swap2"})])],-1)),jo={class:"coin"},Mo=["src"],Lo={class:"bottom"},Wo={class:"induction"},qo={class:"item"},Qo={class:"induction-text"},Ko={class:"induction-value induction-value-change"},zo={key:0},Ho={key:1},Xo=Ne(()=>o("use",{"xlink:href":"#icon-a-icon-change2"},null,-1)),Yo=[Xo],Zo={class:"item"},Jo={class:"induction-text"},Go={class:"induction-value"},Vo={class:"item"},xo={class:"induction-text"},en={class:"induction-value"},on={class:"item"},nn={class:"induction-text"},sn={class:"item"},an={class:"induction-text"},tn={class:"induction-value"};function ln(e,t,m,v,N,R){const c=ze,O=Ao("Modal");return g(),Y(O,{width:"440px",visible:!0,footer:null,title:e.$t("modal.swapConfirmTitle"),class:"swap-confirm-modal",onCancel:t[2]||(t[2]=I=>e.$emit("on-close"))},{closeIcon:ue(()=>[Do]),default:ue(()=>[o("div",Ro,[o("div",$o,[o("div",Eo,[o("div",Po,[o("img",{src:e.fromCoinUrl||e.getCoinIcon(e.fromCoin)},null,8,_o),o("p",null,i(e.fromCoinAmount),1),x("    "),o("p",null,i(e.fromCoin.symbol),1)]),Fo,o("div",jo,[o("img",{src:e.toCoinUrl||e.getCoinIcon(e.toCoin)},null,8,Mo),o("p",null,i(e.toCoinAmount),1),x("    "),o("p",null,i(e.toCoin.symbol),1)])]),o("div",Lo,[o("div",Wo,[o("div",qo,[o("div",Qo,i(e.$t("common.rate")),1),o("div",Ko,[e.rateChange?(g(),y("span",Ho," 1 "+i(e.toCoin.symbol)+" ≈ "+i(("fixD"in e?e.fixD:ee(_))(Number(e.fromCoinAmount)/Number(e.toCoinAmount),e.toCoin.decimals))+" "+i(e.fromCoin.symbol),1)):(g(),y("span",zo," 1 "+i(e.fromCoin.symbol)+" ≈ "+i(("fixD"in e?e.fixD:ee(_))(Number(e.toCoinAmount)/Number(e.fromCoinAmount),e.toCoin.decimals))+" "+i(e.toCoin.symbol),1)),(g(),y("svg",{class:"icon-change","aria-hidden":"true",onClick:t[0]||(t[0]=I=>e.rateChange=!e.rateChange)},Yo))])]),o("div",Zo,[o("div",Jo,i(e.$t("modal.slippageTolerance")),1),o("div",Go,i(e.slippage)+"%",1)]),o("div",Vo,[o("div",xo,i(e.fixedFromCoin?e.$t("common.minimumReceived"):e.$t("common.maximumSold")),1),o("div",en,i(e.fixedFromCoin?("fixD"in e?e.fixD:ee(_))(e.toCoinAmount-Number(e.toCoinAmount)*Number(e.slippage)/100,e.toCoin.decimals):("fixD"in e?e.fixD:ee(_))(Number(e.fromCoinAmount)*Number(e.slippage)/100+Number(e.fromCoinAmount),e.fromCoin.decimals))+" "+i(e.fixedFromCoin?e.toCoin.symbol:e.fromCoin.symbol),1)]),o("div",on,[o("div",nn,i(e.$t("common.priceImpact")),1),o("div",{class:ce(["induction-value",e.impact<1?"impact-s":e.impact<10&&e.impact>1?"impact-w":"impact-e"])},i(e.impact<.01?"<0.01":e.impact>100?"100":e.impact)+"% ",3)]),o("div",sn,[o("div",an,i(e.$t("common.fee")),1),o("div",tn,i(e.formatFee)+" "+i(e.fromCoin.symbol)+" ("+i(e.fee*100)+"%) ",1)])])])])]),V(c,{class:"big-btn swap-confirm-btn",onClick:t[1]||(t[1]=I=>e.clickNextBtn())},{default:ue(()=>[x(i(e.$t("button.confirmSwap")),1)]),_:1})]),_:1},8,["title"])}const un=ye(Uo,[["render",ln],["__scopeId","data-v-7e64b12b"]]);async function rn(e){const{prices:t}=await $fetch(`https://api.coingecko.com/api/v3/coins/${e}/market_chart?vs_currency=usd&id=${e}&days=1&interval=hourly`,{headers:{Connection:"keep-alive",Accept:"*/*"}});return t}const dn={props:{coin:{type:Object,default:()=>({})},refresh:{type:Boolean,default:!1},id:{type:String,default:""}},setup(e,t){const{$echarts:m}=wo();let v=null,N;const R=d(!0),c=(u,S,r)=>{N={xAxis:{type:"category",boundaryGap:!1,show:!1,data:S},yAxis:{type:"value",show:!1,min:function(s){return s.min-s.min*.1},max:function(s){return s.max+s.max*.1}},grid:{top:1,right:1,bottom:1,left:1},tooltip:{trigger:"axis",borderWidth:0,padding:0,backgroundColor:"transparent",axisPointer:{lineStyle:{color:k.value.chainName=="Aptos"?"#68FFD8":"#76C8FF"}},formatter:function(s){return`<div class="chart-tip">
              <div>${s&&s[0]&&s[0].name}</div>
              <div>$${_(s&&s[0]&&s[0].value,4)}</div>
            </chart-tip>`}},color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:k.value.chainName=="Aptos"?"#0C4535":"#2E546D"},{offset:1,color:k.value.chainName=="Aptos"?"#151817":"#1B1B1B"}]},series:[{data:u,type:"line",showSymbol:!1,areaStyle:{},lineStyle:{color:k.value.chainName=="Aptos"?"#68FFD8":"#76C8FF",width:2,type:"solid"}}]},N&&v.clear(),N&&v.setOption(N,!0),v.resize(),R.value=!1},O=Se(),I=w(()=>O),J=d(""),G=d(""),L=async u=>{var z,oe;const S=[],r=[],s=await rn(u);J.value=s&&s.length>1&&(s[s.length-1][1]-s[0][1])/s[0][1]*100,G.value=s&&s.length>1&&s[s.length-1][1],s.forEach(te=>{S.push(te[1]);const me=je(te[0],"MD"),B=je(te[0],"HM");r.push(me+" "+B)});let re=document.getElementById(`main${(z=e.coin)==null?void 0:z.name}`);v=m.init(re),c(S,r,(oe=e.coin)==null?void 0:oe.name)},Q=be(),k=w(()=>Q),K=w(()=>k.value.chainName),W=w(()=>Co[K.value]);Z(()=>e.id,(u,S)=>{console.log(u,S,"===>oldValue"),console.log(!R.value,"!isFirst.value"),u&&setTimeout(()=>{L(u)},1e3)},{immediate:!0});const h=d(""),p=d(""),ae=d("");return Z(()=>[I.value.tokensObj,e.coin],([u,S])=>{var r,s;u&&S&&u[S.address]&&(console.log(u[S.address],"===>newValue[coin.address]"),p.value=((r=u[S.address])==null?void 0:r.labels)&&((s=u[S.address])==null?void 0:s.labels[0]),h.value=u[S.address].name,ae.value=u[S.address].symbol)},{immediate:!0,deep:!0}),Z(()=>e.refresh,u=>{u&&L(e.id)}),{store:Q,importIcon:ne,fixD:_,config:W,price_rate_24h:J,nowPrice:G,coinName:h,coinLabels:p,coinSymbol:ae}}};const cn=e=>(ke("data-v-f7d5a1ed"),e=e(),Ie(),e),mn={class:"token-info"},vn={class:"token-info-padding"},fn={class:"token-info-header"},pn={class:"left"},bn=["src"],Cn={class:"name"},gn={class:"desc"},hn={class:"right"},An={class:"price"},wn={class:"token-info-footer"},Sn={class:"left"},yn={class:"address"},kn={class:"pc-address"},In={class:"h5-address"},Nn=cn(()=>o("use",{"xlink:href":"#icon-icon-copy"},null,-1)),Bn=[Nn],On={class:"right"},Tn=["id"];function Un(e,t,m,v,N,R){var c;return g(),y("div",mn,[o("div",vn,[o("div",fn,[o("div",pn,[o("img",{src:m.coin.logoURI||v.importIcon(`/image/coins/${m.coin.symbol.toLowerCase()}.png`)},null,8,bn),o("div",null,[o("div",Cn,i(v.coinSymbol),1),o("div",gn,[o("span",null,i(v.coinName)+" "+i(v.coinLabels?`(${v.coinLabels})`:""),1)])])]),o("div",hn,[o("div",An,"$"+i(v.fixD(v.nowPrice,2)),1),v.price_rate_24h?(g(),y("div",{key:0,class:ce(v.price_rate_24h>0?"increase up":v.price_rate_24h<0?"increase down":"increase up")},i(v.price_rate_24h>0?`+ ${v.fixD(v.price_rate_24h,2)}`:v.price_rate_24h<0?+`${v.fixD(v.price_rate_24h,2)}`:`+${v.fixD(v.price_rate_24h,2)}`)+"% ",3)):$("",!0)])]),o("div",wn,[o("div",Sn,[o("div",yn,[o("span",kn,i(m.coin&&m.coin.address.substr(0,8))+" ... "+i(m.coin&&m.coin.address.substr(m.coin.address.length-8,8)),1),o("span",In,i(m.coin&&m.coin.address.substr(0,4))+" ... "+i(m.coin&&m.coin.address.substr(m.coin.address.length-4,4)),1),(g(),y("svg",{class:"icon","aria-hidden":"true",onClick:t[0]||(t[0]=O=>v.store.copy(m.coin&&m.coin.address))},Bn))])]),o("div",On,[o("div",{id:`main${(c=m.coin)==null?void 0:c.name}`,class:"main"},null,8,Tn)])])])])}const Dn=ye(dn,[["render",Un],["__scopeId","data-v-f7d5a1ed"]]),Rn=Qe({setup(){const e=Le(),t=So(yo,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0}),{t:m,locale:v}=Ke(),N=be(),R=Se(),c=w(()=>R);let O=d(!1),I=d(!1),J=d(!1),G=d(!1),L=d(!1),Q=d(!1);const k=d("fromCoin"),K=d(""),W=d(""),h=d(!1),p=d(!0),ae=d(!1),u=d(!1),S=d(!1),r=d(""),s=d(""),re=d(20),z=d(0),oe=d(null),te=d(!1),me=w(()=>N.slippage),B=w(()=>N.chainName),E=w(()=>B.value?go(B.value):{}),a=d(),l=d(),Be=w(()=>R.getPoolInfoSuccess),He=w(()=>A.value&&A.value.is_pause?"Pool Closed":!a.value||!l.value?m("modal.selectTokenModalTitle"):!A.value&&Be.value?"Pool Not Found":te.value?m("button.insufficientLiquidity"):!Number(r.value)||Number(r.value)==0||Number(s.value)==0?m("button.enterAmount"):Number(r.value)>Number(P.value)?m("button.insufficientBalance",{name:a.value.symbol}):m("button.swap")),Xe=n=>{var b,f,j,T;k.value=n,n==="fromCoin"?(K.value=((b=l.value)==null?void 0:b.address)||"",W.value=((f=a.value)==null?void 0:f.address)||""):(K.value=((j=a.value)==null?void 0:j.address)||"",W.value=((T=l.value)==null?void 0:T.address)||""),h.value=!0},Ye=n=>{r.value="",s.value="",k.value==="fromCoin"?(l.value&&n.address.toLowerCase()===(l==null?void 0:l.value.address.toLowerCase())&&(l.value=null),a.value=n):(a.value&&n.address.toLowerCase()===(a==null?void 0:a.value.address.toLowerCase())&&(a.value=null),l.value=n),h.value=!1},Ze=n=>{n==="fromCoin"?(p.value=!0,B.value==="Aptos"?r.value=P.value>0?a.value.symbol=="APT"?new C(Number(P.value)).sub(new C(.1)).lt(new C(0))?"0":new C(Number(P.value)).sub(new C(.1)).toString():String(P.value):"":r.value=P.value>0?a.value.symbol=="SUI"?new C(Number(P.value)).sub(new C(1e-4)).lt(new C(0))?"0":new C(Number(P.value)).sub(new C(1e-4)).toString():String(P.value):""):(p.value=!1,B.value==="Aptos"?s.value=F.value>0?l.value.symbol=="APT"?new C(Number(F.value)).sub(new C(.1)).lt(new C(0))?"0":new C(Number(F.value)).sub(new C(.1)).toString():String(F.value):"":s.value=F.value>0?l.value.symbol=="SUI"?new C(Number(F.value)).sub(new C(1e-4)).lt(new C(0))?"0":new C(Number(F.value)).sub(new C(1e-4)).toString():String(F.value):"")},Je=n=>{n==="fromCoin"?(p.value=!0,r.value=P.value>0?ge(new C(Number(P.value)).div(2).toString(),a.value.decimals).toString():""):(p.value=!1,s.value=F.value>0?ge(new C(Number(F.value)).div(2).toString(),l.value.decimals).toString():"")};ko(()=>{Ce()}),Io(()=>{clearInterval(oe.value)});const Ge=()=>{A.value&&(clearInterval(oe.value),z.value=0,I.value=!0,R.updateCurrentPools(A.value.poolAddress,B.value),ie(p.value?r.value:s.value),N.getStatsData(B.value),setTimeout(()=>{I.value=!1,Ce()},1e3))},Ve=()=>{const n=a.value;a.value=l.value,l.value=n,O.value=!0,p.value=!p.value,p.value?(r.value=s.value,s.value=""):(s.value=r.value,r.value=""),setTimeout(()=>{O.value=!1},300)},Ce=()=>{oe.value=setInterval(()=>{I.value=!1,ae.value||z.value<re.value&&(z.value+=1,z.value===re.value&&(A.value&&A.value.poolAddress&&R.updateCurrentPools(A.value.poolAddress,B.value),z.value=0,I.value=!0))},1e3)};Z(p,Ae((n,b)=>{p.value=n},500));const Oe=d(!1);Z(r,Ae((n,b)=>{n&&p.value&&ie(n),n==""&&p.value&&(s.value="")},500)),Z(s,Ae((n,b)=>{n&&!p.value&&ie(n),n==""&&!p.value&&(r.value="")},500));const Te=d(1e-4),xe=()=>{if(A.value.current_sqrt_price&&r.value&&s.value){const b=(a.value.address===A.value.coinA.address&&l.value.address===A.value.coinB.address?0:1)==0,f=new C(r.value),j=new C(s.value),T=f.sub(f.mul(new C(A.value.fee)).div(100));console.log("getImpact###fAmount####",f.toString()),console.log("getImpact###tAmount####",j.toString()),console.log("getImpact###f####",T.toString());const H=j.div(T);return console.log("getImpact####rates####",H.toString()),E.value.getPriceImpactPct(A.value,H.toString(),b)}return 1e-4},Ue=d(0),De=d(0),ie=async n=>{if(A.value)if(a.value&&l.value&&(r.value||s.value)){u.value=!0,S.value=!0,Oe.value=!0,console.log(A.value,"poolInfo=====>451");const b=a.value.address===A.value.coinA.address&&l.value.address===A.value.coinB.address?0:1;console.log(p.value?r.value:s.value,"fixedFromCoin.value ? fromCoinAmount.value : toCoinAmount.value"),console.log(b,"===>direct");try{const f=await E.value.preSwap({pool:A.value,a2b:b==0,byAmountIn:p.value,amount:p.value?r.value:s.value});console.log(f,"preSwapRespreSwapRes"),te.value=f.isExceed,p.value?(s.value=f.estimatedAmountOut,L.value?ve.value=(n/Number(f.estimatedAmountOut)).toString():fe.value=(Number(f.estimatedAmountOut)/n).toString()):(r.value=f.estimatedAmountIn,L.value?ve.value=(Number(f.estimatedAmountIn)/n).toString():fe.value=(n/Number(f.estimatedAmountIn)).toString()),Ue.value=Number(s.value)/Number(r.value),De.value=Number(r.value)/Number(s.value),Te.value=xe(),u.value=!1,S.value=!1}catch(f){console.log("pre swap error",f),u.value=!1,S.value=!1}}else p.value?s.value="":r.value="",u.value=!1,S.value=!1},eo=qe(),q=w(()=>eo),oo=d({}),ve=d(""),fe=d("");Z(O,()=>{ve.value="",fe.value="",p.value?ie(r.value):ie(s.value)});const P=w(()=>q.value.assets&&a.value&&q.value.assets[a.value.address]?Me(q.value.assets[a.value.address].balance,a.value.decimals):0),F=w(()=>q.value.assets&&l.value&&q.value.assets[l.value.address]?Me(q.value.assets[l.value.address].balance,l.value.decimals):0),no=Le();Z(()=>c.value.tokensObj,async n=>{if(!he(n)){console.log(n,"===>newValue626"),console.log(no,"===>route625");const b=e?e.currentRoute.value.query.to:"",f=e?e.currentRoute.value.query.from:"";f?a.value=await E.value.getTokenBySymbol(n,f):(a.value=await E.value.getTokenBySymbol(n,N.chainName==="Aptos"?"0x5e156f1207d0ebfa19a9eeff00d62a282278fb8719f4fab3a586a0a2c0fffbea::coin::T":"0x5d4b302506645c37ff133b98c4b50a5ae14841659738d6d733d59d0d217a93bf::coin::COIN"),console.log(a.value,"===>fromCoin.value")),b?l.value=await E.value.getTokenBySymbol(n,b):l.value=await E.value.getTokenBySymbol(n,N.chainName==="Aptos"?"0x1::aptos_coin::AptosCoin":"0x2::sui::SUI"),!f&&b&&(a.value="")}},{immediate:!0});const A=w(()=>{var n,b,f,j;if(a.value&&l.value){let T=null;const H={};if(Object.values(c.value.poolConfigList).forEach(U=>{var D,de,X,M;(U.coinA.address.toUpperCase()===((D=a.value.address)==null?void 0:D.toUpperCase())&&U.coinB.address.toUpperCase()===((de=l.value.address)==null?void 0:de.toUpperCase())||U.coinB.address.toUpperCase()===((X=a.value.address)==null?void 0:X.toUpperCase())&&U.coinA.address.toUpperCase()===((M=l.value.address)==null?void 0:M.toUpperCase()))&&(H[U.address]={...U})}),c.value.poolsObj&&!he(c.value.poolsObj))for(const U in c.value.poolsObj){const D=c.value.poolsObj[U];(D.token_a.address.toUpperCase()===((n=a.value.address)==null?void 0:n.toUpperCase())&&D.token_b.address.toUpperCase()===((b=l.value.address)==null?void 0:b.toUpperCase())||D.token_b.address.toUpperCase()===((f=a.value.address)==null?void 0:f.toUpperCase())&&D.token_a.address.toUpperCase()===((j=l.value.address)==null?void 0:j.toUpperCase()))&&(H[D.address]={...D})}return T=Object.values(H).sort((U,D)=>U.fee-D.fee)[0],console.log("0412###swap###poolInfo###",T),T&&!he(T)?T:null}return null}),Re=d(!0),$e=d(!1),so=async n=>{n&&(ie(p.value?r.value:s.value),$e.value=!0,n.coinA.symbol.toLowerCase()===a.value.symbol.toLowerCase()&&n.coinB.symbol.toLowerCase()===l.value.symbol.toLowerCase()?Re.value=!0:Re.value=!1)};Z(()=>A.value,(n,b)=>{n&&(!b||n.address!==b.address||n.current_sqrt_price!==b.current_sqrt_price)&&so(n)},{immediate:!0,deep:!0});const ao=w(()=>c.value.tokensObj&&a.value&&a.value.address&&c.value.tokensObj[a.value.address]&&c.value.tokensObj[a.value.address].logoURI),to=w(()=>(console.log(c.value.tokensObj,"===>pools.value.tokensObj"),c.value.tokensObj&&l.value&&l.value.address&&c.value.tokensObj[l.value.address]&&c.value.tokensObj[l.value.address].logoURI)),io=w(()=>c.value.tokensObj&&a.value&&a.value.address&&c.value.tokensObj[a.value.address]&&c.value.tokensObj[a.value.address].coingecko_id||null),lo=w(()=>c.value.tokensObj&&l.value&&l.value.address&&c.value.tokensObj[l.value.address]&&c.value.tokensObj[l.value.address].coingecko_id||null),uo=w(()=>{const n=new C(r.value),b=new C(A.value.fee),f=n.mul(b).toString();return console.log(f,"===>fee"),Number(f)<1/Math.pow(10,a.value.decimals)?`<${new C(1).div(new C(Math.pow(10,a.value.decimals))).toString()}`:ge(f,a.value.decimals)}),{setIsShowSuccess:ro,setIsShowRejected:Ee,setIsShowWaiting:pe,setTransactionDesc:co,setTransactionTxid:Pe}=N;return{hasPool:$e,getPoolInfoSuccess:Be,halfBtnSelect:Je,formCoinId:io,toCoinId:lo,fromCoinUrl:ao,toCoinUrl:to,t:m,indicator:t,wallet:q,currentLpInfo:oo,fixD:_,decimalFormat:we,impact:Te,oneFromAmount:ve,oneToAmount:fe,importIcon:ne,clickExchange:Ve,clickRefresh:Ge,refresh:I,change:O,isShowAddress:J,isShowSwapSetting:G,fromCoin:a,toCoin:l,slippage:me,openCoinSelect:Xe,onCoinSelect:Ye,existingCoins:K,lastSelectCoin:W,currentCoinKey:k,showCoinSelect:h,fromCoinAmount:r,toCoinAmount:s,maxBtnSelect:Ze,fixedFromCoin:p,swapBtnText:He,toSwap:async()=>{var b,f,j,T,H,U,D,de;Q.value=!1,u.value=!0,Pe(""),co(m("tips.swapping",{from:`${r.value} ${(b=a.value)==null?void 0:b.symbol}`,to:`${s.value} ${(f=l.value)==null?void 0:f.symbol}`})),pe(!0);const n=a.value.address===A.value.token_a.address&&l.value.address===A.value.token_b.address?0:1;try{console.log("0221####swap start####",B.value,"###",E),console.log("0412###toSwap###poolInfo.value###",A.value);const X=await E.value.getSwapTransactionPayload({pool:A.value,a2b:n==0,byAmountIn:p.value,amount:p.value?r.value:s.value,slippage:Number(me.value)/100});console.log("0221####swap###swapPayload###",X);let M;if(B.value==="Aptos")M=await q.value.currentWallet.signAndSubmitTransaction(X);else{console.log("0221###swap###sui##signAndExecuteTransaction前###",B.value,"###swapPayload###",X);const le=await q.value.currentWallet.signAndExecuteTransactionBlock(X);console.log("0221###sui swap res###",le),M=E.value.handleTx(le),console.log("0221###swap###sui##tx###",M)}if(M&&M.hash){Pe(M.hash),pe(!1),ro(!0);const le={title:m("tips.swap"),desc:m("tips.swapSuccessText",{from:`${r.value} ${(j=a.value)==null?void 0:j.symbol}`,to:`${s.value} ${(T=l.value)==null?void 0:T.symbol}`}),hash:M.hash,tit:"Swap",icon:"icon-icon-swap1",tokenInfo:{tokena:`${(H=a.value)==null?void 0:H.address}`,numa:`- ${r.value}`,logoa:c.value.tokensObj&&a.value&&a.value.address&&c.value.tokensObj[a.value.address]&&c.value.tokensObj[a.value.address].logoURI,tokenb:`${(U=l.value)==null?void 0:U.address}`,numb:`+ ${s.value}`,logob:c.value.tokensObj&&l.value&&l.value.address&&c.value.tokensObj[l.value.address]&&c.value.tokensObj[l.value.address].logoURI},text:`Pay ${r.value} ${(D=a.value)==null?void 0:D.symbol} to receive ${s.value} ${(de=l.value)==null?void 0:de.symbol}`};B.value!=="Aptos"&&(le.res=M.res),E.value.showTransitionPending(le);const _e=await E.value.watchTransaction(le);console.log("0221###swap###transitionStatus####",_e),_e&&setTimeout(()=>{R.updateCurrentPools(A.value.poolAddress,B.value),E.value.getAccount(q.value.address)},1e3)}else pe(!1),Ee(!0);r.value="",s.value="",u.value=!1}catch(X){r.value="",s.value="",console.log("Swap Error###",X),u.value=!1,pe(!1),Ee(!0)}},loading:ae,swaping:u,autoRefreshTime:re,countdown:z,setMarketTimer:Ce,marketTimer:oe,rateChange:L,isSwapConfirmMpdal:Q,fromCoinBlance:P,toCoinBlance:F,poolInfo:A,chainName:B,swapRouterLoading:Oe,formatFee:uo,calculating:S,currentRate:Ue,currentRateReverse:De,getCoinIcon:n=>{var b;return(n==null?void 0:n.logoURI)||(n==null?void 0:n.logo_url)||((b=c.value.tokensObj[n==null?void 0:n.address])==null?void 0:b.logo_url)||(N.theme==="default"?ne("/image/coins/unknown.png"):ne("/image/coins/sui-unknown.png"))}}}}),$n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAGCBAMAAAAmlj/IAAAAFVBMVEVHcEwzMzMzMzMyMjI0NDQvLy8zMzOcydXuAAAABnRSTlMAy9hRbBs90ObtAAAAWklEQVRIx2NgYBFLdGBgYBVLS0sMYGBMMg1WE2BwU2VgCEphEDNgYGBOZEgLAMqnMaQxAEEaTBCqBKoBqh1qGAMDWwLDKDVKjVKj1Cg1So1So9QoNdwo6rccATYwqRNK4tkrAAAAAElFTkSuQmCC",En="data:image/png;base64,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";const se=e=>(ke("data-v-8c1fbdb6"),e=e(),Ie(),e),Pn={class:"swap-container"},_n={class:"title"},Fn={class:"left"},jn={class:"right title-right"},Mn=se(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),Ln={class:"swap-card"},Wn={class:"card-container"},qn={class:"card-item"},Qn={class:"card-item"},Kn=se(()=>o("use",{"xlink:href":"#icon-icon-swap1"},null,-1)),zn=[Kn],Hn={key:0,class:"induction"},Xn={key:0,class:"exchange-rate-btn"},Yn={key:0},Zn=["src"],Jn={key:0},Gn=["src"],Vn={key:0},xn={key:1},es={key:0},os=["src"],ns=["src"],ss=se(()=>o("use",{"xlink:href":"#icon-a-icon-change2"},null,-1)),as=[ss],ts={class:"item"},is={class:"induction-text"},ls={key:1},us={class:"item"},rs={class:"induction-text"},ds={class:"induction-value"},cs={class:"item"},ms={class:"induction-text"},vs={class:"induction-value"},fs={key:0,class:"icon","aria-hidden":"true"},ps=se(()=>o("use",{"xlink:href":"#icon-icon-swap"},null,-1)),bs=[ps],Cs={key:3,class:"token-info-container"},gs={class:"token-info-title"},hs=se(()=>o("span",{class:"coingecko"},"Ref. CoinGecko",-1)),As=se(()=>o("img",{src:En,alt:""},null,-1)),ws=se(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-information"})],-1));function Ss(e,t,m,v,N,R){const c=mo,O=vo,I=No,J=ze,G=po,L=fo,Q=bo,k=un,K=Bo,W=Dn;return g(),y("div",Pn,[o("div",_n,[o("div",Fn,i(e.$t("menu.swap")),1),o("div",jn,[o("div",{class:"slippage-icon",onClick:t[0]||(t[0]=h=>e.isShowSwapSetting=!0)},[Mn,o("span",null,i(e.slippage)+"%",1)]),V(c,{loading:e.refresh,"auto-refresh-time":e.autoRefreshTime,countdown:e.countdown,onClickRefresh:e.clickRefresh},null,8,["loading","auto-refresh-time","countdown","onClickRefresh"])])]),o("div",Ln,[o("div",Wn,[o("div",qn,[V(O,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=h=>e.fromCoinAmount=h),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logo_url:"",address:e.fromCoin?e.fromCoin.address:"","swap-direction":"From",onOnMax:t[2]||(t[2]=h=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=h=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=h=>{e.fromCoinAmount=h,e.fixedFromCoin=!0}),onOnSelect:t[5]||(t[5]=h=>e.openCoinSelect("fromCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),o("div",Qn,[V(O,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[6]||(t[6]=h=>e.toCoinAmount=h),"input-value":e.toCoinAmount,havemax:!1,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direction":"To","coin-icon":e.toCoin?e.toCoin.logo_url:"",address:e.toCoin?e.toCoin.address:"",onOnInput:t[7]||(t[7]=h=>{e.toCoinAmount=h,e.fixedFromCoin=!1}),onOnSelect:t[8]||(t[8]=h=>e.openCoinSelect("toCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),o("img",{class:ce(e.change?"gang animationex":"gang"),src:$n,alt:""},null,2),o("div",{class:"exchange",onClick:t[9]||(t[9]=h=>e.clickExchange())},[(g(),y("svg",{class:ce(e.change?"icon animationex":"icon"),"aria-hidden":"true"},zn,2))])]),e.poolInfo&&e.fromCoinAmount&&e.toCoinAmount&&e.fromCoinAmount!=="0"&&e.toCoinAmount!=="0"&&e.swapBtnText!==e.$t("button.poolNotFound")?(g(),y("div",Hn,[e.fromCoinAmount&&e.toCoinAmount?(g(),y("div",Xn,[e.rateChange?Number(e.fromCoinAmount)&&Number(e.toCoinAmount)&&e.rateChange?(g(),y("span",xn,[Number(e.fromCoinAmount)&&Number(e.toCoinAmount)?(g(),y("span",es,[o("img",{src:e.toCoinUrl||e.getCoinIcon(e.toCoin)},null,8,os),x(" 1 "+i(e.toCoin.symbol)+" ≈ ",1),o("img",{src:e.fromCoinUrl||e.getCoinIcon(e.fromCoin)},null,8,ns),o("span",null,i(("fixD"in e?e.fixD:ee(_))(e.currentRateReverse,e.fromCoin.decimals)),1),x("  "+i(e.fromCoin.symbol),1)])):(g(),Y(I,{key:1,indicator:e.indicator},null,8,["indicator"]))])):$("",!0):(g(),y("span",Yn,[o("img",{src:e.fromCoinUrl||e.getCoinIcon(e.fromCoin)},null,8,Zn),x(" 1 "+i(e.fromCoin.symbol)+" ≈ ",1),Number(e.fromCoinAmount)&&Number(e.toCoinAmount)?(g(),y("span",Jn,[o("img",{src:e.toCoinUrl||e.getCoinIcon(e.toCoin)},null,8,Gn),e.calculating?$("",!0):(g(),y("span",Vn,i(("fixD"in e?e.fixD:ee(_))(e.currentRate,e.toCoin.decimals)),1)),x("  "+i(e.toCoin.symbol)+" ",1),e.calculating?(g(),Y(I,{key:1,indicator:e.indicator},null,8,["indicator"])):$("",!0)])):(g(),Y(I,{key:1,indicator:e.indicator},null,8,["indicator"]))])),(g(),y("svg",{class:"icon-change","aria-hidden":"true",onClick:t[10]||(t[10]=h=>e.rateChange=!e.rateChange)},as))])):$("",!0),o("div",ts,[o("div",is,i(e.$t("common.priceImpact")),1),e.swaping?(g(),y("div",ls,[V(I,{indicator:e.indicator},null,8,["indicator"])])):(g(),y("div",{key:0,class:ce(["induction-value",e.impact<1?"impact-s":e.impact<10&&e.impact>1?"impact-w":"impact-e"])},i(e.impact<.01?"<0.01":e.impact>100?"100":e.impact)+"% ",3))]),o("div",us,[o("div",rs,i(e.fixedFromCoin?e.$t("common.minimumReceived"):e.$t("common.maximumSold")),1),o("div",ds,i(e.fixedFromCoin?("fixD"in e?e.fixD:ee(_))(Number(e.toCoinAmount)-Number(e.toCoinAmount)*Number(e.slippage)/100,e.toCoin.decimals):("fixD"in e?e.fixD:ee(_))(Number(e.fromCoinAmount)*Number(e.slippage)/100+Number(e.fromCoinAmount),e.fromCoin.decimals))+" "+i(e.fixedFromCoin?e.toCoin.symbol:e.fromCoin.symbol),1)]),o("div",cs,[o("div",ms,i(e.$t("common.fee")),1),o("div",vs,i(e.formatFee)+" "+i(e.fromCoin.symbol)+" ("+i(e.poolInfo.fee*100)+"%) ",1)])])):$("",!0)]),V(J,{disabled:e.wallet.connected?e.swaping||!e.fromCoin||!e.toCoin||!Number(e.fromCoinAmount)||!Number(e.toCoinAmount)||Number(e.fromCoinAmount)>Number(e.fromCoinBlance)||e.swapBtnText==e.$t("button.poolNotFound")||e.swapBtnText!==e.$t("button.swap")||e.poolInfo.is_pause:!1,class:"big-btn",loading:e.swaping,onClick:t[11]||(t[11]=h=>e.wallet.connected?e.isSwapConfirmMpdal=!0:e.wallet.setIsShowWalletModal(!0))},{default:ue(()=>[e.wallet.connected?(g(),y("svg",fs,bs)):$("",!0),o("span",null,i(e.wallet.connected?e.swapBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled","loading"]),V(G),e.showCoinSelect?(g(),Y(L,{key:0,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:t[12]||(t[12]=h=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):$("",!0),e.isShowSwapSetting?(g(),Y(Q,{key:1,onOnClose:t[13]||(t[13]=h=>e.isShowSwapSetting=!1)})):$("",!0),e.isSwapConfirmMpdal?(g(),Y(k,{key:2,"fixed-from-coin":e.fixedFromCoin,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,impact:e.impact,fee:e.poolInfo.fee,"format-fee":e.formatFee,onOnClose:t[14]||(t[14]=h=>e.isSwapConfirmMpdal=!1),onToSwap:e.toSwap},null,8,["fixed-from-coin","from-coin","to-coin","from-coin-amount","to-coin-amount","impact","fee","format-fee","onToSwap"])):$("",!0),e.chainName&&(e.formCoinId||e.toCoinId)?(g(),y("div",Cs,[o("div",gs,[hs,As,V(K,{placement:"top","arrow-point-at-center":""},{title:ue(()=>[x(" The following price is only an external reference from CoinGecko, which may not reflect actual data on Cetus. ")]),default:ue(()=>[ws]),_:1})]),e.fromCoin&&e.formCoinId?(g(),Y(W,{key:0,id:e.formCoinId,coin:e.fromCoin,refresh:e.refresh},null,8,["id","coin","refresh"])):$("",!0),e.toCoin&&e.toCoinId?(g(),Y(W,{key:1,id:e.toCoinId,coin:e.toCoin,refresh:e.refresh},null,8,["id","coin","refresh"])):$("",!0)])):$("",!0)])}const Ps=ye(Rn,[["render",Ss],["__scopeId","data-v-8c1fbdb6"]]);export{Ps as default};
