import{_ as Go}from"./back.dca58a72.js";import{_ as zo}from"./swap-setting.d9aa7206.js";import{u as Fe,a as ro}from"./sha256.9163db08.js";import{a as We,r as O,m as A,e as He,o as C,f as L,h as s,v as E,c as Le,x as me,p as no,k as to,C as Yo,D as we,b as io,i as ue,z as uo,y as No,t as Be,G as Ro,E as co,q as Oo,u as Y,j as Ae,l as Ao,a0 as Jo,a1 as Ye,a6 as Io,H as Co,w as Ze,F as go,s as bo,B as vo,a7 as Qo,a8 as Zo,K as Ko,Y as Vo,M as xo,J as en}from"./entry.aafbdb45.js";import{u as Ve,c as fe,a as so,b as on,n as nn,d as he,e as Q,q as ko,s as Ee,h as Pe,p as So,f as Oe,z as qo,A as Bo,T as $o,C as tn}from"./pool.500c575e.js";import{_ as mo}from"./token-warning.772e388e.js";import{_ as Lo}from"./status-block.db1d4fc9.js";import{s as eo,m as sn,l as an,b as ln,a as un,_ as rn}from"./transform.8e146a90.js";import{D as b}from"./decimal.0e8aa3f1.js";import{i as oo}from"./import-icon.de3e6c66.js";import{_ as fo}from"./assets-card.5a3ef894.js";import{b as dn}from"./new-add-or-create.2b991999.js";import{_ as cn,a as vn}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              *//* empty css              */import{u as Mo}from"./notifi.234b7ff0.js";/* empty css              *//* empty css              *//* empty css              */import"./img-lock_2x.8729363d.js";/* empty css              */import"./useWhale.0d4c9dd2.js";import"./index.7ca15f77.js";const _o=Math.PI,wo=2*_o,Qe=1e-6,mn=wo-Qe;function Uo(e){this._+=e[0];for(let n=1,t=e.length;n<t;++n)this._+=arguments[n]+e[n]}function fn(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return Uo;const t=10**n;return function(i){this._+=i[0];for(let $=1,I=i.length;$<I;++$)this._+=Math.round(arguments[$]*t)/t+i[$]}}class pn{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?Uo:fn(n)}moveTo(n,t){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,t){this._append`L${this._x1=+n},${this._y1=+t}`}quadraticCurveTo(n,t,i,$){this._append`Q${+n},${+t},${this._x1=+i},${this._y1=+$}`}bezierCurveTo(n,t,i,$,I,P){this._append`C${+n},${+t},${+i},${+$},${this._x1=+I},${this._y1=+P}`}arcTo(n,t,i,$,I){if(n=+n,t=+t,i=+i,$=+$,I=+I,I<0)throw new Error(`negative radius: ${I}`);let P=this._x1,r=this._y1,o=i-n,d=$-t,m=P-n,c=r-t,g=m*m+c*c;if(this._x1===null)this._append`M${this._x1=n},${this._y1=t}`;else if(g>Qe)if(!(Math.abs(c*o-d*m)>Qe)||!I)this._append`L${this._x1=n},${this._y1=t}`;else{let W=i-P,ee=$-r,oe=o*o+d*d,ie=W*W+ee*ee,f=Math.sqrt(oe),v=Math.sqrt(g),h=I*Math.tan((_o-Math.acos((oe+g-ie)/(2*f*v)))/2),a=h/v,y=h/f;Math.abs(a-1)>Qe&&this._append`L${n+a*m},${t+a*c}`,this._append`A${I},${I},0,0,${+(c*W>m*ee)},${this._x1=n+y*o},${this._y1=t+y*d}`}}arc(n,t,i,$,I,P){if(n=+n,t=+t,i=+i,P=!!P,i<0)throw new Error(`negative radius: ${i}`);let r=i*Math.cos($),o=i*Math.sin($),d=n+r,m=t+o,c=1^P,g=P?$-I:I-$;this._x1===null?this._append`M${d},${m}`:(Math.abs(this._x1-d)>Qe||Math.abs(this._y1-m)>Qe)&&this._append`L${d},${m}`,i&&(g<0&&(g=g%wo+wo),g>mn?this._append`A${i},${i},0,1,${c},${n-r},${t-o}A${i},${i},0,1,${c},${this._x1=d},${this._y1=m}`:g>Qe&&this._append`A${i},${i},0,${+(g>=_o)},${c},${this._x1=n+i*Math.cos(I)},${this._y1=t+i*Math.sin(I)}`)}rect(n,t,i,$){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}h${i=+i}v${+$}h${-i}Z`}toString(){return this._}}function Ke(e){return function(){return e}}function hn(e){let n=3;return e.digits=function(t){if(!arguments.length)return n;if(t==null)n=null;else{const i=Math.floor(t);if(!(i>=0))throw new RangeError(`invalid digits: ${t}`);n=i}return e},()=>new pn(n)}function gn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function jo(e){this._context=e}jo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:this._context.lineTo(e,n);break}}};function bn(e){return new jo(e)}function kn(e){return e[0]}function _n(e){return e[1]}function wn(e,n){var t=Ke(!0),i=null,$=bn,I=null,P=hn(r);e=typeof e=="function"?e:e===void 0?kn:Ke(e),n=typeof n=="function"?n:n===void 0?_n:Ke(n);function r(o){var d,m=(o=gn(o)).length,c,g=!1,W;for(i==null&&(I=$(W=P())),d=0;d<=m;++d)!(d<m&&t(c=o[d],d,o))===g&&((g=!g)?I.lineStart():I.lineEnd()),g&&I.point(+e(c,d,o),+n(c,d,o));if(W)return I=null,W+""||null}return r.x=function(o){return arguments.length?(e=typeof o=="function"?o:Ke(+o),r):e},r.y=function(o){return arguments.length?(n=typeof o=="function"?o:Ke(+o),r):n},r.defined=function(o){return arguments.length?(t=typeof o=="function"?o:Ke(!!o),r):t},r.curve=function(o){return arguments.length?($=o,i!=null&&(I=$(i)),r):$},r.context=function(o){return arguments.length?(o==null?i=I=null:I=$(i=o),r):i},r}function To(){}function Eo(e){this._context=e}Eo.prototype={areaStart:To,areaEnd:To,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,n){e=+e,n=+n,this._point?this._context.lineTo(e,n):(this._point=1,this._context.moveTo(e,n))}};function yn(e){return new Eo(e)}const An=We({setup(){const e=Fe(),n=O(!1),t=A(()=>e);return{slippage:A(()=>t.value.slippage),isShowSwapSetting:n}}});const In=e=>(no("data-v-82585f8b"),e=e(),to(),e),Cn=In(()=>s("svg",{class:"icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1));function Sn(e,n,t,i,$,I){const P=zo;return C(),L("div",{class:"slippage-icon",onClick:n[1]||(n[1]=r=>e.isShowSwapSetting=!0)},[Cn,s("span",null,E(e.slippage)+"%",1),e.isShowSwapSetting?(C(),Le(P,{key:0,onOnClose:n[0]||(n[0]=r=>e.isShowSwapSetting=!1)})):me("",!0)])}const $n=He(An,[["render",Sn],["__scopeId","data-v-82585f8b"]]),Tn=We({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,n){const t=O(!1),i=O(null),$=O(0),I=O(20),P=Ve(),r=Fe(),o=O(!1);Yo(()=>{clearInterval(i.value)});const d=()=>{i.value=setInterval(()=>{var ie;o.value||$.value<I.value&&($.value+=1,$.value===I.value&&((ie=e==null?void 0:e.poolInfo)!=null&&ie.poolAddress&&P.updateCurrentPools(e.poolInfo.poolAddress,r.chainName),$.value=0))},1e3)},m=A(()=>r.slippage),c=()=>{n.emit("clearAll")},g=O(!1),W=()=>{$.value=0,g.value=!0,n.emit("clickRefresh"),setTimeout(()=>{g.value=!1},1e3)};we(()=>e.poolInfo,ie=>{ie&&!i.value&&d()},{immediate:!0});const ee=io(),oe=A(()=>r.chainName);return{clickRefresh:W,isShowSwapSetting:t,countdown:$,autoRefreshTime:I,slippage:m,clearAll:c,checkNullObj:fe,router:ee,loading:o,chainName:oe,refresh:g}}});const Pn=e=>(no("data-v-ca768f9b"),e=e(),to(),e),Nn={class:"new-position-title"},Rn={class:"left"},On={class:"right"},qn=Pn(()=>s("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),Bn=[qn];function Ln(e,n,t,i,$,I){const P=Go,r=$n;return C(),L("div",Nn,[s("div",Rn,[ue(P)]),s("div",On,[ue(r),(C(),L("svg",{"aria-hidden":"true",class:uo(e.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:n[0]||(n[0]=(...o)=>e.clickRefresh&&e.clickRefresh(...o))},Bn,2))])])}const Do=He(Tn,[["render",Ln],["__scopeId","data-v-ca768f9b"]]);function Po(e,n,t){const i=new b(10).pow(n-t);return new b(1.0001).pow(e).mul(i)}const Mn=We({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,n){const t=O(1),i=O(""),$=O(""),I=A(()=>{var a,y,N;return c.sqrtPriceX64ToPrice((a=e.poolInfo)==null?void 0:a.current_sqrt_price,(y=e.poolInfo)==null?void 0:y.coinA.decimals,(N=e.poolInfo)==null?void 0:N.coinB.decimals).toString()}),P=A(()=>{let a=0;return e.direction?a=(Number(e.minPrice)/Number(I.value)-1)*100:a=(Number(e.minPrice)/Number(1/Number(I.value))-1)*100,a=a>0&&a<.1?.1:a,a=a<0&&a>-.1?-.1:a,a}),r=A(()=>{let a=0;return e.direction?a=(Number(e.maxPrice)/Number(I.value)-1)*100:a=(Number(e.maxPrice)/Number(1/Number(I.value))-1)*100,a=a>0&&a<.1?.1:a,a=a<0&&a>-.1?-.1:a,a}),o=Fe(),d=A(()=>o),m=A(()=>d.value.chainName?so(d.value.chainName):{}),{TickMath:c,getNearestTickByTick:g}=m.value,W=()=>{const a=t.value/2;t.value=a,ie(e.poolInfo,a)},ee=()=>{const a=t.value*2;t.value=a,ie(e.poolInfo,a)},oe=(a=[])=>{let y=6;const N=Math.abs(Number(a[0])-Number(a[a.length-1]));return N>=6?y=0:N>=1?y=1:N>=.1?y=2:N>=.01?y=3:N>=.001?y=4:N>=1e-4?y=5:N>=1e-5?y=6:N>=1e-6?y=7:N>=1e-7&&(y=8),y},ie=(a,y=1)=>{if(a&&a.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){console.log(e.poolInfo,"==>props.poolInfo");const N=Number(e.poolInfo.current_tick_index);console.log("0117###dataProcessing###currentTick###",N),console.log("0117###dataProcessing###props.poolInfo###",e.poolInfo),console.log("0117###dataProcessing###minPrice###",e.minPrice),console.log("0117###dataProcessing###maxPrice###",e.maxPrice),console.log("0117###dataProcessing###poolInfo###",e.poolInfo);let w=N+100*y,l=N-100*y,V,G;if(e.maxPrice==="∞")G=m.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?G=c.priceToTickIndex(new b(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):G=c.priceToTickIndex(new b(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{G=443636}if(e.minPrice==="0")V=m.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?V=c.priceToTickIndex(new b(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):V=c.priceToTickIndex(new b(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{V=-443636}let re=0;if(e.currentPriceTab!=="full range"){if(N>=V&&N<=G){const U=N-V,pe=G-N;re=Math.max(Math.abs(U),Math.abs(pe))}else N<V?re=Math.abs(G-N):re=Math.abs(N-V);w=N+re+100*y,l=N-re-100*y,console.log(y,N,"===>zooms")}else{const U=(Math.abs(N)>5e3,2e4);w=N+U*y,l=N-U*y}l<-443636&&(l=-443636),w>443636&&(w=443636),console.log(l,w,"===>201");const x=new b(a.liquidity).div(Math.pow(10,8)).toString();console.log(x,"==>currentLiquity");const M=e.tickList;console.log("0117####drawChart####tick_info_array####",M);const H=[],J=[];let ne={};for(let U=0;U<M.length;U++){if(ne=M[U],ne.index<=N&&ne.index>=l){if(H.length<1&&U!==0){const pe=M[U-1];H.unshift({...pe,index:l})}H.unshift(ne)}else if(ne.index>N&&ne.index<=w&&(J.push(ne),H.length<1&&U!==0)){const pe=M[U-1];H.push({...pe,index:l})}if(ne.index>w){const pe=M[U];if(J.push({...pe,index:w}),H.length<1&&U!==0){const _e=M[U-1];H.push({..._e,index:l})}break}}console.log(N,l,w,"===>currentTick");let de="0";for(let U=H.length-1;U>=0;U--)de=new b(de).plus(new b(H[U].liquidityNet.toString()).div(Math.pow(10,8))).toString(),H[U].liquityAmount=de;let K=x;for(let U=0;U<J.length;U++)K=new b(K).plus(new b(J[U].liquidityNet.toString()).div(Math.pow(10,8))).toString(),J[U].liquityAmount=K;console.log(H.length,J.length,"leftArray");let se=[];const Z=M&&M.length>0?{index:N,liquityAmount:Number(x)}:{index:N,liquityAmount:0};(H.length>0||J.length>0)&&(console.log([Z,...J],"279===>"),se=[...H.reverse(),Z,...J],e.direction||(se=se.reverse()));const ge=[];M.forEach(U=>{ge.push({...U,liquidityGross:U.liquidityGross.toString(),liquidityNet:U.liquidityNet.toString()})}),console.log("0117####drawChart####testTickInfoArray####",ge),console.log("0117####drawChart####currentLiquity####",x),console.log(se,"===>chartData"),v(se,l,w,V,G,N)}};let f=O(!1);No(()=>{document.body.clientWidth<750?f.value=!1:f.value=!0,window.onresize=()=>{document.body.clientWidth<750?f.value=!1:f.value=!0,ie(e.poolInfo,t.value)}});const v=(a,y,N,w,l,V)=>{console.log("0117####drawChart####chartData####",a),console.log("0117####drawChart####tickMin####",y),console.log("0117####drawChart####tickMax####",N),console.log("0117####drawChart####minPriceTick####",w),console.log("0117####drawChart####maxPriceTick####",l),console.log("0117####drawChart####currentTick####",V),console.log("0117####drawChart####props.direction####",e.direction),console.log("0518###newd3###props.before7dContractPriceLowest###",e.before7dContractPriceLowest),console.log("0518###newd3###props.before7dContractPriceHighest###",e.before7dContractPriceHighest);let G,re;e.direction?(G=e.before7dContractPriceLowest?c.priceToTickIndex(new b(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",re=e.before7dContractPriceHighest?c.priceToTickIndex(new b(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(G=e.before7dContractPriceLowest?c.priceToTickIndex(new b(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",re=e.before7dContractPriceHighest?c.priceToTickIndex(new b(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const x={top:30,right:35,bottom:20,left:55};let M,H;f.value,M=340-x.left-x.right,H=205-x.top-x.bottom;const J=N-y,ne=parseInt(String(J/4));let de=[y+ne/4,y+ne,y+2*ne,N-ne,N-ne/4];const K=y,se=N,Z=M/(se-K);e.currentPriceTab==="full range"&&(de=[y,y+2*ne,N]),console.log("0117####drawChart####xArr####",de),console.log("0117####drawChart####utickMin####",K),console.log("0117####drawChart####utickMax####",se),console.log("0117####drawChart####unit####",Z);const ge=de.map(R=>e.direction?Po(R,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new b(1).div(Po(R,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());oe(ge),eo("#chart").selectAll("*").remove();const U=eo("#chart").attr("width",M+x.left+x.right).attr("height",H+x.top+x.bottom).append("g").attr("transform",`translate(${x.left},${x.right})`),pe=sn(a,function(R){return Number(Math.abs(R.liquityAmount))})||0,_e=an().range([0,H]).domain([pe,0]);ln().rangeRound([0,M]).padding(.1);const u=U.append("g").attr("id","barsBox").selectAll("rect").data(a).enter().append("rect");d.value.theme=="default"?u.attr("x",function(R,B){return B===0?0:e.direction?Math.abs(R.index-K)*Z:Math.abs(se-R.index)*Z}).attr("y",function(R,B){return e.direction?B===a.length-1?0:_e(R.liquityAmount):B===a.length-1?0:_e(a[B+1].liquityAmount)}).attr("width",function(R,B){return B===0&&a.length===1&&R.liquityAmount>0?M:(e.direction,B!==a.length-1?Math.abs(a[B+1].index-R.index)*Z:0)}).attr("height",function(R,B){return B===0&&a.length===1&&R.liquityAmount>0?H:e.direction?B===a.length-1?0:H-_e(R.liquityAmount):B===a.length-1?0:H-_e(a[B+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):u.attr("x",function(R,B){return B===0?0:e.direction?Math.abs(R.index-K)*Z:Math.abs(se-R.index)*Z}).attr("y",function(R,B){return e.direction?B===a.length-1?0:_e(Math.abs(R.liquityAmount)):B===a.length-1?0:_e(Math.abs(a[B+1].liquityAmount))}).attr("width",function(R,B){return B===0&&a.length===1&&R.liquityAmount>0?M:(e.direction,B!==a.length-1?Math.abs(a[B+1].index-R.index)*Z:0)}).attr("height",function(R,B){if(B===0&&a.length===1&&R.liquityAmount>0)return H;if(e.direction)return B===a.length-1?0:Number(R.liquityAmount)?H-_e(Math.abs(R.liquityAmount)):0;{if(B===a.length-1)return 0;const le=H-_e(Math.abs(a[B+1].liquityAmount));return Number(a[B+1].liquityAmount)?le:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const p=U.append("g");p.append("line").attr("x1",0).attr("y1",155).attr("x2",M).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),p.append("g");let S=0;e.direction?S=Math.abs(V-K)*Z:S=Math.abs(V-se)*Z,(d.value.theme=="default"?U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+S+", 0)"),eo("#triangle").attr("width",8).attr("height",4);let j=[[0,0],[4,4],[8,0]],D=wn().x(function(R){return R[0]}).y(function(R){return R[1]}).curve(yn);const q=S-4;U.append("path").attr("d",D(j)).style("fill","#76C8FF").attr("transform","translate("+q+", 0)");let F,z,ae,ce;e.direction?(console.log("0525###d3###select###minPriceTick###",w),console.log("0525###d3###select###maxPriceTick###",l),console.log("0525###d3###select###props.minPrice###",e.minPrice),console.log("0525###d3###select###props.maxPrice###",e.maxPrice),F=w<K?-100:parseInt(String(Math.abs(w-K)*Z)),z=l<K?-100:parseInt(String(Math.abs(l-K)*Z)),ae=G<K?-100:Math.abs(G-K)*Z,ce=re<K?-100:Math.abs(re-K)*Z):(z=w<K?-100:Math.abs(se-w)*Z,F=l<K?-100:Math.abs(se-l)*Z,ce=G<K?-100:Math.abs(se-G)*Z,ae=re<K?-100:Math.abs(se-re)*Z),e.minPrice==="0"&&(F=0),e.maxPrice==="∞"&&(z=M),f.value?i.value=M-F+60+"px":i.value=M-F+52+"px",$.value=z+74+"px",G&&ae<M&&U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ae+", 0)"),re&&ce<M&&U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ce+", 0)");const be=un().extent([[0,0],[M,H]]).handleSize(30).on("end",ye);U.append("g").attr("class","brush").call(be).call(be.move,[F,z]);function ye(R){if(!R.sourceEvent||!R.selection)return;f.value?i.value=M-R.selection[0]+60+"px":i.value=M-R.selection[0]+52+"px",$.value=R.selection[1]+74+"px";let B,le;console.log("0525###d3###select###e.selection[0]###",R.selection[0]),console.log("0525###d3###select###e.selection[0]###",R.selection[1]),console.log("0525###d3###select###props.direction###",e.direction),console.log("0525###d3###select###width###",M),console.log("0525###d3###select###unit###",Z),console.log("0525###d3###select###utickMin###",K),console.log("0525###d3###select###utickMax###",se),console.log("0525###d3###select###props.poolInfo###",e.poolInfo);let ke=0,k=0;e.direction?(ke=g(parseInt(String(R.selection[0]/Z+K)),Number(e.poolInfo.tickSpacing)),B=c.tickIndexToPrice(ke,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),k=g(parseInt(String(R.selection[1]/Z+K)),Number(e.poolInfo.tickSpacing)),le=c.tickIndexToPrice(k,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),console.log("0525###d3###select###minTick###",ke),console.log("0525###d3###select###maxTick###",k),console.log("0525###d3###select###minPrice###",B),console.log("0525###d3###select###maxPrice###",le)):(k=g(se-R.selection[0]/Z,Number(e.poolInfo.tickSpacing)),B=1/c.tickIndexToPrice(k,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ke=g(se-R.selection[1]/Z,Number(e.poolInfo.tickSpacing)),le=1/c.tickIndexToPrice(ke,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),n.emit("onChangeMinPrice",String(he(String(B),6))),n.emit("onChangeMaxPrice",String(he(String(le),6)))}d.value.theme=="default"?eo(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):eo(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(118,200,255,0.7)")};O(""),we(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([a,y,N,w])=>{console.log(a,y,N,N>y,"poolInfo && minPrice && maxPrice && (maxPrice > minPrice)"),a&&y&&N&&ie(a,t.value)},{immediate:!0});const h=O(!0);return we(()=>e.chartLoading,(a,y)=>{a!==y&&(h.value=a)},{immediate:!0,deep:!0}),{store:d,loading:h,zoomOut:W,zoomIn:ee,rangeSizeLower:P,rangeSizeUpper:r,rangeSizeLowerPosition:i,rangeSizeUpperPosition:$,decimalFormat:on,numberformat:nn}}});const Un=e=>(no("data-v-58b786ed"),e=e(),to(),e),jn={class:"chart-box"},En={class:"chart"},Dn=Un(()=>s("svg",{id:"chart"},null,-1)),Fn=[Dn];function Wn(e,n,t,i,$,I){return C(),L("div",jn,[Be(s("div",En,Fn,512),[[Ro,!e.loading]])])}const Fo=He(Mn,[["render",Wn],["__scopeId","data-v-58b786ed"]]),Hn=We({components:{StatusBlock:Lo,NewPositionChart:Fo,TokenWarning:mo},setup(e){const n=O(),t=O(),i=A(()=>{var h,a;return(a=(h=m.value)==null?void 0:h.poolInfo)==null?void 0:a.needReverse}),$=Fe(),I=A(()=>$),P=A(()=>I.value.theme),r=A(()=>I.value.chainName),o=Ve(),d=A(()=>o),m=O({}),c=co();we(()=>[d.value.currentPositionInfo,r.value],([h,a])=>{var y;a=="Aptos"&&h?(m.value=h,n.value=m.value.token_a,t.value=m.value.token_b):a=="Sui"&&h&&(h==null?void 0:h.nftHash)==((y=c==null?void 0:c.query)==null?void 0:y.pos)&&(console.log(h,"==>newVal"),m.value=h,n.value=m.value.token_a,t.value=m.value.token_b)},{immediate:!0});const g=h=>{var a;return(h==null?void 0:h.logoURI)||(h==null?void 0:h.logo_url)||((a=d.value.tokensObj[h==null?void 0:h.address])==null?void 0:a.logo_url)||(P.value==="default"?oo("/image/coins/unknown.png"):oo("/image/coins/sui-unknown.png"))},W=A(()=>r.value?so(r.value):{}),ee=O([]),oe=async h=>{console.log(h,"===>positionInfo.value.poolInfo");const a=await W.value.getTicks(h),y=a?W.value.getTickDataFromUrlData(a):[];console.log(y,"list===>"),ee.value=y};we(()=>[m.value,d.value.poolsObj],([h,a])=>{console.log(h,!fe(h),"177111"),h&&!fe(h)&&h.poolInfo&&a&&!fe(a)&&(console.log(h,a,"==>poolConfigObj"),oe(a[h.poolAddress]))},{immediate:!0});const ie=O(!0);console.log(m.value,"188---------->");const f=(h,a)=>h!=="0"&&a!=="∞"?Ee(1/(1-Number((h/a)**.25)),2)+"x":1,v=A(()=>m.value.minPrice&&m.value.maxPrice?f(m.value.minPrice,m.value.maxPrice):"--");return{needReverse:i,getCoinIcon:g,theme:P,indexStore:$,direct:ie,addCommom:Q,decimalUi:he,tickList:ee,positionInfo:m,fromCoin:n,toCoin:t,getExplorerUrl:ko,lever:v}}}),Xn=""+globalThis.__publicAssetsURL("image/aptos-price.png"),Gn=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),zn=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),Yn=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Xe=e=>(no("data-v-9d16f189"),e=e(),to(),e),Jn={class:"new-position-info"},Qn={class:"pool-info"},Zn={class:"left"},Kn={class:"coin-a"},Vn={alt:""},xn={class:"coin-b"},et={alt:""},ot={class:"position-name"},nt=["href"],tt=Xe(()=>s("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),it=[tt],st={key:0,class:"pool-fee"},at=Xe(()=>s("span",null,"Fee tier",-1)),lt={class:"right"},ut={class:"h5-pool-info"},rt={class:"coin-info"},dt={class:"coin-a"},ct={alt:""},vt={class:"coin-b"},mt={alt:""},ft={class:"position-name"},pt=["href"],ht=Xe(()=>s("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),gt=[ht],bt={key:0,class:"pool-fee"},kt={class:"price-info"},_t={class:"price-and-chart"},wt={class:"left"},yt={class:"current-price"},At=Xe(()=>s("span",null,"Current Price",-1)),It={class:"coin-rate"},Ct=Xe(()=>s("div",null,[s("svg",{class:"icon icon-up","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),St=Xe(()=>s("div",null,[s("svg",{class:"icon icon-down","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),$t=[Ct,St],Tt={key:0},Pt={key:1},Nt={key:0,class:"position-range"},Rt=Xe(()=>s("div",{class:"position-range-title"}," Position Range ",-1)),Ot={key:0},qt={key:1},Bt={key:2,src:Xn,alt:""},Lt={key:3,src:Gn,alt:""},Mt={key:4},Ut={key:5},jt={key:1,class:"position-range position-range-warp"},Et={key:0,class:"position-range-title"},Dt={key:1,class:"position-range-title"},Ft={key:2},Wt={key:3},Ht={class:"price-img"},Xt={key:0,src:zn,alt:""},Gt={key:1,src:Yn,alt:""},zt={key:4},Yt={key:5},Jt={key:2,class:"lever"},Qt=Xe(()=>s("div",{class:"lever-title"},"Leverage",-1)),Zt={class:"lever-text"},Kt={class:"right"},Vt=Xe(()=>s("div",{class:"chat-mask"},null,-1));function xt(e,n,t,i,$,I){var m,c,g,W,ee,oe,ie,f,v,h,a,y,N,w,l,V,G,re,x,M,H,J,ne,de,K,se,Z,ge,U,pe,_e,qe;const P=mo,r=Lo,o=Fo,d=Oo("image");return C(),L("div",Jn,[s("div",Qn,[s("div",Zn,[s("div",Kn,[Be(s("img",Vn,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),ue(P,{address:e.needReverse?(W=(g=e.positionInfo)==null?void 0:g.token_b)==null?void 0:W.address:(c=(m=e.positionInfo)==null?void 0:m.token_a)==null?void 0:c.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),s("div",xn,[Be(s("img",et,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),ue(P,{address:e.needReverse?(f=(ie=e.positionInfo)==null?void 0:ie.token_a)==null?void 0:f.address:(oe=(ee=e.positionInfo)==null?void 0:ee.token_b)==null?void 0:oe.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),s("div",ot,[s("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:Y(ko))("nftAddress",e.positionInfo.nftHash),target:"_blank"},E((h=(v=e.positionInfo)==null?void 0:v.name)==null?void 0:h.split("|")[1]),9,nt)]),(C(),L("svg",{class:"copy-icon","aria-hidden":"true",onClick:n[0]||(n[0]=u=>e.indexStore.copy(e.positionInfo.nftHash))},it)),e.positionInfo.fee?(C(),L("div",st,[at,Ae(" "+E(e.positionInfo.fee*100)+"% ",1)])):me("",!0)]),s("div",lt,[ue(r,{"current-status":(a=e.positionInfo)==null?void 0:a.currentStatus},null,8,["current-status"])])]),s("div",ut,[s("div",null,[s("div",rt,[s("div",dt,[Be(s("img",ct,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),ue(P,{address:e.needReverse?(l=(w=e.positionInfo)==null?void 0:w.token_b)==null?void 0:l.address:(N=(y=e.positionInfo)==null?void 0:y.token_a)==null?void 0:N.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),s("div",vt,[Be(s("img",mt,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),ue(P,{address:e.needReverse?(x=(re=e.positionInfo)==null?void 0:re.token_a)==null?void 0:x.address:(G=(V=e.positionInfo)==null?void 0:V.token_b)==null?void 0:G.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),s("div",ft,[s("div",null,[s("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:Y(ko))("nftAddress",e.positionInfo.nftHash),target:"_blank"},E((H=(M=e.positionInfo)==null?void 0:M.name)==null?void 0:H.split("|")[1]),9,pt),(C(),L("svg",{class:"copy-icon","aria-hidden":"true",onClick:n[1]||(n[1]=u=>e.indexStore.copy(e.positionInfo.nftHash))},gt))]),e.positionInfo.fee?(C(),L("div",bt,E(e.positionInfo.fee*100)+"%",1)):me("",!0)])]),ue(r,{"current-status":(J=e.positionInfo)==null?void 0:J.currentStatus},null,8,["current-status"])]),s("div",kt,[s("div",_t,[s("div",wt,[s("div",yt,[s("div",null,[At,s("div",It,[s("div",{onClick:n[2]||(n[2]=u=>e.direct=!e.direct)},$t)])]),(e.needReverse?!e.direct:e.direct)?(C(),L("div",Tt,[Ae(E(("addCommom"in e?e.addCommom:Y(Q))(("decimalUi"in e?e.decimalUi:Y(he))(e.positionInfo.currentPrice,6)))+"   ",1),s("span",null,E((ne=e.toCoin)==null?void 0:ne.symbol)+" per "+E((de=e.fromCoin)==null?void 0:de.symbol),1)])):(C(),L("div",Pt,[Ae(E(("addCommom"in e?e.addCommom:Y(Q))(("decimalUi"in e?e.decimalUi:Y(he))(1/e.positionInfo.currentPrice,6)))+"   ",1),s("span",null,E((K=e.fromCoin)==null?void 0:K.symbol)+" per "+E((se=e.toCoin)==null?void 0:se.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(C(),L("div",Nt,[Rt,s("div",null,[(e.needReverse?!e.direct:e.direct)?(C(),L("div",Ot,[Ae(E(("addCommom"in e?e.addCommom:Y(Q))(("decimalUi"in e?e.decimalUi:Y(he))(e.positionInfo.minPrice,6)))+" ",1),s("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(C(),L("div",qt,[Ae(E(((Z=e.positionInfo)==null?void 0:Z.minPrice)!=="0"?("addCommom"in e?e.addCommom:Y(Q))(("decimalUi"in e?e.decimalUi:Y(he))(1/e.positionInfo.minPrice,6)):0)+" ",1),s("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(C(),L("img",Bt)):(C(),L("img",Lt)),(e.needReverse?!e.direct:e.direct)?(C(),L("div",Mt,[Ae(E(((ge=e.positionInfo)==null?void 0:ge.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:Y(Q))(("decimalUi"in e?e.decimalUi:Y(he))(e.positionInfo.maxPrice,6)):"∞")+" ",1),s("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(C(),L("div",Ut,[Ae(E(((U=e.positionInfo)==null?void 0:U.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:Y(Q))(("decimalUi"in e?e.decimalUi:Y(he))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),s("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(C(),L("div",jt,[(e.needReverse?!e.direct:e.direct)?(C(),L("span",Et," Position Range ")):(C(),L("span",Dt," Position Range ")),(e.needReverse?!e.direct:e.direct)?(C(),L("div",Ft,[Ae(E(("addCommom"in e?e.addCommom:Y(Q))(("decimalUi"in e?e.decimalUi:Y(he))(e.positionInfo.minPrice,6)))+" ",1),s("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(C(),L("div",Wt,[Ae(E(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:Y(Q))(("decimalUi"in e?e.decimalUi:Y(he))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),s("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),s("div",Ht,[e.theme=="default"?(C(),L("img",Xt)):(C(),L("img",Gt))]),(e.needReverse?!e.direct:e.direct)?(C(),L("div",zt,[Ae(E(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:Y(Q))(("decimalUi"in e?e.decimalUi:Y(he))(e.positionInfo.maxPrice,6)):"∞")+" ",1),s("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(C(),L("div",Yt,[Ae(E(((pe=e.positionInfo)==null?void 0:pe.minPrice)!=="0"?("addCommom"in e?e.addCommom:Y(Q))(("decimalUi"in e?e.decimalUi:Y(he))(1/e.positionInfo.minPrice,6)):0)+" ",1),s("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),Ae("   ")]))])),((_e=e.positionInfo)==null?void 0:_e.minPrice)!==0&&((qe=e.positionInfo)==null?void 0:qe.maxPrice)!=="∞"?(C(),L("div",Jt,[Qt,s("div",Zt,E(e.lever),1)])):me("",!0)]),s("div",Kt,[ue(o,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,direction:!0,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price"]),Vt])])])])}const Wo=He(Hn,[["render",xt],["__scopeId","data-v-9d16f189"]]),ei=We({components:{TokenWarning:mo},setup(e,n){const{t}=Ao(),{$notify:i}=Jo(),$=Fe(),I=A(()=>$),P=Ve(),r=A(()=>P),o=O({}),d=O({}),m=O({}),c=A(()=>I.value.chainName),g=A(()=>c.value?so(c.value):{}),W=co(),ee=O(!1),oe=async(u=null)=>{const p=u||o.value;console.log(p,"===>posInfo");const S=r.value.addressLpTokens[p.poolAddress];if(S){const _=await g.value.getTickDataByIndex(S.ticks_handle,Number(p.tick_lower_index)),j=await g.value.getTickDataByIndex(S.ticks_handle,Number(p.tick_upper_index));let D={};c.value==="Aptos"?D=await g.value.getPosRewardersAmount({poolAddress:N.currentRoute.value.query.address,positionName:N.currentRoute.value.query.token,tickLowerData:_,tickUpperData:j}):D=await g.value.fetchPosRewardersAmount({poolAddress:p.poolAddress,positionId:p.pos_object_id,coinTypeA:p.coin_type_a,coinTypeB:p.coin_type_b,rewarderInfo:p.poolInfo.rewarder_infos});const q=[];let F=new b(0);D.forEach((z,ae)=>{var R,B;const ce=(R=r.value.tokensObj[z.coin_address])==null?void 0:R.decimals,be=z.amount_owed.toString();let ye=new b(be).div(Math.pow(10,ce)).toString();if(c.value=="Aptos"&&Number(ye)>999999999&&(ye="0"),p.poolInfo[`rewarder_display${ae+1}`]||Number(ye)>0){const le=r.value.tokensObj[z.coin_address],ke=((B=r.value.RATES[z.coin_address])==null?void 0:B.price)||0,k=new b(ye).mul(ke).toString();F=new b(F).plus(k),q.push({...z,...le,amount:Number(ye)>0?Pe(ye,ce):0,amountUSD:Number(k)>0?Pe(k,2):0,amountUSDText:k})}}),w.value=q,console.log(q,"====>result722")}};we(()=>[r.value.currentPositionInfo,c.value],([u,p])=>{var S;p=="Aptos"&&u?(o.value=u,d.value=u==null?void 0:u.token_a,m.value=u==null?void 0:u.token_b):p=="Sui"&&u&&(u==null?void 0:u.nftHash)==((S=W==null?void 0:W.query)==null?void 0:S.pos)&&(console.log(u,"==>newVal"),o.value=u,d.value=u==null?void 0:u.token_a,m.value=u==null?void 0:u.token_b,ee.value=!1)},{immediate:!0}),we(()=>[o.value,r.value.addressLpTokens],([u,p])=>{!fe(u)&&!fe(p)&&oe(u)},{immediate:!0});const ie=A(()=>{var u,p,S,_,j,D,q,F;if(o.value&&!fe(o.value)&&r.value.RATES){const z=o.value.amountA*((p=r.value.RATES[(u=o.value)==null?void 0:u.token_a.address])==null?void 0:p.price),ae=o.value.amountB*((_=r.value.RATES[(S=o.value)==null?void 0:S.token_b.address])==null?void 0:_.price);if((D=r.value.RATES[(j=o.value)==null?void 0:j.token_a.address])!=null&&D.price&&((F=r.value.RATES[(q=o.value)==null?void 0:q.token_b.address])!=null&&F.price)){const ce=Number(z+ae);return ce>0&&ce<.01?"<0.01":Q(Ee(z+ae,2),2)}else return" --"}else return" --"}),f=A(()=>{var u,p,S,_;return console.log((p=(u=o.value)==null?void 0:u.poolInfo)==null?void 0:p.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(_=(S=o.value)==null?void 0:S.poolInfo)==null?void 0:_.needReverse}),v=A(()=>r.value.RATES),h=A(()=>{var u,p;if(v.value&&d.value&&m.value&&!fe(v.value)&&!fe(d.value)&&!fe(m.value)){const S=[],_=Number(o.value.feeOwedA)||0,j=Number(o.value.feeOwedB)||0;console.log(_,j,"===292"),console.log(v.value,d.value.address,"===293"),console.log(v.value[d.value.address],"===>RATES.value[fromCoin.value.address]"),console.log(v.value[m.value.address],"===>RATES.value[toCoin.value.address]");const D=new b(_).mul(((u=v.value[d.value.address])==null?void 0:u.price)||0),q=new b(j).mul(((p=v.value[m.value.address])==null?void 0:p.price)||0);return console.log(D.toString(),q.toString(),"====>292"),S.push({amount:_,amountUSD:D.toString()},{amount:j,amountUSD:q.toString()}),S}return[]}),a=A(()=>{var p,S;let u=new b(0);return(p=h.value)==null||p.forEach(_=>{u=u.add(new b(_.amountUSD))}),c.value=="Sui"&&((S=w.value)==null||S.forEach(_=>{u=u.add(new b(_.amountUSDText))})),console.log(h.value,w.value,"===>pendingRewarderArr.value"),u.toNumber()}),y=A(()=>{var p;let u=new b(0);return(p=w.value)==null||p.forEach(S=>{u=u.add(new b(S.amountUSDText))}),u.toNumber()}),N=io(),w=O([]),{setIsShowSuccess:l,setIsShowRejected:V,setIsShowWaiting:G,setTransactionDesc:re,setTransactionTxid:x}=$,M=ro(),H=A(()=>M),J=async()=>{ee.value=!0;let u={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:w.value.length,collect_fee:!0};u.coinTypeC=w.value[0]?w.value[0].coin_address:"",u.coinTypeD=w.value[1]?w.value[1].coin_address:"",u.coinTypeE=w.value[2]?w.value[2].coin_address:"",G(!0),re();try{let p;if(c.value==="Aptos"){const S=await g.value.getCollectRewarderTransactionPayload(u);p=await H.value.currentWallet.signAndSubmitTransaction(S)}else{u.pos_index=o.value.pos_object_id;const S=await g.value.getCollectRewarderTransactionPayload(u),_=await H.value.currentWallet.signAndExecuteTransactionBlock(S);p=g.value.handleTx(_)}if(p&&p.hash){x(p.hash),G(!1),l(!0);const S={title:"Claim",desc:"",hash:p.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};c.value!=="Aptos"&&(S.res=p.res),g.value.showTransitionPending(S);const _=await g.value.watchTransaction(S);console.log("0310###toClaimRewards###transitionStatus###",_),_&&n.emit("getDetails")}else console.log("0310###toClaimRewards###else###"),G(!1),V(!0),ee.value=!1}catch(p){G(!1),V(!0),ee.value=!1,console.log(p,"error===>")}},ne=O(!1),de=async()=>{console.log("0310###toClaimRewards##start###",o.value),ne.value=!0;const u=w.value;let p={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:u.length};p.coinTypeC=u[0]?u[0].coin_address:"",p.coinTypeD=u[1]?u[1].coin_address:"",p.coinTypeE=u[2]?u[2].coin_address:"",console.log(p,"===>collectRewarderParams");try{let S;if(c.value==="Aptos"){const _=await g.value.getCollectRewarderTransactionPayload(p);S=await H.value.currentWallet.signAndSubmitTransaction(_)}else{p.pos_index=o.value.pos_object_id;const _=await g.value.getCollectRewarderTransactionPayload(p),j=await H.value.currentWallet.signAndExecuteTransactionBlock(_);S=g.value.handleTx(j)}if(console.log("0310###toClaimRewards##tx###",S),S&&S.hash){x(S.hash),G(!1),l(!0);const _=u[0].amount+u[0].symbol,j=p.coinTypeD?" and "+u[1].amount+u[1].symbol:"",D=p.coinTypeE?" and "+u[2].amount+u[2].symbol:"",q={title:"Claim",desc:"",hash:S.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:u[0].address,numa:`+ ${Number(u[0].amount)}`,logoa:r.value.tokensObj&&u[0]&&u[0].address&&r.value.tokensObj[u[0].address]&&r.value.tokensObj[u[0].address].logoURI,tokenb:u[1]&&u[1].address,numb:p.coinTypeD?`+ ${Number(u[1].amount)}`:"",logob:p.coinTypeD?r.value.tokensObj&&u[1]&&u[1].address&&r.value.tokensObj[u[1].address]&&r.value.tokensObj[u[1].address].logoURI:"",tokenc:u[2]&&u[2].address,numc:p.coinTypeE?`+ ${Number(u[2].amount)}`:"",logoc:p.coinTypeE?r.value.tokensObj&&u[2]&&u[2].address&&r.value.tokensObj[u[2].address]&&r.value.tokensObj[u[2].address].logoURI:""},text:_+j+D};c.value!=="Aptos"&&(q.res=S.res),g.value.showTransitionPending(q);const F=await g.value.watchTransaction(q);console.log("0310###toClaimRewards###transitionStatus###",F),F&&setTimeout(()=>{n.emit("getDetails"),g.value.getAccount(H.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),G(!1),V(!0);ne.value=!1}catch(S){console.log("0310###collectRewarderParams Error###",S),ne.value=!1,G(!1),V(!0)}},K=A(()=>r.value.positionDetailCurrentTab),se=A(()=>{var S,_,j,D,q,F;const u=he(f.value?(_=o.value)==null?void 0:_.amountB:(S=o.value)==null?void 0:S.amountA,f.value?(F=(q=o.value)==null?void 0:q.token_b)==null?void 0:F.decimals:(D=(j=o.value)==null?void 0:j.token_a)==null?void 0:D.decimals),p=f.value?r.value.positionActionAmount.toCoinAmount||0:r.value.positionActionAmount.fromCoinAmount||0;if(K.value=="increase")return p?new b(u).add(new b(p)).toString():"";if(p){const z=new b(u).minus(new b(p)).toString();return z<0?"0":String(z)}else return""}),Z=A(()=>{var S,_,j,D,q,F;const u=he(f.value?(_=o.value)==null?void 0:_.amountA:(S=o.value)==null?void 0:S.amountB,f.value?(F=(q=o.value)==null?void 0:q.token_a)==null?void 0:F.decimals:(D=(j=o.value)==null?void 0:j.token_b)==null?void 0:D.decimals),p=f.value?r.value.positionActionAmount.fromCoinAmount||0:r.value.positionActionAmount.toCoinAmount||0;if(console.log(u,p,"===>427"),K.value=="increase")return p?new b(u).add(new b(p)).toString():"";if(p){const z=new b(u).minus(new b(p)).toString();return z<0?"0":String(z)}else return""}),ge=A(()=>f.value?r.value.positionActionAmount.toCoinAmount:r.value.positionActionAmount.fromCoinAmount),U=A(()=>f.value?r.value.positionActionAmount.fromCoinAmount:r.value.positionActionAmount.toCoinAmount),pe=u=>{var p;return(u==null?void 0:u.logoURI)||(u==null?void 0:u.logo_url)||((p=r.value.tokensObj[u==null?void 0:u.address])==null?void 0:p.logo_url)||(I.value.theme==="default"?oo("/image/coins/unknown.png"):oo("/image/coins/sui-unknown.png"))},_e=A(()=>{var D,q,F,z,ae,ce,be,ye,R,B,le,ke;const{fromCoinAmount:u,toCoinAmount:p}=r.value.positionActionAmount,S=r.value.positionDetailCurrentTab,_=he(f.value?(q=o.value)==null?void 0:q.amountB:(D=o.value)==null?void 0:D.amountA,f.value?(ce=(ae=o.value)==null?void 0:ae.token_b)==null?void 0:ce.decimals:(z=(F=o.value)==null?void 0:F.token_a)==null?void 0:z.decimals),j=he(f.value?(ye=o.value)==null?void 0:ye.amountA:(be=o.value)==null?void 0:be.amountB,f.value?(ke=(le=o.value)==null?void 0:le.token_a)==null?void 0:ke.decimals:(B=(R=o.value)==null?void 0:R.token_b)==null?void 0:B.decimals);return console.log(_,j,u,p,"621===>"),c.value=="Sui"||S=="remove"&&c.value=="Aptos"&&u==_&&p==j});return{amountUSD:ie,needReverse:f,decimalUi:he,pendingFees:h,positionInfo:o,pendingRewarderArr:w,pendingYieldAmount:a,toClaim:async()=>{ee.value=!0;const u=Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,p=Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;re(t("newAdd.claimWaitingText",{from:f.value?p:u,and:Q(o.value.feeOwedA,o.value.token_a.decimals)==0||Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:f.value?u:p})),G(!0);let S;const _={pool:o.value.poolInfo,position:o.value};try{const j=await g.value.getCollectFeeTransactionPayload(_);if(c.value==="Aptos")S=await H.value.currentWallet.signAndSubmitTransaction(j);else{const D=await H.value.currentWallet.signAndExecuteTransactionBlock(j);S=g.value.handleTx(D)}if(S){x(S.hash),G(!1),l(!0);const D={title:"Claim",desc:"",hash:S.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":r.value.tokensObj&&o.value&&o.value.token_a.address&&r.value.tokensObj[o.value.token_a.address]&&r.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":r.value.tokensObj&&o.value&&o.value.token_b.address&&r.value.tokensObj[o.value.token_b.address]&&r.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${Q(o.value.feeOwedA,o.value.token_a.decimals)==0||Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};c.value!=="Aptos"&&(D.res=S.res),g.value.showTransitionPending(D);const q=await g.value.watchTransaction(D);console.log("0310##toClaim###transitionStatus####",q),q&&setTimeout(()=>{n.emit("getDetails")},1e3)}else G(!1),V(!0),i.error({icon:Ye("svg",{class:{icon:!0},"aria-hidden":!0},[Ye("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Ye("div",{class:"notification-title"},[Ye("span",{innerHTML:Io.global.t("newAdd.claimFailed")},null)]),description:t("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});ee.value=!1,console.log("claim####test###",S)}catch(j){console.log("claim###error####",j),ee.value=!1,G(!1),V(!0),i.error({icon:Ye("svg",{class:{icon:!0},"aria-hidden":!0},[Ye("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Ye("div",{class:"notification-title"},[Ye("span",{innerHTML:Io.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:t("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},claimAll:J,fromCoin:d,toCoin:m,showNum:Pe,claimLoading:ee,addCommom:Q,afterBase:se,afterQuote:Z,fromCoinAmount:ge,toCoinAmount:U,checkNullObj:fe,getCoinIcon:pe,chainName:c,isShowAfterAmount:_e,pendingRewarderAmount:y,toClaimRewards:de,rewarderLoading:ne}}});const oi={class:"liquidity-card"},ni={class:"liquidity-title"},ti={class:"liquidity-usd"},ii=s("span",null,"Liquidity",-1),si={class:"liquidity-ratio"},ai={class:"coin-ratio"},li={class:"coin-a-ratio"},ui={class:"coin-b-ratio"},ri={class:"ratio-progress"},di={class:"base-quote-num"},ci={class:"base-coin-num"},vi=s("span",null,"Base",-1),mi={alt:""},fi={key:0,class:"after"},pi={class:"quote-coin-num"},hi=s("span",null,"Quote",-1),gi={alt:""},bi={key:0,class:"after"},ki={class:"pending-yield"},_i={class:"left"},wi={class:"pending-yield-title"},yi={key:0,class:"after"},Ai={class:"right"},Ii={class:"fees-rewards"},Ci={class:"fees-rewards-item"},Si=s("span",null,"Fees",-1),$i={key:0,class:"after"},Ti=s("span",null,"Fees",-1),Pi={key:0,class:"after"},Ni=s("span",null,"Bonus",-1),Ri={alt:""},Oi={key:0,class:"after"},qi={key:0,class:"pending-yield"},Bi={class:"left"},Li=s("div",{class:"pending-yield-title"},"Pending rewards",-1),Mi={key:0,class:"after"},Ui={class:"right"},ji={key:1,class:"fees-rewards"},Ei={class:"fees-rewards-item"},Di=s("span",null,"Bonus",-1),Fi={alt:""},Wi={key:0,class:"after"};function Hi(e,n,t,i,$,I){var d,m,c,g,W,ee,oe,ie,f,v,h,a,y,N,w,l,V,G,re,x,M,H,J,ne,de,K,se,Z,ge,U,pe,_e,qe,u,p,S,_,j,D,q,F,z,ae,ce,be,ye,R,B,le,ke,k,X,T,te,ve,Se,Ne,Ie,Te,Me,Ue,Ge,Re,je;const P=mo,r=vo,o=Oo("image");return C(),L("div",oi,[s("div",ni,[s("div",ti,[ii,s("div",null,"$"+E(e.amountUSD),1)]),s("div",si,[s("div",ai,[s("div",li,[s("span",null,E(e.needReverse?(m=e.toCoin)==null?void 0:m.symbol:(d=e.fromCoin)==null?void 0:d.symbol),1),Ae(" "+E(e.needReverse?(g=e.positionInfo)==null?void 0:g.toPercent:(c=e.positionInfo)==null?void 0:c.fromPercent)+"% ",1)]),s("div",ui,[s("span",null,E(e.needReverse?(ee=e.fromCoin)==null?void 0:ee.symbol:(W=e.toCoin)==null?void 0:W.symbol),1),Ae(" "+E(e.needReverse?(ie=e.positionInfo)==null?void 0:ie.fromPercent:(oe=e.positionInfo)==null?void 0:oe.toPercent)+"% ",1)])]),s("div",ri,[s("div",{class:"from-percent",style:Co({width:e.needReverse?((v=e.positionInfo)==null?void 0:v.toPercent)+"%":((f=e.positionInfo)==null?void 0:f.fromPercent)+"%"})},null,4),s("div",{class:"to-percent",style:Co({width:e.needReverse?((a=e.positionInfo)==null?void 0:a.fromPercent)+"%":((h=e.positionInfo)==null?void 0:h.toPercent)+"%"})},null,4)])])]),s("div",di,[s("div",ci,[vi,s("div",null,[Be(s("img",mi,null,512),[[o,(e.needReverse?(N=e.toCoin)==null?void 0:N.logo_url:(y=e.fromCoin)==null?void 0:y.logo_url)||e.getCoinIcon(e.needReverse?(l=e.positionInfo)==null?void 0:l.token_b:(w=e.positionInfo)==null?void 0:w.token_a)]]),ue(P,{address:e.needReverse?(x=(re=e.positionInfo)==null?void 0:re.token_b)==null?void 0:x.address:(G=(V=e.positionInfo)==null?void 0:V.token_a)==null?void 0:G.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),s("span",null,E(("addCommom"in e?e.addCommom:Y(Q))(("decimalUi"in e?e.decimalUi:Y(he))(e.needReverse?(H=e.positionInfo)==null?void 0:H.amountB:(M=e.positionInfo)==null?void 0:M.amountA,e.needReverse?(K=(de=e.positionInfo)==null?void 0:de.token_b)==null?void 0:K.decimals:(ne=(J=e.positionInfo)==null?void 0:J.token_a)==null?void 0:ne.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:Y(fe))(e.positionInfo)?(C(),L("div",fi,E(("addCommom"in e?e.addCommom:Y(Q))(e.afterBase))+" after ",1)):me("",!0)]),s("div",pi,[hi,s("div",null,[Be(s("img",gi,null,512),[[o,(e.needReverse?(Z=e.fromCoin)==null?void 0:Z.logo_url:(se=e.toCoin)==null?void 0:se.logo_url)||e.getCoinIcon(e.needReverse?(U=e.positionInfo)==null?void 0:U.token_a:(ge=e.positionInfo)==null?void 0:ge.token_b)]]),ue(P,{address:e.needReverse?(u=(qe=e.positionInfo)==null?void 0:qe.token_a)==null?void 0:u.address:(_e=(pe=e.positionInfo)==null?void 0:pe.token_b)==null?void 0:_e.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),s("span",null,E(("addCommom"in e?e.addCommom:Y(Q))(("decimalUi"in e?e.decimalUi:Y(he))(e.needReverse?(S=e.positionInfo)==null?void 0:S.amountA:(p=e.positionInfo)==null?void 0:p.amountB,e.needReverse?(q=(D=e.positionInfo)==null?void 0:D.token_a)==null?void 0:q.decimals:(j=(_=e.positionInfo)==null?void 0:_.token_b)==null?void 0:j.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:Y(fe))(e.positionInfo)?(C(),L("div",bi,E(("addCommom"in e?e.addCommom:Y(Q))(e.afterQuote))+" after ",1)):me("",!0)])]),s("div",ki,[s("div",_i,[s("div",wi,E(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),s("div",null,[Ae(" $"+E(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:Y(Q))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(C(),L("span",yi,"$0 after")):me("",!0)])]),s("div",Ai,[ue(r,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.pendingYieldAmount==0,onClick:n[0]||(n[0]=Ce=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Ze(()=>[Ae("Claim")]),_:1},8,["loading","disabled"])])]),s("div",Ii,[s("div",Ci,[s("div",null,[Si,s("div",null,[Be(s("img",null,null,512),[[o,(e.needReverse?(z=e.toCoin)==null?void 0:z.logo_url:(F=e.fromCoin)==null?void 0:F.logo_url)||e.getCoinIcon(e.needReverse?(ce=e.positionInfo)==null?void 0:ce.token_b:(ae=e.positionInfo)==null?void 0:ae.token_a)]]),ue(P,{address:e.needReverse?(B=(R=e.positionInfo)==null?void 0:R.token_b)==null?void 0:B.address:(ye=(be=e.positionInfo)==null?void 0:be.token_a)==null?void 0:ye.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),s("span",null,E(e.needReverse?("showNum"in e?e.showNum:Y(Pe))(e.positionInfo.feeOwedB,(X=(k=e.positionInfo)==null?void 0:k.token_b)==null?void 0:X.decimals):("showNum"in e?e.showNum:Y(Pe))(e.positionInfo.feeOwedA,(ke=(le=e.positionInfo)==null?void 0:le.token_a)==null?void 0:ke.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Y(fe))(e.positionInfo)&&e.isShowAfterAmount?(C(),L("div",$i," 0 after ")):me("",!0)]),s("div",null,[Ti,s("div",null,[Be(s("img",null,null,512),[[o,(e.needReverse?(te=e.fromCoin)==null?void 0:te.logo_url:(T=e.toCoin)==null?void 0:T.logo_url)||e.getCoinIcon(e.needReverse?(Se=e.positionInfo)==null?void 0:Se.token_a:(ve=e.positionInfo)==null?void 0:ve.token_b)]]),ue(P,{address:e.needReverse?(Me=(Te=e.positionInfo)==null?void 0:Te.token_a)==null?void 0:Me.address:(Ie=(Ne=e.positionInfo)==null?void 0:Ne.token_b)==null?void 0:Ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),s("span",null,E(e.needReverse?("showNum"in e?e.showNum:Y(Pe))(e.positionInfo.feeOwedA,(je=(Re=e.positionInfo)==null?void 0:Re.token_a)==null?void 0:je.decimals):("showNum"in e?e.showNum:Y(Pe))(e.positionInfo.feeOwedB,(Ge=(Ue=e.positionInfo)==null?void 0:Ue.token_b)==null?void 0:Ge.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Y(fe))(e.positionInfo)&&e.isShowAfterAmount?(C(),L("div",Pi," 0 after ")):me("",!0)]),e.chainName=="Sui"?(C(!0),L(go,{key:0},bo(e.pendingRewarderArr,Ce=>(C(),L("div",{key:Ce},[Ni,s("div",null,[Be(s("img",Ri,null,512),[[o,Ce.logo_url]]),ue(P,{address:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),s("span",null,E(Ce.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Y(fe))(e.positionInfo)&&e.isShowAfterAmount?(C(),L("div",Oi," 0 after ")):me("",!0)]))),128)):me("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(C(),L("div",qi,[s("div",Bi,[Li,s("div",null,[Ae(" $"+E(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:Y(Q))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(C(),L("span",Mi,"$0 after")):me("",!0)])]),s("div",Ui,[ue(r,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Ze(()=>[Ae("Claim")]),_:1},8,["loading","disabled","onClick"])])])):me("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(C(),L("div",ji,[s("div",Ei,[(C(!0),L(go,null,bo(e.pendingRewarderArr,Ce=>(C(),L("div",{key:Ce},[Di,s("div",null,[Be(s("img",Fi,null,512),[[o,Ce.logo_url]]),ue(P,{address:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),s("span",null,E(Ce.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Y(fe))(e.positionInfo)&&e.isShowAfterAmount?(C(),L("div",Wi," 0 after ")):me("",!0)]))),128))])])):me("",!0)])}const Ho=He(ei,[["render",Hi]]),Xi=We({components:{AssetsCard:fo},setup(e,n){const t=O(""),i=O(""),$=Fe(),I=A(()=>$),P=A(()=>I.value.theme),r=Ve(),o=A(()=>r),d=O(!1),m=O(!1),c=O(!0),g=A(()=>I.value.chainName),W=A(()=>g.value?so(g.value):{}),ee=ro(),oe=A(()=>ee),ie=A(()=>I.value.slippage),f=O(),v=O(),h=A(()=>oe.value.assets&&f.value&&oe.value.assets[f.value.address]?So(oe.value.assets[f.value.address].balance,f.value.decimals):0),a=A(()=>oe.value.assets&&v.value&&oe.value.assets[v.value.address]?So(oe.value.assets[v.value.address].balance,v.value.decimals):0),y=_=>{_==="fromCoin"?(c.value=!0,g.value==="Aptos"?t.value=h.value>0?f.value.symbol=="APT"?new b(Number(h.value)).sub(new b(.1)).lt(new b(0))?"0":new b(Number(h.value)).sub(new b(.1)).toString():String(h.value):"":t.value=h.value>0?f.value.symbol=="SUI"?new b(Number(h.value)).sub(new b(.05)).lt(new b(0))?"0":new b(Number(h.value)).sub(new b(.05)).toString():String(h.value):""):(c.value=!1,g.value==="Aptos"?i.value=a.value>0?v.value.symbol=="APT"?new b(Number(a.value)).sub(new b(.1)).lt(new b(0))?"0":new b(Number(a.value)).sub(new b(.1)).toString():String(a.value):"":i.value=a.value>0?v.value.symbol=="SUI"?new b(Number(a.value)).sub(new b(.05)).lt(new b(0))?"0":new b(Number(a.value)).sub(new b(.05)).toString():String(a.value):"")},N=_=>{_==="fromCoin"?(c.value=!0,t.value=Ee(new b(Number(h.value)).div(2).toString(),f.value.decimals).toString()):(c.value=!1,i.value=Ee(new b(Number(a.value)).div(2).toString(),v.value.decimals).toString())},w=O({}),l=O(!0),V=O({}),G=O(),re=O(),x=()=>{var B;if(!w.value||!t.value&&!i.value)return;const{TickMath:_,TickUtil:j}=W.value;console.log(t.value,i.value,"====>369"),console.log(w.value,"===>positionInfo.value339");let D=w.value.minPrice,q=w.value.maxPrice.indexOf("+")>0?"∞":w.value.maxPrice;console.log(w.value,"positionInfo.value====>");let F=Number(w.value.tick_lower_index),z=Number(w.value.tick_upper_index);const ae=Number(w.value.current_tick_index);let ce,be,ye=Number(D).toString(),R=w.value.maxPrice.indexOf("+")>0||w.value.maxPrice==="∞"?"∞":Number(q);if(ye=="0"&&R=="∞"?(F=Number(w.value.tick_lower_index),z=Number(w.value.tick_upper_index)):(ce=_.priceToSqrtPriceX64(new b(D),f.value.decimals,v.value.decimals),be=_.priceToSqrtPriceX64(new b(q),f.value.decimals,v.value.decimals)),G.value=F,re.value=z,console.log(F,z,"tick_lowertick_lower"),q!=="∞"&&F>=z){d.value=!0,t.value="",m.value=!0,i.value="";return}if(q=="∞"||ae>=F&&ae<=z){console.log("0413###increase###11111"),d.value=!1,m.value=!1;let le;if(t.value||i.value){if(c.value){const ve=new b(t.value).mul(Math.pow(10,f.value.decimals)).toString();le=new Oe(ve)}else{const ve=new b(i.value).mul(Math.pow(10,v.value.decimals)).toString();le=new Oe(ve)}const{liquidityAmount:ke,tokenMaxA:k,tokenMaxB:X,tokenMaxAOrigin:T,tokenMaxBOrigin:te}=W.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:f.value,tokenB:v.value,lowerTick:F,upperTick:z,coinAmount:le,iscoinA:l.value?c.value:!c.value,roundUp:!0,slippage:Number(ie.value)/100,curSqrtPrice:new Oe(w.value.current_sqrt_price)});V.value={liquidityAmount:ke,tokenMaxA:k,tokenMaxB:X,tokenMaxAOrigin:T,tokenMaxBOrigin:te},l.value?c.value?i.value=Number(X)>0?X:"":t.value=Number(k)>0?k:"":c.value?i.value=k:t.value=X}}else if(ae>z){if(console.log("0413###increase###22222"),t.value="",d.value=!0,m.value=!1,t.value||i.value){let le;const ke=new b(i.value).mul(Math.pow(10,(B=v.value)==null?void 0:B.decimals)).toString();le=new Oe(ke),V.value={liquidityAmount:qo(ce,be,le),tokenMaxA:0,tokenMaxB:i.value}}}else if(ae<F){if(console.log("0413###increase###33333"),d.value=!1,m.value=!0,i.value="",t.value||i.value){let le;const ke=new b(t.value).mul(Math.pow(10,f.value.decimals)).toString();le=new Oe(ke),V.value={liquidityAmount:Bo(ce,be,le),tokenMaxA:t.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),d.value=!0,t.value="",m.value=!0,i.value="";r.setPositionActionAmount({fromCoinAmount:t,toCoinAmount:i}),console.log(V.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount")};we(()=>o.value.currentPositionInfo,_=>{if(_&&!fe(_)){w.value=_,console.log(_,"newVal===>"),f.value=w.value.token_a,v.value=w.value.token_b;let j=Number(w.value.tick_lower_index),D=Number(w.value.tick_upper_index);const q=Number(w.value.current_tick_index);(_.maxPrice.indexOf("+")>0||_.maxPrice==="∞"?"∞":_.maxPrice)=="∞"||q>=j&&q<=D?(d.value=!1,m.value=!1):q>D?(t.value="",d.value=!0,m.value=!1):q<j?(d.value=!1,m.value=!0,i.value=""):(d.value=!0,t.value="",m.value=!0,i.value=""),x()}},{immediate:!0}),we(t,(_,j)=>{_&&x(),_==""&&(i.value="")}),we(i,(_,j)=>{_&&x(),_==""&&(t.value="")});const M=A(()=>{var _,j,D,q;return console.log((j=(_=w.value)==null?void 0:_.poolInfo)==null?void 0:j.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(q=(D=w.value)==null?void 0:D.poolInfo)==null?void 0:q.needReverse}),H=A(()=>o.value.RATES),J=A(()=>{var z,ae,ce,be;const _=((ae=H.value[(z=f.value)==null?void 0:z.address])==null?void 0:ae.price)||0,j=((be=H.value[(ce=v.value)==null?void 0:ce.address])==null?void 0:be.price)||0,D=new b(_).mul(new b(t.value||0)),q=new b(j).mul(new b(i.value||0)),F=D.add(q);return console.log(_,j,D.toString(),q.toString(),"====>amount"),F.toNumber()?F.toNumber()>0&&F.toNumber()>.01?Q(F.toString(),2):"<0.01":"--"}),ne=O(!1),{t:de,locale:K}=Ao(),se=A(()=>{const _=Number(t.value)>Number(h.value),j=Number(i.value)>Number(a.value);return!t.value&&!i.value?de("button.enterAmount"):_?de("button.insufficientBalance",{name:f.value.symbol}):j?de("button.insufficientBalance",{name:v.value.symbol}):de("newAdd.addMore")}),Z=A(()=>{const _=Number(t.value)>Number(h.value),j=Number(i.value)>Number(a.value);return!!(!t.value&&!i.value||_||j)}),{setIsShowSuccess:ge,setIsShowRejected:U,setIsShowWaiting:pe,setTransactionDesc:_e,setTransactionTxid:qe,setPositiomNum:u}=$,p=O(!1);return{theme:P,showFromCoinLock:d,showToCoinLock:m,toCoinAmount:i,fromCoinAmount:t,fromCoinBlance:h,toCoinBlance:a,fromCoin:f,toCoin:v,maxBtnSelect:y,halfBtnSelect:N,fixedFromCoin:c,needReverse:M,totalAmount:J,wallet:oe,addLiquidityBtnText:se,isShowLiquidityModal:ne,indexStore:$,positionInfo:w,actionLoading:p,toAdd:async()=>{var z,ae,ce,be,ye,R,B,le,ke,k;ne.value=!1,p.value=!0,qe("");const _=d.value?"":`${t.value} ${(z=f.value)==null?void 0:z.symbol}`,j=m.value?"":`${i.value} ${(ae=v.value)==null?void 0:ae.symbol}`;_e(de("tips.increaseLiquiditySuccess",{from:M.value?j:_,and:!d.value&&!m.value?"and":"",to:M.value?_:j})),pe(!0);const D=c.value;console.log(D,"===>fix_amount_a"),console.log(G.value,"tickLower.value===>"),console.log(re.value,"tickUpper.value,===>"),console.log("0222###increase###positionInfo###",w);const q=w.value.poolInfo.rewarder_infos;let F={};F.coinTypeC=q[0]?q[0].coinAddress:"",F.coinTypeD=q[1]?q[1].coinAddress:"",F.coinTypeE=q[2]?q[2].coinAddress:"";try{const X=await W.value.getAddLiquidityTransactionPayload({pool:{poolAddress:w.value.poolAddress,token_a:w.value.token_a,token_b:w.value.token_b},amount:D?V.value.tokenMaxA:V.value.tokenMaxB,fix_amount_a:D,tick_lower:G.value,tick_upper:re.value,index:g.value==="Aptos"?w.value.index:w.value.pos_object_id,slippage:Number(ie.value)/100,roundUp:!0,collect_fee:!0,...F,curSqrtPrice:new Oe(w==null?void 0:w.value.poolInfo.current_sqrt_price)});console.log(X,"===>payloadAdd11111");let T;if(g.value==="Aptos")T=await oe.value.currentWallet.signAndSubmitTransaction(X);else{const te=await oe.value.currentWallet.signAndExecuteTransactionBlock(X);T=W.value.handleTx(te)}if(console.log("toAdd###tx###",T),T&&T.hash){qe(T.hash),pe(!1),ge(!0),console.log(w,"===>positionInfo");const te={title:"Supplied",desc:de("tips.addLiquiditySuccessText",{from:d.value?"":`${t.value} ${(ce=f.value)==null?void 0:ce.symbol}`,and:!d.value&&!m.value?"and":"",to:m.value?"":`${i.value} ${(be=v.value)==null?void 0:be.symbol}`}),hash:T.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:M.value?`${(R=v.value)==null?void 0:R.address}`:`${(ye=f.value)==null?void 0:ye.address}`,numa:M.value?`- ${i.value}`:`- ${t.value}`,logoa:M.value?o.value.tokensObj&&v.value&&v.value.address&&o.value.tokensObj[v.value.address]&&o.value.tokensObj[v.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI,tokenb:M.value?`${(le=f.value)==null?void 0:le.address}`:`${(B=v.value)==null?void 0:B.address}`,numb:M.value?`- ${t.value}`:`- ${i.value}`,logob:M.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&v.value&&v.value.address&&o.value.tokensObj[v.value.address]&&o.value.tokensObj[v.value.address].logoURI},text:`Deopsit ${d.value?"":`${t.value} ${(ke=f.value)==null?void 0:ke.symbol}`} ${!d.value&&!m.value?"and":""} ${m.value?"":`${i.value} ${(k=v.value)==null?void 0:k.symbol}`}`};g.value!=="Aptos"&&(te.res=T.res),W.value.showTransitionPending(te),await W.value.watchTransaction(te)&&setTimeout(()=>{n.emit("getDetails"),W.value.getAccount(oe.value.address)},1e3),u()}else pe(!1),U(!0);t.value="",i.value="",p.value=!1}catch(X){t.value="",i.value="",console.log("addError###",X),p.value=!1,pe(!1),U(!0)}},addLiquidityBtnDisabled:Z,poolStore:r}}});const Gi={class:"new-position-asset"},zi={class:"add-or-remove"},Yi={class:"liquidity-action-tab"},Ji=s("div",{class:"increase tab-active"}," Increase ",-1),Qi={class:"card-item"},Zi={class:"card-item"},Ki={key:0,class:"add",src:cn},Vi={key:1,class:"add",src:vn},xi={class:"total-amount"},es=s("span",null,"Total Amount",-1);function os(e,n,t,i,$,I){var m;const P=fo,r=rn,o=vo,d=dn;return C(),L("div",Gi,[s("div",zi,[s("div",Yi,[Ji,s("div",{class:"remove",onClick:n[0]||(n[0]=c=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),s("div",{class:uo(e.needReverse?"card-container reverse":"card-container")},[s("div",Qi,[ue(P,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=c=>e.fromCoinAmount=c),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:n[2]||(n[2]=c=>e.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=c=>e.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=c=>{e.fromCoinAmount=c}),onOnFocus:n[5]||(n[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(C(),Le(r,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):me("",!0)]),s("div",Zi,[ue(P,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[6]||(n[6]=c=>e.toCoinAmount=c),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:n[7]||(n[7]=c=>e.maxBtnSelect("toCoin")),onOnHalf:n[8]||(n[8]=c=>e.halfBtnSelect("toCoin")),onOnInput:n[9]||(n[9]=c=>{e.toCoinAmount=c}),onOnFocus:n[10]||(n[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(C(),Le(r,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):me("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(C(),L("img",Ki)):me("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(C(),L("img",Vi)):me("",!0)],2),s("div",xi,[es,s("span",null,"$"+E(e.totalAmount),1)])]),e.wallet.connected?(C(),Le(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:n[11]||(n[11]=c=>e.isShowLiquidityModal=!0)},{default:Ze(()=>[s("span",null,E(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(C(),Le(o,{key:1,class:"big-btn",onClick:n[12]||(n[12]=c=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Ze(()=>[s("span",null,E(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(C(),Le(d,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(m=e.positionInfo)==null?void 0:m.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:n[13]||(n[13]=c=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):me("",!0)])}const yo=He(Xi,[["render",os]]),ns=We({components:{AssetsCard:fo},setup(e,n){const t=O(""),i=O(""),$=Fe(),I=A(()=>$),P=A(()=>I.value.theme),r=Ve(),o=A(()=>r),d=O(!1),m=O(!1),c=O(!0),g=A(()=>I.value.chainName),W=A(()=>g.value?so(g.value):{}),ee=ro(),oe=A(()=>ee),ie=A(()=>I.value.slippage),f=O(),v=O(),h=A(()=>{var k,X;return(X=(k=l.value)==null?void 0:k.poolInfo)==null?void 0:X.needReverse}),a=A(()=>{var k;return console.log(l==null?void 0:l.value,"==>positionInfo?.value"),console.log(!h.value,"===>!needReverse.value"),he(l==null?void 0:l.value.amountA,(k=l==null?void 0:l.value.token_a)==null?void 0:k.decimals)}),y=A(()=>{var k;return he(l==null?void 0:l.value.amountB,(k=l==null?void 0:l.value.token_b)==null?void 0:k.decimals)}),N=k=>{k==="fromCoin"?(c.value=!0,g.value==="Aptos"||console.log(a.value,"213===>"),t.value=String(a.value)):(c.value=!1,g.value,i.value=String(y.value)),M.value=!1},w=k=>{k==="fromCoin"?(c.value=!0,t.value=Ee(new b(Number(a.value)).div(2).toString(),f.value.decimals).toString()):(c.value=!1,i.value=Ee(new b(Number(y.value)).div(2).toString(),v.value.decimals).toString()),M.value=!1},l=O({}),V=O(!0),G=O({}),re=O(),x=O(),M=O(!0),H=()=>{var Ge;if(M.value||!l.value||!t.value&&!i.value||(console.log(t.value>a.value,Number(i.value)>Number(y.value),"==>toCoinAmount.value"),Number(t.value)>Number(a.value)||Number(i.value)>Number(y.value)))return;if(t.value==a.value&&i.value==y.value){J.value=100,de({value:1}),M.value=!0;return}const{TickMath:k,TickUtil:X}=W.value;console.log(t.value,i.value,"====>369"),console.log(l.value,"===>positionInfo.value339");let T=l.value.minPrice,te=l.value.maxPrice.indexOf("+")>0?"∞":l.value.maxPrice;console.log(l.value,"positionInfo.value====>");let ve=Number(l.value.tick_lower_index),Se=Number(l.value.tick_upper_index);const Ne=Number(l.value.current_tick_index);let Ie,Te,Me=Number(T).toString(),Ue=l.value.maxPrice.indexOf("+")>0||l.value.maxPrice==="∞"?"∞":Number(te);if(Me=="0"&&Ue=="∞"?(ve=Number(l.value.tick_lower_index),Se=Number(l.value.tick_upper_index)):(Ie=k.priceToSqrtPriceX64(new b(T),f.value.decimals,v.value.decimals),Te=k.priceToSqrtPriceX64(new b(te),f.value.decimals,v.value.decimals)),re.value=ve,x.value=Se,console.log(ve,Se,"tick_lowertick_lower"),te!=="∞"&&ve>=Se){d.value=!0,t.value="",m.value=!0,i.value="";return}if(te=="∞"||Ne>=ve&&Ne<=Se){console.log("0413###increase###11111"),console.log(t.value,"==>341"),console.log(i.value,"==>341"),d.value=!1,m.value=!1;let Re;if(t.value||i.value){if(c.value){const Je=new b(t.value).mul(Math.pow(10,f.value.decimals)).toString();Re=new Oe(Je)}else{const Je=new b(i.value).mul(Math.pow(10,v.value.decimals)).toString();Re=new Oe(Je)}const{liquidityAmount:je,tokenMaxA:Ce,tokenMaxB:ze,tokenMaxAOrigin:ao,tokenMaxBOrigin:$e}=W.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:f.value,tokenB:v.value,lowerTick:ve,upperTick:Se,coinAmount:Re,iscoinA:V.value?c.value:!c.value,roundUp:g.value!="Sui",slippage:Number(ie.value)/100,curSqrtPrice:new Oe(l.value.current_sqrt_price)});G.value={liquidityAmount:je,tokenMaxA:Ce,tokenMaxB:ze,tokenMaxAOrigin:ao,tokenMaxBOrigin:$e},console.log(ze,Ce,"362===>"),V.value?c.value?i.value=Number(ze)>0?ze:"":t.value=Number(Ce)>0?Ce:"":c.value?i.value=Ce:t.value=ze}}else if(Ne>Se){if(console.log("0413###increase###22222"),t.value="",d.value=!0,m.value=!1,t.value||i.value){let Re;const je=new b(i.value).mul(Math.pow(10,(Ge=v.value)==null?void 0:Ge.decimals)).toString();Re=new Oe(je),G.value={liquidityAmount:qo(Ie,Te,Re),tokenMaxA:0,tokenMaxB:i.value}}}else if(Ne<ve){if(console.log("0413###increase###33333"),d.value=!1,m.value=!0,i.value="",t.value||i.value){let Re;const je=new b(t.value).mul(Math.pow(10,f.value.decimals)).toString();Re=new Oe(je),G.value={liquidityAmount:Bo(Ie,Te,Re),tokenMaxA:t.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),d.value=!0,m.value=!0;M.value=!1,J.value=new b(G.value.liquidityAmount.toString()).div(l.value.liquidity).mul(100).toNumber().toFixed(2),ne.value=G.value.liquidityAmount,console.log(J.value,"===>sliderVal.value"),console.log(G.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount"),r.setPositionActionAmount({fromCoinAmount:t,toCoinAmount:i}),console.log(J.value,"===>sliderVal.value")},J=O(50),ne=O("0"),de=k=>{if(!M.value)return;M.value=!0;const X=l.value.token_a.decimals,T=l.value.token_b.decimals,te=l.value.tick_lower_index,ve=l.value.tick_upper_index,Se=$o.tickIndexToSqrtPriceX64(te),Ne=$o.tickIndexToSqrtPriceX64(ve);let Ie="";k.value!==1?Ie=new b(l.value.liquidity).mul(k.value).toString():Ie=l.value.liquidity,Ie=Ee(Ie,0)||"0",ne.value=Ie;const Te=tn.getCoinAmountFromLiquidity(new Oe(Ie),new Oe(l.value.current_sqrt_price),Se,Ne,g.value!="Sui");console.log(Te.coinA.toString(),Te.coinB.toString(),X,T,"===>amountInfo");const Me=new b(Te.coinA.toString()).div(Math.pow(10,X)).toString(),Ue=new b(Te.coinB.toString()).div(Math.pow(10,T)).toString();console.log(Me,Ue,"amountA121212"),t.value=Number(Me)>0?Me:"",i.value=Number(Ue)>0?Ue:"",r.setPositionActionAmount({fromCoinAmount:t,toCoinAmount:i})};we(()=>o.value.currentPositionInfo,k=>{if(k&&!fe(k)){l.value=k,console.log(k,"newVal===>"),f.value=l.value.token_a,v.value=l.value.token_b,de({value:J.value/100});let X=Number(l.value.tick_lower_index),T=Number(l.value.tick_upper_index);const te=Number(l.value.current_tick_index);(k.maxPrice.indexOf("+")>0||k.maxPrice==="∞"?"∞":k.maxPrice)=="∞"||te>=X&&te<=T?(d.value=!1,m.value=!1):te>T?(t.value="",d.value=!0,m.value=!1):te<X?(d.value=!1,m.value=!0,i.value=""):(d.value=!0,t.value="",m.value=!0,i.value=""),H()}},{immediate:!0}),we(t,(k,X)=>{k&&H(),k==""&&(i.value="",J.value=0)}),we(i,(k,X)=>{k&&H(),k==""&&(t.value="",J.value=0)});const K=A(()=>o.value.RATES),se=A(()=>{var Se,Ne,Ie,Te;const k=((Ne=K.value[(Se=f.value)==null?void 0:Se.address])==null?void 0:Ne.price)||0,X=((Te=K.value[(Ie=v.value)==null?void 0:Ie.address])==null?void 0:Te.price)||0,T=new b(k).mul(new b(t.value||0)),te=new b(X).mul(new b(i.value||0)),ve=T.add(te);return console.log(k,X,T.toString(),te.toString(),"====>amount"),Q(ve.toString(),2)}),Z=O(!1),{t:ge,locale:U}=Ao(),pe=A(()=>{const k=Number(t.value)>Number(a.value),X=Number(i.value)>Number(y.value);return!t.value&&!i.value?ge("button.enterAmount"):k||X?"Invalid Amount":ge("button.remove")}),_e=A(()=>{const k=Number(t.value)>Number(a.value),X=Number(i.value)>Number(y.value);return!!(!t.value&&!i.value||k||X)}),{setIsShowSuccess:qe,setIsShowRejected:u,setIsShowWaiting:p,setTransactionDesc:S,setTransactionTxid:_,setPositiomNum:j,setTransactionDescText:D}=$,q=O(!1);we(J,Qo((k,X)=>{k!==X&&(Number(k)>100?J.value=100:k&&l.value?(console.log("687===>"),J.value=k,de({value:J.value/100})):(t.value="",i.value=""))},300)),we(ie,k=>{k&&l.value&&de({value:J.value/100})});const F=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],z=Mo(),ae=A(()=>z),ce=A(()=>ae.value.status),be=O(!1),ye=k=>{const X=k.sources;X.forEach(T=>{const{pool_address:te,position_index:ve}=JSON.parse(T.blockchainAddress);console.log(te,ve,"===>pool_address, position_index"),console.log(l.value.poolAddress,l.value.index,"===>positionInfo.value.index"),te==l.value.poolAddress&&Number(ve)==Number(l.value.index)&&(be.value=!0)}),console.log(X,"===>sources")},R=async()=>{await z.getSources();let k;ae.value.allSources.forEach(X=>{const{pool_address:T,position_index:te}=JSON.parse(X.blockchainAddress);T==l.value.poolAddress&&te==l.value.index&&(k=X.id)}),console.log(k,"sourceID649==>"),z.deleteSource(k)};we(()=>[ae.value.sourceGroups,l.value],([k,X])=>{k&&k.sources&&k.sources.length>0&&X&&!fe(X)&&ye(k)},{immediate:!0,deep:!0});const B=io(),le=co();return{theme:P,showFromCoinLock:d,showToCoinLock:m,toCoinAmount:i,fromCoinAmount:t,fromCoinBlance:a,toCoinBlance:y,fromCoin:f,toCoin:v,maxBtnSelect:N,halfBtnSelect:w,fixedFromCoin:c,needReverse:h,totalAmount:se,wallet:oe,addLiquidityBtnText:pe,isShowLiquidityModal:Z,indexStore:$,positionInfo:l,actionLoading:q,addLiquidityBtnDisabled:_e,sliderVal:J,ratioArr:F,setPercent:de,poolStore:r,isSlider:M,toRemove:async()=>{var ve,Se,Ne,Ie,Te,Me,Ue,Ge,Re,je,Ce,ze,ao;q.value=!0,_("");const k=Q(t.value,f.value.decimals)==0?"":`${he(t.value,f.value.decimals)} ${f.value.symbol}`,X=Q(i.value,v.value.decimals)==0?"":`${he(i.value,v.value.decimals)} ${v.value.symbol}`;S(ge("tips.removeLiquidiyText",{from:h.value?X:k,and:Q(t.value,f.value.decimals)==0||Q(i.value,v.value.decimals)==0?"":"and",to:h.value?k:X})),p(!0),console.log(l.value,"==>positionInfo.value");const T=l.value.poolInfo.rewarder_infos,te=T&&T.length>0&&g.value=="Sui"||T&&T.length>0&&J.value==100?ge("modal.removeLiquidityText1"):ge("modal.removeLiquidityText2");D(te);try{let $e={};$e={pool:{...l.value.poolInfo,coinA:l.value.token_a,coinB:l.value.token_b},coinTypeA:l.value.poolInfo.coinTypeA,coinTypeB:l.value.poolInfo.coinTypeB,position:l.value,delta_liquidity:J.value==100?new Oe(l.value.liquidity):new Oe(Ee(ne.value,0)),slippage:Number(ie.value),rewards_num:T.length},console.log(T,"===>pendingRewarderArr"),$e.coinTypeC=T[0]?T[0].coinAddress:"",$e.coinTypeD=T[1]?T[1].coinAddress:"",$e.coinTypeE=T[2]?T[2].coinAddress:"",console.log($e,"===>params");const Je=await W.value.getRemoveLiquidityTransactionPayload($e);console.log(Je,"===>payload");let De;if(g.value==="Aptos")De=await oe.value.currentWallet.signAndSubmitTransaction(Je);else{const xe=await oe.value.currentWallet.signAndExecuteTransactionBlock(Je);De=W.value.handleTx(xe),console.log("0331###remove###tx####",De)}if(De&&De.hash){_(De.hash),p(!1),qe(!0);const xe={title:ge("common.removeLiquidity"),desc:"",hash:De.hash,descTransactions:`Remove ${t.value} ${(ve=f.value)==null?void 0:ve.symbol} and ${i.value} ${(Se=v.value)==null?void 0:Se.symbol} 
             from the pool`,sender:oe.value.address,chainName:g.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:h.value?`${(Ie=v.value)==null?void 0:Ie.address}`:`${(Ne=f.value)==null?void 0:Ne.address}`,numa:h.value?`+ ${i.value}`:`+ ${t.value}`,logoa:h.value?o.value.tokensObj&&v.value&&v.value.address&&o.value.tokensObj[v.value.address]&&o.value.tokensObj[v.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI,tokenb:h.value?`${(Te=f.value)==null?void 0:Te.address}`:`${(Me=v.value)==null?void 0:Me.address}`,numb:h.value?`+ ${t.value}`:`+ ${i.value}`,logob:h.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&v.value&&v.value.address&&o.value.tokensObj[v.value.address]&&o.value.tokensObj[v.value.address].logoURI},text:`Withdraw ${t.value} ${(Ue=f.value)==null?void 0:Ue.symbol} and ${i.value} ${(Ge=v.value)==null?void 0:Ge.symbol}`};g.value!=="Aptos"&&(xe.res=De.res),W.value.showTransitionPending(xe);const lo=await W.value.watchTransaction(xe);if(T.value&&T.value.length>0&&(Number((Re=T[0])==null?void 0:Re.amount)!==0||$e.coinTypeD&&Number((je=T[1])==null?void 0:je.amount)!==0||$e.coinTypeE&&Number((Ce=T[2])==null?void 0:Ce.amount)!==0)){const po={title:ge("common.removeLiquidity"),desc:"",hash:De.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:T[0].symbol,numa:`+ ${Number(T[0].amount)}`,logoa:o.value.tokensObj&&T[0]&&T[0].address&&o.value.tokensObj[T[0].address]&&o.value.tokensObj[T[0].address].logoURI,tokenb:$e.coinTypeD?T[1].symbol:"",numb:$e.coinTypeD?`+ ${Number(T[1].amount)}`:"",logob:$e.coinTypeD?o.value.tokensObj&&T[1]&&T[1].address&&o.value.tokensObj[T[1].address]&&o.value.tokensObj[T[1].address].logoURI:"",tokenc:$e.coinTypeE?T[2].symbol:"",numc:$e.coinTypeE?`+ ${Number(T[2].amount)}`:"",logoc:$e.coinTypeE?o.value.tokensObj&&T[2]&&T[2].address&&o.value.tokensObj[T[2].address]&&o.value.tokensObj[T[2].address].logoURI:""},text:`Withdraw ${t.value} ${(ze=f.value)==null?void 0:ze.symbol} and ${i.value} ${(ao=v.value)==null?void 0:ao.symbol}`},ho=await W.value.setTransations(po);console.log("9999transitionStatusFees",lo,ho)}if(Pe(l.value.feeOwedA,l.value.token_a.decimals)!==0||Pe(l.value.feeOwedB,l.value.token_b.decimals)!==0){const po={title:"Claim",desc:"",hash:De.hash,chainName:g.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${l.value.token_a.symbol}`,numa:Q(l.value.feeOwedA,l.value.token_a.decimals)==0?"":`+ ${Pe(l.value.feeOwedA,l.value.token_a.decimals)}`,logoa:Q(l.value.feeOwedA,l.value.token_a.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_a.address&&o.value.tokensObj[l.value.token_a.address]&&o.value.tokensObj[l.value.token_a.address].logoURI,tokenb:`${l.value.token_b.symbol}`,numb:Q(l.value.feeOwedB,l.value.token_b.decimals)==0?"":`+ ${Pe(l.value.feeOwedB,l.value.token_b.decimals)}`,logob:Q(l.value.feeOwedB,l.value.token_b.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_b.address&&o.value.tokensObj[l.value.token_b.address]&&o.value.tokensObj[l.value.token_b.address].logoURI}},ho=await W.value.setTransations(po);console.log("9999transitionStatusFees",lo,ho)}lo&&Number(J.value)==100&&ce.value=="authenticated"&&be.value&&(await z.subscribePosition({pool_address:l.value.poolAddress,position_index:l.value.index},l.value.nftHash,!1),R()),lo&&(t.value="",i.value="",setTimeout(()=>{n.emit("getDetails")},3e3),setTimeout(()=>{n.emit("getDetails")},6e3),console.log(J.value,le.name,g.value,"998===>"),Number(J.value)==100&&le.name=="new-position-detail"&&(g.value==="Aptos"?B.push("/position"):B.push("/pool/position")),J.value=0)}else p(!1),u(!0);q.value=!1}catch($e){console.log("Remove error",$e),q.value=!1,p(!1),u(!0)}},sFixD:Ee}}});const ts={class:"new-position-asset"},is={class:"add-or-remove"},ss={class:"liquidity-action-tab"},as=s("div",{class:"remove tab-active"},"Remove",-1),ls={class:"card-item"},us={key:0,class:"assets-card-mask"},rs={class:"card-item"},ds={key:0,class:"assets-card-mask"},cs={class:"remove-ratio"},vs=s("div",{class:"remove-ratio-title"},"Amount",-1),ms={class:"remove-ratio-select"},fs={key:0,class:"ratio"},ps={key:1,class:"ratio"},hs={class:"ratio-list"},gs=["onClick"];function bs(e,n,t,i,$,I){const P=fo,r=Zo,o=vo;return C(),L("div",ts,[s("div",is,[s("div",ss,[s("div",{class:"increase",onClick:n[0]||(n[0]=d=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),as]),s("div",{class:uo(e.needReverse?"card-container reverse":"card-container")},[s("div",ls,[ue(P,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=d=>e.fromCoinAmount=d),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:n[2]||(n[2]=d=>e.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=d=>e.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=d=>{e.fromCoinAmount=d,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(C(),L("div",us)):me("",!0)]),s("div",rs,[ue(P,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[5]||(n[5]=d=>e.toCoinAmount=d),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:n[6]||(n[6]=d=>e.maxBtnSelect("toCoin")),onOnHalf:n[7]||(n[7]=d=>e.halfBtnSelect("toCoin")),onOnInput:n[8]||(n[8]=d=>{e.toCoinAmount=d,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(C(),L("div",ds)):me("",!0)])],2),s("div",cs,[vs,s("div",ms,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(C(),L("div",fs,E(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:Y(Ee))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:Y(Ee))(e.sliderVal,2))+"% ",1)):(C(),L("div",ps," -- ")),s("div",hs,[(C(!0),L(go,null,bo(e.ratioArr,(d,m)=>(C(),L("div",{key:m,class:uo(["ratio-item",e.sliderVal==d.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=d.value}},E(d.name),11,gs))),128))])]),ue(r,{value:e.sliderVal,"onUpdate:value":n[9]||(n[9]=d=>e.sliderVal=d)},null,8,["value"])])]),e.wallet.connected?(C(),Le(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Ze(()=>[s("span",null,E(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(C(),Le(o,{key:1,class:"big-btn",onClick:n[10]||(n[10]=d=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Ze(()=>[s("span",null,E(e.$t("button.connectWallet")),1)]),_:1}))])}const ks=He(ns,[["render",bs]]),_s=We({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const n=Mo(),t=A(()=>n),i=A(()=>t.value.status),$=Fe();we(()=>[t.value.targetGroups],m=>{console.log("0327###watch###newTargetGoups###",m)},{immediate:!0});const I=O(!1);we(()=>i.value,m=>{m=="authenticated",I.value=!1},{immediate:!0});const P=O(!1),r=async()=>{P.value=!P.value,console.log(P.value,"===>checked.value");const m={pool_address:e.positionInfo.poolAddress,position_index:e.positionInfo.index},c=e.positionInfo.nftHash;console.log("0529###changeSwitch###positionInfo####",e.positionInfo);try{await n.subscribePosition(m,c,P.value)}catch{P.value=!P.value}},o=m=>{const c=m.sources;P.value=c.some(g=>JSON.parse(g.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(g.blockchainAddress).position_index)==Number(e.positionInfo.index))},d=io();return console.log(d.currentRoute.value.query.token,"===>rouyter"),we(()=>[t.value.sourceGroups,e.positionInfo],([m,c])=>{var g,W,ee;console.log(m,"==>newSourceGroups169"),console.log(c,"===>positionInfo170"),P.value=!1,m&&m.length>0&&m[0]&&c&&!fe(c)&&((ee=(W=(g=d==null?void 0:d.currentRoute)==null?void 0:g.value)==null?void 0:W.query)==null?void 0:ee.token)==(c==null?void 0:c.name)&&(console.log("触发"),console.log(m,"==>newSourceGroups"),console.log(c,"===>positionInfo"),o(m[0]))},{immediate:!0,deep:!0}),{importIcon:oo,isShowSetUp:I,changeSwitch:r,checked:P,notifiStatus:i,store:$}}});const ws=e=>(no("data-v-8f838b7e"),e=e(),to(),e),ys={class:"range-alerts"},As={class:"range-alerts-top"},Is={class:"title"},Cs=ws(()=>s("div",{class:"title-all"},[s("span",{class:"Range"},"Range Alerts")],-1)),Ss={key:1,class:"h5-switch-box"},$s={class:"range-alerts-bottom"},Ts={key:0,class:"pc-switch-box"};function Ps(e,n,t,i,$,I){const P=vo,r=Vo;return C(),L("div",ys,[s("div",As,[s("div",Is,[Cs,e.isShowSetUp||e.notifiStatus!=="authenticated"?(C(),Le(P,{key:0,class:"range-alerts-button",onClick:n[0]||(n[0]=Ko(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Ze(()=>[Ae(" Set up ")]),_:1})):me("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(C(),L("div",Ss,[ue(r,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):me("",!0)])]),s("div",$s,[Ae(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(C(),L("div",Ts,[ue(r,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):me("",!0)])])}const Xo=He(_s,[["render",Ps],["__scopeId","data-v-8f838b7e"]]),Ns=We({components:{NewPositionTitle:Do,NewPositionInfo:Wo,NewPositionLiquidity:Ho,NewPositionAssetAdd:yo,NewPositionAssetRemove:yo,NewPositionNotifi:Xo},setup(){const e=O(),n=O(),t=O(),i=Fe(),$=A(()=>i),I=A(()=>$.value.chainName),P=Ve(),r=A(()=>P),o=io();No(()=>{e.value={},P.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),r.value.setCurrentPositionLoading(!0)});const d=async()=>{r.value.setCurrentPositionLoading(!0);const v=o.currentRoute.value.query.token||"",h=o.currentRoute.value.query.collect||"",a=o.currentRoute.value.query.address||"",y=o.currentRoute.value.query.pos||"",N=o.currentRoute.value.query.id||"";I.value==="Aptos"?v&&h&&a&&r.value.setCurrentPositionInfo(a,h,v,I.value):(console.log("0414###position-detail###id#####",N),console.log("0414###position-detail###name#####",v),console.log("0414###position-detail###pool_address#####",a),console.log("0414###position-detail###pos#####",y),v&&a&&y?r.value.setCurrentPositionInfo(a,h,v,I.value,y):N&&r.value.setCurrentPositionInfo("","","",I.value,N))};we(()=>r.value.poolConfigObj,v=>{v&&!fe(v)&&d()},{immediate:!0});const m=A(()=>r.value.currentPositionLoading),c=A(()=>{var h,a,y;const v=((y=(a=(h=o==null?void 0:o.currentRoute)==null?void 0:h.value)==null?void 0:a.query)==null?void 0:y.address)||"";return v&&r.value.addressLpTokens&&!fe(r.value.addressLpTokens)&&r.value.addressLpTokens[v]?r.value.addressLpTokens[v]:null});we(()=>c.value,(v,h)=>{v&&!fe(v)&&(e.value=v),v&&!fe(v)&&v.current_sqrt_price!==(h==null?void 0:h.current_sqrt_price)&&d()},{immediate:!0});const g=co();we(()=>[r.value.currentPositionInfo,I.value],([v,h])=>{var a;h=="Aptos"&&v?(e.value=v,n.value=e.value.token_a,t.value=e.value.token_b):h=="Sui"&&v&&(v==null?void 0:v.nftHash)==((a=g==null?void 0:g.query)==null?void 0:a.pos)&&(console.log(v,"==>newVal"),e.value=v,n.value=e.value.token_a,t.value=e.value.token_b)},{immediate:!0});const W=A(()=>r.value.positionDetailCurrentTab),ee=ro(),oe=A(()=>ee),ie=A(()=>$.value.theme);return xo(()=>{oe.value.connected||(ie.value==="default"?o.push("/position"):o.push("/pool/position"))}),console.log(e.value,"===>positionInfo.value135"),{positionInfo:e,fromCoin:n,toCoin:t,getDetails:d,currentPositionLoading:m,positionDetailCurrentTab:W,clickRefresh:()=>{d()},chainName:I}}});const Rs={class:"new-position-detail"},Os={class:"new-position-content"},qs={class:"left"},Bs={class:"right"},Ls={class:"loading-global"};function Ms(e,n,t,i,$,I){const P=Do,r=Wo,o=Ho,d=yo,m=ks,c=Xo,g=en;return C(),L("div",Rs,[ue(P,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),s("div",Os,[s("div",qs,[ue(r),ue(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),s("div",Bs,[e.positionDetailCurrentTab=="increase"?(C(),Le(d,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(C(),Le(m,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),ue(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="∞"&&e.chainName=="Sui"?(C(),Le(c,{key:2,"position-info":e.positionInfo},null,8,["position-info"])):me("",!0)])]),Be(s("div",Ls,[ue(g)],512),[[Ro,e.currentPositionLoading]])])}const aa=He(Ns,[["render",Ms],["__scopeId","data-v-6904756a"]]);export{aa as default};
