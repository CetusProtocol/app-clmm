import{_ as dn}from"./refresh-icon.d944d961.js";import{_ as cn}from"./assets-card.c468ee9b.js";import{u as Me,e as ao,c as _e,s as ae,a as J,o as Ze,d as ue,y as Xe,g as Po,j as mn,b as He,p as _o}from"./pool.be70b3b7.js";import{e as Te,a as Ke,C as No,L as Ro,r as f,l as N,q as oe,s as Ue,o as r,f as h,h as o,c as Z,x as j,t as x,j as K,v as u,A as de,F as ze,u as X,S as Oo,M as Bo,p as Fe,k as je,a4 as vn,i as he,w as ce,P as Mo,$ as To,V as Uo,E as $o,B as Fo,b as Io,y as fn,H as pn,K as hn,D as Ye}from"./entry.8845e577.js";/* empty css              *//* empty css              */import{c as pe,u as Ee,a as gn}from"./sha256.d9bd2ab7.js";import"./decimal.6f03adc8.js";import{i as ve}from"./import-icon.de3e6c66.js";import{D as i}from"./decimal.0bdeb344.js";import{_ as Cn}from"./network-tips.3066699e.js";import{_ as bn}from"./coin-select.ecba7d71.js";import{_ as wn}from"./swap-setting.e511fb3e.js";/* empty css              */import{_ as kn}from"./token-warning-modal.210a85cc.js";import{u as yn}from"./swapRouter.a17a696d.js";import{_ as An}from"./img-leverage_2x.1c577303.js";/* empty css              */import"./token-warning.7e767055.js";/* empty css              */import"./img-no-Positions_2x.50784187.js";/* empty css              */import"./icon-error_2x.1614ec09.js";import"./icon-selected_3x.09e9a6f0.js";async function Sn(e,p){var E,q,m;const S=e==="0x2::sui::SUI"?"0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI":e,k=`${pe.Sui.api}/v2/sui/coin/kline?coin_address=${S}&interval=day&market=${p}`;try{const _=await $fetch(k);return{price:((q=(E=_==null?void 0:_.data)==null?void 0:E.list)==null?void 0:q.reverse())||[],daily_rate:(m=_==null?void 0:_.data)==null?void 0:m.daily_rate.replace("%","")}}catch{return{price:[],daily_rate:""}}}async function _n(e){try{const{prices:p}=await $fetch(`https://api.coingecko.com/api/v3/coins/${e}/market_chart?vs_currency=usd&id=${e}&days=7&interval=daily`,{headers:{Connection:"keep-alive",Accept:"*/*"}}),k=(await $fetch(`https://api.coingecko.com/api/v3/coins/markets?ids=${e}&vs_currency=usd&price_change_percentage=24h`,{headers:{Connection:"keep-alive",Accept:"*/*"}}))[0].price_change_percentage_24h,E=[];return p.forEach(q=>{E.push({price:new i(q[1]).toString(),timestamp:q[0]})}),{price:E,daily_rate:k}}catch{return{price:[],daily_rate:""}}}const $n=""+globalThis.__publicAssetsURL("sui-image/route-view.png");const In=Ke({props:{swapLoading:{type:Boolean,default:!1},fromCoinAmount:{type:String,default:""},toCoinAmount:{type:String,default:""},fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},fixedFromCoin:{type:Boolean,default:!0},impact:{type:String,default:""},insufficientLiquidity:{type:Boolean,default:!1},oneToAmount:{type:String,default:""},oneFromAmount:{type:String,default:""},suiPreSwapdata:{type:Object,default:()=>({})},suiSwapFee:{type:String,default:""},swapRouterLoading:{type:Boolean,default:!1}},setup(e){const p=No(Ro,{style:{fontSize:"20px",color:"#75C8FF"},spin:!0}),S=f(!1),k=Ee(),E=N(()=>k),q=N(()=>E.value.slippage),m=N(()=>E.isShowRouterModal);oe(()=>e,n=>{},{immediate:!0,deep:!0});const _=Me(),g=N(()=>_),H=ao("Sui"),V=f(0),ee=f([]),A=f({});oe(()=>e.suiPreSwapdata,async n=>{var s;if(n&&!_e(n)){let w=[];(s=n==null?void 0:n.splitPaths)==null||s.forEach(L=>{L==null||L.basePaths.forEach(async Q=>{w.push(Q.label)})});const{splitPaths:C}=n,O=C&&C[0]&&C[0].basePaths;if(C&&C.length==1&&O&&O.length==2){const L=O[0].toCoin=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":O[0].toCoin;A.value=g.value.tokensObj[L]||(await H.getTokenListByCoinType[L])[0]}else A.value="";ee.value=Array.from(new Set(w)),V.value=ee.value.length}},{immediate:!0});const U=f(0),a=f(0);oe(()=>[e.fromCoinAmount,e.toCoinAmount,e.fromCoin,e.toCoin,e.fixedFromCoin,q.value],([n,s,w,C,O,L])=>{if(n&&s&&w&&C&&L)if(O){const Q=new i(s).mul(new i(L/100));a.value=new i(s).sub(Q).toString()}else{const Q=new i(n).mul(new i(L/100));U.value=new i(n).add(Q).toString()}},{immediate:!0});const Y=n=>{var s;return(n==null?void 0:n.logoURI)||(n==null?void 0:n.logo_url)||((s=g.value.tokensObj[n==null?void 0:n.address])==null?void 0:s.logo_url)||(E.theme==="default"?ve("/image/coins/unknown.png"):ve("/image/coins/sui-unknown.png"))},ne=N(()=>{var n,s,w,C,O,L,Q,$,D;return(w=(s=g==null?void 0:g.value)==null?void 0:s.tokensObj[(n=e.fromCoin)==null?void 0:n.address])!=null&&w.pyth_id&&((L=(O=g==null?void 0:g.value)==null?void 0:O.tokensObj[(C=e.fromCoin)==null?void 0:C.address])==null?void 0:L.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":(D=($=g==null?void 0:g.value)==null?void 0:$.tokensObj[(Q=e.fromCoin)==null?void 0:Q.address])!=null&&D.coingecko_id?"coingecko":null}),b=N(()=>{var n,s,w,C,O,L,Q,$,D;return(w=(s=g==null?void 0:g.value)==null?void 0:s.tokensObj[(n=e.toCoin)==null?void 0:n.address])!=null&&w.pyth_id&&((L=(O=g==null?void 0:g.value)==null?void 0:O.tokensObj[(C=e.toCoin)==null?void 0:C.address])==null?void 0:L.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":(D=($=g==null?void 0:g.value)==null?void 0:$.tokensObj[(Q=e.toCoin)==null?void 0:Q.address])!=null&&D.coingecko_id?"coingecko":null}),G=f(""),M=async()=>{const n=g.value.tokenExternalPriceObj[e.fromCoin.address],s=g.value.tokenExternalPriceObj[e.toCoin.address];if(n&&s){const w=new i(n).div(new i(s)),C=new i(e.oneToAmount.replace(new RegExp(/,/g),"")).sub(w).div(w).mul(100);let O=Math.abs(ae(C,2));w.toNumber()<Number(e.oneToAmount.replace(new RegExp(/,/g),""))?G.value="":G.value=C>0&&C<=.01?"0.01":O}else G.value=""},P=n=>{if(n<5)return"color-s";if(n>=5&&n<10)return"color-w";if(n>=10)return"color-e"};return oe(()=>[e.oneToAmount,g.value.tokenExternalPriceObj],([n,s])=>{n&&s&&!_e(s)&&M()},{immediate:!0,deep:!0}),{sFixD:ae,getCoinIcon:Y,indicator:p,rateChange:S,slippage:q,isShowRouterModal:m,indexStore:k,maximumSold:U,minimumReceived:a,addCommom:J,pathLength:V,sourcesArr:ee,coinTypeB:A,priceExangeRate:G,getTextColor:P,formCoinMarket:ne,toCoinMarket:b}}}),se=e=>(Fe("data-v-976188e4"),e=e(),je(),e),Pn={key:0,class:"swap-info"},Nn={class:"loading-swap"},Rn={key:1,class:"swap-rate"},On={key:0},Bn={key:0,class:"after-amount"},Mn={key:1},Tn={key:0,class:"after-amount"},Un=se(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Fn=se(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),jn=[Un,Fn],En={key:2,class:"swap-exchange-rate"},Ln={class:"swap-exchange-rate-content"},Dn={key:0},Wn=["href"],qn=se(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),Jn=[qn],Qn={key:1},Xn=["href"],Hn=se(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),Yn=[Hn],Zn={key:0},zn=["href"],Kn=se(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),Gn=[Kn],Vn={key:1},xn=["href"],et=se(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),ot=[et],nt={key:2},tt=["href"],at=se(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),st=[at],it={key:3},lt=["href"],ut=se(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link"})],-1)),rt=[ut],dt={key:3},ct={class:"trade-info"},mt={class:"trade-block"},vt=se(()=>o("div",{class:"lebal"},"Price Impact",-1)),ft={key:0,class:"icon","aria-hidden":"true"},pt=se(()=>o("use",{"xlink:href":"#icon-icon-warning1"},null,-1)),ht=[pt],gt={class:"trade-block"},Ct={class:"lebal"},bt={key:0,class:"text"},wt={class:"trade-block"},kt=se(()=>o("div",{class:"lebal"},"Fee",-1)),yt={key:0,class:"text"},At={key:0,class:"trade-block"},St=se(()=>o("div",{class:"lebal"},"Route",-1)),_t={key:0,class:"text text-box"},$t=["src"],It=["src"],Pt={key:1,class:"text text-box"},Nt=["src"],Rt=["src"],Ot=se(()=>o("img",{src:$n,alt:""},null,-1));function Bt(e,p,S,k,E,q){var H,V,ee,A;const m=Oo,_=Bo,g=Ue("image");return e.swapLoading||Number(e.fromCoinAmount)&&Number(e.toCoinAmount)&&!e.insufficientLiquidity?(r(),h("div",Pn,[o("div",Nn,[e.swapLoading||e.swapRouterLoading?(r(),Z(m,{key:0,size:"small",indicator:e.indicator},null,8,["indicator"])):j("",!0),e.swapLoading?j("",!0):(r(),h("div",Rn,[e.rateChange?(r(),h("span",Mn,[e.fromCoinAmount&&e.toCoinAmount?(r(),h("span",Tn,[x(o("img",null,null,512),[[g,e.getCoinIcon(e.toCoin)]]),K(" 1 "+u(e.toCoin.symbol)+" ≈ ",1),x(o("img",null,null,512),[[g,e.getCoinIcon(e.fromCoin)]]),K(u(e.oneFromAmount==1/0?0:e.oneFromAmount)+" "+u(e.fromCoin.symbol),1)])):(r(),Z(m,{key:1,indicator:e.indicator},null,8,["indicator"]))])):(r(),h("span",On,[x(o("img",null,null,512),[[g,e.getCoinIcon(e.fromCoin)]]),K(" 1 "+u(e.fromCoin.symbol)+" ≈ ",1),e.fromCoinAmount&&e.toCoinAmount?(r(),h("span",Bn,[x(o("img",null,null,512),[[g,e.getCoinIcon(e.toCoin)]]),K(u(e.oneToAmount==1/0?0:e.oneToAmount)+" "+u(e.toCoin.symbol),1)])):(r(),Z(m,{key:1,indicator:e.indicator},null,8,["indicator"]))])),o("div",{class:"right",onClick:p[0]||(p[0]=U=>e.rateChange=!e.rateChange)},jn)])),!e.swapLoading&&e.priceExangeRate!==""&&e.priceExangeRate>10?(r(),h("div",En,[o("div",Ln,[o("p",null,[o("span",{class:de(e.getTextColor(e.priceExangeRate))},"Within ~"+u(e.priceExangeRate)+"% of",3)]),e.formCoinMarket=="pyth"&&e.toCoinMarket=="pyth"?(r(),h("span",Dn,[K("Pyth Network "),o("a",{href:`https://xc-mainnet.pyth.network/api/latest_price_feeds?ids[]=${e.fromCoin.pyth_id}&ids[]=${e.toCoin.pyth_id}`,target:"_blank"},Jn,8,Wn)])):e.formCoinMarket=="coingecko"&&e.toCoinMarket=="coingecko"?(r(),h("span",Qn,[K("CoinGecko "),o("a",{href:`https://api.coingecko.com/api/v3/simple/price?ids=${e.fromCoin.coingecko_id},${e.toCoin.coingecko_id}&vs_currencies=usd`,target:"_blank"},Yn,8,Xn)])):e.formCoinMarket!==e.toCoinMarket?(r(),h(ze,{key:2},[e.formCoinMarket=="pyth"?(r(),h("span",Zn,[K("Pyth Network "),o("a",{href:`https://xc-mainnet.pyth.network/api/latest_price_feeds?ids[]=${e.fromCoin.pyth_id}`,target:"_blank"},Gn,8,zn)])):e.formCoinMarket=="coingecko"?(r(),h("span",Vn,[K("CoinGecko "),o("a",{href:`https://api.coingecko.com/api/v3/simple/price?ids=${e.fromCoin.coingecko_id}&vs_currencies=usd`,target:"_blank"},ot,8,xn)])):j("",!0),e.toCoinMarket=="coingecko"?(r(),h("span",nt,[K("CoinGecko "),o("a",{href:`https://api.coingecko.com/api/v3/simple/price?ids=${e.toCoin.coingecko_id}&vs_currencies=usd`,target:"_blank"},st,8,tt)])):e.toCoinMarket=="pyth"?(r(),h("span",it,[K("Pyth Network "),o("a",{href:`https://xc-mainnet.pyth.network/api/latest_price_feeds?ids[]=${e.toCoin.pyth_id}`,target:"_blank"},rt,8,lt)])):j("",!0)],64)):j("",!0)])])):e.swapLoading?(r(),h("span",dt,"Best route and price")):j("",!0)]),o("div",ct,[o("div",mt,[vt,e.swapRouterLoading?(r(),Z(_,{key:1,paragraph:!1,active:""})):(r(),h("div",{key:0,class:de(["text",e.impact<1?"impact-s":e.impact<10&&e.impact>=1?"impact-w":"impact-e"])},[K(u(e.impact<.01?"<0.01":e.impact>100?"100":e.impact)+"% ",1),e.impact>=10?(r(),h("svg",ft,ht)):j("",!0)],2))]),o("div",gt,[o("div",Ct,u(e.fixedFromCoin?e.$t("common.minimumReceived"):e.$t("common.maximumSold")),1),e.swapRouterLoading?(r(),Z(_,{key:1,paragraph:!1,active:""})):(r(),h("div",bt,u(e.fixedFromCoin?("addCommom"in e?e.addCommom:X(J))(("sFixD"in e?e.sFixD:X(ae))(e.minimumReceived,e.toCoin.decimals)):("addCommom"in e?e.addCommom:X(J))(("sFixD"in e?e.sFixD:X(ae))(e.maximumSold,e.fromCoin.decimals)))+" "+u(e.fixedFromCoin?e.toCoin.symbol:e.fromCoin.symbol),1))]),o("div",wt,[kt,e.swapRouterLoading?(r(),Z(_,{key:1,paragraph:!1,active:""})):(r(),h("div",yt,u(e.suiSwapFee)+" "+u(e.fromCoin.symbol),1))]),e.insufficientLiquidity?j("",!0):(r(),h("div",At,[St,e.swapRouterLoading?(r(),Z(_,{key:1,paragraph:!1,active:""})):(r(),h("div",{key:0,class:"text",onClick:p[1]||(p[1]=U=>e.indexStore.setIsShowRouterModal(!e.isShowRouterModal))},[!e.swapRouterLoading&&e.suiPreSwapdata&&e.suiPreSwapdata.splitPaths&&e.suiPreSwapdata.splitPaths.length==1?(r(),h("div",_t,[o("span",null,u(e.fromCoin.symbol)+" "+u(e.coinTypeB&&((H=e.coinTypeB)!=null&&H.symbol)?`> ${(V=e.coinTypeB)==null?void 0:V.symbol}`:"")+" > "+u(e.toCoin.symbol),1),o("img",{src:e.sourcesArr[0]=="Deepbook"?"/sui-image/logo_deepbook@2x.png":"/sui-image/logo_cetus@2x.png",alt:""},null,8,$t),e.sourcesArr[1]?(r(),h("img",{key:0,src:e.sourcesArr[1]=="Deepbook"?"/sui-image/logo_deepbook@2x.png":"/sui-image/logo_cetus@2x.png",alt:""},null,8,It)):j("",!0)])):e.swapRouterLoading?j("",!0):(r(),h("div",Pt,[K(u((A=(ee=e.suiPreSwapdata)==null?void 0:ee.splitPaths)==null?void 0:A.length)+" Streams ",1),e.sourcesArr[0]?(r(),h("img",{key:0,src:e.sourcesArr[0]=="Deepbook"?"/sui-image/logo_deepbook@2x.png":"/sui-image/logo_cetus@2x.png",alt:""},null,8,Nt)):j("",!0),e.sourcesArr[1]?(r(),h("img",{key:1,src:e.sourcesArr[1]=="Deepbook"?"/sui-image/logo_deepbook@2x.png":"/sui-image/logo_cetus@2x.png",alt:""},null,8,Rt)):j("",!0)])),Ot]))]))])])):j("",!0)}const Mt=Te(In,[["render",Bt],["__scopeId","data-v-976188e4"]]),Tt={props:{coin:{type:Object,default:()=>({})},refresh:{type:Boolean,default:!1},id:{type:String,default:""},market:{type:String,default:""}},setup(e,p){const{$echarts:S}=vn();let k=null,E;const q=f(!0),m=Ee(),_=N(()=>m),g=N(()=>_.value.chainName),H=N(()=>pe[g.value]),V=Me(),ee=N(()=>V),A=(n,s,w)=>{E={xAxis:{type:"category",boundaryGap:!1,show:!1,data:s},yAxis:{type:"value",show:!1,min:function(C){return C.min-C.min*.1},max:function(C){return C.max+C.max*.1}},grid:{top:1,right:1,bottom:1,left:1},tooltip:{trigger:"axis",borderWidth:0,padding:0,backgroundColor:"transparent",axisPointer:{lineStyle:{color:_.value.chainName=="Aptos"?"#68FFD8":"#76C8FF"}},formatter:function(C){return`<div class="chart-tip">
              <div>${C&&C[0]&&C[0].name}</div>
              <div>$${ue(C&&C[0]&&C[0].value,4)}</div>
            </chart-tip>`}},color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:_.value.chainName=="Aptos"?"#0C4535":"#2E546D"},{offset:1,color:_.value.chainName=="Aptos"?"#151817":"#1B1B1B"}]},series:[{data:n,type:"line",showSymbol:!1,areaStyle:{},lineStyle:{color:_.value.chainName=="Aptos"?"#68FFD8":"#76C8FF",width:2,type:"solid"}}]},E&&k.clear(),E&&k.setOption(E,!0),k.resize(),q.value=!1},U=f(""),a=f(""),Y=async n=>{var Q,$;const s=[],w=[],{price:C,daily_rate:O}=g.value==="Aptos"?await _n(n):await Sn(n,e.market);g.value=="Sui"&&V.setTokenExternalPrice(e.coin.address,C[C.length-1].price),U.value=O,a.value=C&&C.length>1&&C[C.length-1].price,g.value==="Aptos"?C.forEach(D=>{s.push(D.price);const d=Xe(Number(D.timestamp),"MD"),c=Xe(Number(D.timestamp),"HM");w.push(d+" "+c)}):C.forEach(D=>{s.push(D.price);const d=Xe(new i(D.timestamp).mul(1e3).toNumber(),"MD"),c=Xe(new i(D.timestamp).mul(1e3).toNumber(),"HM");w.push(d+" "+c)});let L=document.getElementById(`main${(Q=e.coin)==null?void 0:Q.name}`);k=S.init(L),A(s,w,($=e.coin)==null?void 0:$.name)};oe(()=>e.id,(n,s)=>{n&&(U.value="",a.value="",setTimeout(()=>{Y(n)},1e3))},{immediate:!0});const ne=f(""),b=f(""),G=f(""),M=f("");return oe(()=>[ee.value.tokensObj,e.coin],([n,s])=>{var w,C;n&&s&&n[s.address]&&(b.value=((w=n[s.address])==null?void 0:w.labels)&&((C=n[s.address])==null?void 0:C.labels[0]),ne.value=n[s.address].name,G.value=n[s.address].symbol,M.value=n[s.address].address)},{immediate:!0,deep:!0}),oe(()=>e.refresh,n=>{n&&Y(e.id)}),{theme:N(()=>_.value.theme),store:m,importIcon:ve,fixD:Ze,config:H,price_rate_24h:U,nowPrice:a,coinName:ne,coinLabels:b,coinSymbol:G,address:M,decimalUi:ue}}},Ut="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAk1BMVEUAAADn2v/m2//r2//v4//n2v/55P/n2v/o3P//+P/m2v/n2f/n2v/n2v/n2v/n2v/n2v/o2//p2//n3f/o3v/n2f/n2v/n2v/n2v/n2v/n2//o2v/q3f/r4f/u3f/n2v/o2v/n2//p3P/o3P/m2v/n2v/n2f/n2v/o2f/n2//r3f/t3P/n2v/m2v/o2v/r3v/m2f/tUDLHAAAAMHRSTlMAl5oyFNMJqSwFhvvr5d7Yr2FGNSD0zb2lkIltOhkOxoJoT0D48aJzWFYlHeB8Wief0nHAAAABSElEQVQ4y52Q53LCMBCEZWK5g0swBpveQknZ93+6rFxAHkSYyf6x9+67JqHLKxOZRzJJbWHStkCn0Fo8pG0XuvJv0dciBjVZb+dZeoxABb38MlbpXeucr5z2QwdUf8vX1h0ByLT9aAeCGlez4Ozw5zoE4nvFBJB0yymUhqp0B2DT5ec0O+YlWlUMJsCqAwJA8jNV1W4RAnuvqepeYwWsOR/AkfM9ji8YjYBTC3wCZyEq1jvKnoCQP8X90j0wF2IGuM2jArjUE8sWAPAmxACwavtDf623XJsBtoqa2zcm4MI8Ag7iNZkBeAcVc8cUOPhPgJjP4I/UzkYgKtWxpQqaAGfMvvUATIUBaOQHAEb2M2CZcj4OnrhJasDYXYVQ9Vpe2LJ/BeWyf4/oAXlC25e9uI0IqswRJulX/BOwXgG2JPCCIPA3sXmM/QK1PTc8LGCPoAAAAABJRU5ErkJggg==",Ft="data:image/png;base64,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";const jt=e=>(Fe("data-v-cab5b536"),e=e(),je(),e),Et={class:"token-info"},Lt={class:"token-info-padding"},Dt={class:"token-info-header"},Wt={class:"left"},qt=["onerror"],Jt={class:"name"},Qt={class:"desc"},Xt={key:0},Ht={class:"right"},Yt={class:"price-info"},Zt={key:0,src:Ut,alt:""},zt={key:1,src:Ft,alt:""},Kt={class:"token-info-footer"},Gt={class:"left"},Vt={class:"address"},xt={key:0,class:"pc-address"},ea={key:1,class:"pc-address"},oa={class:"h5-address"},na=jt(()=>o("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),ta=[na],aa={class:"right"},sa=["id"];function ia(e,p,S,k,E,q){var g;const m=Mo,_=Ue("image");return r(),h("div",Et,[o("div",Lt,[o("div",Dt,[o("div",Wt,[x(o("img",{onerror:k.theme=="default"?k.importIcon("/image/coins/unknown.png"):k.importIcon("/image/coins/sui-unknown.png")},null,8,qt),[[_,S.coin.logoURI||k.importIcon(`/image/coins/${S.coin.symbol.toLowerCase()}.png`)]]),o("div",null,[o("div",Jt,u(k.coinSymbol),1),o("div",Qt,[o("span",null,[K(u(k.coinName)+" ",1),k.theme!=="sui"?(r(),h("span",Xt,u(k.coinLabels?`(${k.coinLabels})`:""),1)):j("",!0)])])])]),o("div",Ht,[he(m,{placement:"top","arrow-point-at-center":""},{title:ce(()=>[K(u(S.market==="pyth"?"Data source: Pyth Network":"Data source: CoinGecko"),1)]),default:ce(()=>[o("div",Yt,[S.market==="pyth"?(r(),h("img",Zt)):(r(),h("img",zt)),o("span",null,"$"+u(k.nowPrice?Number(k.nowPrice)<1?k.decimalUi(k.nowPrice,4):k.fixD(k.nowPrice,2):"--"),1),k.price_rate_24h?(r(),h("i",{key:2,class:de(k.price_rate_24h>0?"up":k.price_rate_24h<0?"down":"up")},u(k.price_rate_24h>0?`+ ${k.fixD(k.price_rate_24h,2)}`:k.price_rate_24h<0?+`${k.fixD(k.price_rate_24h,2)}`:`+${k.fixD(k.price_rate_24h,2)}`)+"%",3)):j("",!0)])]),_:1})])]),o("div",Kt,[o("div",Gt,[o("div",Vt,[S.coin&&k.address!=="0x2::sui::SUI"?(r(),h("span",xt,u(S.coin&&S.coin.address.substr(0,13))+" ... "+u(S.coin&&S.coin.address.substr(S.coin.address.length-13,13)),1)):(r(),h("span",ea,u(S.coin&&S.coin.address),1)),o("span",oa,u(S.coin&&S.coin.address.substr(0,4))+" ... "+u(S.coin&&S.coin.address.substr(S.coin.address.length-4,4)),1),(r(),h("svg",{class:"icon","aria-hidden":"true",onClick:p[0]||(p[0]=H=>k.store.copy(S.coin&&S.coin.address))},ta))])]),o("div",aa,[o("div",{id:`main${(g=S.coin)==null?void 0:g.name}`,class:"main"},null,8,sa)])])])])}const la=Te(Tt,[["render",ia],["__scopeId","data-v-cab5b536"]]);const ua=Ke({components:{Modal:To},props:{fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},fromCoinAmount:{type:String,default:""},toCoinAmount:{type:String,default:""},suiPreSwapdata:{type:Object,default:()=>({})}},setup(e){const p=Me(),S=ao("Sui"),k=N(()=>p);N(()=>{var A,U;return(U=(A=k.value)==null?void 0:A.poolInfo)==null?void 0:U.needReverse});const E=f([]),q=f({});oe(()=>[e.suiPreSwapdata,e.fromCoin,e.toCoin],async([A,U,a])=>{if(A&&!_e(A)){let Y=[];A.splitPaths.sort((P,n)=>n.outputAmount-P.outputAmount);for(let P=0;P<A.splitPaths.length;P++){const n=A.splitPaths[P],s={...n,amountIn:new i(n.inputAmount).div(new i(Math.pow(10,U.decimals))).toString(),amountOut:new i(n.outputAmount).div(new i(Math.pow(10,a.decimals))).toString()};let w=[];for(let C=0;C<n.basePaths.length;C++){const O=n.basePaths[C],L=O.fromCoin=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":O.fromCoin,Q=O.toCoin=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":O.toCoin,$=k.value.tokensObj[L]||(await S.getTokenListByCoinType([L]))[0],D=k.value.tokensObj[Q]||(await S.getTokenListByCoinType([Q]))[0];(O==null?void 0:O.label)=="Deepbook"?w.push({...O,...k.value.routerPoolConfigObj[O.poolAddress],feeRate:new i(O.feeRate).div(new i(Math.pow(10,9))),coin_a:$,coin_b:D}):w.push({...O,...k.value.routerPoolConfigObj[O.poolAddress],feeRate:new i(O.feeRate).div(new i(Math.pow(10,6)))})}Y.push({...s,basePaths:w})}E.value=Y;const ne=[];let b=new i(0);Y.forEach(P=>{const n=new i(P.percent).gt(0)?new i(P.percent).div(100).mul(100).toString():0,s=ae(n,2);b=b.plus(s);const w=s.split(".");ne.push({value:s,int:w[0],decimal:w[1],pathIndex:P.pathIndex})});let G=new i(100).minus(b).toNumber();const M=ne.sort((P,n)=>Number(n.decimal)-Number(P.decimal));if(G)for(let P=0;P<M.length&&G;P++)M[P].value=new i(M[P].value).plus(.01).toString(),G=new i(G).minus(.01).toNumber();q.value=Object.fromEntries(M.map((P,n)=>[P.pathIndex,P]))}},{immediate:!0});const m=Ee(),_=N(()=>m),g=A=>{var U;return(A==null?void 0:A.logoURI)||(A==null?void 0:A.logo_url)||((U=k.value.tokensObj[(A==null?void 0:A.address)=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":A==null?void 0:A.address])==null?void 0:U.logo_url)||(_.value.theme==="default"?ve("/image/coins/unknown.png"):ve("/image/coins/sui-unknown.png"))},H=async A=>{const U=(await S.getTokenListByCoinType([A]))[0];return U&&!_e(U)?U==null?void 0:U.logo_url:""},V=N(()=>k.value.tokensObj),ee=N(()=>_.value.currentExplorer);return{addCommom:J,routerStep:E,getCoinIcon:g,getDeepBookLogo:H,percentObj:q,tokensObj:V,store:_,getExplorerUrl:Po,currentExplorer:ee}}}),ge=e=>(Fe("data-v-dc1c7246"),e=e(),je(),e),ra=ge(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),da={class:"route-top"},ca={class:"token-a"},ma={alt:""},va={class:"token-num"},fa={class:"token-symbol"},pa={class:"token-b"},ha={class:"token-num"},ga={class:"token-symbol"},Ca={alt:""},ba={class:"route-bottom"},wa=ge(()=>o("div",{class:"left-round"},null,-1)),ka=ge(()=>o("div",{class:"right-round"},null,-1)),ya={class:"percent-text"},Aa={class:"amount"},Sa={class:"symbol"},_a={class:"percent-ratio"},$a={class:"percent-text"},Ia={class:"amount"},Pa={class:"symbol"},Na={class:"pool-info-box"},Ra={key:0,class:"icon","aria-hidden":"true"},Oa=ge(()=>o("use",{"xlink:href":"#icon-icon_on1"},null,-1)),Ba=[Oa],Ma={class:"pool-info"},Ta={class:"pool-info-top"},Ua={class:"token-a-img",alt:""},Fa={class:"token-b-img",alt:""},ja={class:"source"},Ea=["src"],La={class:"pool-info-detail"},Da={class:"pool-address"},Wa=ge(()=>o("span",null,"Pool Address",-1)),qa=["href"],Ja=["onClick"],Qa=ge(()=>o("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),Xa=[Qa],Ha={key:0,class:"token-info-detail"},Ya={alt:""},Za={class:"token-name"},za={class:"token-address"},Ka=["onClick"],Ga=ge(()=>o("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),Va=[Ga],xa={class:"token-symbol"},es={class:"token-info-detail"},os={alt:""},ns={class:"token-name"},ts={class:"token-address"},as=["onClick"],ss=ge(()=>o("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),is=[ss],ls={class:"token-symbol"};function us(e,p,S,k,E,q){const m=Uo("Modal"),_=Ue("image");return r(),Z(m,{title:"Route",width:"600px",visible:!0,footer:null,onCancel:p[0]||(p[0]=g=>e.$emit("onClose"))},{closeIcon:ce(()=>[ra]),default:ce(()=>{var g,H,V,ee;return[o("div",da,[o("div",ca,[x(o("img",ma,null,512),[[_,(g=e.fromCoin)==null?void 0:g.logo_url]]),o("span",va,u(("addCommom"in e?e.addCommom:X(J))(e.fromCoinAmount)),1),o("span",fa,u((H=e.fromCoin)==null?void 0:H.symbol),1)]),o("div",pa,[o("span",ha,u(("addCommom"in e?e.addCommom:X(J))(e.toCoinAmount)),1),o("span",ga,u((V=e.toCoin)==null?void 0:V.symbol),1),x(o("img",Ca,null,512),[[_,(ee=e.toCoin)==null?void 0:ee.logo_url]])])]),o("div",ba,[wa,ka,(r(!0),h(ze,null,$o(e.routerStep,(A,U)=>(r(),h("div",{key:U,class:de(["route-path",U!==0?"route-path-active":""])},[o("div",{class:de(["percent",U!==0?"percent-active":""])},[o("div",ya,[o("div",Aa,u(("addCommom"in e?e.addCommom:X(J))(A.amountIn)),1),o("div",Sa,u(e.fromCoin.symbol),1),o("span",_a,"("+u(e.percentObj&&e.percentObj[A.pathIndex].value)+"%)",1)]),o("div",$a,[o("div",Ia,u(("addCommom"in e?e.addCommom:X(J))(A.amountOut)),1),o("div",Pa,u(e.toCoin.symbol),1)])],2),o("div",Na,[A.basePaths&&A.basePaths.length>1?(r(),h("svg",Ra,Ba)):j("",!0),(r(!0),h(ze,null,$o(A.basePaths,(a,Y)=>{var ne,b,G,M,P,n,s,w,C,O,L,Q,$,D,d,c,$e,Re,Le,De;return r(),h("div",{key:Y},[o("div",Ma,[o("div",Ta,[x(o("img",Ua,null,512),[[_,a.label=="Cetus"?e.getCoinIcon({address:a.fromCoin}):(ne=a==null?void 0:a.coin_a)==null?void 0:ne.logo_url]]),x(o("img",Fa,null,512),[[_,a.label=="Cetus"?e.getCoinIcon({address:a.toCoin}):(b=a==null?void 0:a.coin_b)==null?void 0:b.logo_url]]),o("span",null,u((a==null?void 0:a.feeRate)*100)+"%",1)]),o("div",ja,[o("img",{src:a.label=="Cetus"?"/sui-image/logo_cetus@2x.png":"/sui-image/logo_deepbook@2x.png",alt:""},null,8,Ea),o("span",null,u(a.label=="Cetus"?"Cetus":"DeepBook"),1)]),o("div",{class:de(["pool-info-detail-box",A.basePaths.length==1?"pool-info-detail-box-center":Y==0?"pool-info-detail-box-left":"pool-info-detail-box-right"])},[o("div",La,[o("div",Da,[Wa,o("p",null,[o("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:X(Po))(e.currentExplorer,"poolAddress",a==null?void 0:a.poolAddress),target:"_blank"},u(a&&((G=a==null?void 0:a.poolAddress)==null?void 0:G.substr(0,6)))+" ... "+u(a&&((M=a==null?void 0:a.poolAddress)==null?void 0:M.substr(a.poolAddress.length-6,6))),9,qa),(r(),h("svg",{class:"copy-icon","aria-hidden":"true",onClick:Ie=>e.store.copy(a==null?void 0:a.poolAddress)},Xa,8,Ja))])]),a.coin_a&&a.coin_a?(r(),h("div",Ha,[x(o("img",Ya,null,512),[[_,(P=a==null?void 0:a.coin_a)==null?void 0:P.logo_url]]),o("div",null,[o("div",null,[o("span",Za,u((n=a==null?void 0:a.coin_a)==null?void 0:n.symbol),1),o("p",za,[o("span",null,u((w=(s=a==null?void 0:a.coin_a)==null?void 0:s.address)==null?void 0:w.substr(0,4))+" ... "+u(a&&((L=(C=a==null?void 0:a.coin_a)==null?void 0:C.address)==null?void 0:L.substr(((O=a==null?void 0:a.coin_a)==null?void 0:O.address.length)-4,4))),1),(r(),h("svg",{class:"copy-icon","aria-hidden":"true",onClick:Ie=>{var fe;return e.store.copy((fe=a==null?void 0:a.coin_a)==null?void 0:fe.address)}},Va,8,Ka))])]),o("div",xa,u((Q=a==null?void 0:a.coin_a)==null?void 0:Q.name),1)])])):j("",!0),o("div",es,[x(o("img",os,null,512),[[_,($=a==null?void 0:a.coin_b)==null?void 0:$.logo_url]]),o("div",null,[o("div",null,[o("span",ns,u((D=a==null?void 0:a.coin_b)==null?void 0:D.symbol),1),o("p",ts,[o("span",null,u((c=(d=a==null?void 0:a.coin_b)==null?void 0:d.address)==null?void 0:c.substr(0,4))+" ... "+u(a&&((Le=($e=a==null?void 0:a.coin_b)==null?void 0:$e.address)==null?void 0:Le.substr(((Re=a==null?void 0:a.coin_b)==null?void 0:Re.address.length)-4,4))),1),(r(),h("svg",{class:"copy-icon","aria-hidden":"true",onClick:Ie=>{var fe;return e.store.copy((fe=a==null?void 0:a.coin_b)==null?void 0:fe.address)}},is,8,as))])]),o("div",ls,u((De=a==null?void 0:a.coin_b)==null?void 0:De.name),1)])])])],2)])])}),128))])],2))),128))])]}),_:1})}const rs=Te(ua,[["render",us],["__scopeId","data-v-dc1c7246"]]),ds=Ke({components:{Modal:To},props:{fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},fromCoinAmount:{type:String,required:!0},toCoinAmount:{type:String,required:!0},slippage:{type:String,default:""},impact:{type:Number,required:!1},fixedFromCoin:{type:Boolean,default:!1},fee:{type:String,required:!1},formatFee:{type:String,default:""},isShowAccept:{type:Boolean,default:!1},swapLoading:{type:Boolean,required:!1},oneFromAmount:{type:String,default:""},oneToAmount:{type:String,default:""},suiPreSwapdata:{type:Object,default:()=>({})}},setup(e,p){const S=Me(),k=N(()=>S),E=Ee(),q=N(()=>E),m=a=>{var Y;return(a==null?void 0:a.logoURI)||(a==null?void 0:a.logo_url)||((Y=k.value.tokensObj[a==null?void 0:a.address])==null?void 0:Y.logo_url)||(q.value.theme==="default"?ve("/image/coins/unknown.png"):ve("/image/coins/sui-unknown.png"))},_=f(!1),g=N(()=>q.value.chainName),H=async()=>{p.emit("to-swap")};f([]);const V=f(0),ee=f(""),A=f(""),U=N(()=>q.value.slippage);return oe(()=>[e.fromCoinAmount,e.toCoinAmount,e.fromCoin,e.toCoin,e.fixedFromCoin,U.value],([a,Y,ne,b,G,M])=>{if(a&&Y&&ne&&b&&M)if(G){const P=new i(Y).mul(new i(M/100));A.value=new i(Y).sub(P).toString()}else{const P=new i(a).mul(new i(M/100));ee.value=new i(a).add(P).toString()}},{immediate:!0}),{getCoinIcon:m,addCommom:J,sFixD:ae,rateChange:_,chainName:g,clickNextBtn:H,pathLength:V,maximumSold:ee,minimumReceived:A,decimalUi:ue}}});const Ce=e=>(Fe("data-v-ce681136"),e=e(),je(),e),cs=Ce(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),ms={class:"new-swap-contnet"},vs={class:"coin-info"},fs={class:"from-coin-info"},ps={class:"left"},hs={class:"coin-amount"},gs={class:"coin-symbol"},Cs={class:"right"},bs={class:"to-coin-info"},ws={class:"left"},ks={class:"coin-amount"},ys={class:"coin-symbol"},As={class:"right"},Ss=Ce(()=>o("div",{class:"to-swap-logo"},null,-1)),_s={class:"coin-rate"},$s={key:0},Is={class:"left"},Ps=Ce(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Ns=Ce(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Rs=[Ps,Ns],Os={key:1},Bs={class:"left"},Ms=Ce(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Ts=Ce(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Us=[Ms,Ts],Fs={class:"bottom"},js={class:"induction"},Es={class:"item"},Ls={class:"induction-text"},Ds={class:"induction-value"},Ws={class:"item"},qs={class:"induction-text"},Js={class:"induction-value"},Qs={class:"item"},Xs={class:"induction-text"},Hs={key:0,class:"icon","aria-hidden":"true"},Ys=Ce(()=>o("use",{"xlink:href":"#icon-icon-warning1"},null,-1)),Zs=[Ys],zs={class:"item"},Ks={class:"induction-text"},Gs={key:0,class:"induction-value"},Vs={key:1,class:"induction-value"},xs={key:0,class:"price-updated"},ei=Ce(()=>o("span",null,"Price updated",-1));function oi(e,p,S,k,E,q){const m=Fo,_=Uo("Modal"),g=Ue("image");return r(),Z(_,{width:"440px",visible:!0,footer:null,title:e.$t("button.swap"),class:"add-liquidity-modal",onCancel:p[4]||(p[4]=H=>e.$emit("on-close"))},{closeIcon:ce(()=>[cs]),default:ce(()=>[o("div",ms,[o("div",vs,[o("div",fs,[o("div",ps,[o("div",hs,u(e.fromCoinAmount&&("addCommom"in e?e.addCommom:X(J))(e.fromCoinAmount)),1),o("div",gs,u(e.fromCoin&&e.fromCoin.symbol),1)]),o("div",Cs,[x(o("img",null,null,512),[[g,e.fromCoin&&e.fromCoin.logoURI||e.getCoinIcon(e.fromCoin)]])])]),o("div",bs,[o("div",ws,[o("div",ks,u(e.toCoinAmount&&("addCommom"in e?e.addCommom:X(J))(e.toCoinAmount)),1),o("div",ys,u(e.toCoin&&e.toCoin.symbol),1)]),o("div",As,[x(o("img",null,null,512),[[g,e.toCoin&&e.toCoin.logoURI||e.getCoinIcon(e.toCoin)]])]),Ss]),o("div",_s,[e.rateChange?(r(),h("div",Os,[o("div",Bs,[x(o("img",null,null,512),[[g,e.toCoin&&e.toCoin.logoURI||e.getCoinIcon(e.toCoin)]]),o("span",null,"1 "+u(e.toCoin&&e.toCoin.symbol)+" ≈",1),x(o("img",null,null,512),[[g,e.fromCoin&&e.fromCoin.logoURI||e.getCoinIcon(e.fromCoin)]]),o("span",null,u(("decimalUi"in e?e.decimalUi:X(ue))(e.oneFromAmount,e.fromCoin.decimals))+" "+u(e.fromCoin.symbol),1)]),o("div",{class:"right",onClick:p[1]||(p[1]=H=>e.rateChange=!e.rateChange)},Us)])):(r(),h("div",$s,[o("div",Is,[x(o("img",null,null,512),[[g,e.fromCoin&&e.fromCoin.logoURI||e.getCoinIcon(e.fromCoin)]]),o("span",null,"1 "+u(e.fromCoin&&e.fromCoin.symbol)+" ≈",1),x(o("img",null,null,512),[[g,e.toCoin&&e.toCoin.logoURI||e.getCoinIcon(e.toCoin)]]),o("span",null,u(("decimalUi"in e?e.decimalUi:X(ue))(e.oneToAmount,e.toCoin.decimals))+" "+u(e.toCoin.symbol),1)]),o("div",{class:"right",onClick:p[0]||(p[0]=H=>e.rateChange=!e.rateChange)},Rs)]))])]),o("div",Fs,[o("div",js,[o("div",Es,[o("div",Ls,u(e.$t("modal.slippageTolerance")),1),o("div",Ds,u(e.slippage)+"%",1)]),o("div",Ws,[o("div",qs,u(e.fixedFromCoin?e.$t("common.minimumReceived"):e.$t("common.maximumSold")),1),o("div",Js,u(e.fixedFromCoin?("addCommom"in e?e.addCommom:X(J))(("sFixD"in e?e.sFixD:X(ae))(e.minimumReceived,e.toCoin.decimals)):("addCommom"in e?e.addCommom:X(J))(("sFixD"in e?e.sFixD:X(ae))(e.maximumSold,e.fromCoin.decimals)))+" "+u(e.fixedFromCoin?e.toCoin.symbol:e.fromCoin.symbol),1)]),o("div",Qs,[o("div",Xs,u(e.$t("common.priceImpact")),1),o("div",{class:de(["induction-value",e.impact<1?"impact-s":e.impact<10&&e.impact>=1?"impact-w":"impact-e"])},[K(u(e.impact<.01?"<0.01":e.impact>100?"100":e.impact)+"% ",1),e.impact>=10?(r(),h("svg",Hs,Zs)):j("",!0)],2)]),o("div",zs,[o("div",Ks,u(e.$t("common.fee")),1),e.chainName=="Aptos"?(r(),h("div",Gs,u(e.formatFee)+" "+u(e.fromCoin.symbol)+" ("+u(e.fee*100)+"%) ",1)):(r(),h("div",Vs,u(e.fee)+" "+u(e.fromCoin.symbol),1))])])])]),e.isShowAccept?(r(),h("div",xs,[ei,he(m,{class:"accept-btn",loading:e.swapLoading,onClick:p[2]||(p[2]=H=>e.$emit("accept"))},{default:ce(()=>[K("Accept")]),_:1},8,["loading"])])):(r(),Z(m,{key:1,class:"big-btn swap-confirm-btn",onClick:p[3]||(p[3]=H=>e.clickNextBtn())},{default:ce(()=>[K(u(e.$t("button.confirmSwap")),1)]),_:1}))]),_:1},8,["title"])}const ni=Te(ds,[["render",oi],["__scopeId","data-v-ce681136"]]),ti=Ke({setup(){const e=Io(),p=No(Ro,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0}),{t:S,locale:k}=fn(),E=Ee(),q=Me(),m=N(()=>q);let _=f(!1),g=f(!1),H=f(!1),V=f(!1),ee=f(!1),A=f(!1);const U=f("fromCoin"),a=f(""),Y=f(""),ne=f(!1),b=f(!0),G=f(!1),M=f(!1),P=f(!1),n=f(""),s=f(""),w=f(20),C=f(0),O=f(null),L=f(!1),Q=N(()=>E.slippage),$=N(()=>E.chainName),D=N(()=>$.value?ao($.value):{}),d=f(),c=f(),$e=N(()=>pe&&pe[$.value]&&pe[$.value].hasRouter),Re=N(()=>q.getPoolInfoSuccess),Le=N(()=>{var t;return B.value&&((t=B.value)!=null&&t.is_pause)?"Pool Closed":!d.value||!c.value?S("modal.selectTokenModalTitle"):!Number(n.value)&&!Number(s.value)?S("button.enterAmount"):!$e.value&&!B.value&&Re.value?"Pool Not Found":$e.value&&ye.value?"No Available Route":L.value?S("button.insufficientLiquidity"):Number(n.value)>Number(le.value)?S("button.insufficientBalance",{name:d.value.symbol}):S("button.swap")}),De=t=>{var v,l,y,R;U.value=t,t==="fromCoin"?(a.value=((v=c.value)==null?void 0:v.address)||"",Y.value=((l=d.value)==null?void 0:l.address)||""):(a.value=((y=d.value)==null?void 0:y.address)||"",Y.value=((R=c.value)==null?void 0:R.address)||""),ne.value=!0},Ie=f({}),fe=f({}),jo=t=>{U.value==="fromCoin"?(Ie.value=t,eo(t)):(fe.value=t,eo(t))},Eo=t=>{t==="fromCoin"?(b.value=!0,$.value==="Aptos"?n.value=le.value>0?d.value.symbol=="APT"?new i(Number(le.value)).sub(new i(.1)).lt(new i(0))?"0":new i(Number(le.value)).sub(new i(.1)).toString():String(le.value):"":n.value=le.value>0?d.value.symbol=="SUI"?new i(Number(le.value)).sub(new i(.05)).lt(new i(0))?"0":new i(Number(le.value)).sub(new i(.05)).toString():String(le.value):""):(b.value=!1,$.value==="Aptos"?s.value=re.value>0?c.value.symbol=="APT"?new i(Number(re.value)).sub(new i(.1)).lt(new i(0))?"0":new i(Number(re.value)).sub(new i(.1)).toString():String(re.value):"":s.value=re.value>0?c.value.symbol=="SUI"?new i(Number(re.value)).sub(new i(.05)).lt(new i(0))?"0":new i(Number(re.value)).sub(new i(.05)).toString():String(re.value):"")},Lo=t=>{t==="fromCoin"?(b.value=!0,n.value=le.value>0?ae(new i(Number(le.value)).div(2).toString(),d.value.decimals).toString():""):(b.value=!1,s.value=re.value>0?ae(new i(Number(re.value)).div(2).toString(),c.value.decimals).toString():"")},Ge=f(!1);pn(()=>{so(),window.addEventListener("updateSwapParams",t=>{Ge.value=!Ge.value})}),hn(()=>{clearInterval(O.value)});const Ve=N(()=>E),xe=()=>{g.value||!B.value&&!$e.value||(clearInterval(O.value),q.setPoolConfigList(Ve.value.chainName,Ve.value.filterCoinsObj),C.value=0,g.value=!0,B.value&&q.updateCurrentPools(B.value.poolAddress,$.value),Se(b.value?n.value:s.value),ie.value.address&&D.value.getAccount(ie.value.address),E.getStatsData($.value,Ve.value.filterCoinsObj),setTimeout(()=>{g.value=!1,so()},1e3))},so=()=>{O.value=setInterval(()=>{g.value=!1,G.value||C.value<w.value&&(C.value+=1,C.value===w.value&&($.value=="Aptos"?(B.value&&B.value.poolAddress&&q.updateCurrentPools(B.value.poolAddress,$.value),xe()):A.value||xe(),C.value=0,g.value=!0))},1e3)};oe(b,Ye((t,v)=>{b.value=t},500));const Pe=f(!1);oe(n,Ye((t,v)=>{t&&t!==0&&b.value&&(C.value=0,Se(t)),t==""&&b.value&&(s.value="")},500)),oe(s,Ye((t,v)=>{t&&t!==0&&!b.value&&(C.value=0,Se(t)),t==""&&!b.value&&(n.value="")},500));const We=f(1e-4),qe=async t=>{let v=t;if($.value==="Aptos"&&!v.current_sqrt_price&&n.value&&s.value){const l=await D.value.getPools([v.address]);l&&l[0]&&(v={...t,...l[0],fee:Number(l[0].fee_rate)/1e6})}if(v.current_sqrt_price&&n.value&&s.value){const y=(d.value.address===v.coinA.address&&c.value.address===v.coinB.address?0:1)==0,R=new i(n.value),I=new i(s.value),F=R.sub(R.mul(new i(v.fee))),z=I.div(F);return D.value.getPriceImpactPct(v,z.toString(),y)}return"--"},io=f(0),lo=f(0),uo=f(),Ne=f({}),Do=async t=>{if(B.value&&!(b.value&&Number(n.value)==0)&&!(!b.value&&Number(s.value)==0))if(d.value&&c.value&&(n.value||s.value)){M.value=!0,P.value=!0,L.value=!1;const v=d.value.address===B.value.coinA.address&&c.value.address===B.value.coinB.address?0:1;try{let l=await D.value.preSwap({pool:B.value,a2b:v==0,byAmountIn:b.value,amount:b.value?n.value:s.value});L.value=l==null?void 0:l.isExceed,uo.value=l==null?void 0:l.estimatedFeeAmount,b.value?(s.value=l.estimatedAmountOut,ke.value=(Number(l.estimatedAmountOut)/t).toString(),we.value=(t/Number(l.estimatedAmountOut)).toString()):(n.value=l.estimatedAmountIn,ke.value=(t/Number(l.estimatedAmountIn)).toString(),we.value=(Number(l.estimatedAmountIn)/t).toString()),io.value=new i(s.value).div(n.value).toString(),lo.value=new i(n.value).div(s.value).toString(),We.value=$.value=="Aptos"?await qe(B.value):await qe(Ne.value||B.value),M.value=!1,P.value=!1}catch{M.value=!1,P.value=!1}}else b.value?s.value="":n.value="",M.value=!1,P.value=!1},Wo=gn(),ie=N(()=>Wo),qo=f({}),we=f(""),ke=f(""),le=N(()=>ie.value.assets&&d.value&&ie.value.assets[d.value.address]?_o(ie.value.assets[d.value.address].balance,d.value.decimals):0),re=N(()=>ie.value.assets&&c.value&&ie.value.assets[c.value.address]?_o(ie.value.assets[c.value.address].balance,c.value.decimals):0);Io(),oe(()=>m.value.tokensObj,async t=>{if(!_e(t)){const v=e?e.currentRoute.value.query.to:"",l=e?e.currentRoute.value.query.from:"";l?d.value=await D.value.getTokenBySymbol(t,l):!l&&!d.value&&(d.value=await D.value.getTokenBySymbol(t,pe[$.value].swapDefaultPair.fromCoin)),v?c.value=await D.value.getTokenBySymbol(t,v):!v&&!c.value&&(c.value=await D.value.getTokenBySymbol(t,pe[$.value].swapDefaultPair.toCoin)),!l&&v&&(d.value="")}},{immediate:!0});const B=N(()=>{var t,v,l,y,R;if(d.value&&c.value){let I=null,F={};if(Object.values(m.value.poolConfigList).forEach(T=>{var W,te,me,Be;(T.coinA.address.toUpperCase()===((W=d.value.address)==null?void 0:W.toUpperCase())&&T.coinB.address.toUpperCase()===((te=c.value.address)==null?void 0:te.toUpperCase())||T.coinB.address.toUpperCase()===((me=d.value.address)==null?void 0:me.toUpperCase())&&T.coinA.address.toUpperCase()===((Be=c.value.address)==null?void 0:Be.toUpperCase()))&&(F[T.address]={...T})}),$.value=="Aptos"&&m.value.poolsObj&&!_e(m.value.poolsObj))for(const T in m.value.poolsObj){const W=m.value.poolsObj[T];(W.token_a.address.toUpperCase()===((t=d.value.address)==null?void 0:t.toUpperCase())&&W.token_b.address.toUpperCase()===((v=c.value.address)==null?void 0:v.toUpperCase())||W.token_b.address.toUpperCase()===((l=d.value.address)==null?void 0:l.toUpperCase())&&W.token_a.address.toUpperCase()===((y=c.value.address)==null?void 0:y.toUpperCase()))&&(F[W.address]={...W})}const z=Object.values(F).sort((T,W)=>T.fee-W.fee);for(let T=0;T<z.length;T++)if(!((R=z[T])!=null&&R.is_pause)){I=z[T];break}return I=Object.values(F).sort((T,W)=>T.fee-W.fee)[0],I&&!_e(I)?I:null}return null}),ro=f(!0),co=f(!1),Jo=async t=>{t&&$.value=="Aptos"&&(Se(b.value?n.value:s.value),co.value=!0,t.coinA.symbol.toLowerCase()===d.value.symbol.toLowerCase()&&t.coinB.symbol.toLowerCase()===c.value.symbol.toLowerCase()?ro.value=!0:ro.value=!1,L.value=!1)};oe(()=>B.value,(t,v)=>{t&&(!v||t.address!==v.address||t.current_sqrt_price!==v.current_sqrt_price)&&Jo(t)},{immediate:!0,deep:!0});const Qo=N(()=>m.value.tokensObj&&d.value&&d.value.address&&m.value.tokensObj[d.value.address]&&m.value.tokensObj[d.value.address].logoURI),Xo=N(()=>m.value.tokensObj&&c.value&&c.value.address&&m.value.tokensObj[c.value.address]&&m.value.tokensObj[c.value.address].logoURI),Ho=N(()=>$.value==="Aptos"?m.value.tokensObj&&d.value&&d.value.address&&m.value.tokensObj[d.value.address]&&m.value.tokensObj[d.value.address].coingecko_id||null:m.value.tokensObj&&d.value&&d.value.address||null),Yo=N(()=>$.value==="Aptos"?m.value.tokensObj&&c.value&&c.value.address&&m.value.tokensObj[c.value.address]&&m.value.tokensObj[c.value.address].coingecko_id||null:m.value.tokensObj&&c.value&&c.value.address||null),Zo=N(()=>{var t,v,l,y,R,I,F,z,T;return(l=(v=m==null?void 0:m.value)==null?void 0:v.tokensObj[(t=d==null?void 0:d.value)==null?void 0:t.address])!=null&&l.pyth_id&&((I=(R=m==null?void 0:m.value)==null?void 0:R.tokensObj[(y=d==null?void 0:d.value)==null?void 0:y.address])==null?void 0:I.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":(T=(z=m==null?void 0:m.value)==null?void 0:z.tokensObj[(F=d==null?void 0:d.value)==null?void 0:F.address])!=null&&T.coingecko_id?"coingecko":null}),zo=N(()=>{var t,v,l,y,R,I,F,z,T;return(l=(v=m==null?void 0:m.value)==null?void 0:v.tokensObj[(t=c==null?void 0:c.value)==null?void 0:t.address])!=null&&l.pyth_id&&((I=(R=m==null?void 0:m.value)==null?void 0:R.tokensObj[(y=c==null?void 0:c.value)==null?void 0:y.address])==null?void 0:I.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":(T=(z=m==null?void 0:m.value)==null?void 0:z.tokensObj[(F=c==null?void 0:c.value)==null?void 0:F.address])!=null&&T.coingecko_id?"coingecko":null}),Ko=N(()=>{var y,R;const t=new i(n.value),v=new i($.value=="Aptos"?(y=B==null?void 0:B.value)==null?void 0:y.fee:(R=Ne==null?void 0:Ne.value)==null?void 0:R.fee),l=t.mul(v).toString();return Number(l)<1/Math.pow(10,d.value.decimals)?`<${new i(1).div(new i(Math.pow(10,d.value.decimals))).toString()}`:ae(l,d.value.decimals)}),{setIsShowSuccess:Go,setIsShowRejected:mo,setIsShowWaiting:Je,setTransactionDesc:Vo,setTransactionTxid:vo}=E,xo=async()=>{var v,l,y,R,I,F,z,T;A.value=!1,M.value=!0,clearInterval(Oe),window.clearInterval(Oe),vo(""),Vo(S("tips.swapping",{from:`${J(n.value)} ${(v=d.value)==null?void 0:v.symbol}`,to:`${J(s.value)} ${(l=c.value)==null?void 0:l.symbol}`})),Je(!0);let t;$.value=="Aptos"&&(t=d.value.address===B.value.token_a.address&&c.value.address===B.value.token_b.address?0:1);try{let W;$.value=="Aptos"?W=await D.value.getSwapTransactionPayload({pool:B.value,a2b:t==0,byAmountIn:b.value,amount:b.value?n.value:s.value,slippage:Number(Q.value)/100}):W=await to.value.swapRouterContract.getSwapRouterPayload(Qe.value,Number(Q.value)/100);let te;if($.value==="Aptos")te=await ie.value.currentWallet.signAndSubmitTransaction(W);else{const me=await ie.value.currentWallet.signAndExecuteTransactionBlock(W);te=D.value.handleTx(me)}if(te&&te.hash){vo(te.hash),Je(!1),Go(!0);const me={title:S("tips.swap"),desc:S("tips.swapSuccessText",{from:`${J(n.value)} ${(y=d.value)==null?void 0:y.symbol}`,to:`${J(s.value)} ${(R=c.value)==null?void 0:R.symbol}`}),hash:te.hash,tit:"Swap",type:"liquidity",action:"swap",isHaveSui:d.value.address==pe[$.value].currentChainTokenAddress||c.value.address==pe[$.value].currentChainTokenAddress,icon:"icon-icon-swap1",tokenInfo:{tokena:`${(I=d.value)==null?void 0:I.address}`,numa:`- ${n.value}`,logoa:m.value.tokensObj&&d.value&&d.value.address&&m.value.tokensObj[d.value.address]&&m.value.tokensObj[d.value.address].logoURI,tokenb:`${(F=c.value)==null?void 0:F.address}`,numb:`+ ${s.value}`,logob:m.value.tokensObj&&c.value&&c.value.address&&m.value.tokensObj[c.value.address]&&m.value.tokensObj[c.value.address].logoURI},text:`Pay ${n.value} ${(z=d.value)==null?void 0:z.symbol} to receive ${s.value} ${(T=c.value)==null?void 0:T.symbol}`};$.value!=="Aptos"&&(me.res=te.res),D.value.showTransitionPending(me),await D.value.watchTransaction(me)&&setTimeout(()=>{$.value=="Aptos"&&q.updateCurrentPools(B.value.poolAddress,$.value),D.value.getAccount(ie.value.address)},1e3)}else Je(!1),mo(!0);n.value="",s.value="",M.value=!1}catch{n.value="",s.value="",M.value=!1,Je(!1),mo(!0)}},en=t=>{var v;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((v=m.value.tokensObj[t==null?void 0:t.address])==null?void 0:v.logo_url)||(E.theme==="default"?ve("/image/coins/unknown.png"):ve("/image/coins/sui-unknown.png"))},fo=f([]);oe(()=>[d.value,c.value,m.value.poolConfigList],([t,v,l])=>{if(l&&l.length>0&&t&&v){const y=[];l.forEach(R=>{var I,F,z,T;(R.coinA.address.toUpperCase()===((I=t.address)==null?void 0:I.toUpperCase())&&R.coinB.address.toUpperCase()===((F=v.address)==null?void 0:F.toUpperCase())||R.coinB.address.toUpperCase()===((z=t.address)==null?void 0:z.toUpperCase())&&R.coinA.address.toUpperCase()===((T=v.address)==null?void 0:T.toUpperCase()))&&(R!=null&&R.is_pause||y.push(R.address))}),fo.value=y}},{immediate:!0});const eo=t=>{const v=localStorage.getItem(t.address);m.value.tokensObj&&m.value.tokensObj[t.address]&&m.value.tokensObj[t.address].isSelfBuilt&&!v?oo.value=!0:(U.value==="fromCoin"?(n.value="",c.value&&t.address.toLowerCase()===(c==null?void 0:c.value.address.toLowerCase())&&(c.value=null),d.value=t):(d.value&&(s.value="",t.address.toLowerCase()===(d==null?void 0:d.value.address.toLowerCase())&&(d.value=null)),c.value=t),po())},oo=f(!1),po=()=>{fe.value={},Ie.value={},oo.value=!1},on=N(()=>E.isShowRouterModal),no=f([]),ho=f(""),nn=f(!1),go=yn(),to=N(()=>go),ye=f(!1),Qe=f({}),Co=f(""),bo=t=>{const{splitPaths:v}=t;let l=new i(0);v.forEach((R,I)=>{const F=R.basePaths[0],z=F.label==="Cetus"?new i(F.feeRate).div(Math.pow(10,6)):new i(F.feeRate).div(Math.pow(10,9)),T=new i(F.inputAmount).div(Math.pow(10,d.value.decimals)).mul(z);if(l=l.add(T),R.basePaths[1]){const W=R.basePaths[1],te=F.direction?F.currentPrice:new i(1).div(F.currentPrice),me=W.direction?W.currentPrice:new i(1).div(R.basePaths[1].currentPrice),Be=W.label==="Cetus"?new i(W.feeRate).div(Math.pow(10,6)):new i(W.feeRate).div(Math.pow(10,9)),rn=new i(W.outputAmount).div(Math.pow(10,c.value.decimals)).mul(Be).div(te.mul(me));l=l.add(rn)}});const y=l.toNumber();Co.value=y>0&&y<1e-6?"<0.000001":J(ae(y,d.value.decimals))},wo=(t,v)=>v.minus(t).div(v).mul(100),ko=async t=>{const{splitPaths:v}=t;let l=new i(0);v.forEach((y,R)=>{if(y.basePaths.length===1){const I=y.basePaths[0],F=new i(I.outputAmount).div(Math.pow(10,I.toDecimal)),z=new i(I.inputAmount).div(Math.pow(10,I.fromDecimal)),T=F.div(z),W=I.direction?new i(I.currentPrice):new i(1).div(I.currentPrice);l=l.add(wo(T,W))}else{const I=y.basePaths[0].direction?new i(y.basePaths[0].currentPrice):new i(1).div(y.basePaths[0].currentPrice),F=y.basePaths[1].direction?new i(y.basePaths[1].currentPrice):new i(1).div(y.basePaths[1].currentPrice),z=I.mul(F),T=new i(y.basePaths[1].outputAmount).div(Math.pow(10,y.basePaths[1].toDecimal)),W=new i(y.basePaths[0].inputAmount).div(Math.pow(10,y.basePaths[0].fromDecimal)),te=T.div(W);l=l.add(wo(te,z))}}),We.value=Number(ae(l.toNumber(),2))},yo=async t=>{if(d.value&&c.value&&(Number(n.value)>0||Number(s.value)>0)){(!n.value&&s.value||n.value&&!s.value)&&(M.value=!0),Pe.value=!0,ye.value=!1;let v;B.value&&(v=d.value.address===B.value.coinA.address&&c.value.address===B.value.coinB.address?0:1);try{let l;if(b.value){const F=new i(n.value).mul(Math.pow(10,d.value.decimals)).toString();l=new He(F)}else{const F=new i(s.value).mul(Math.pow(10,c.value.decimals)).toString();l=new He(F)}const y=Number(Q.value)/100,R=B.value?{poolAddresses:fo.value,coinTypeA:B.value.coin_a_address,coinTypeB:B.value.coin_b_address,decimalsA:B.value.coinA.decimals,decimalsB:B.value.coinB.decimals,a2b:v==0,byAmountIn:b.value,amount:l.toString()}:"",I=await to.value.swapRouterContract.getSwapRouter(d,c,l,b.value,y,"",B.value?R:"");if(I&&!I.isExceed&&I.splitPaths&&I.splitPaths.length==0){ye.value=!0;return}if(I){if(Qe.value=I,no.value=I.paths,L.value=I.isExceed,I.isExceed){M.value=!1,ye.value=!1,b.value?s.value="":n.value="";return}bo(I),b.value?n.value&&(s.value=new i(I.outputAmount).div(new i(Math.pow(10,c.value.decimals))).toString()):s.value&&(n.value=new i(I.inputAmount).div(new i(Math.pow(10,d.value.decimals))).toString()),we.value=J(ue(new i(n.value).div(new i(s.value).toString()),d.value.decimals)),ke.value=J(ue(new i(s.value).div(n.value).toString(),c.value.decimals)),ko(I),M.value=!1,ye.value=!1,Pe.value=!1}else M.value=!1,ye.value=!0,Pe.value=!1}catch{M.value=!1,Pe.value=!1}}else b.value?s.value="":n.value="",M.value=!1,Pe.value=!1},Ae=f(!1),Ao=async t=>{try{let v;if(b.value){const R=new i(n.value).mul(Math.pow(10,d.value.decimals)).toString();v=new He(R)}else{const R=new i(s.value).mul(Math.pow(10,c.value.decimals)).toString();v=new He(R)}const l=Number(Q.value)/100,y=await to.value.swapRouterContract.getSwapRouter(d,c,v,b.value,l,"");y&&(Qe.value=y,no.value=y.paths,L.value=y.isExceed,ho.value=y.amountIn,bo(y),we.value=J(ue(new i(n.value).div(new i(s.value).toString()),d.value.decimals)),ke.value=J(ue(new i(s.value).div(n.value).toString(),c.value.decimals)),ko(y),b.value?s.value!==y.amountOut&&(Ae.value=!0,s.value=y.amountOut):n.value!==y.amountIn&&(Ae.value=!0,n.value=y.amountIn))}catch{}},tn=async t=>{if(d.value&&c.value&&(n.value||s.value)){const v=d.value.address===B.value.coinA.address&&c.value.address===B.value.coinB.address?0:1;try{let l=await D.value.preSwap({pool:B.value,a2b:v==0,byAmountIn:b.value,amount:b.value?n.value:s.value});L.value=l==null?void 0:l.isExceed,uo.value=l==null?void 0:l.estimatedFeeAmount,b.value?(ke.value=(Number(l.estimatedAmountOut)/l.estimatedAmountIn).toString(),we.value=(l.estimatedAmountIn/Number(l.estimatedAmountOut)).toString()):(ke.value=(Number(l.estimatedAmountOut)/Number(l.estimatedAmountIn)).toString(),we.value=(Number(l.estimatedAmountIn)/Number(l.estimatedAmountOut)).toString()),b.value?s.value!==l.estimatedAmountOut&&(Ae.value=!0,s.value=l.estimatedAmountOut):n.value!==l.estimatedAmountIn&&(Ae.value=!0,n.value=l.estimatedAmountIn),We.value=$.value=="Aptos"?await qe(B.value):await qe(Ne.value||B.value),M.value=!1,P.value=!1}catch{M.value=!1,P.value=!1}}else M.value=!1,P.value=!1};let Oe=f(null);oe(()=>A.value,t=>{t?Oe.value=setInterval(()=>{$.value=="Aptos"?tn(b.value):Ao(b.value)},3e3):(clearInterval(Oe.value),window.clearInterval(Oe.value))},{immediate:!0});const Se=async t=>{$.value=="Aptos"?Do(t):yo()};oe(()=>Ge.value,t=>{(Number(n.value)>0||Number(s.value)>0)&&Se(b.value?n.value:s.value)},{immediate:!0});const an=N(()=>go),sn=N(()=>an.value.isInitRouter);oe(()=>sn.value,t=>{t||(C.value=0,Se(b.value?n.value:s.value))},{immediate:!0}),oe(()=>[d.value,c.value],([t,v])=>{if(t&&v&&(C.value=0,Se(b.value?n.value:s.value)),t||v){const l=`/swap?from=${t==null?void 0:t.address}&to=${v==null?void 0:v.address}`;e.push(l)}},{immediate:!0});function ln(t,v=500){let l=null;return function(...y){clearTimeout(l),l=setTimeout(()=>{t.call(this,...y)},v)}}const un=ln(So);function So(){const t=d.value;d.value=c.value,c.value=t,_.value=!0,b.value=!b.value,b.value?(n.value=s.value,s.value=""):(s.value=n.value,n.value=""),setTimeout(()=>{_.value=!1},300)}return{closeSwapConfirmModal:()=>{A.value=!1,Ae.value=!1},updateAccept:()=>{Ae.value=!1},clickExchange:So,debounceClickExchange:un,closeTokenWarning:po,isShowTokenWarning:oo,getTokenSource:eo,hasPool:co,getPoolInfoSuccess:Re,halfBtnSelect:Lo,formCoinId:Ho,toCoinId:Yo,formCoinMarket:Zo,toCoinMarket:zo,fromCoinUrl:Qo,toCoinUrl:Xo,t:S,indicator:p,wallet:ie,currentLpInfo:qo,fixD:Ze,decimalFormat:mn,impact:We,oneFromAmount:we,oneToAmount:ke,importIcon:ve,clickRefresh:xe,refresh:g,change:_,isShowAddress:H,isShowSwapSetting:V,fromCoin:d,toCoin:c,slippage:Q,openCoinSelect:De,onCoinSelect:jo,existingCoins:a,lastSelectCoin:Y,currentCoinKey:U,showCoinSelect:ne,fromCoinAmount:n,toCoinAmount:s,maxBtnSelect:Eo,fixedFromCoin:b,swapBtnText:Le,toSwap:xo,loading:G,swaping:M,autoRefreshTime:w,countdown:C,marketTimer:O,rateChange:ee,isSwapConfirmMpdal:A,fromCoinBlance:le,toCoinBlance:re,poolInfo:B,chainName:$,swapRouterLoading:Pe,formatFee:Ko,calculating:P,currentRate:io,currentRateReverse:lo,getCoinIcon:en,toAddLiquidiPoolInfo:Ne,decimalUi:ue,warningToCoin:fe,warningFromCoin:Ie,isShowRouterModal:on,toSwapLoading:nn,insufficientLiquidity:L,routerPool:no,routerTotalAmounts:ho,store:E,suiPreSwapdata:Qe,suiSwapFee:Co,addCommom:J,debounce:Ye,notFoundRouter:ye,getSuiAmountAccept:Ao,isShowAccept:Ae,getSuiAmount:yo}}});const be=e=>(Fe("data-v-b21a1327"),e=e(),je(),e),ai={class:"swap-container"},si={class:"title"},ii={class:"left"},li={class:"right title-right"},ui=be(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),ri={class:"swap-card"},di={class:"card-container"},ci={class:"card-item"},mi={class:"card-item"},vi=be(()=>o("use",{"xlink:href":"#icon-icon-swap1"},null,-1)),fi=[vi],pi={key:1,class:"induction"},hi={key:0,class:"exchange-rate-btn"},gi={key:0},Ci={key:0},bi={key:0},wi={key:1},ki={key:0},yi=be(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Ai=be(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Si=[yi,Ai],_i={class:"item"},$i={class:"induction-text"},Ii={key:0,class:"icon","aria-hidden":"true"},Pi=be(()=>o("use",{"xlink:href":"#icon-icon-warning1"},null,-1)),Ni=[Pi],Ri={class:"item"},Oi={class:"induction-text"},Bi={key:0,class:"induction-value"},Mi={class:"item"},Ti={class:"induction-text"},Ui={key:0,class:"induction-value"},Fi={key:0,class:"icon","aria-hidden":"true"},ji=be(()=>o("use",{"xlink:href":"#icon-icon-swap"},null,-1)),Ei=[ji],Li={key:2,class:"token-info-container"},Di={class:"token-info-title"},Wi=be(()=>o("span",{class:"coingecko"},"Price Reference",-1)),qi=be(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-information"})],-1));function Ji(e,p,S,k,E,q){var n,s;const m=dn,_=cn,g=Mt,H=Oo,V=Bo,ee=Fo,A=Cn,U=bn,a=wn,Y=Mo,ne=la,b=kn,G=rs,M=ni,P=Ue("image");return r(),h("div",ai,[o("div",si,[o("div",ii,u(e.$t("menu.swap")),1),o("div",li,[o("div",{class:"slippage-icon",onClick:p[0]||(p[0]=w=>e.isShowSwapSetting=!0)},[ui,o("span",null,u(e.slippage)+"%",1)]),he(m,{loading:e.refresh,"auto-refresh-time":e.autoRefreshTime,countdown:e.countdown,onClickRefresh:e.clickRefresh},null,8,["loading","auto-refresh-time","countdown","onClickRefresh"])])]),o("div",ri,[o("div",di,[o("div",ci,[he(_,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":p[1]||(p[1]=w=>e.fromCoinAmount=w),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logo_url:"",address:e.fromCoin?e.fromCoin.address:"","swap-direction":"From",onOnMax:p[2]||(p[2]=w=>e.maxBtnSelect("fromCoin")),onOnHalf:p[3]||(p[3]=w=>e.halfBtnSelect("fromCoin")),onOnInput:p[4]||(p[4]=w=>{e.fromCoinAmount=w,e.fixedFromCoin=!0}),onOnSelect:p[5]||(p[5]=w=>e.openCoinSelect("fromCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),o("div",mi,[he(_,{modelValue:e.toCoinAmount,"onUpdate:modelValue":p[6]||(p[6]=w=>e.toCoinAmount=w),"input-value":e.toCoinAmount,havemax:!1,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direction":"To","coin-icon":e.toCoin?e.toCoin.logo_url:"",address:e.toCoin?e.toCoin.address:"",havehalf:!1,onOnInput:p[7]||(p[7]=w=>{e.toCoinAmount=w,e.fixedFromCoin=!1}),onOnSelect:p[8]||(p[8]=w=>e.openCoinSelect("toCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),o("img",{class:de(e.change?"gang animationex":"gang"),src:An,alt:""},null,2),o("div",{class:de(["exchange",e.chainName=="Sui"?"sui-exchange":""]),onClick:p[9]||(p[9]=(...w)=>e.debounceClickExchange&&e.debounceClickExchange(...w))},[(r(),h("svg",{class:de(e.change?"icon animationex":"icon"),"aria-hidden":"true"},fi,2))],2)]),e.chainName=="Sui"&&!e.notFoundRouter?(r(),Z(g,{key:0,"swap-loading":e.swaping,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"router-pool":e.routerPool,impact:e.impact,"insufficient-liquidity":e.insufficientLiquidity,"one-to-amount":e.oneToAmount,"one-from-amount":e.oneFromAmount,"sui-pre-swapdata":e.suiPreSwapdata,"sui-swap-fee":e.suiSwapFee,"swap-router-loading":e.swapRouterLoading},null,8,["swap-loading","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","router-pool","impact","insufficient-liquidity","one-to-amount","one-from-amount","sui-pre-swapdata","sui-swap-fee","swap-router-loading"])):e.poolInfo&&e.fromCoinAmount&&e.toCoinAmount&&e.fromCoinAmount!=="0"&&e.toCoinAmount!=="0"&&e.swapBtnText!==e.$t("button.poolNotFound")?(r(),h("div",pi,[Number(e.fromCoinAmount)>0&&Number(e.toCoinAmount)>0?(r(),h("div",hi,[e.rateChange?Number(e.fromCoinAmount)&&Number(e.toCoinAmount)&&e.rateChange?(r(),h("span",wi,[Number(e.fromCoinAmount)&&Number(e.toCoinAmount)?(r(),h("span",ki,[x(o("img",null,null,512),[[P,e.toCoinUrl||e.getCoinIcon(e.toCoin)]]),K(" 1 "+u(e.toCoin.symbol)+" ≈ ",1),x(o("img",null,null,512),[[P,e.fromCoinUrl||e.getCoinIcon(e.fromCoin)]]),o("span",null,u(("addCommom"in e?e.addCommom:X(J))(("decimalUi"in e?e.decimalUi:X(ue))(e.currentRateReverse,e.fromCoin.decimals),e.fromCoin.decimals)),1),K("  "+u(e.fromCoin.symbol),1)])):(r(),Z(H,{key:1,indicator:e.indicator},null,8,["indicator"]))])):j("",!0):(r(),h("span",gi,[x(o("img",null,null,512),[[P,e.fromCoinUrl||e.getCoinIcon(e.fromCoin)]]),K(" 1 "+u(e.fromCoin.symbol)+" ≈ ",1),Number(e.fromCoinAmount)&&Number(e.toCoinAmount)?(r(),h("span",Ci,[x(o("img",null,null,512),[[P,e.toCoinUrl||e.getCoinIcon(e.toCoin)]]),e.calculating?j("",!0):(r(),h("span",bi,u(("addCommom"in e?e.addCommom:X(J))(("decimalUi"in e?e.decimalUi:X(ue))(e.currentRate,e.toCoin.decimals))),1)),e.calculating?(r(),Z(H,{key:1,indicator:e.indicator},null,8,["indicator"])):j("",!0),K("  "+u(e.toCoin.symbol),1)])):(r(),Z(H,{key:1,indicator:e.indicator},null,8,["indicator"]))])),o("div",{class:"icon-change",onClick:p[10]||(p[10]=w=>e.rateChange=!e.rateChange)},Si)])):j("",!0),Number(e.fromCoinAmount)>0&&Number(e.toCoinAmount)>0?(r(),h(ze,{key:1},[o("div",_i,[o("div",$i,u(e.$t("common.priceImpact")),1),e.swaping?(r(),Z(V,{key:1,paragraph:!1,active:""})):(r(),h("div",{key:0,class:de(["induction-value",Number(e.impact)<1?"impact-s":Number(e.impact)<10&&Number(e.impact)>1?"impact-w":"impact-e"])},[K(u(Number(e.impact)<.01?"<0.01":Number(e.impact)>100?"100":e.impact)+"% ",1),e.impact>=10?(r(),h("svg",Ii,Ni)):j("",!0)],2))]),o("div",Ri,[o("div",Oi,u(e.fixedFromCoin?e.$t("common.minimumReceived"):e.$t("common.maximumSold")),1),e.swaping?(r(),Z(V,{key:1,paragraph:!1,active:""})):(r(),h("div",Bi,u(e.fixedFromCoin?("addCommom"in e?e.addCommom:X(J))(("fixD"in e?e.fixD:X(Ze))(Number(e.toCoinAmount)-Number(e.toCoinAmount)*Number(e.slippage)/100,e.toCoin.decimals),e.toCoin.decimals):("addCommom"in e?e.addCommom:X(J))(("fixD"in e?e.fixD:X(Ze))(Number(e.fromCoinAmount)*Number(e.slippage)/100+Number(e.fromCoinAmount),e.fromCoin.decimals),e.fromCoin.decimals))+" "+u(e.fixedFromCoin?e.toCoin.symbol:e.fromCoin.symbol),1))]),o("div",Mi,[o("div",Ti,u(e.$t("common.fee")),1),e.swaping?(r(),Z(V,{key:1,paragraph:!1,active:""})):(r(),h("div",Ui,u(("addCommom"in e?e.addCommom:X(J))(e.formatFee,e.fromCoin.decimals))+" "+u(e.fromCoin.symbol)+" ("+u(e.chainName=="Aptos"?e.poolInfo.fee*100:((n=e.toAddLiquidiPoolInfo)==null?void 0:n.fee)*100)+"%) ",1))])],64)):j("",!0)])):j("",!0)]),he(ee,{disabled:e.wallet.connected?e.swaping||!e.fromCoin||!e.toCoin||!Number(e.fromCoinAmount)||!Number(e.toCoinAmount)||Number(e.fromCoinAmount)>Number(e.fromCoinBlance)||e.swapBtnText==e.$t("button.poolNotFound")||e.swapBtnText!==e.$t("button.swap")||((s=e.poolInfo)==null?void 0:s.is_pause)||e.swapRouterLoading:!1,class:"big-btn",loading:e.chainName=="Aptos"?e.swaping:!1,onClick:p[11]||(p[11]=w=>e.wallet.connected?e.isSwapConfirmMpdal=!0:e.wallet.setIsShowWalletModal(!0))},{default:ce(()=>[e.wallet.connected?(r(),h("svg",Fi,Ei)):j("",!0),o("span",null,u(e.wallet.connected?e.swapBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled","loading"]),he(A),e.showCoinSelect?(r(),Z(U,{key:0,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:p[12]||(p[12]=w=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):j("",!0),e.isShowSwapSetting?(r(),Z(a,{key:1,onOnClose:p[13]||(p[13]=w=>e.isShowSwapSetting=!1)})):j("",!0),e.chainName&&(e.formCoinMarket||e.toCoinMarket)?(r(),h("div",Li,[o("div",Di,[Wi,he(Y,{placement:"top","arrow-point-at-center":""},{title:ce(()=>[K(" The following price is only an external reference from 3rd party data providers, which does not reflect actual data on Cetus. ")]),default:ce(()=>[qi]),_:1})]),e.fromCoin&&e.formCoinMarket?(r(),Z(ne,{key:0,id:e.formCoinId,coin:e.fromCoin,market:e.formCoinMarket,refresh:e.refresh},null,8,["id","coin","market","refresh"])):j("",!0),e.toCoin&&e.toCoinMarket?(r(),Z(ne,{key:1,id:e.toCoinId,coin:e.toCoin,market:e.toCoinMarket,refresh:e.refresh},null,8,["id","coin","market","refresh"])):j("",!0)])):j("",!0),e.chainName=="Sui"&&e.isShowTokenWarning?(r(),Z(b,{key:3,"from-coin":e.warningFromCoin,"to-coin":e.warningToCoin,onClose:e.closeTokenWarning,onClickContinue:e.getTokenSource},null,8,["from-coin","to-coin","onClose","onClickContinue"])):j("",!0),e.isShowRouterModal?(r(),Z(G,{key:4,"sui-pre-swapdata":e.suiPreSwapdata,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,onOnClose:p[14]||(p[14]=w=>e.store.setIsShowRouterModal(!1))},null,8,["sui-pre-swapdata","from-coin","to-coin","from-coin-amount","to-coin-amount"])):j("",!0),e.isSwapConfirmMpdal?(r(),Z(M,{key:5,"sui-pre-swapdata":e.suiPreSwapdata,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,slippage:e.slippage,impact:e.impact,"fixed-from-coin":e.fixedFromCoin,fee:e.chainName=="Sui"?e.suiSwapFee:e.poolInfo.fee,"format-fee":e.chainName=="Sui"?e.suiSwapFee:e.formatFee,"is-show-accept":e.isShowAccept,"swap-loading":e.swapRouterLoading,"one-from-amount":e.oneFromAmount,"one-to-amount":e.oneToAmount,onOnClose:e.closeSwapConfirmModal,onToSwap:e.toSwap,onAccept:e.updateAccept},null,8,["sui-pre-swapdata","from-coin","to-coin","from-coin-amount","to-coin-amount","slippage","impact","fixed-from-coin","fee","format-fee","is-show-accept","swap-loading","one-from-amount","one-to-amount","onOnClose","onToSwap","onAccept"])):j("",!0)])}const gl=Te(ti,[["render",Ji],["__scopeId","data-v-b21a1327"]]);export{gl as default};
