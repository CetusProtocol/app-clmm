import{_ as Co}from"./back.0fe798f2.js";import{_ as $o}from"./coin-pair-name.9873ff26.js";import{_ as Ro}from"./status-block.c9f688a2.js";import{_ as To}from"./network-tips.e82bfcde.js";import{_ as Bo}from"./swap-setting.b729d888.js";import{a as qo,L as Po,r as a,F as Lo,v as $,N as Uo,G as Do,ai as Oo,z as jo,w as O,s as Vo,ay as Eo,ac as j,H as m,i as Mo,V as fo,az as Fo,Q as to,A as ho,k as _o,X as V,b as Wo,o as y,e as E,l as A,f as e,t as i,q as ao,c as Io,h as lo,$ as Xo,a0 as zo,y as R,m as Go,C as Ho,E as Qo,I as Jo,aA as Ko,B as Yo,p as Zo,j as xo,a2 as oe}from"./entry.5bd2346c.js";import{p as uo}from"./precision.ce0280e5.js";const ee=qo({setup(){const{t:o,locale:v}=Po();let ro=a(!1),B=a(!1);const M=a(!1),co=()=>{K(),M.value=!0,setTimeout(()=>{M.value=!1},1e3)},x=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],oo=Lo(),F=a(""),W=a(""),X=a(""),z=a(""),G=a(""),H=a(""),Q=a(""),l=a(""),t=$(()=>oo),u=a({}),r=a({}),s=a(t.value.currentPositionInfo||{}),bo=Uo(),J=$(()=>bo),q=Do();Oo(()=>{J.value.connected||q.push("/position")});const N=jo(),K=async()=>{t.value.setCurrentPositionLoading(!0);const n=q.currentRoute.value.query.token||"",f=q.currentRoute.value.query.collect||"";n&&f&&(F.value=f,W.value=q.currentRoute.value.query.address,X.value=n,t.value.setCurrentPositionInfo(W.value,F.value,X.value),s.value=t.value.currentPositionInfo)};O(()=>t.value.addressLpTokens,n=>{V(n)||K()},{immediate:!0}),O(()=>t.value.currentPositionInfo,n=>{n&&(s.value=t.value.currentPositionInfo,u.value=s.value.token_a,r.value=s.value.token_b,io({value:b.value/100}),console.log(s.value,"  positionInfo.valuepositionInfo.value"))});const b=a(50),d=a(0),p=a(0),eo=a(0),so=Vo(),ko=$(()=>so),no=$(()=>so.slippage);O(b,Eo((n,f)=>{Number(n)>100?b.value=100:n&&s.value&&(b.value=n,io({value:b.value/100}))},300)),O(no,n=>{n&&s.value&&io({value:b.value/100})});const io=n=>{const f=s.value.token_a.decimals,k=s.value.token_b.decimals,w=s.value.tick_lower_index,c=s.value.tick_upper_index,_=fo.tickIndexToSqrtPriceX64(w),L=fo.tickIndexToSqrtPriceX64(c);eo.value=s.value.liquidity*Number(n.value);const I=Fo.getCoinAmountFromLiquidity(new to(eo.value),new to(s.value.current_sqrt_price),_,L,!0),g=Number(I.coinA.toString())/Math.pow(10,f),S=Number(I.coinB.toString())/Math.pow(10,k);console.log(g,S,"amountA121212"),d.value=g,p.value=S;const h=t.value.RATES[t.value.newTokenObj[s.value.token_a.address].name.toUpperCase()].price,U=t.value.RATES[t.value.newTokenObj[s.value.token_b.address].name.toUpperCase()].price;console.log(d.value,h,"fromCoinAmount.value"),z.value=Number(d.value*h)<.01?"<0.01":m(d.value*h,2),G.value=Number(p.value*U)<.01?"<0.01":m(p.value*U,2);const D=uo.minus(Number(s.value.amountA),Number(d.value))*h;H.value=Number(D)<.01?"<0.01":m(D,2);const C=uo.minus(Number(s.value.amountB),Number(p.value))*U;Q.value=Number(C)<.01?"<0.01":m(C,2);const Z=Number(ho(D,2))+Number(ho(C,2));l.value=Number(Z)<.01?"<0.01":m(Z,2)},{setIsShowSuccess:go,setIsShowRejected:mo,setIsShowWaiting:Y,setTransactionDesc:wo,setTransactionTxid:vo,setPositiomNum:os}=so,yo=async()=>{var n,f,k,w;B.value=!0,vo(""),wo(o("tips.removeLiquidiyText",{from:m(d.value,u.value.decimals)==0?"":`${j(d.value,u.value.decimals)} ${u.value.symbol}`,and:m(d.value,u.value.decimals)==0||m(p.value,r.value.decimals)==0?"":"and",to:m(p.value,r.value.decimals)==0?"":`${j(p.value,r.value.decimals)} ${r.value.symbol}`})),Y(!0);try{let c={};c={pool:{...s.value.poolInfo,coinA:s.value.token_a,coinB:s.value.token_b},coinTypeA:s.value.poolInfo.coinTypeA,coinTypeB:s.value.poolInfo.coinTypeB,position:s.value,delta_liquidity:new to(_o(eo.value,0)),slippage:Number(no.value),rewards_num:P.value.length};const _=P.value;console.log(P,"===>pendingRewarderArr"),c.coinTypeC=_[0]?_[0].coin_address:"",c.coinTypeD=_[1]?_[1].coin_address:"",c.coinTypeE=_[2]?_[2].coin_address:"",console.log(c,"===>params");const L=await N.getRemoveLiquidityTransactionPayload(c);let I;if(I=await J.value.currentWallet.signAndSubmitTransaction(L),I&&I.hash){vo(I.hash),Y(!1),go(!0);const g={title:o("common.removeLiquidity"),desc:o("tips.removeSuccessText",{from:m(d.value,u.value.decimals)==0?"":`${j(d.value,u.value.decimals)} ${u.value.symbol}`,and:m(d.value,u.value.decimals)==0||m(p.value,r.value.decimals)==0?"":"and",to:m(p.value,r.value.decimals)==0?"":`${j(p.value,r.value.decimals)} ${r.value.symbol}`}),hash:I.hash,descTransactions:`Remove ${d.value} ${(n=u.value)==null?void 0:n.symbol} and ${p.value} ${(f=r.value)==null?void 0:f.symbol} 
             from the pool`,sender:J.value.address,chainName:ko.value.chainName,tit:`${b.value==100?"Closed":"Modified"} Position: ${s.value.poolInfo.symbol}`,text:`Withdraw ${d.value} ${(k=u.value)==null?void 0:k.symbol} and ${p.value} ${(w=r.value)==null?void 0:w.symbol}`};N.showTransitionPending(g),await N.watchTransaction(g)&&(setTimeout(()=>{K()},3e3),setTimeout(()=>{K()},6e3),Number(b.value)==100&&q.push("/position"))}else Y(!1),mo(!0);B.value=!1}catch(c){console.log("Remove error",c),B.value=!1,Y(!1),mo(!0)}},Ao=$(()=>t.value.tokensObj&&u.value.address&&t.value.tokensObj[u.value.address]&&t.value.tokensObj[u.value.address].logoURI),No=$(()=>t.value.tokensObj&&r.value.address&&t.value.tokensObj[r.value.address]&&t.value.tokensObj[r.value.address].logoURI),So=a(0),P=a([]);return O(()=>[s.value,t.value.addressLpTokens,t.value.newTokenObj,t.value.RATES],async([n,f,k,w])=>{if(!V(n)&&!V(f)&&!V(k)&&!V(w)){const c=f[n.poolAddress];console.log(c,"===>pool");const _=await N.getTickDataByIndex(c.ticks_handle,Number(n.tick_lower_index)),L=await N.getTickDataByIndex(c.ticks_handle,Number(n.tick_upper_index)),I=await N.getPosRewardersAmount({poolAddress:n.poolAddress,positionName:n.tokenName,tickLowerData:_,tickUpperData:L}),g=[];let S=0;I.forEach(h=>{const U=k[h.coin_address].decimals,D=k[h.coin_address];console.log(h.amount_owed.toString(),"===>element.amount_owed.toString()");const C=Number(h.amount_owed.toString())/Math.pow(10,U),Z=w[k[h.coin_address].name.toUpperCase()].price,po=C*Z;S+=po,g.push({...h,...D,amount:C,amountUSD:po})}),P.value=g,So.value=Number(_o(S,2))}},{immediate:!0}),{removeAmountARates:H,removeAmountBRates:Q,removeAmountRates:l,receiveAmountARates:z,receiveAmountBRates:G,showNum:j,fromCoinUrl:Ao,toCoinUrl:No,precision:uo,addCommom:m,loading:B,wallet:J,toRemove:yo,fromCoinAmount:d,toCoinAmount:p,pools:t,refresh:M,amountArr:x,sliderVal:b,positionInfo:s,slippage:no,importIcon:Mo,clickRefresh:co,isShowSwapSetting:ro,pendingRewarderArr:P}}});const T=o=>(Zo("data-v-cf9ed00b"),o=o(),xo(),o),se={class:"remove-liquidity"},ne={class:"remove-liquidity-top"},ie={class:"remove-title"},te={class:"right title-right"},ae=T(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),le=T(()=>e("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),ue=[le],re={class:"remove-liquidity-center"},de={class:"top"},ce={class:"left"},me={class:"right"},ve={class:"fee"},pe={class:"bottom"},fe={class:"add-amount"},he={class:"add-amount-header"},_e={class:"amount-list"},Ie=["onClick"],be={class:"slider-box"},ke={class:"receive"},ge={class:"receiveTit"},we={class:"item"},ye={class:"left"},Ae=["src"],Ne={class:"right"},Se={class:"item"},Ce={class:"left"},$e=["src"],Re={class:"right"},Te={class:"remove-liquidity-bottom-box"},Be={class:"induction remove-liquidity-bottom"},qe={class:"item"},Pe=T(()=>e("div",{class:"induction-text"},"Fees",-1)),Le={class:"induction-value"},Ue=["src"],De=T(()=>e("div",{class:"induction-text"},null,-1)),Oe={class:"induction-value"},je=["src"],Ve=T(()=>e("svg",{"aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-Remove"})],-1)),Ee={key:0,class:"receive"},Me={class:"receiveTit"},Fe=T(()=>e("div",{class:"left"},"Remaining in Position",-1)),We={class:"right"},Xe={class:"item"},ze={class:"left"},Ge=["src"],He={class:"right"},Qe={class:"item"},Je={class:"left"},Ke=["src"],Ye={class:"right"},Ze={class:"loading-global"};function xe(o,v,ro,B,M,co){const x=Co,oo=$o,F=Ro,W=Jo,X=Ko,z=Yo,G=To,H=Bo,Q=oe;return y(),E("div",se,[A(x),e("div",ne,[e("div",ie,i(o.$t("common.removeLiquidity")),1),e("div",te,[e("div",{class:"slippage-icon",onClick:v[0]||(v[0]=l=>o.isShowSwapSetting=!0)},[ae,e("span",null,i(o.slippage)+"%",1)]),(y(),E("svg",{"aria-hidden":"true",class:ao(o.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:v[1]||(v[1]=(...l)=>o.clickRefresh&&o.clickRefresh(...l))},ue,2))])]),e("div",re,[e("div",de,[e("div",ce,[o.positionInfo?(y(),Io(oo,{key:0,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b},null,8,["from-coin","to-coin"])):lo("",!0),e("div",me,[e("div",ve,i(o.positionInfo.fee)+"%",1)])]),A(F,{"current-status":o.positionInfo.currentStatus||""},null,8,["current-status"])]),e("div",pe,[e("div",fe,[e("div",he,[e("span",null,i(o.$t("common.amount")),1),e("div",_e,[(y(!0),E(Xo,null,zo(o.amountArr,(l,t)=>(y(),E("div",{key:t,class:ao(["amount-item",o.sliderVal==l.value?"amount-item-active":""]),onClick:u=>o.sliderVal=l.value},i(l.name),11,Ie))),128))])]),e("div",be,[A(W,{value:o.sliderVal,"onUpdate:value":v[2]||(v[2]=l=>o.sliderVal=l),oninpu:"value=value.replace(/[^\\d]/g,'')",suffix:"%"},null,8,["value"]),A(X,{value:o.sliderVal,"onUpdate:value":v[3]||(v[3]=l=>o.sliderVal=l)},null,8,["value"])])])])]),e("div",ke,[e("div",ge,i(o.$t("newAdd.receive")),1),e("div",we,[e("div",ye,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Ae),e("span",null,i(o.showNum(o.fromCoinAmount,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),R(" "+i(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)]),e("div",Ne,"\u2248 $"+i(o.receiveAmountARates),1)]),e("div",Se,[e("div",Ce,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,$e),e("span",null,i(o.showNum(o.toCoinAmount,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),R(" "+i(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)]),e("div",Re,"\u2248 $"+i(o.receiveAmountBRates),1)])]),e("div",Te,[e("div",Be,[e("div",qe,[Pe,e("div",Le,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Ue),R(" "+i(o.showNum(o.positionInfo&&o.positionInfo.feeOwedA,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals))+" "+i(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)])]),e("div",{class:ao(o.pendingRewarderArr.length>0?"item item-boder":"item")},[De,e("div",Oe,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,je),R(" "+i(o.showNum(o.positionInfo&&o.positionInfo.feeOwedB,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals))+" "+i(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)])],2)])]),A(z,{disabled:o.wallet.connected?Number(o.sliderVal)==0||o.loading:!1,class:"remove-btn big-btn",onClick:v[4]||(v[4]=l=>o.wallet.connected?o.toRemove():o.wallet.setIsShowWalletModal(!0))},{default:Go(()=>[Ve,e("span",null,i(o.wallet.connected?o.$t("button.remove"):o.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),A(G),o.sliderVal<100?(y(),E("div",Ee,[e("div",Me,[Fe,e("div",We,"$"+i(o.removeAmountRates),1)]),e("div",Xe,[e("div",ze,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Ge),e("span",null,i(o.showNum(o.precision.minus(Number(o.positionInfo.amountA),Number(o.fromCoinAmount)),o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),R(" "+i(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)]),e("div",He,"\u2248 $"+i(o.removeAmountARates),1)]),e("div",Qe,[e("div",Je,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,Ke),e("span",null,i(o.showNum(o.precision.minus(Number(o.positionInfo.amountB),Number(o.toCoinAmount)),o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),R(" "+i(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)]),e("div",Ye,"\u2248 $"+i(o.removeAmountBRates),1)])])):lo("",!0),o.isShowSwapSetting?(y(),Io(H,{key:1,onOnClose:v[5]||(v[5]=l=>o.isShowSwapSetting=!1)})):lo("",!0),Ho(e("div",Ze,[A(Q)],512),[[Qo,o.pools.currentPositionLoading]])])}const us=Wo(ee,[["render",xe],["__scopeId","data-v-cf9ed00b"]]);export{us as default};
