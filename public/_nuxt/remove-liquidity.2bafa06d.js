import{_ as Po}from"./back.f7a7b77b.js";import{_ as Bo}from"./coin-pair-name.85f6453f.js";import{_ as Lo}from"./status-block.ecab1503.js";import{_ as Uo,a as Do}from"./swap-setting.b671a10a.js";import{a as jo,Z as Oo,r as l,e as Eo,i as R,b as Vo,$ as Wo,W as Mo,f2 as Fo,w as G,fh as Xo,ab as uo,Q as g,x as zo,fi as Io,fj as Go,B as ro,L as bo,z as ko,A as Ko,j as K,k as Qo,o as N,l as T,E as q,m as e,t as n,q as mo,c as _o,p as oo,G as go,T as yo,C as P,F as Zo,N as Ho,O as Jo,I as Yo,fk as xo,K as oe,s as ee,v as ne,U as se}from"./entry.dfbbf7bb.js";import{p as co}from"./precision.1cd464a0.js";const ie=jo({setup(){const{t:o,locale:r}=Oo();let vo=l(!1),M=l(!1);const Q=l(!1),po=()=>{J(),Q.value=!0,setTimeout(()=>{Q.value=!1},1e3)},no=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],F=Eo(),f=R(()=>F),so=Vo(),B=l(""),L=l(""),U=l(""),Z=l(""),H=l(""),t=l(""),D=l(""),io=l(""),wo=s=>{let u=s.replace(/[^\d.]/g,"");const d=/^\d+(\.\d+)?$/;u.split(".").length>2&&!d.exec(u)&&(u=u.substr(0,u.length-1)),b.value=u},a=R(()=>so),h=l({}),I=l({}),i=l(a.value.currentPositionInfo||{}),No=Wo(),X=R(()=>No),$=Mo();Fo(()=>{X.value.connected||$.push("/position")});const A=R(()=>f.value.chainName?Ko(f.value.chainName):{}),J=async()=>{a.value.setCurrentPositionLoading(!0);const s=$.currentRoute.value.query.token||"",u=$.currentRoute.value.query.collect||"",d=$.currentRoute.value.query.pos||"";f.value.chainName==="Aptos"?s&&u&&(B.value=u,L.value=$.currentRoute.value.query.address,U.value=s,a.value.setCurrentPositionInfo(L.value,B.value,U.value,f.value.chainName),i.value=a.value.currentPositionInfo):d&&(B.value=u,L.value=$.currentRoute.value.query.address,U.value=s,a.value.setCurrentPositionInfo(L.value,B.value,U.value,f.value.chainName,d),i.value=a.value.currentPositionInfo)};G(()=>a.value.addressLpTokens,s=>{K(s)||J()},{immediate:!0}),G(()=>a.value.currentPositionInfo,s=>{s&&(i.value=a.value.currentPositionInfo,h.value=i.value.token_a,I.value=i.value.token_b,lo({value:b.value/100}))});const b=l(50),m=l(0),c=l(0),to=l(0),ao=R(()=>F.slippage);G(b,Xo((s,u)=>{Number(s)>100?b.value=100:s&&i.value&&(b.value=s,lo({value:b.value/100}))},300)),G(ao,s=>{s&&i.value&&lo({value:b.value/100})});const lo=s=>{var x,z;const u=i.value.token_a.decimals,d=i.value.token_b.decimals,C=i.value.tick_lower_index,S=i.value.tick_upper_index,k=Io.tickIndexToSqrtPriceX64(C),_=Io.tickIndexToSqrtPriceX64(S);to.value=i.value.liquidity*Number(s.value);const y=Go.getCoinAmountFromLiquidity(new ro(to.value),new ro(i.value.current_sqrt_price),k,_,!0),v=Number(y.coinA.toString())/Math.pow(10,u),w=Number(y.coinB.toString())/Math.pow(10,d);m.value=v,c.value=w;const p=(x=a.value.RATES[i.value.token_a.address])==null?void 0:x.price,O=(z=a.value.RATES[i.value.token_b.address])==null?void 0:z.price;Z.value=Number(m.value*p)<.01?Number(m.value*p)===0?"0":"<0.01":g(m.value*p,2),H.value=Number(c.value*O)<.01?Number(c.value*O)===0?"0":"<0.01":g(c.value*O,2);const E=co.minus(Number(i.value.amountA),Number(m.value))*p;t.value=Number(E)<.01?Number(E)===0?"0":"<0.01":g(E,2);const V=co.minus(Number(i.value.amountB),Number(c.value))*O;D.value=Number(V)<.01?Number(V)===0?"0":"<0.01":g(V,2);const W=Number(bo(E,2))+Number(bo(V,2));io.value=Number(W)<.01?Number(W)===0?"0":"<0.01":g(W,2)},{setIsShowSuccess:Ao,setIsShowRejected:fo,setIsShowWaiting:Y,setTransactionDesc:$o,setTransactionTxid:ho,setPositiomNum:ln,setTransactionDescText:Co}=F,So=async()=>{var u,d,C,S;M.value=!0,ho(""),$o(o("tips.removeLiquidiyText",{from:g(m.value,h.value.decimals)==0?"":`${uo(m.value,h.value.decimals)} ${h.value.symbol}`,and:g(m.value,h.value.decimals)==0||g(c.value,I.value.decimals)==0?"":"and",to:g(c.value,I.value.decimals)==0?"":`${uo(c.value,I.value.decimals)} ${I.value.symbol}`})),Y(!0);const s=j.value&&j.value.length>0?o("modal.removeLiquidityText1"):o("modal.removeLiquidityText2");Co(s);try{let k={};k={pool:{...i.value.poolInfo,coinA:i.value.token_a,coinB:i.value.token_b},coinTypeA:i.value.poolInfo.coinTypeA,coinTypeB:i.value.poolInfo.coinTypeB,position:i.value,delta_liquidity:new ro(ko(to.value,0)),slippage:Number(ao.value),rewards_num:j.value.length};const _=j.value;k.coinTypeC=_[0]?_[0].coin_address:"",k.coinTypeD=_[1]?_[1].coin_address:"",k.coinTypeE=_[2]?_[2].coin_address:"";const y=await A.value.getRemoveLiquidityTransactionPayload(k);let v;if(f.value.chainName==="Aptos")v=await X.value.currentWallet.signAndSubmitTransaction(y);else{const w=await X.value.currentWallet.signAndExecuteTransaction(y);v=A.value.handleTx(w)}if(v&&v.hash){ho(v.hash),Y(!1),Ao(!0);const w={title:o("common.removeLiquidity"),desc:"",hash:v.hash,descTransactions:`Remove ${m.value} ${(u=h.value)==null?void 0:u.symbol} and ${c.value} ${(d=I.value)==null?void 0:d.symbol} 
             from the pool`,sender:X.value.address,chainName:f.value.chainName,tit:`${b.value==100?"Closed":"Modified"} Position: ${i.value.poolInfo.symbol}`,text:`Withdraw ${m.value} ${(C=h.value)==null?void 0:C.symbol} and ${c.value} ${(S=I.value)==null?void 0:S.symbol}`};A.value.showTransitionPending(w),await A.value.watchTransaction(w)&&(setTimeout(()=>{J()},3e3),setTimeout(()=>{J()},6e3),Number(b.value)==100&&$.push("/position"))}else Y(!1),fo(!0);M.value=!1}catch{M.value=!1,Y(!1),fo(!0)}},Ro=R(()=>a.value.tokensObj&&h.value.address&&a.value.tokensObj[h.value.address]&&a.value.tokensObj[h.value.address].logoURI),To=R(()=>a.value.tokensObj&&I.value.address&&a.value.tokensObj[I.value.address]&&a.value.tokensObj[I.value.address].logoURI),qo=l(0),j=l([]);return G(()=>[i.value,a.value.addressLpTokens,a.value.newTokenObj,a.value.RATES],async([s,u,d,C])=>{if(!K(s)&&!K(u)&&!K(d)&&!K(C)){const S=u[s.poolAddress],k=await A.value.getTickDataByIndex(S.ticks_handle,Number(s.tick_lower_index)),_=await A.value.getTickDataByIndex(S.ticks_handle,Number(s.tick_upper_index));let y={};f.value.chainName==="Aptos"?y=await A.value.getPosRewardersAmount({poolAddress:s.poolAddress,positionName:s.tokenName,tickLowerData:k,tickUpperData:_}):y=await A.value.getPosRewardersAmount({poolAddress:s.poolAddress,pos:s.pos_object_id});const v=[];let w=0;y.forEach((p,O)=>{if(i.value.poolInfo[`rewarder_display${O+1}`]){const E=d[p.coin_address].decimals,V=d[p.coin_address],W=Number(p.amount_owed.toString())/Math.pow(10,E),x=C[d[p.coin_address].name.toUpperCase()].price,z=W*x;w+=z,v.push({...p,...V,amount:W,amountUSD:z})}}),j.value=v,qo.value=Number(ko(w,2))}},{immediate:!0}),{removeAmountARates:t,removeAmountBRates:D,removeAmountRates:io,receiveAmountARates:Z,receiveAmountBRates:H,showNum:uo,fromCoinUrl:Ro,toCoinUrl:To,precision:co,addCommom:g,loading:M,wallet:X,toRemove:So,fromCoinAmount:m,toCoinAmount:c,pools:a,refresh:Q,amountArr:no,sliderVal:b,positionInfo:i,slippage:ao,importIcon:zo,clickRefresh:po,isShowSwapSetting:vo,pendingRewarderArr:j,changeValue:wo}}});const eo=o=>(ee("data-v-a0a58f5f"),o=o(),ne(),o),te={class:"remove-liquidity"},ae={class:"remove-liquidity-top"},le={class:"remove-title"},ue={class:"right title-right"},re=eo(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),de=eo(()=>e("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),me=[de],ce={class:"remove-liquidity-center"},ve={class:"top"},pe={class:"left"},fe={class:"right"},he={class:"fee"},Ie={class:"bottom"},be={class:"add-amount"},ke={class:"add-amount-header"},_e={class:"amount-list"},ge=["onClick"],ye={class:"slider-box"},we={class:"receive"},Ne={class:"receiveTit"},Ae={class:"item"},$e={class:"left"},Ce=["src"],Se={class:"right"},Re={class:"item"},Te={class:"left"},qe=["src"],Pe={class:"right"},Be={class:"remove-liquidity-bottom-box"},Le={class:"induction remove-liquidity-bottom"},Ue={class:"item"},De={class:"induction-text"},je={class:"induction-value"},Oe=["src"],Ee=eo(()=>e("div",{class:"induction-text"},null,-1)),Ve={class:"induction-value"},We=["src"],Me={class:"induction-text"},Fe={class:"induction-value"},Xe=["src"],ze=eo(()=>e("svg",{"aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-Remove"})],-1)),Ge={key:0,class:"receive"},Ke={class:"receiveTit"},Qe={class:"left"},Ze={class:"right"},He={class:"item"},Je={class:"left"},Ye=["src"],xe={class:"right"},on={class:"item"},en={class:"left"},nn=["src"],sn={class:"right"},tn={class:"loading-global"};function an(o,r,vo,M,Q,po){const no=Po,F=Bo,f=Lo,so=Yo,B=xo,L=oe,U=Do,Z=Uo,H=se;return N(),T("div",te,[q(no),e("div",ae,[e("div",le,n(o.$t("common.removeLiquidity")),1),e("div",ue,[e("div",{class:"slippage-icon",onClick:r[0]||(r[0]=t=>o.isShowSwapSetting=!0)},[re,e("span",null,n(o.slippage)+"%",1)]),(N(),T("svg",{"aria-hidden":"true",class:mo(o.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:r[1]||(r[1]=(...t)=>o.clickRefresh&&o.clickRefresh(...t))},me,2))])]),e("div",ce,[e("div",ve,[e("div",pe,[o.positionInfo?(N(),_o(F,{key:0,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b},null,8,["from-coin","to-coin"])):oo("",!0),e("div",fe,[e("div",he,n(o.positionInfo.fee*100)+"%",1)])]),q(f,{"current-status":o.positionInfo.currentStatus||""},null,8,["current-status"])]),e("div",Ie,[e("div",be,[e("div",ke,[e("span",null,n(o.$t("common.amount")),1),e("div",_e,[(N(!0),T(go,null,yo(o.amountArr,(t,D)=>(N(),T("div",{key:D,class:mo(["amount-item",o.sliderVal==t.value?"amount-item-active":""]),onClick:io=>o.sliderVal=t.value},n(t.name),11,ge))),128))])]),e("div",ye,[q(so,{value:o.sliderVal,"onUpdate:value":r[2]||(r[2]=t=>o.sliderVal=t),suffix:"%",onChange:r[3]||(r[3]=t=>o.changeValue(t.target.value))},null,8,["value"]),q(B,{value:o.sliderVal,"onUpdate:value":r[4]||(r[4]=t=>o.sliderVal=t)},null,8,["value"])])])])]),e("div",we,[e("div",Ne,n(o.$t("newAdd.receive")),1),e("div",Ae,[e("div",$e,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Ce),e("span",null,n(o.showNum(o.fromCoinAmount,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),P(" "+n(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol)+" "+n(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.labels&&o.positionInfo.token_a.labels[0]?`(${o.positionInfo.token_a.labels[0]})`:""),1)]),e("div",Se,"\u2248 $"+n(o.receiveAmountARates),1)]),e("div",Re,[e("div",Te,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,qe),e("span",null,n(o.showNum(o.toCoinAmount,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),P(" "+n(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol)+" "+n(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.labels&&o.positionInfo.token_b.labels[0]?`(${o.positionInfo.token_b.labels[0]})`:""),1)]),e("div",Pe,"\u2248 $"+n(o.receiveAmountBRates),1)])]),e("div",Be,[e("div",Le,[e("div",Ue,[e("div",De,n(o.$t("common.fees")),1),e("div",je,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Oe),P(" "+n(o.showNum(o.positionInfo&&o.positionInfo.feeOwedA,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals))+" ",1),e("span",null,n(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)])]),e("div",{class:mo(o.pendingRewarderArr.length>0?"item item-boder":"item")},[Ee,e("div",Ve,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,We),P(" "+n(o.showNum(o.positionInfo&&o.positionInfo.feeOwedB,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals))+" ",1),e("span",null,n(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)])],2),o.positionInfo.is_display_rewarder?(N(!0),T(go,{key:0},yo(o.pendingRewarderArr,(t,D)=>(N(),T("div",{key:t,class:"item"},[e("div",Me,n(D==0?o.$t("common.rewards"):""),1),e("div",Fe,[e("img",{src:t.logoURI},null,8,Xe),P(" "+n(t.amount>1e-6?t.amount:t.amount===0?"0":"<0.000001")+" ",1),e("span",null,n(t.symbol),1)])]))),128)):oo("",!0)])]),q(L,{disabled:o.wallet.connected?Number(o.sliderVal)==0||o.loading:!1,class:"remove-btn big-btn",onClick:r[5]||(r[5]=t=>o.wallet.connected?o.toRemove():o.wallet.setIsShowWalletModal(!0))},{default:Zo(()=>[ze,e("span",null,n(o.wallet.connected?o.$t("button.remove"):o.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),q(U),o.sliderVal<100?(N(),T("div",Ge,[e("div",Ke,[e("div",Qe,n(o.$t("newAdd.remainingPosition")),1),e("div",Ze,"$"+n(o.removeAmountRates),1)]),e("div",He,[e("div",Je,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Ye),e("span",null,n(o.showNum(o.precision.minus(Number(o.positionInfo.amountA),Number(o.fromCoinAmount)),o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),P(" "+n(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol)+" "+n(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.labels&&o.positionInfo.token_a.labels[0]?`(${o.positionInfo.token_a.labels[0]})`:""),1)]),e("div",xe,"\u2248 $"+n(o.removeAmountARates),1)]),e("div",on,[e("div",en,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,nn),e("span",null,n(o.showNum(o.precision.minus(Number(o.positionInfo.amountB),Number(o.toCoinAmount)),o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),P(" "+n(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol)+" "+n(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.labels&&o.positionInfo.token_b.labels[0]?`(${o.positionInfo.token_b.labels[0]})`:""),1)]),e("div",sn,"\u2248 $"+n(o.removeAmountBRates),1)])])):oo("",!0),o.isShowSwapSetting?(N(),_o(Z,{key:1,onOnClose:r[6]||(r[6]=t=>o.isShowSwapSetting=!1)})):oo("",!0),Ho(e("div",tn,[q(H)],512),[[Jo,o.pools.currentPositionLoading]])])}const pn=Qo(ie,[["render",an],["__scopeId","data-v-a0a58f5f"]]);export{pn as default};
